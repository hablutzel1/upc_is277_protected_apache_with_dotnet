/*
 
jsPDF standard_fonts_metrics plugin
Copyright (c) 2012 Willow Systems Corporation, willow-systems.com
MIT license.
 
 jsPDF split_text_to_size plugin
 Copyright (c) 2012 Willow Systems Corporation, willow-systems.com
 MIT license.

 jsPDF Silly SVG plugin
 Copyright (c) 2012 Willow Systems Corporation, willow-systems.com
*/
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){window.OAT={};for(var uR="",i=0;i<jQuery("script").length;i++){var js_url=jQuery("script")[i].src;if(0<js_url.indexOf("gxpivotjs")){uR=js_url;break}}OAT.rP=uR.substring(0,uR.indexOf("QueryViewer/oatPivot"));if("jap"==gx.languageCode||"jpn"==gx.languageCode||"jp"==gx.languageCode||"ja"==gx.languageCode||"jpx"==gx.languageCode||"ain"==gx.languageCode||"jpns"==gx.languageCode||"ams"==gx.languageCode||"japanese"==gx.languageCode||"JAP"==gx.languageCode||
"JP"==gx.languageCode||"JA"==gx.languageCode||"JPN"==gx.languageCode||"ja-JP"==gx.languageCode||"ja_JP"==gx.languageCode||"jp"==gx.languageCode){for(var b=gx.util.resourceUrl(OAT.rP+"QueryViewer/oatPivot/downloadify/jsPDF_japanese.js",!0),d=document.getElementsByTagName("head")[0]||document.documentElement,s=d.getElementsByTagName("script"),prevLoad=!1,i=0;s.length>i;i++)s[i].src==b&&(prevLoad=!0);if(!prevLoad){var e=document.createElement("script");e.type="text/javascript";e.src=b;e.onerror=function(){var c=
document.createElement("script");c.type="text/javascript";c.src=gx.util.resourceUrl(OAT.rP+"QueryViewer/oatPivot/downloadify/jsPDF_japanese.src.js",!0);var g=document.getElementsByTagName("head")[0]||document.documentElement;g.insertBefore(c,g.lastChild)};e.onreadystatechange=function(){var c=this.readyState;if("loaded"===c||"complete"===c)e.onreadystatechange=null};d.insertBefore(e,d.lastChild)}}var featureList=["pivot","grid","statistics"];OAT.Preferences={showAjax:1,useCursors:1,windowTypeOverride:0,
xsltPath:"../xslt/",imagePath:gx.util.resourceUrl(OAT.rP+"QueryViewer/oatPivot/images/",!0),stylePath:gx.util.resourceUrl(OAT.rP+"QueryViewer/oatPivot/css/",!0),version:"19.03.2008",httpError:1,allowDefaultResize:1,allowDefaultDrag:1};OAT.$=function(c){var g="string"==typeof c?document.getElementById(c):c;if(c instanceof Array)for(var g=[],h=0;h<c.length;h++)g.push(OAT.$(c[h]));return!g?!1:g};OAT.$$=function(c,g){var h=g||document,j=h.getElementsByTagName("*"),k=[];OAT.Dom.isClass(h,c)&&k.push(h);
for(h=0;h<j.length;h++)OAT.Dom.isClass(j[h],c)&&k.push(j[h]);return k};OAT.$v=function(c){c=OAT.$(c);return!c||!("value"in c)?!1:c.value};Array.prototype.findIndex=function(c){for(var g=0;g<this.length;g++)if(this[g]==c)return g;return-1};String.prototype.trimpivot=function(){var c=this.match(/^ *(.*?) *$/);return c?c[1]:this};OAT.addTextNode=function(c,g){var h=document.createTextNode(g),j=jQuery('<span id="span_txt_pivot"></span>')[0];j.appendChild(h);c.appendChild(j)};OAT.addImageNode=function(c,
g,h,j){var k=document.createElement("i");void 0!=j&&k.setAttribute("id",j);k.setAttribute("class","material-icons");k.setAttribute("style",h);k.textContent=g;c.appendChild(k)};OAT.replaceTextNode=function(c,g){for(;c.firstChild;)c.removeChild(c.firstChild);var h=document.createTextNode(g);c.appendChild(h)};OAT.AddItemToList=function(c,g){-1==c.indexOf(g)&&c.push(g);return c.sort(function(c,g){return c-g})};OAT.removeIconFont=function(c){return c.replace(/arrow_drop_up/g,"").replace(/arrow_drop_down/g,
"").replace(/indeterminate_check_box/g,"").replace(/add_box/g,"")};OAT.ApplyPictureValue=function(c,g,h,j){if("#NuN#"==c)return h=h.getAttribute("textForNullValues"),""==h?" ":void 0!=h?h:" ";var k=void 0!=h.getAttribute("decimalSeparator")&&null!=h.getAttribute("decimalSeparator")?h.getAttribute("decimalSeparator"):".",l=void 0!=h.getAttribute("decimalPlaces")&&null!=h.getAttribute("decimalPlaces")?h.getAttribute("decimalPlaces"):2;h.getAttribute("thousandsSeparator");var n=h.getAttribute("dateFormat"),
h=c,o=!1,m="";if("integer"==g||"real"==g)if(void 0!=j||null!=j)if("Z"!=j[0]||"9"!=j[0]||","!=j[0]||"."!=j[0]){for(var o=!0,r=0;j.length>r&&"Z"!=j[r]&&"9"!=j[r]&&","!=j[r]&&"."!=j[r];)r++;m=j.substring(0,r);j=j.substring(r)}var t=!1,u="";if("integer"==g||"real"==g)if(void 0!=j||null!=j)if("Z"!=j[j.length-1]||"9"!=j[j.length-1]||","!=j[j.length-1]||"."!=j[j.length-1]){t=!0;for(r=j.length-1;-1<r&&"Z"!=j[r]&&"9"!=j[r]&&","!=j[r]&&"."!=j[r];)r--;u=j.substring(r+1);j=j.substring(0,r+1)}switch(g){case "integer":l=
0;case "real":if(void 0!=j&&""!=j)h=qv.util.formatNumber(parseFloat(c),l,j,!1);else if(r=c.split("."),n=!0,""==j&&"integer"==g&&(n=!1),"real"==g&&(h=parseFloat(c).toFixed(2),r=h.split(".")),h=r[0],c=-1,void 0!=j&&""!=j&&(j=j.split("."),1<j.length&&(c=j[1].indexOf("Z"))),null==r[1]){if(n&&(j=l,-1!=c&&(j=c),0<j)){h+=k;for(c=0;c<j;c++)h+="0"}}else if(n)if(-1===c)if(r[1].length<l){h=h+k+r[1];for(c=0;c<l-r[1].length;c++)h+="0"}else if(r[1].length>l){j="";for(c=0;c<l;c++)j+=r[1].charAt(c);h=h+k+j}else h=
h+k+r[1];else if(j=c,r[1].length<l){if(0<r[1].length||0<j){h=h+k+r[1];for(c=0;c<j-r[1].length;c++)h+="0"}}else if(r[1].length>l){j="";for(c=0;c<l;c++)j+=r[1].charAt(c);h=h+k+j}else h=h+k+r[1];break;case "date":if(""==c)return"";if(""===j)if(l=c.split("-"),void 0!=n&&null!=n){pict=n.split("");h="";for(c=0;2>=c;c++)"M"===pict[c]&&(h+=l[1]),"D"===pict[c]&&(h+=l[2]),"Y"===pict[c]&&(h+=l[0]),2!=c&&(h+="/")}else h=l[1]+"/"+l[2]+"/"+l[0];else if(r=c.split("-"),"99/99/9999"==j)if(4==r[0].length)h=void 0==
n||null==n||"MDY"==n?r[1]+"/"+r[2]+"/"+r[0]:void 0!=n&&"YMD"==n?r[0]+"/"+r[1]+"/"+r[2]:r[2]+"/"+r[1]+"/"+r[0];else for(h=c;-1!=h.indexOf("-");)h.replace("-","/");else"99/99/99"==j?4==r[0].length&&(r[0]=r[0].substr(r[0].length-2,2)):"9999/99/99"!=j&&4==r[0].length&&(r[0]=r[0].substr(r[0].length-2,2)),h=void 0==n||null==n||"MDY"==n?r[1]+"/"+r[2]+"/"+r[0]:void 0!=n&&"YMD"==n?r[0]+"/"+r[1]+"/"+r[2]:r[2]+"/"+r[1]+"/"+r[0];break;case "datetime":if(""==c)return"";k=c.split("T");-1===c.indexOf("T")&&(k=c.split(" "));
if(""===j)if(l=k[0].split("-"),void 0!=n&&null!=n){pict=n.split("");h="";for(c=0;2>=c;c++)"M"===pict[c]&&(h+=l[1]),"D"===pict[c]&&(h+=l[2]),"Y"===pict[c]&&(h+=l[0]),2!=c&&(h+="/")}else h=l[1]+"/"+l[2]+"/"+l[0];else if(l=j.split(" "),r=k[0].split("-"),"99/99/9999"==l[0])if(4==r[0].length)h=void 0==n||null==n||"MDY"==n?r[1]+"/"+r[2]+"/"+r[0]:void 0!=n&&"YMD"==n?r[0]+"/"+r[1]+"/"+r[2]:r[2]+"/"+r[1]+"/"+r[0];else for(h=c;-1!=h.indexOf("-");)h.replace("-","/");else"99/99/99"==l[0]?(4==r[0].length&&(r[0]=
r[0].substr(r[0].length-2,2)),h=void 0==n||null==n||"MDY"==n?r[1]+"/"+r[2]+"/"+r[0]:void 0!=n&&"YMD"==n?r[0]+"/"+r[1]+"/"+r[2]:r[2]+"/"+r[1]+"/"+r[0]):h="9999/99/99"==l[0]?void 0==n||null==n||"MDY"==n?r[1]+"/"+r[2]+"/"+r[0]:void 0!=n&&"YMD"==n?r[0]+"/"+r[1]+"/"+r[2]:r[2]+"/"+r[1]+"/"+r[0]:"";if(""===j)1<k.length&&(k=k[1].split("."),h=h+" "+k[0]);else if(l=j.split(" "),2>j.split(" ").length&&("99/99/9999"!=l[0]&&"9999/99/99"!=l[0]&&"99/99/99"!=l[0])&&l.push(j),1<l.length)switch(1<k.length?(k=k[1].split("."),
j=k[0].split(":"),2>j.length&&(j[1]="00",j[2]="00"),3>j.length&&(j[2]="00"),j[3]=2>k.length?"000":k[1]):(j=Array(3),j[0]="00",j[1]="00",j[2]="00",j[3]="000"),l[1]){case "99":h=h+" "+j[0];break;case "99:99":h=h+" "+j[0]+":"+j[1];break;case "99:99:99":h=h+" "+j[0]+":"+j[1]+":"+j[2];break;case "99:99:99.999":h=h+" "+j[0]+":"+j[1]+":"+j[2]+"."+j[3];break;default:h=h+" "+j[0]+":"+j[1]+":"+j[2]}break;case "character":h=OAT.Dom.fromSafeXML(c),"@!"==j&&(h=c.toUpperCase())}o&&(h=m+h);t&&(h+=u);return h};OAT.SetSelectedNodeBackgroundColor=
function(c,g,h){OAT.ClearSelectedNodes(h);OAT.SetNodeBackgroundColor(c,g)};OAT.ClearSelectedNodes=function(c){c.find(".gx-qv-selected-element").removeClass("gx-qv-selected-element")};OAT.SetNodeBackgroundColor=function(c){jQuery(c).hasClass("gx-qv-selected-element")||jQuery(c).addClass("gx-qv-selected-element")};OAT.IsNodeSelected=function(c){return jQuery(c).hasClass("gx-qv-selected-element")};OAT.SelectAllRow=function(c,g,h){for(var j=0;j<c.children.length;j++)(void 0==h||h!=j)&&OAT.SetNodeBackgroundColor(c.children[j],
g)};OAT.Dom={create:function(c,g,h){c=document.createElement(c);if(g)for(prop in g)c.style[prop]=g[prop];h&&(c.className=h);return c},createNS:function(c,g){if(document.createElementNS)var h=document.createElementNS(c,g);else h=document.createElement(g),h.setAttribute("xmlns",c);return h},text:function(c){return document.createTextNode(c)},button:function(c){var g=OAT.Dom.create("input");g.type="button";g.value=c;return g},radio:function(c){if(OAT.Browser.isIE)var g=document.createElement('<input type="radio" name="'+
c+'" />');else g=OAT.Dom.create("input"),g.name=c,g.type="radio";return g},image:function(c,g,h,j){h=OAT.Dom.create("img",{width:h?h+"px":"auto",height:j?j+"px":"auto"});OAT.Dom.imageSrc(h,c,g);return h},imageSrc:function(c,g){var h=OAT.$(c);g.toLowerCase().match(/png$/);h.src=g},option:function(c,g,h){var j=OAT.Dom.create("option");OAT.addTextNode(j,c);j.value=g;h&&OAT.$(h).appendChild(j);return j},append:function(){for(var c=0;c<arguments.length;c++){var g=arguments[c];if(g instanceof Array&&!(2>
g.length))for(var h=OAT.$(g[0]),j=1;j<g.length;j++){var k=g[j];k instanceof Array||(k=[k]);for(var l=0;l<k.length;l++)h.appendChild(OAT.$(k[l]))}}},hide:function(c){if(1<arguments.length)for(var g=0;g<arguments.length;g++)OAT.Dom.hide(arguments[g]);else if(c instanceof Array)for(g=0;g<c.length;g++)OAT.Dom.hide(c[g]);else{var h=OAT.$(c);if(h){for(var j=h.getElementsByTagName("input"),k=[],g=0;g<j.length;g++)k.push(j[g]);"input"==h.tagName.toLowerCase()&&k.push(h);for(g=0;g<k.length;g++)if(j=k[g],("radio"==
j.type||"checkbox"==j.type)&&!j.__checked)j.__checked=j.checked?"1":"0";h.style.display="none"}}},show:function(c){if(1<arguments.length)for(var g=0;g<arguments.length;g++)OAT.Dom.show(arguments[g]);else if(c instanceof Array)for(g=0;g<c.length;g++)OAT.Dom.show(c[g]);else{var h=OAT.$(c);if(h){h.style.display="";for(var j=h.getElementsByTagName("input"),k=[],g=0;g<j.length;g++)k.push(j[g]);"input"==h.tagName.toLowerCase()&&k.push(h);for(g=0;g<k.length;g++)if(h=k[g],"radio"==h.type||"checkbox"==h.type)h.__checked&&
"1"===h.__checked&&(h.checked=!0),h.__checked&&"0"===h.__checked&&(h.checked=!1),h.__checked=!1}}},clear:function(c){for(c=OAT.$(c);c.firstChild;)c.removeChild(c.firstChild)},unlink:function(c){(c=OAT.$(c))&&c.parentNode&&c.parentNode.removeChild(c)},center:function(c,g,h,j){var c=OAT.$(c),k=c.offsetParent;j&&(k=j);if(k){var l=k==document.body||"html"==k.tagName.toLowerCase()?OAT.Dom.getViewport():OAT.Dom.getWH(k),n=OAT.Dom.getWH(c),j=Math.round(l[0]/2-n[0]/2),l=Math.round(l[1]/2-n[1]/2);0>l&&(l=
30);n=OAT.Dom.getScroll();if(k==document.body||"html"==k.tagName.toLowerCase())j+=n[0],l+=n[1];g&&(c.style.left=j+"px");h&&(c.style.top=l+"px")}},isChild:function(c,g){var h=OAT.$(c),j=OAT.$(g),h=h.parentNode;do{if(!h)break;if(h==j)return!0;h=h.parentNode}while(h!=document.body&&h!=document);return!1},isKonqueror:function(){return navigator.userAgent.match(/konqueror/i)?!0:!1},isKHTML:function(){return navigator.userAgent.match(/khtml/i)?!0:!1},isIE:function(){return document.attachEvent&&!document.addEventListener?
!0:!1},isIE7:function(){return navigator.userAgent.match(/msie 7/i)?!0:!1},isIE6:function(){return OAT.Dom.isIE()&&!OAT.Dom.isIE7()},isGecko:function(){return!OAT.Dom.isKHTML()&&navigator.userAgent.match(/Gecko/i)?!0:!1},isOpera:function(){return navigator.userAgent.match(/Opera/)?!0:!1},isWebKit:function(){return navigator.userAgent.match(/AppleWebKit/)?!0:!1},isMac:function(){return navigator.platform.toString().match(/mac/i)?!0:!1},isLinux:function(){return navigator.platform.toString().match(/linux/i)?
!0:!1},isWindows:function(){return navigator.userAgent.toString().match(/windows/i)?!0:!1},color:function(c){if(c.match(/#/))return c=(4==c.length?"#"+c.charAt(1)+c.charAt(1)+c.charAt(2)+c.charAt(2)+c.charAt(3)+c.charAt(3):c).match(/#(..)(..)(..)/),[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)];c=c.match(/\(([^,]*),([^,]*),([^\)]*)/);return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]},isClass:function(c,g){var h=OAT.$(c);return!h?!1:"*"==g?!0:""==g||!h.className?!1:-1!=h.className.split(" ").indexOf(g)},
addClass:function(c,g){var h=OAT.$(c);if(h&&!OAT.Dom.isClass(h,g)){var j=h.className.split(" ");j.push(g);""==j[0]&&j.splice(0,1);h.className=j.join(" ")}},setIdPropertyValue:function(c,g){var h=OAT.$(c);h&&(h.id=g)},removeClass:function(c,g){var h=OAT.$(c);if(h&&OAT.Dom.isClass(h,g)){"*"==g&&(h.className="");var j=h.className.split(" "),k=j.indexOf(g);-1!=k&&(j.splice(k,1),h.className=j.join(" "))}},getViewport:function(){return OAT.Browser.isWebKit?[window.innerWidth,window.innerHeight]:OAT.Browser.isOpera||
"BackCompat"==document.compatMode?[document.body.clientWidth,document.body.clientHeight]:[document.documentElement.clientWidth,document.documentElement.clientHeight]},position:function(c){var c=OAT.$(c),g=c.offsetParent;if(c==document.body||c==document||!g)return OAT.Dom.getLT(c);var h=OAT.Dom.position(g),j=OAT.Dom.getLT(c),k=j[0],j=j[1];if(!OAT.Browser.isOpera||c.scrollTop!=c.offsetTop||c.scrollLeft!=c.offsetLeft)k-=c.scrollLeft,j-=c.scrollTop;if(OAT.Browser.isWebKit&&g==document.body&&"absolute"==
OAT.Dom.style(c,"position"))return[k,j];k+=h[0];j+=h[1];return[k,j]},getLT:function(c){var g=OAT.$(c),c=g.style.left&&"relative"!=g.style.position?parseInt(g.style.left):g.offsetLeft,g=g.style.top&&"relative"!=g.style.position?parseInt(g.style.top):g.offsetTop;return[c,g]},getWH:function(c){var g,h=OAT.$(c);h.style.width&&!h.style.width.match(/%/)&&"auto"!=h.style.width?c=parseInt(h.style.width):OAT.Style.get(h,"width")&&!OAT.Browser.isIE?c=Math.round(parseFloat(OAT.Style.get(h,"width"))):(c=h.offsetWidth,
"input"==h.tagName.toLowerCase()&&(c+=5));h.style.height&&!h.style.height.match(/%/)&&"auto"!=h.style.height?g=parseInt(h.style.height):OAT.Style.get(h,"height")&&!OAT.Browser.isIE?g=Math.round(parseFloat(OAT.Style.get(h,"height"))):(g=h.offsetHeight,"input"==h.tagName.toLowerCase()&&(g+=5));h==document.body&&(g=OAT.Browser.isIE?document.body.clientHeight:window.innerHeight);return[c,g]},moveBy:function(c,g,h){c=OAT.$(c);if("absolute"==OAT.Dom.style(c,"position")&&(c.style.left||(c.style.left=c.offsetLeft+
"px",c.style.right=""),!c.style.top))c.style.top=c.offsetTop+"px",c.style.bottom="";var j=OAT.Dom.getLT(c),h=j[1]+h;c.style.left=j[0]+g+"px";c.style.top=h+"px"},resizeBy:function(c,g,h){c=OAT.$(c);if("absolute"==OAT.Dom.style(c,"position")&&g&&(c.style.left||(c.style.left=c.offsetLeft+"px",c.style.right=""),!c.style.top&&h))c.style.top=c.offsetTop+"px",c.style.bottom="";var j=OAT.Dom.getWH(c),k=j[0]+g,j=j[1]+h;g&&(c.style.width=k+"px");h&&(c.style.height=j+"px")},decodeImage:function(c){var g="image/";
switch(OAT.Crypto.base64d(c).charAt(1)){case "I":g+="gif";break;case "P":g+="png";break;case "M":g+="bmp";break;default:g+="jpeg"}return"data:"+g+";base64,"+c},removeSelection:function(){var c=!1;document.getSelection&&!OAT.Browser.isGecko&&(c=document.getSelection());window.getSelection&&(c=window.getSelection());document.selection&&(c=document.selection);c&&(c.empty&&c.empty(),c.removeAllRanges&&c.removeAllRanges())},getScroll:function(){var c=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),
g=Math.max(document.documentElement.scrollTop,document.body.scrollTop);return[c,g]},getFreeSpace:function(c,g){var h=OAT.Dom.getScroll(),j=OAT.Dom.getViewport();return[c-h[0]>j[0]-c+h[0],g-h[1]>j[1]-g+h[1]]},toSafeXML:function(c){return"string"!=typeof c?c:c.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")},fromSafeXML:function(c){return c.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<")},uriParams:function(){var c={},g=location.search;1<g.length&&(g=g.substring(1));
if(!g)return c;for(var g=g.split("&"),h=0;h<g.length;h++){var j=g[h];if(j){var k=j.indexOf("=");if(-1==k)c[decodeURIComponent(j)]="";else{var l=j.substring(0,k),j=j.substring(k+1),l=decodeURIComponent(l),j=decodeURIComponent(j),k=!1;(k=l.match(/(.*)\[\]$/))?(l=k[1],l in c?c[l].push(j):c[l]=[j]):c[l]=j}}}return c},changeHref:function(c,g){for(var h=!1,j=OAT.$(c),k=j;k.parentNode;)k=k.parentNode,k==document.body&&(h=!0);h?j.href=g:j.parentNode?(h=j.parentNode,k=j.nextSibling,document.body.appendChild(j),
j.href=g,OAT.Dom.unlink(j),h.insertBefore(j,k)):(document.body.appendChild(j),j.href=g,OAT.Dom.unlink(j))},makePosition:function(c){c=OAT.$(c);"absolute"!=OAT.Dom.style(c,"position")&&(c.style.position="relative")}};OAT.Style={include:function(c,g,h){if(c){c=g+"QueryViewer/oatPivot/css/"+c;if(!h)for(var j=document.getElementsByTagName("link"),h=location.protocol+"//"+location.host,g=0;g<j.length;g++)if(c==j[g].getAttribute("href")||h+c==j[g].getAttribute("href"))return;g=OAT.Dom.create("link");g.rel=
"stylesheet";g.type="text/css";g.href=c;jQuery("head").prepend(g);if(gx.util.browser.isIE()){c="Resources/English/GeneXusXEv2.css";for(g=0;g<=j.length-1;g++)"gxtheme_css_reference"===j[g].getAttribute("id")&&(c=j[g].getAttribute("href"));jQuery("head").prepend(jQuery('<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+c+'" />'))}}},get:function(c,g){var h=OAT.$(c);if(document.defaultView&&document.defaultView.getComputedStyle)return h=document.defaultView.getComputedStyle(h,
""),!h?!0:h[g];try{var j=h.currentStyle[g]}catch(k){j=h.getExpression(g)}return j},background:function(c,g){var h=OAT.$(c);g.toLowerCase().match(/png$/)&&OAT.Browser.isIE?h.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+g+"', sizingMethod='crop')":h.style.backgroundImage="url("+g+")"},apply:function(c,g){var h=OAT.$(c);if(h)for(var j in g)h.style[j]=g[j]},opacity:function(c,g){var h=Math.max(g,0),j=OAT.$(c);OAT.Browser.isIE?j.style.filter="alpha(opacity="+Math.round(100*h)+
")":j.style.opacity=h}};OAT.Dom.style=OAT.Style.get;OAT.Dom.applyStyle=OAT.Style.apply;OAT.Browser={isIE:OAT.Dom.isIE(),isIE6:OAT.Dom.isIE6(),isIE7:OAT.Dom.isIE7(),isGecko:OAT.Dom.isGecko(),isOpera:OAT.Dom.isOpera(),isKonqueror:OAT.Dom.isKonqueror(),isKHTML:OAT.Dom.isKHTML(),isWebKit:OAT.Dom.isWebKit(),isMac:OAT.Dom.isMac(),isLinux:OAT.Dom.isLinux(),isWindows:OAT.Dom.isWindows()};OAT.Event={attach:function(c,g,h){c=OAT.$(c);c.addEventListener?c.addEventListener(g,h,!1):c.attachEvent?c.attachEvent("on"+
g,h):c["on"+g]=h},detach:function(c,g,h){c=OAT.$(c);c.removeEventListener?c.removeEventListener(g,h,!1):c.detachEvent?c.detachEvent("on"+g,h):c["on"+g]=!1},source:function(c){return c.target?c.target:c.srcElement},cancel:function(c){c.cancelBubble=!0;c.stopPropagation&&c.stopPropagation()},position:function(c){var g=OAT.Dom.getScroll();return[c.clientX+g[0],c.clientY+g[1]]},prevent:function(c){c.preventDefault&&c.preventDefault();gx.util.browser.isIE()&&(c.returnValue=!1)}};OAT.Dom.attach=OAT.Event.attach;
OAT.Dom.detach=OAT.Event.detach;OAT.Dom.source=OAT.Event.source;OAT.Dom.eventPos=OAT.Event.position;OAT.Dom.prevent=OAT.Event.prevent;OAT.Loader={toolkitPath:!1,loadOccurred:0,openAjax:!1,include:function(c){for(var g=OAT.Loader.toolkitPath||"",c="object"==typeof c?c:[c],h=0;h<c.length;h++){var j=g+c[h],k=document.createElement("script");k.src=j;document.getElementsByTagName("head")[0].appendChild(k)}},findPath:function(){OAT.Loader.toolkitPath=gx.util.resourceUrl(OAT.rP+"QueryViewer/oatPivot/js/",
!0)},startOpenAjax:function(){OpenAjax.hub.registerLibrary("oat","http://www.openlinksw.com/oat","1.0")}};OAT.MSG={DEBUG:0,OAT_DEBUG:0,OAT_LOAD:1,ANIMATION_STOP:2,TREE_EXPAND:3,TREE_COLLAPSE:4,DS_RECORD_PREADVANCE:5,DS_RECORD_ADVANCE:6,DS_PAGE_PREADVANCE:7,DS_PAGE_ADVANCE:8,AJAX_START:9,AJAX_ERROR:10,GD_START:11,GD_ABORT:12,GD_END:13,DOCK_DRAG:14,DOCK_REMOVE:15,SLB_OPENED:16,SLB_CLOSED:17,registry:[],attach:function(c,g,h){c&&OAT.MSG.registry.push([c,g,h])},detach:function(c,g,h){if(c){for(var j=
-1,k=0;k<OAT.MSG.registry.length;k++){var l=OAT.MSG.registry[k];l[0]==c&&(l[1]==g&&l[2]==h)&&(j=k)}-1!=j&&OAT.MSG.registry.splice(j,1)}},send:function(c,g,h){for(var j=0;j<OAT.MSG.registry.length;j++){var k=OAT.MSG.registry[j];if(c==k[0]||"*"==k[0]){var l=g==k[1]||"*"==k[1];if(!l&&k[1].toString().match(/\*/)){var n=RegExp(k[1]),o="",m;for(m in OAT.MSG)OAT.MSG[m]==g&&(o=m);o.match(n)&&(l=!0)}if(l)k[2](c,g,h)}}}};OAT.Debug={data:[],attach:function(c,g){OAT.MSG.attach(c,g,OAT.Debug.listen)},listen:function(c,
g,h){var j="n/a",k;for(k in OAT.MSG){var l=OAT.MSG[k];"number"==typeof l&&l==g&&(j=k)}OAT.Debug.data.push([c,j,h])}};OAT.Loader.findPath();OAT.Loader.openAjax&&OAT.Loader.startOpenAjax();OAT.Event.attach(window,"load",function(){OAT.Loader.loadOccurred=1;OAT.Loader.callListeners()});OAT.Loader.listeners=[];OAT.Loader.addListener=function(c){1==OAT.Loader.loadOccurred?c():OAT.Loader.listeners.push(c)};OAT.Loader.callListeners=function(){for(var c=0,g=this.listeners.length;c<g;c++)OAT.Loader.listeners[c]()}}
if((!gx.util.browser.isIE()||8<gx.util.browser.ieVersion())&&gx.util.browser.isIE()&&9==gx.util.browser.ieVersion()){(function(){Downloadify=window.Downloadify={queue:{},uid:(new Date).getTime(),getTextForSave:function(c){return(c=Downloadify.queue[c])?c.getData():""},getFileNameForSave:function(c){return(c=Downloadify.queue[c])?c.getFilename():""},getDataTypeForSave:function(c){return(c=Downloadify.queue[c])?c.getDataType():""},saveComplete:function(c){(c=Downloadify.queue[c])&&c.complete();return!0},
saveCancel:function(c){(c=Downloadify.queue[c])&&c.cancel();return!0},saveError:function(c){(c=Downloadify.queue[c])&&c.error();return!0},addToQueue:function(c){Downloadify.queue[c.queue_name]=c},getUID:function(c){""==c.id&&(c.id="downloadify_"+Downloadify.uid++);return c.id}};Downloadify.create=function(c,g){var h="string"==typeof c?document.getElementById(c):c;return new Downloadify.Container(h,g)};Downloadify.Container=function(c,g){var h=this;h.el=c;h.enabled=!0;h.dataCallback=null;h.filenameCallback=
null;h.data=null;h.filename=null;h.enable=function(){document.getElementById(h.flashContainer.id).setEnabled(!0);h.enabled=!0};h.disable=function(){document.getElementById(h.flashContainer.id).setEnabled(!1);h.enabled=!1};h.getData=function(){return!h.enabled?"":h.dataCallback?h.dataCallback():h.data?h.data:""};h.getFilename=function(){return h.filenameCallback?h.filenameCallback():h.filename?h.filename:""};h.getDataType=function(){return h.options.dataType?h.options.dataType:"string"};h.complete=
function(){if("function"===typeof h.options.onComplete)h.options.onComplete()};h.cancel=function(){if("function"===typeof h.options.onCancel)h.options.onCancel()};h.error=function(){if("function"===typeof h.options.onError)h.options.onError()};(function(){h.options=g;h.options.append||(h.el.innerHTML="");h.flashContainer=document.createElement("span");h.el.appendChild(h.flashContainer);h.queue_name=Downloadify.getUID(h.flashContainer);"function"===typeof h.options.filename?h.filenameCallback=h.options.filename:
h.options.filename&&(h.filename=h.options.filename);"function"===typeof h.options.data?h.dataCallback=h.options.data:h.options.data&&(h.data=h.options.data);var c={queue_name:h.queue_name,width:h.options.width,height:h.options.height},k={allowScriptAccess:"always"},l={id:h.flashContainer.id,name:h.flashContainer.id};!1===h.options.enabled&&(h.enabled=!1);!0===h.options.transparent&&(k.wmode="transparent");h.options.downloadImage&&(c.downloadImage=h.options.downloadImage);swfobject.embedSWF(h.options.swf,
h.flashContainer.id,h.options.width,h.options.height,"10",null,c,k,l);Downloadify.addToQueue(h)})()};Downloadify.defaultOptions={swf:"media/downloadify.swf",downloadImage:"images/download_file.png",width:100,height:30,transparent:!0,append:!1,dataType:"string"}})();"undefined"!=typeof jQuery&&function(c){c.fn.downloadify=function(g){return this.each(function(){g=c.extend({},Downloadify.defaultOptions,g);var h=Downloadify.create(this,g);c(this).data("Downloadify",h)})}}(jQuery);"undefined"!=typeof MooTools&&
Element.implement({downloadify:function(c){c=$merge(Downloadify.defaultOptions,c);return this.store("Downloadify",Downloadify.create(this,c))}});var swfobject=function(){function c(){if(!M){try{var f=D.getElementsByTagName("body")[0].appendChild(D.createElement("span"));f.parentNode.removeChild(f)}catch(c){return}M=!0;for(var f=Q.length,g=0;g<f;g++)Q[g]()}}function g(f){M?f():Q[Q.length]=f}function h(f){if(typeof I.addEventListener!=q)I.addEventListener("load",f,!1);else if(typeof D.addEventListener!=
q)D.addEventListener("load",f,!1);else if(typeof I.attachEvent!=q)x(I,"onload",f);else if("function"==typeof I.onload){var c=I.onload;I.onload=function(){c();f()}}else I.onload=f}function j(){var f=D.getElementsByTagName("body")[0],c=D.createElement(C);c.setAttribute("type",y);var g=f.appendChild(c);if(g){var h=0;(function(){if(typeof g.GetVariable!=q){var j=g.GetVariable("$version");j&&(j=j.split(" ")[1].split(","),O.pv=[parseInt(j[0],10),parseInt(j[1],10),parseInt(j[2],10)])}else if(10>h){h++;setTimeout(arguments.callee,
10);return}f.removeChild(c);g=null;k()})()}else k()}function k(){var f=U.length;if(0<f)for(var c=0;c<f;c++){var g=U[c].id,h=U[c].callbackFn,k={success:!1,id:g};if(0<O.pv[0]){var j=v(g);if(j)if(B(U[c].swfVersion)&&!(O.wk&&312>O.wk))w(g,!0),h&&(k.success=!0,k.ref=l(g),h(k));else if(U[c].expressInstall&&n()){k={};k.data=U[c].expressInstall;k.width=j.getAttribute("width")||"0";k.height=j.getAttribute("height")||"0";j.getAttribute("class")&&(k.styleclass=j.getAttribute("class"));j.getAttribute("align")&&
(k.align=j.getAttribute("align"));for(var A={},j=j.getElementsByTagName("param"),T=j.length,K=0;K<T;K++)"movie"!=j[K].getAttribute("name").toLowerCase()&&(A[j[K].getAttribute("name")]=j[K].getAttribute("value"));o(k,A,g,h)}else m(j),h&&h(k)}else if(w(g,!0),h){if((g=l(g))&&typeof g.SetVariable!=q)k.success=!0,k.ref=g;h(k)}}}function l(f){var c=null;if((f=v(f))&&"OBJECT"==f.nodeName)typeof f.SetVariable!=q?c=f:(f=f.getElementsByTagName(C)[0])&&(c=f);return c}function n(){return!Z&&B("6.0.65")&&(O.win||
O.mac)&&!(O.wk&&312>O.wk)}function o(f,c,g,h){Z=!0;E=h||null;N={success:!1,id:g};var k=v(g);if(k){"OBJECT"==k.nodeName?(S=r(k),W=null):(S=k,W=g);f.id=G;if(typeof f.width==q||!/%$/.test(f.width)&&310>parseInt(f.width,10))f.width="310";if(typeof f.height==q||!/%$/.test(f.height)&&137>parseInt(f.height,10))f.height="137";D.title=D.title.slice(0,47)+" - Flash Player Installation";h=O.ie&&O.win?"ActiveX":"PlugIn";h="MMredirectURL="+I.location.toString().replace(/&/g,"%26")+"&MMplayerType="+h+"&MMdoctitle="+
D.title;c.flashvars=typeof c.flashvars!=q?c.flashvars+("&"+h):h;O.ie&&(O.win&&4!=k.readyState)&&(h=D.createElement("div"),g+="SWFObjectNew",h.setAttribute("id",g),k.parentNode.insertBefore(h,k),k.style.display="none",function(){k.readyState==4?k.parentNode.removeChild(k):setTimeout(arguments.callee,10)}());t(f,c,g)}}function m(f){if(O.ie&&O.win&&4!=f.readyState){var c=D.createElement("div");f.parentNode.insertBefore(c,f);c.parentNode.replaceChild(r(f),c);f.style.display="none";(function(){4==f.readyState?
f.parentNode.removeChild(f):setTimeout(arguments.callee,10)})()}else f.parentNode.replaceChild(r(f),f)}function r(f){var c=D.createElement("div");if(O.win&&O.ie)c.innerHTML=f.innerHTML;else if(f=f.getElementsByTagName(C)[0])if(f=f.childNodes)for(var g=f.length,h=0;h<g;h++)!(1==f[h].nodeType&&"PARAM"==f[h].nodeName)&&8!=f[h].nodeType&&c.appendChild(f[h].cloneNode(!0));return c}function t(f,c,g){var h,k=v(g);if(O.wk&&312>O.wk)return h;if(k)if(typeof f.id==q&&(f.id=g),O.ie&&O.win){var j="",A;for(A in f)f[A]!=
Object.prototype[A]&&("data"==A.toLowerCase()?c.movie=f[A]:"styleclass"==A.toLowerCase()?j+=' class="'+f[A]+'"':"classid"!=A.toLowerCase()&&(j+=" "+A+'="'+f[A]+'"'));A="";for(var T in c)c[T]!=Object.prototype[T]&&(A+='<param name="'+T+'" value="'+c[T]+'" />');k.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+j+">"+A+"</object>";V[V.length]=f.id;h=v(f.id)}else{T=D.createElement(C);T.setAttribute("type",y);for(var K in f)f[K]!=Object.prototype[K]&&("styleclass"==K.toLowerCase()?
T.setAttribute("class",f[K]):"classid"!=K.toLowerCase()&&T.setAttribute(K,f[K]));for(j in c)c[j]!=Object.prototype[j]&&"movie"!=j.toLowerCase()&&(f=T,A=j,K=c[j],g=D.createElement("param"),g.setAttribute("name",A),g.setAttribute("value",K),f.appendChild(g));k.parentNode.replaceChild(T,k);h=T}return h}function u(f){var c=v(f);c&&"OBJECT"==c.nodeName&&(O.ie&&O.win?(c.style.display="none",function(){if(4==c.readyState){var g=v(f);if(g){for(var h in g)"function"==typeof g[h]&&(g[h]=null);g.parentNode.removeChild(g)}}else setTimeout(arguments.callee,
10)}()):c.parentNode.removeChild(c))}function v(f){var c=null;try{c=D.getElementById(f)}catch(g){}return c}function x(f,c,g){f.attachEvent(c,g);L[L.length]=[f,c,g]}function B(f){var c=O.pv,f=f.split(".");f[0]=parseInt(f[0],10);f[1]=parseInt(f[1],10)||0;f[2]=parseInt(f[2],10)||0;return c[0]>f[0]||c[0]==f[0]&&c[1]>f[1]||c[0]==f[0]&&c[1]==f[1]&&c[2]>=f[2]?!0:!1}function H(f,c,g,h){if(!O.ie||!O.mac){var k=D.getElementsByTagName("head")[0];if(k){g=g&&"string"==typeof g?g:"screen";h&&(aa=R=null);if(!R||
aa!=g)h=D.createElement("style"),h.setAttribute("type","text/css"),h.setAttribute("media",g),R=k.appendChild(h),O.ie&&(O.win&&typeof D.styleSheets!=q&&0<D.styleSheets.length)&&(R=D.styleSheets[D.styleSheets.length-1]),aa=g;O.ie&&O.win?R&&typeof R.addRule==C&&R.addRule(f,c):R&&typeof D.createTextNode!=q&&R.appendChild(D.createTextNode(f+" {"+c+"}"))}}}function w(c,g){if(f){var h=g?"visible":"hidden";M&&v(c)?v(c).style.visibility=h:H("#"+c,"visibility:"+h)}}function z(f){return null!=/[\\\"<>\.;]/.exec(f)&&
typeof encodeURIComponent!=q?encodeURIComponent(f):f}var q="undefined",C="object",y="application/x-shockwave-flash",G="SWFObjectExprInst",I=window,D=document,F=navigator,J=!1,Q=[function(){J?j():k()}],U=[],V=[],L=[],S,W,E,N,M=!1,Z=!1,R,aa,f=!0,O=function(){var f=typeof D.getElementById!=q&&typeof D.getElementsByTagName!=q&&typeof D.createElement!=q,c=F.userAgent.toLowerCase(),g=F.platform.toLowerCase(),h=g?/win/.test(g):/win/.test(c),g=g?/mac/.test(g):/mac/.test(c),c=/webkit/.test(c)?parseFloat(c.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,
"$1")):!1,k=!+"\v1",j=[0,0,0],A=null;if(typeof F.plugins!=q&&typeof F.plugins["Shockwave Flash"]==C){if((A=F.plugins["Shockwave Flash"].description)&&!(typeof F.mimeTypes!=q&&F.mimeTypes[y]&&!F.mimeTypes[y].enabledPlugin))J=!0,k=!1,A=A.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),j[0]=parseInt(A.replace(/^(.*)\..*$/,"$1"),10),j[1]=parseInt(A.replace(/^.*\.(.*)\s.*$/,"$1"),10),j[2]=/[a-zA-Z]/.test(A)?parseInt(A.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof I.ActiveXObject!=q)try{var T=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
if(T&&(A=T.GetVariable("$version")))k=!0,A=A.split(" ")[1].split(","),j=[parseInt(A[0],10),parseInt(A[1],10),parseInt(A[2],10)]}catch(K){}return{w3:f,pv:j,wk:c,ie:k,win:h,mac:g}}();(function(){O.w3&&((typeof D.readyState!=q&&"complete"==D.readyState||typeof D.readyState==q&&(D.getElementsByTagName("body")[0]||D.body))&&c(),M||(typeof D.addEventListener!=q&&D.addEventListener("DOMContentLoaded",c,!1),O.ie&&O.win&&(D.attachEvent("onreadystatechange",function(){"complete"==D.readyState&&(D.detachEvent("onreadystatechange",
arguments.callee),c())}),I==top&&function(){if(!M){try{D.documentElement.doScroll("left")}catch(f){setTimeout(arguments.callee,0);return}c()}}()),O.wk&&function(){M||(/loaded|complete/.test(D.readyState)?c():setTimeout(arguments.callee,0))}(),h(c)))})();(function(){O.ie&&O.win&&window.attachEvent("onunload",function(){for(var f=L.length,c=0;c<f;c++)L[c][0].detachEvent(L[c][1],L[c][2]);f=V.length;for(c=0;c<f;c++)u(V[c]);for(var g in O)O[g]=null;O=null;for(var h in swfobject)swfobject[h]=null;swfobject=
null})})();return{registerObject:function(f,c,g,h){if(O.w3&&f&&c){var k={};k.id=f;k.swfVersion=c;k.expressInstall=g;k.callbackFn=h;U[U.length]=k;w(f,!1)}else h&&h({success:!1,id:f})},getObjectById:function(f){if(O.w3)return l(f)},embedSWF:function(f,c,h,k,j,l,A,T,K,X){var P={success:!1,id:c};O.w3&&!(O.wk&&312>O.wk)&&f&&c&&h&&k&&j?(w(c,!1),g(function(){h+="";k+="";var g={};if(K&&typeof K===C)for(var m in K)g[m]=K[m];g.data=f;g.width=h;g.height=k;m={};if(T&&typeof T===C)for(var ea in T)m[ea]=T[ea];
if(A&&typeof A===C)for(var r in A)m.flashvars=typeof m.flashvars!=q?m.flashvars+("&"+r+"="+A[r]):r+"="+A[r];if(B(j))ea=t(g,m,c),g.id==c&&w(c,!0),P.success=!0,P.ref=ea;else{if(l&&n()){g.data=l;o(g,m,c,X);return}w(c,!0)}X&&X(P)})):X&&X(P)},switchOffAutoHideShow:function(){f=!1},ua:O,getFlashPlayerVersion:function(){return{major:O.pv[0],minor:O.pv[1],release:O.pv[2]}},hasFlashPlayerVersion:B,createSWF:function(f,c,g){if(O.w3)return t(f,c,g)},showExpressInstall:function(f,c,g,h){O.w3&&n()&&o(f,c,g,h)},
removeSWF:function(f){O.w3&&u(f)},createCSS:function(f,c,g,h){O.w3&&H(f,c,g,h)},addDomLoadEvent:g,addLoadEvent:h,getQueryParamValue:function(f){var c=D.location.search||D.location.hash;if(c){/\?/.test(c)&&(c=c.split("?")[1]);if(null==f)return z(c);for(var c=c.split("&"),g=0;g<c.length;g++)if(c[g].substring(0,c[g].indexOf("="))==f)return z(c[g].substring(c[g].indexOf("=")+1))}return""},expressInstallCallback:function(){if(Z){var f=v(G);f&&S&&(f.parentNode.replaceChild(S,f),W&&(w(W,!0),O.ie&&O.win&&
(S.style.display="block")),E&&E(N));Z=!1}}}}()}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){var jsPDF=function(){function c(j,k,l,n,o,m){j="undefined"===typeof j?"p":j.toString().toLowerCase();"undefined"===typeof k&&(k="mm");"undefined"===typeof l&&(l="a4");"undefined"===typeof n&&"undefined"===typeof zpipe&&(n=!1);var r=l.toString().toLowerCase(),t=[],u=0,v=n,n={a3:[841.89,1190.55],a4:[o,m],a5:[420.94,595.28],letter:[612,792],legal:[612,1008]},x="0 g",B=0,H=[],w=2,z=!1,q=[],C={},y={},G=16,I,D,F,J,Q={title:"",subject:"",author:"",
keywords:"",creator:""},U=0,V=0,L={},S=new h(L),W,E=function(f){return f.toFixed(2)},N=function(f){var c=f.toFixed(0);return 10>f?"0"+c:c},M=function(f){z?H[B].push(f):(t.push(f),u+=f.length+1)},Z=function(){w++;q[w]=u;M(w+" 0 obj");return w},R=function(f){M("stream");M(f);M("endstream")},aa,f,O,Y=function(f,c){var g;g=f;var A=c,h,k,j,l,m,n;void 0===A&&(A={});h=A.sourceEncoding?h:"Unicode";j=A.outputEncoding;if((A.autoencode||j)&&C[I].metadata&&C[I].metadata[h]&&C[I].metadata[h].encoding)if(h=C[I].metadata[h].encoding,
!j&&C[I].encoding&&(j=C[I].encoding),!j&&h.codePages&&(j=h.codePages[0]),"string"===typeof j&&(j=h[j]),j){m=!1;l=[];h=0;for(k=g.length;h<k;h++)(n=j[g.charCodeAt(h)])?l.push(String.fromCharCode(n)):l.push(g[h]),l[h].charCodeAt(0)>>8&&(m=!0);g=l.join("")}for(h=g.length;void 0===m&&0!==h;)g.charCodeAt(h-1)>>8&&(m=!0),h--;if(m){l=A.noBOM?[]:[254,255];h=0;for(k=g.length;h<k;h++){n=g.charCodeAt(h);A=n>>8;if(A>>8)throw Error("Character at position "+h.toString(10)+" of string '"+g+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");
l.push(A);l.push(n-(A<<8))}g=String.fromCharCode.apply(void 0,l)}return g.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ba=function(){B++;z=!0;H[B]=[];M(E(0.200025*J)+" w");M("0 G");0!==U&&M(U.toString(10)+" J");0!==V&&M(V.toString(10)+" j");S.publish("addPage",{pageNumber:B})},ia=function(f,c){var g;void 0===f&&(f=C[I].fontName);void 0===c&&(c=C[I].fontStyle);try{g=y[f][c]}catch(A){g=void 0}if(!g)throw Error("Unable to look up font label for font '"+f+"', '"+c+"'. Refer to getFontList() for available fonts.");
return g},da=function(){z=!1;t=[];q=[];M("%PDF-1.3");aa=F*J;f=D*J;var c,g,A,h,k;for(c=1;c<=B;c++){Z();M("<</Type /Page");M("/Parent 1 0 R");M("/Resources 2 0 R");M("/Contents "+(w+1)+" 0 R>>");M("endobj");g=H[c].join("\n");Z();if(v){A=[];for(h=0;h<g.length;++h)A[h]=g.charCodeAt(h);k=adler32cs.from(g);g=new Deflater(6);g.append(new Uint8Array(A));g=g.flush();A=[new Uint8Array([120,156]),new Uint8Array(g),new Uint8Array([k&255,k>>8&255,k>>16&255,k>>24&255])];g="";for(h in A)A.hasOwnProperty(h)&&(g+=
String.fromCharCode.apply(null,A[h]));M("<</Length "+g.length+" /Filter [/FlateDecode]>>")}else M("<</Length "+g.length+">>");R(g);M("endobj")}q[1]=u;M("1 0 obj");M("<</Type /Pages");O="/Kids [";for(h=0;h<B;h++)O+=3+2*h+" 0 R ";M(O+"]");M("/Count "+B);M("/MediaBox [0 0 "+E(aa)+" "+E(f)+"]");M(">>");M("endobj");for(var j in C)C.hasOwnProperty(j)&&(c=C[j],c.objectNumber=Z(),M("<</BaseFont/"+c.PostScriptName+"/Type/Font"),"string"===typeof c.encoding&&M("/Encoding/"+c.encoding),M("/Subtype/Type1>>"),
M("endobj"));S.publish("putResources");q[2]=u;M("2 0 obj");M("<<");M("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]");M("/Font <<");for(var l in C)C.hasOwnProperty(l)&&M("/"+l+" "+C[l].objectNumber+" 0 R");M(">>");M("/XObject <<");S.publish("putXobjectDict");M(">>");M(">>");M("endobj");S.publish("postPutResources");Z();M("<<");M("/Producer (jsPDF 0.9.0rc2)");Q.title&&M("/Title ("+Y(Q.title)+")");Q.subject&&M("/Subject ("+Y(Q.subject)+")");Q.author&&M("/Author ("+Y(Q.author)+")");Q.keywords&&M("/Keywords ("+
Y(Q.keywords)+")");Q.creator&&M("/Creator ("+Y(Q.creator)+")");j=new Date;M("/CreationDate (D:"+[j.getFullYear(),N(j.getMonth()+1),N(j.getDate()),N(j.getHours()),N(j.getMinutes()),N(j.getSeconds())].join("")+")");M(">>");M("endobj");Z();M("<<");M("/Type /Catalog");M("/Pages 1 0 R");M("/OpenAction [3 0 R /FitH null]");M("/PageLayout /OneColumn");S.publish("putCatalog");M(">>");M("endobj");j=u;M("xref");M("0 "+(w+1));M("0000000000 65535 f ");for(l=1;l<=w;l++)c=q[l].toFixed(0),c=10>c.length?Array(11-
c.length).join("0")+c:c,M(c+" 00000 n ");M("trailer");M("<<");M("/Size "+(w+1));M("/Root "+w+" 0 R");M("/Info "+(w-1)+" 0 R");M(">>");M("startxref");M(j);M("%%EOF");z=!0;return t.join("\n")},ca=function(f){var c="S";if("F"===f)c="f";else if("FD"===f||"DF"===f)c="B";return c},fa=function(f,c){var g,A,h,k;switch(f){case void 0:return da();case "save":if(navigator.getUserMedia&&(void 0===window.URL||void 0===window.URL.createObjectURL))return L.output("dataurlnewwindow");g=da();A=g.length;h=new Uint8Array(new ArrayBuffer(A));
for(k=0;k<A;k++)h[k]=g.charCodeAt(k);g=new Blob([h],{type:"application/pdf"});saveAs(g,c);break;case "datauristring":case "dataurlstring":return"data:application/pdf;base64,"+btoa(da());case "datauri":case "dataurl":document.location.href="data:application/pdf;base64,"+btoa(da());break;case "dataurlnewwindow":window.open("data:application/pdf;base64,"+btoa(da()));break;default:throw Error('Output type "'+f+'" is not supported.');}};if("pt"===k)J=1;else if("mm"===k)J=72/25.4;else if("cm"===k)J=72/
2.54;else if("in"===k)J=72;else throw"Invalid unit: "+k;if(n.hasOwnProperty(r))D=n[r][1]/J,F=n[r][0]/J;else try{D=l[1],F=l[0]}catch(A){throw"Invalid format: "+l;}if("p"===j||"portrait"===j)j="p",F>D&&(j=F,F=D,D=j);else if("l"===j||"landscape"===j)j="l",D>F&&(j=F,F=D,D=j);else throw"Invalid orientation: "+j;L.internal={pdfEscape:Y,getStyle:ca,getFont:function(){return C[ia.apply(L,arguments)]},getFontSize:function(){return G},btoa:btoa,write:function(f,c,g,A){M(1===arguments.length?f:Array.prototype.join.call(arguments,
" "))},getCoordinateString:function(f){return E(f*J)},getVerticalCoordinateString:function(f){return E((D-f)*J)},collections:{},newObject:Z,putStream:R,events:S,scaleFactor:J,pageSize:{width:F,height:D},output:function(f,c){return fa(f,c)}};L.addPage=function(){ba();return this};L.text=function(f,c,g,A){var h,k;"number"===typeof f&&(h=f,k=c,f=g,c=h,g=k);"string"===typeof f&&f.match(/[\n\r]/)&&(f=f.split(/\r\n|\r|\n/g));if("undefined"===typeof A)A={noBOM:!0,autoencode:!0};else if(void 0===A.noBOM&&
(A.noBOM=!0),void 0===A.autoencode)A.autoencode=!0;if("string"===typeof f)A=Y(f,A);else if(f instanceof Array){f=f.concat();for(h=f.length-1;-1!==h;h--)f[h]=Y(f[h],A);A=f.join(") Tj\nT* (")}else throw Error('Type of text must be string or Array. "'+f+'" is not recognized.');M("BT\n/"+I+" "+G+" Tf\n"+G+" TL\n"+x+"\n"+E(c*J)+" "+E((D-g)*J)+" Td\n("+A+") Tj\nET");return this};L.line=function(f,c,g,A){M(E(f*J)+" "+E((D-c)*J)+" m "+E(g*J)+" "+E((D-A)*J)+" l S");return this};L.lines=function(f,c,g,A,h){var k,
j,l,m,n,o,q,r;"number"===typeof f&&(k=f,j=c,f=g,c=k,g=j);h=ca(h);A=void 0===A?[1,1]:A;M((c*J).toFixed(3)+" "+((D-g)*J).toFixed(3)+" m ");k=A[0];A=A[1];j=f.length;r=g;for(g=0;g<j;g++)l=f[g],2===l.length?(c=l[0]*k+c,r=l[1]*A+r,M((c*J).toFixed(3)+" "+((D-r)*J).toFixed(3)+" l")):(m=l[0]*k+c,n=l[1]*A+r,o=l[2]*k+c,q=l[3]*A+r,c=l[4]*k+c,r=l[5]*A+r,M((m*J).toFixed(3)+" "+((D-n)*J).toFixed(3)+" "+(o*J).toFixed(3)+" "+((D-q)*J).toFixed(3)+" "+(c*J).toFixed(3)+" "+((D-r)*J).toFixed(3)+" c"));M(h);return this};
L.rect=function(f,c,g,A,h){h=ca(h);M([E(f*J),E((D-c)*J),E(g*J),E(-A*J),"re",h].join(" "));return this};L.setProperties=function(f){for(var c in Q)Q.hasOwnProperty(c)&&f[c]&&(Q[c]=f[c]);return this};L.setFontSize=function(f){G=f;return this};L.setFont=function(f,c){I=ia(f,c);return this};L.setFontStyle=L.setFontType=function(f){I=ia(void 0,f);return this};L.getFontList=function(){var f={},c,g,A;for(c in y)if(y.hasOwnProperty(c))for(g in f[c]=A=[],y[c])y[c].hasOwnProperty(g)&&A.push(g);return f};L.setLineWidth=
function(f){M((f*J).toFixed(2)+" w");return this};L.setDrawColor=function(f,c,g,A){f=void 0===c||void 0===A&&f===c===g?"string"===typeof f?f+" G":E(f/255)+" G":void 0===A?"string"===typeof f?[f,c,g,"RG"].join(" "):[E(f/255),E(c/255),E(g/255),"RG"].join(" "):"string"===typeof f?[f,c,g,A,"K"].join(" "):[E(f),E(c),E(g),E(A),"K"].join(" ");M(f);return this};L.setFillColor=function(f,c,g,A){f=void 0===c||void 0===A&&f===c===g?"string"===typeof f?f+" g":E(f/255)+" g":void 0===A?"string"===typeof f?[f,c,
g,"rg"].join(" "):[E(f/255),E(c/255),E(g/255),"rg"].join(" "):"string"===typeof f?[f,c,g,A,"k"].join(" "):[E(f),E(c),E(g),E(A),"k"].join(" ");M(f);return this};L.setTextColor=function(f,c,g){x=0===f&&0===c&&0===g||"undefined"===typeof c?(f/255).toFixed(3)+" g":[(f/255).toFixed(3),(c/255).toFixed(3),(g/255).toFixed(3),"rg"].join(" ");return this};L.CapJoinStyles={"0":0,butt:0,but:0,bevel:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,milter:2};L.setLineCap=function(f){var c=this.CapJoinStyles[f];
if(void 0===c)throw Error("Line cap style of '"+f+"' is not recognized. See or extend .CapJoinStyles property for valid styles");U=c;M(c.toString(10)+" J");return this};L.setLineJoin=function(f){var c=this.CapJoinStyles[f];if(void 0===c)throw Error("Line join style of '"+f+"' is not recognized. See or extend .CapJoinStyles property for valid styles");V=c;M(c.toString(10)+" j");return this};L.output=fa;L.save=function(f){L.output("save",f)};for(W in c.API)c.API.hasOwnProperty(W)&&("events"===W&&c.API.events.length?
function(f,c){var g,A,h;for(h=c.length-1;-1!==h;h--)g=c[h][0],A=c[h][1],f.subscribe.apply(f,[g].concat("function"===typeof A?[A]:A))}(S,c.API.events):L[W]=c.API[W]);(function(){var f=[["Helvetica","helvetica","normal"],["Helvetica-Bold","helvetica","bold"],["Helvetica-Oblique","helvetica","italic"],["Helvetica-BoldOblique","helvetica","bolditalic"],["Courier","courier","normal"],["Courier-Bold","courier","bold"],["Courier-Oblique","courier","italic"],["Courier-BoldOblique","courier","bolditalic"],
["Times-Roman","times","normal"],["Times-Bold","times","bold"],["Times-Italic","times","italic"],["Times-BoldItalic","times","bolditalic"]],c,A,h,k;c=0;for(A=f.length;c<A;c++){var j=f[c][0],l=f[c][1];h=f[c][2];k="F"+(g(C)+1).toString(10);var j=C[k]={id:k,PostScriptName:j,fontName:l,fontStyle:h,encoding:"StandardEncoding",metadata:{}},m=k;void 0===y[l]&&(y[l]={});y[l][h]=m;S.publish("addFont",j);h=k;k=f[c][0].split("-");j=k[0];k=k[1]||"";void 0===y[j]&&(y[j]={});y[j][k]=h}S.publish("addFonts",{fonts:C,
dictionary:y})})();I="F1";ba();S.publish("initialized");return L}"undefined"===typeof btoa&&(window.btoa=function(c){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),h,n,o,m,r=0,t=0,u="",u=[];do h=c.charCodeAt(r++),n=c.charCodeAt(r++),o=c.charCodeAt(r++),m=h<<16|n<<8|o,h=m>>18&63,n=m>>12&63,o=m>>6&63,m&=63,u[t++]=g[h]+g[n]+g[o]+g[m];while(r<c.length);u=u.join("");c=c.length%3;return(c?u.slice(0,c-3):u)+"===".slice(c||3)});"undefined"===typeof atob&&(window.atob=
function(c){var g,h,n,o,m,r=0,t=0;o="";var u=[];if(!c)return c;c=c+"";do{g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(r++));h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(r++));o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(r++));m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(r++));n=g<<18|h<<12|o<<6|m;g=n>>16&255;h=n>>8&255;n=n&255;o===
64?u[t++]=String.fromCharCode(g):m===64?u[t++]=String.fromCharCode(g,h):u[t++]=String.fromCharCode(g,h,n)}while(r<c.length);return o=u.join("")});var g="function"===typeof Object.keys?function(c){return Object.keys(c).length}:function(c){var g=0,h;for(h in c)c.hasOwnProperty(h)&&g++;return g},h=function(c){this.topics={};this.context=c;this.publish=function(c,g){if(this.topics[c]){var h=this.topics[c],j=[],m,r,t,u,v=function(){},g=Array.prototype.slice.call(arguments,1);r=0;for(t=h.length;r<t;r++){u=
h[r];m=u[0];if(u[1]){u[0]=v;j.push(r)}m.apply(this.context,g)}r=0;for(t=j.length;r<t;r++)h.splice(j[r],1)}};this.subscribe=function(c,g,h){this.topics[c]?this.topics[c].push([g,h]):this.topics[c]=[[g,h]];return{topic:c,callback:g}};this.unsubscribe=function(c){if(this.topics[c.topic]){var g=this.topics[c.topic],h,j;h=0;for(j=g.length;h<j;h++)g[h][0]===c.callback&&g.splice(h,1)}}};c.API={events:[]};return c}(),Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){for(var g=
"",h,j,k,l,n,o,m=0,c=Base64._utf8_encode(c);m<c.length;)h=c.charCodeAt(m++),j=c.charCodeAt(m++),k=c.charCodeAt(m++),l=h>>2,h=(h&3)<<4|j>>4,n=(j&15)<<2|k>>6,o=k&63,isNaN(j)?n=o=64:isNaN(k)&&(o=64),g=g+this._keyStr.charAt(l)+this._keyStr.charAt(h)+this._keyStr.charAt(n)+this._keyStr.charAt(o);return g},decode:function(c){for(var g="",h,j,k,l,n,o=0,c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");o<c.length;)h=this._keyStr.indexOf(c.charAt(o++)),j=this._keyStr.indexOf(c.charAt(o++)),l=this._keyStr.indexOf(c.charAt(o++)),
n=this._keyStr.indexOf(c.charAt(o++)),h=h<<2|j>>4,j=(j&15)<<4|l>>2,k=(l&3)<<6|n,g+=String.fromCharCode(h),64!=l&&(g+=String.fromCharCode(j)),64!=n&&(g+=String.fromCharCode(k));return g=Base64._utf8_decode(g)},_utf8_encode:function(c){for(var c=c.replace(/\r\n/g,"\n"),g="",h=0;h<c.length;h++){var j=c.charCodeAt(h);128>j?g+=String.fromCharCode(j):(127<j&&2048>j?g+=String.fromCharCode(j>>6|192):(g+=String.fromCharCode(j>>12|224),g+=String.fromCharCode(j>>6&63|128)),g+=String.fromCharCode(j&63|128))}return g},
_utf8_decode:function(c){for(var g="",h=0,j=c1=c2=0;h<c.length;)j=c.charCodeAt(h),128>j?(g+=String.fromCharCode(j),h++):191<j&&224>j?(c2=c.charCodeAt(h+1),g+=String.fromCharCode((j&31)<<6|c2&63),h+=2):(c2=c.charCodeAt(h+1),c3=c.charCodeAt(h+2),g+=String.fromCharCode((j&15)<<12|(c2&63)<<6|c3&63),h+=3);return g}},sprintf=function(){var c=arguments,g=0,h=function(c,g,h,k){h||(h=" ");g=c.length>=g?"":Array(1+g-c.length>>>0).join(h);return k?c+g:g+c},j=function(c,g,k,j,r,t){var u=j-c.length;0<u&&(c=k||
!r?h(c,j,t,k):c.slice(0,g.length)+h("",u,"0",!0)+c.slice(g.length));return c},k=function(c,g,k,m,r,t,u){c>>>=0;k=k&&c&&{2:"0b",8:"0",16:"0x"}[g]||"";c=k+h(c.toString(g),t||0,"0",!1);return j(c,k,m,r,u)};return c[g++].replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g,function(l,n,o,m,r,t,u){var v,x;if("%%"==l)return"%";var B=!1;x="";var H=r=!1;v=" ";for(var w=o.length,z=0;o&&z<w;z++)switch(o.charAt(z)){case " ":x=" ";break;case "+":x="+";break;case "-":B=!0;
break;case "'":v=o.charAt(z+1);break;case "0":r=!0;break;case "#":H=!0}m=m?"*"==m?+c[g++]:"*"==m.charAt(0)?+c[m.slice(1,-1)]:+m:0;0>m&&(m=-m,B=!0);if(!isFinite(m))throw Error("sprintf: (minimum-)width must be finite");t=t?"*"==t?+c[g++]:"*"==t.charAt(0)?+c[t.slice(1,-1)]:+t:-1<"fFeE".indexOf(u)?6:"d"==u?0:void 0;n=n?c[n.slice(0,-1)]:c[g++];switch(u){case "s":return u=""+n,null!=t&&(u=u.slice(0,t)),j(u,"",B,m,r,v);case "c":return u=String.fromCharCode(+n),null!=t&&(u=u.slice(0,t)),j(u,"",B,m,r,void 0);
case "b":return k(n,2,H,B,m,t,r);case "o":return k(n,8,H,B,m,t,r);case "x":return k(n,16,H,B,m,t,r);case "X":return k(n,16,H,B,m,t,r).toUpperCase();case "u":return k(n,10,H,B,m,t,r);case "i":case "d":return v=parseInt(+n),l=0>v?"-":x,n=l+h(""+Math.abs(v),t,"0",!1),j(n,l,B,m,r);case "e":case "E":case "f":case "F":case "g":case "G":return v=+n,l=0>v?"-":x,x=["toExponential","toFixed","toPrecision"]["efg".indexOf(u.toLowerCase())],u=["toString","toUpperCase"]["eEfFgG".indexOf(u)%2],n=l+Math.abs(v)[x](t),
j(n,l,B,m,r)[u]();default:return l}})};(function(c){var g=function(){var c=this.internal.collections.addImage_images,g;for(g in c){var h=c[g],n=this.internal.newObject(),o=this.internal.write,m=this.internal.putStream;h.n=n;o("<</Type /XObject");o("/Subtype /Image");o("/Width "+h.w);o("/Height "+h.h);"Indexed"===h.cs?o("/ColorSpace [/Indexed /DeviceRGB "+(h.pal.length/3-1)+" "+(n+1)+" 0 R]"):(o("/ColorSpace /"+h.cs),"DeviceCMYK"===h.cs&&o("/Decode [1 0 1 0 1 0 1 0]"));o("/BitsPerComponent "+h.bpc);
"f"in h&&o("/Filter /"+h.f);"dp"in h&&o("/DecodeParms <<"+h.dp+">>");if("trns"in h&&h.trns.constructor==Array)for(var r="",t=0;t<h.trns.length;t++)r+=h[r][t]+" "+h.trns[t]+" ",o("/Mask ["+r+"]");"smask"in h&&o("/SMask "+(n+1)+" 0 R");o("/Length "+h.data.length+">>");m(h.data);o("endobj")}},h=function(){var c=this.internal.collections.addImage_images,g=this.internal.write,h,n;for(n in c)h=c[n],g("/I"+h.i,h.n,"0","R")};c.addImage=function(c,k,l,n,o,m){if("object"===typeof c&&1===c.nodeType){k=document.createElement("canvas");
k.width=c.clientWidth;k.height=c.clientHeight;var r=k.getContext("2d");if(!r)throw"addImage requires canvas to be supported by browser.";r.drawImage(c,0,0,k.width,k.height);c=k.toDataURL("image/jpeg");k="JPEG"}if("JPEG"!==k.toUpperCase())throw Error("addImage currently only supports format 'JPEG', not '"+k+"'");var t,k=this.internal.collections.addImage_images,r=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;"data:image/jpeg;base64,"===c.substring(0,23)&&(c=atob(c.replace("data:image/jpeg;base64,",
"")));if(k)if(Object.keys)t=Object.keys(k).length;else{var v=k,x=0;for(t in v)v.hasOwnProperty(t)&&x++;t=x}else t=0,this.internal.collections.addImage_images=k={},this.internal.events.subscribe("putResources",g),this.internal.events.subscribe("putXobjectDict",h);a:{var v=c,B;if(255===!v.charCodeAt(0)||216===!v.charCodeAt(1)||255===!v.charCodeAt(2)||224===!v.charCodeAt(3)||74===!v.charCodeAt(6)||70===!v.charCodeAt(7)||73===!v.charCodeAt(8)||70===!v.charCodeAt(9)||0===!v.charCodeAt(10))throw Error("getJpegSize requires a binary jpeg file");
B=256*v.charCodeAt(4)+v.charCodeAt(5);for(var x=4,H=v.length;x<H;){x+=B;if(255!==v.charCodeAt(x))throw Error("getJpegSize could not find the size of the image");if(192===v.charCodeAt(x+1)){B=256*v.charCodeAt(x+5)+v.charCodeAt(x+6);v=256*v.charCodeAt(x+7)+v.charCodeAt(x+8);v=[v,B];break a}x+=2;B=256*v.charCodeAt(x)+v.charCodeAt(x+1)}v=void 0}c={w:v[0],h:v[1],cs:"DeviceRGB",bpc:8,f:"DCTDecode",i:t,data:c};k[t]=c;!o&&!m&&(m=o=-96);0>o&&(o=-72*c.w/o/this.internal.scaleFactor);0>m&&(m=-72*c.h/m/this.internal.scaleFactor);
0===o&&(o=m*c.w/c.h);0===m&&(m=o*c.h/c.w);this.internal.write("q",r(o),"0 0",r(m),r(l),u(n+m),"cm /I"+c.i,"Do Q");return this}})(jsPDF.API)}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion())(function(c){var g=function(c){for(var g={},h=0;16>h;h++)g["klmnopqrstuvwxyz"[h]]="0123456789abcdef"[h];for(var k={},j=1,t,u=k,v=[],x,B="",H="",w,z=c.length-1,h=1;h!=z;)x=c[h],h+=1,"'"==x?t?(w=t.join(""),t=void 0):t=[]:t?t.push(x):"{"==x?(v.push([u,w]),u={},w=void 0):"}"==x?(x=v.pop(),x[0][x[1]]=u,w=void 0,u=x[0]):"-"==x?j=-1:void 0===w?g.hasOwnProperty(x)?(B+=g[x],w=parseInt(B,16)*j,j=1,B=""):B+=x:g.hasOwnProperty(x)?(H+=g[x],u[w]=parseInt(H,
16)*j,j=1,w=void 0,H=""):H+=x;return k},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:g("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},j={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},k={Unicode:{"Courier-Oblique":g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),
"Times-BoldItalic":g("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),
"Helvetica-Bold":g("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),
Courier:g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":g("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),
Helvetica:g("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),
"Helvetica-BoldOblique":g("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),
"Courier-Bold":g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":g("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),
"Times-Roman":g("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),
"Helvetica-Oblique":g("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};
c.events.push(["addFonts",function(c){var g,h,m,r;for(h in c.fonts)if(c.fonts.hasOwnProperty(h)){g=c.fonts[h];if(m=k.Unicode[g.PostScriptName])r=g.metadata.Unicode?g.metadata.Unicode:g.metadata.Unicode={},r.widths=m.widths,r.kerning=m.kerning;if(m=j.Unicode[g.PostScriptName])r=g.metadata.Unicode?g.metadata.Unicode:g.metadata.Unicode={},r.encoding=m,m.codePages&&m.codePages.length&&(g.encoding=m.codePages[0])}}])})(jsPDF.API),function(c){var g=c.getCharWidthsArray=function(c,g){g||(g={});var h=g.widths?
g.widths:this.internal.getFont().metadata.Unicode.widths,j=h.fof?h.fof:1,m=g.kerning?g.kerning:this.internal.getFont().metadata.Unicode.kerning,r=m.fof?m.fof:1,t,u,v,x=0,B=h[0]||j,H=[];t=0;for(u=c.length;t<u;t++)v=c.charCodeAt(t),H.push((h[v]||B)/j+(m[v]&&m[v][x]||0)/r),x=v;return H},h=function(c){for(var g=c.length,h=0;g;)g--,h+=c[g];return h};c.getStringUnitWidth=function(c,j){return h(g.call(this,c,j))};var j=function(c,j,n){n||(n={});var o=g(" ",n)[0],m=c.split(" "),r=[],c=[r],t=n.textIndent||
0,u=0,v=0,x,B,H,w;H=0;for(w=m.length;H<w;H++){x=m[H];B=g(x,n);v=h(B);if(t+u+v>j){if(v>j){for(var v=x,z=B,q=j,C=[],y=0,G=v.length,I=0;y!==G&&I+z[y]<j-(t+u);)I+=z[y],y++;C.push(v.slice(0,y));t=y;for(I=0;y!==G;)I+z[y]>q&&(C.push(v.slice(t,y)),I=0,t=y),I+=z[y],y++;t!==y&&C.push(v.slice(t,y));t=C;r.push(t.shift());for(r=[t.pop()];t.length;)c.push([t.shift()]);v=h(B.slice(x.length-r[0].length))}else r=[x];c.push(r);t=v}else r.push(x),t+=u+v;u=o}j=[];H=0;for(w=c.length;H<w;H++)j.push(c[H].join(" "));return j};
c.splitTextToSize=function(c,g,h){h||(h={});var o=h.fontSize||this.internal.getFontSize(),m;var r=h;m={"0":1};var t={};!r.widths||!r.kerning?(r=this.internal.getFont(r.fontName,r.fontStyle),m=r.metadata.Unicode?{widths:r.metadata.Unicode.widths||m,kerning:r.metadata.Unicode.kerning||t}:{widths:m,kerning:t}):m={widths:r.widths,kerning:r.kerning};c=c.match(/[\n\r]/)?c.split(/\r\n|\r|\n/g):[c];g=1*this.internal.scaleFactor*g/o;m.textIndent=h.textIndent?1*h.textIndent*this.internal.scaleFactor/o:0;t=
[];h=0;for(o=c.length;h<o;h++)t=t.concat(j(c[h],g,m));return t}}(jsPDF.API),function(c){c.addSVG=function(c,h,j,k,l){function n(c){for(var g=parseFloat(c[1]),h=parseFloat(c[2]),k=[],j=3,l=c.length;j<l;)"c"===c[j]?(k.push([parseFloat(c[j+1]),parseFloat(c[j+2]),parseFloat(c[j+3]),parseFloat(c[j+4]),parseFloat(c[j+5]),parseFloat(c[j+6])]),j+=7):"l"===c[j]?(k.push([parseFloat(c[j+1]),parseFloat(c[j+2])]),j+=3):j+=1;return[g,h,k]}if(void 0===h||void 0===h)throw Error("addSVG needs values for 'x' and 'y'");
var o=function(c){var g=c.createElement("iframe"),h=c.createElement("style");h.type="text/css";h.styleSheet?h.styleSheet.cssText=".jsPDF_sillysvg_iframe {display:none;position:absolute;}":h.appendChild(c.createTextNode(".jsPDF_sillysvg_iframe {display:none;position:absolute;}"));c.getElementsByTagName("head")[0].appendChild(h);g.name="childframe";g.setAttribute("width",0);g.setAttribute("height",0);g.setAttribute("frameborder","0");g.setAttribute("scrolling","no");g.setAttribute("seamless","seamless");
g.setAttribute("class","jsPDF_sillysvg_iframe");c.body.appendChild(g);return g}(document),o=function(c,g){var h=(g.contentWindow||g.contentDocument).document;h.write(c);h.close();return h.getElementsByTagName("svg")[0]}(c,o),c=[1,1],m=parseFloat(o.getAttribute("width")),r=parseFloat(o.getAttribute("height"));m&&r&&(k&&l?c=[k/m,l/r]:k?c=[k/m,k/m]:l&&(c=[l/r,l/r]));o=o.childNodes;k=0;for(l=o.length;k<l;k++)m=o[k],m.tagName&&"PATH"===m.tagName.toUpperCase()&&(m=n(m.getAttribute("d").split(" ")),m[0]=
m[0]*c[0]+h,m[1]=m[1]*c[1]+j,this.lines.call(this,m[2],m[0],m[1],c));return this}}(jsPDF.API);
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){(function(c){c.output=function(c,h){return this.internal.output(c,h)}})(jsPDF.API);var saveAs=saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator)||function(c){var g=c.document,h=c.URL||c.webkitURL||c,j=g.createElementNS("http://www.w3.org/1999/xhtml","a"),k="download"in j,l=function(h){var k=g.createEvent("MouseEvents");k.initMouseEvent("click",!0,!1,c,0,0,0,0,0,!1,!1,!1,!1,0,null);return h.dispatchEvent(k)},n=c.webkitRequestFileSystem,
o=c.requestFileSystem||n||c.mozRequestFileSystem,m=function(g){(c.setImmediate||c.setTimeout)(function(){throw g;},0)},r=0,t=[],u=function(c,g,h){for(var g=[].concat(g),k=g.length;k--;){var j=c["on"+g[k]];if("function"===typeof j)try{j.call(c,h||c)}catch(l){m(l)}}},v=function(g,h){var m=this,v=g.type,q=!1,C,y,x=function(){var h=(c.URL||c.webkitURL||c).createObjectURL(g);t.push(h);return h},I=function(){u(m,["writestart","progress","write","writeend"])},D=function(){if(q||!C)C=x(g);y&&(y.location.href=
C);m.readyState=m.DONE;I()},F=function(c){return function(){if(m.readyState!==m.DONE)return c.apply(this,arguments)}},J={create:!0,exclusive:!1},Q;m.readyState=m.INIT;h||(h="download");if(k&&(C=x(g),j.href=C,j.download=h,l(j))){m.readyState=m.DONE;I();return}c.chrome&&(v&&"application/octet-stream"!==v)&&(Q=g.slice||g.webkitSlice,g=Q.call(g,0,g.size,"application/octet-stream"),q=!0);n&&"download"!==h&&(h+=".download");if("application/octet-stream"===v||n)y=c;o?(r+=g.size,o(c.TEMPORARY,r,F(function(c){c.root.getDirectory("saved",
J,F(function(c){var k=function(){c.getFile(h,J,F(function(c){c.createWriter(F(function(h){h.onwriteend=function(g){y.location.href=c.toURL();t.push(c);m.readyState=m.DONE;u(m,"writeend",g)};h.onerror=function(){var c=h.error;c.code!==c.ABORT_ERR&&D()};["writestart","progress","write","abort"].forEach(function(c){h["on"+c]=m["on"+c]});h.write(g);m.abort=function(){h.abort();m.readyState=m.DONE};m.readyState=m.WRITING}),D)}),D)};c.getFile(h,{create:false},F(function(c){c.remove();k()}),F(function(c){c.code===
c.NOT_FOUND_ERR?k():D()}))}),D)}),D)):D()},x=v.prototype;x.abort=function(){this.readyState=this.DONE;u(this,"abort")};x.readyState=x.INIT=0;x.WRITING=1;x.DONE=2;x.error=x.onwritestart=x.onprogress=x.onwrite=x.onabort=x.onerror=x.onwriteend=null;c.addEventListener("unload",function(){for(var c=t.length;c--;){var g=t[c];"string"===typeof g?h.revokeObjectURL(g):g.remove()}t.length=0},!1);return function(c,g){return new v(c,g)}}(self),MAX_BITS=15,D_CODES=30,BL_CODES=19,LENGTH_CODES=29,LITERALS=256,L_CODES=
LITERALS+1+LENGTH_CODES,HEAP_SIZE=2*L_CODES+1,END_BLOCK=256,MAX_BL_BITS=7,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,Buf_size=16,Z_DEFAULT_COMPRESSION=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_DEFAULT_STRATEGY=0,Z_NO_FLUSH=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH=4,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_BUF_ERROR=-5,_dist_code=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,
11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,
28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],Tree=function(){var c=this;c.build_tree=function(g){var h=c.dyn_tree,j=c.stat_desc.static_tree,k=c.stat_desc.elems,l,n=-1,o;g.heap_len=0;g.heap_max=HEAP_SIZE;
for(l=0;l<k;l++)0!==h[2*l]?(g.heap[++g.heap_len]=n=l,g.depth[l]=0):h[2*l+1]=0;for(;2>g.heap_len;)o=g.heap[++g.heap_len]=2>n?++n:0,h[2*o]=1,g.depth[o]=0,g.opt_len--,j&&(g.static_len-=j[2*o+1]);c.max_code=n;for(l=Math.floor(g.heap_len/2);1<=l;l--)g.pqdownheap(h,l);o=k;do l=g.heap[1],g.heap[1]=g.heap[g.heap_len--],g.pqdownheap(h,1),j=g.heap[1],g.heap[--g.heap_max]=l,g.heap[--g.heap_max]=j,h[2*o]=h[2*l]+h[2*j],g.depth[o]=Math.max(g.depth[l],g.depth[j])+1,h[2*l+1]=h[2*j+1]=o,g.heap[1]=o++,g.pqdownheap(h,
1);while(2<=g.heap_len);g.heap[--g.heap_max]=g.heap[1];l=c.dyn_tree;for(var n=c.stat_desc.static_tree,m=c.stat_desc.extra_bits,r=c.stat_desc.extra_base,t=c.stat_desc.max_length,u,v,x=0,k=0;k<=MAX_BITS;k++)g.bl_count[k]=0;l[2*g.heap[g.heap_max]+1]=0;for(o=g.heap_max+1;o<HEAP_SIZE;o++)if(j=g.heap[o],k=l[2*l[2*j+1]+1]+1,k>t&&(k=t,x++),l[2*j+1]=k,!(j>c.max_code))g.bl_count[k]++,u=0,j>=r&&(u=m[j-r]),v=l[2*j],g.opt_len+=v*(k+u),n&&(g.static_len+=v*(n[2*j+1]+u));if(0!==x){do{for(k=t-1;0===g.bl_count[k];)k--;
g.bl_count[k]--;g.bl_count[k+1]+=2;g.bl_count[t]--;x-=2}while(0<x);for(k=t;0!==k;k--)for(j=g.bl_count[k];0!==j;)n=g.heap[--o],n>c.max_code||(l[2*n+1]!=k&&(g.opt_len+=(k-l[2*n+1])*l[2*n],l[2*n+1]=k),j--)}l=c.max_code;o=g.bl_count;g=[];j=0;for(k=1;k<=MAX_BITS;k++)g[k]=j=j+o[k-1]<<1;for(o=0;o<=l;o++)if(m=h[2*o+1],0!==m){j=h;k=2*o;n=g[m]++;r=0;do r|=n&1,n>>>=1,r<<=1;while(0<--m);j[k]=r>>>1}}};Tree._length_code=[0,1,2,3,4,5,6,7,8,8,9,9,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,
16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,
26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28];Tree.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0];Tree.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576];Tree.d_code=function(c){return 256>c?_dist_code[c]:_dist_code[256+(c>>>7)]};Tree.extra_lbits=[0,0,0,0,0,0,
0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];Tree.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];Tree.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];Tree.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var StaticTree=function(c,g,h,j,k){this.static_tree=c;this.extra_bits=g;this.extra_base=h;this.elems=j;this.max_length=k};StaticTree.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,
66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,
57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,
9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,
8,99,8,227,8];StaticTree.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5];StaticTree.static_l_desc=new StaticTree(StaticTree.static_ltree,Tree.extra_lbits,LITERALS+1,L_CODES,MAX_BITS);StaticTree.static_d_desc=new StaticTree(StaticTree.static_dtree,Tree.extra_dbits,0,D_CODES,MAX_BITS);StaticTree.static_bl_desc=new StaticTree(null,Tree.extra_blbits,0,BL_CODES,MAX_BL_BITS);var MAX_MEM_LEVEL=9,DEF_MEM_LEVEL=
8,Config=function(c,g,h,j,k){this.good_length=c;this.max_lazy=g;this.nice_length=h;this.max_chain=j;this.func=k},STORED=0,FAST=1,SLOW=2,config_table=[new Config(0,0,0,0,STORED),new Config(4,4,8,4,FAST),new Config(4,5,16,8,FAST),new Config(4,6,32,32,FAST),new Config(4,4,16,16,SLOW),new Config(8,16,32,32,SLOW),new Config(8,16,128,128,SLOW),new Config(8,32,128,256,SLOW),new Config(32,128,258,1024,SLOW),new Config(32,258,258,4096,SLOW)],z_errmsg="need dictionary;stream end;;;stream error;data error;;buffer error;;".split(";"),
NeedMore=0,BlockDone=1,FinishStarted=2,FinishDone=3,PRESET_DICT=32,INIT_STATE=42,BUSY_STATE=113,FINISH_STATE=666,Z_DEFLATED=8,STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,smaller=function(c,g,h,j){var k=c[2*g],c=c[2*h];return k<c||k==c&&j[g]<=j[h]},Deflate=function(){function c(){var f;for(f=0;f<L_CODES;f++)K[2*f]=0;for(f=0;f<D_CODES;f++)X[2*f]=0;for(f=0;f<BL_CODES;f++)P[2*f]=0;K[2*END_BLOCK]=1;ka=ma=z.opt_len=z.static_len=0}function g(f,
c){var g,A=-1,h,k=f[1],K=0,j=7,T=4;0===k&&(j=138,T=3);f[2*(c+1)+1]=65535;for(g=0;g<=c;g++)if(h=k,k=f[2*(g+1)+1],!(++K<j&&h==k))(K<T?P[2*h]+=K:0!==h?(h!=A&&P[2*h]++,P[2*REP_3_6]++):10>=K?P[2*REPZ_3_10]++:P[2*REPZ_11_138]++,K=0,A=h,0===k)?(j=138,T=3):h==k?(j=6,T=3):(j=7,T=4)}function h(f){z.pending_buf[z.pending++]=f}function j(f){h(f&255);h(f>>>8&255)}function k(f,c){ga>Buf_size-c?(ja|=f<<ga&65535,j(ja),ja=f>>>Buf_size-ga,ga+=c-Buf_size):(ja|=f<<ga&65535,ga+=c)}function l(f,c){var g=2*f;k(c[g]&65535,
c[g+1]&65535)}function n(f,c){var g,A=-1,h,K=f[1],j=0,T=7,X=4;0===K&&(T=138,X=3);for(g=0;g<=c;g++)if(h=K,K=f[2*(g+1)+1],!(++j<T&&h==K)){if(j<X){do l(h,P);while(0!==--j)}else 0!==h?(h!=A&&(l(h,P),j--),l(REP_3_6,P),k(j-3,2)):10>=j?(l(REPZ_3_10,P),k(j-3,3)):(l(REPZ_11_138,P),k(j-11,7));j=0;A=h;0===K?(T=138,X=3):h==K?(T=6,X=3):(T=7,X=4)}}function o(){16==ga?(j(ja),ga=ja=0):8<=ga&&(h(ja&255),ja>>>=8,ga-=8)}function m(c,g){var A,h,k;z.pending_buf[la+2*ka]=c>>>8&255;z.pending_buf[la+2*ka+1]=c&255;z.pending_buf[qa+
ka]=g&255;ka++;0===c?K[2*g]++:(ma++,c--,K[2*(Tree._length_code[g]+LITERALS+1)]++,X[2*Tree.d_code(c)]++);if(0===(ka&8191)&&2<ca){A=8*ka;h=f-M;for(k=0;k<D_CODES;k++)A+=X[2*k]*(5+Tree.extra_dbits[k]);if(ma<Math.floor(ka/2)&&A>>>3<Math.floor(h/2))return!0}return ka==ra-1}function r(f,c){var g,A,h=0,K,j;if(0!==ka){do if(g=z.pending_buf[la+2*h]<<8&65280|z.pending_buf[la+2*h+1]&255,A=z.pending_buf[qa+h]&255,h++,0===g)l(A,f);else if(K=Tree._length_code[A],l(K+LITERALS+1,f),j=Tree.extra_lbits[K],0!==j&&(A-=
Tree.base_length[K],k(A,j)),g--,K=Tree.d_code(g),l(K,c),j=Tree.extra_dbits[K],0!==j)g-=Tree.base_dist[K],k(g,j);while(h<ka)}l(END_BLOCK,f);ta=f[2*END_BLOCK+1]}function t(){8<ga?j(ja):0<ga&&h(ja&255);ga=ja=0}function u(f,c,g){t();ta=8;g&&(j(c),j(~c));z.pending_buf.set(J.subarray(f,f+c),z.pending);z.pending+=c}function v(A){var h=0<=M?M:-1,j=f-M,T,l,m=0;if(0<ca){ha.build_tree(z);na.build_tree(z);g(K,ha.max_code);g(X,na.max_code);ea.build_tree(z);for(m=BL_CODES-1;3<=m&&0===P[2*Tree.bl_order[m]+1];m--);
z.opt_len+=3*(m+1)+14;T=z.opt_len+3+7>>>3;l=z.static_len+3+7>>>3;l<=T&&(T=l)}else T=l=j+5;if(j+4<=T&&-1!=h)k((STORED_BLOCK<<1)+(A?1:0),3),u(h,j,!0);else if(l==T)k((STATIC_TREES<<1)+(A?1:0),3),r(StaticTree.static_ltree,StaticTree.static_dtree);else{k((DYN_TREES<<1)+(A?1:0),3);h=ha.max_code+1;j=na.max_code+1;m+=1;k(h-257,5);k(j-1,5);k(m-4,4);for(T=0;T<m;T++)k(P[2*Tree.bl_order[T]+1],3);n(K,h-1);n(X,j-1);r(K,X)}c();A&&t();M=f;q.flush_pending()}function x(){var c,g,A,h;do{h=Q-Y-f;if(0===h&&0===f&&0===
Y)h=I;else if(-1==h)h--;else if(f>=I+I-MIN_LOOKAHEAD){J.set(J.subarray(I,I+I),0);O-=I;f-=I;M-=I;A=c=S;do g=V[--A]&65535,V[A]=g>=I?g-I:0;while(0!==--c);A=c=I;do g=U[--A]&65535,U[A]=g>=I?g-I:0;while(0!==--c);h+=I}if(0===q.avail_in)break;c=q.read_buf(J,f+Y,h);Y+=c;Y>=MIN_MATCH&&(L=J[f]&255,L=(L<<N^J[f+1]&255)&E)}while(Y<MIN_LOOKAHEAD&&0!==q.avail_in)}function B(c){var g=65535,A;for(g>y-5&&(g=y-5);;){if(1>=Y){x();if(0===Y&&c==Z_NO_FLUSH)return NeedMore;if(0===Y)break}f+=Y;Y=0;A=M+g;if(0===f||f>=A)if(Y=
f-A,f=A,v(!1),0===q.avail_out)return NeedMore;if(f-M>=I-MIN_LOOKAHEAD&&(v(!1),0===q.avail_out))return NeedMore}v(c==Z_FINISH);return 0===q.avail_out?c==Z_FINISH?FinishStarted:NeedMore:c==Z_FINISH?FinishDone:BlockDone}function H(c){var g=ia,h=f,k,K=ba,j=f>I-MIN_LOOKAHEAD?f-(I-MIN_LOOKAHEAD):0,X=T,P=F,l=f+MAX_MATCH,m=J[h+K-1],n=J[h+K];ba>=A&&(g>>=2);X>Y&&(X=Y);do if(k=c,!(J[k+K]!=n||J[k+K-1]!=m||J[k]!=J[h]||J[++k]!=J[h+1])){h+=2;k++;do;while(J[++h]==J[++k]&&J[++h]==J[++k]&&J[++h]==J[++k]&&J[++h]==J[++k]&&
J[++h]==J[++k]&&J[++h]==J[++k]&&J[++h]==J[++k]&&J[++h]==J[++k]&&h<l);k=MAX_MATCH-(l-h);h=l-MAX_MATCH;if(k>K){O=c;K=k;if(k>=X)break;m=J[h+K-1];n=J[h+K]}}while((c=U[c&P]&65535)>j&&0!==--g);return K<=Y?K:Y}function w(c){for(var g=0,A,h;;){if(Y<MIN_LOOKAHEAD){x();if(Y<MIN_LOOKAHEAD&&c==Z_NO_FLUSH)return NeedMore;if(0===Y)break}Y>=MIN_MATCH&&(L=(L<<N^J[f+(MIN_MATCH-1)]&255)&E,g=V[L]&65535,U[f&F]=V[L],V[L]=f);ba=Z;R=O;Z=MIN_MATCH-1;if(0!==g&&(ba<da&&(f-g&65535)<=I-MIN_LOOKAHEAD)&&(fa!=Z_HUFFMAN_ONLY&&(Z=
H(g)),5>=Z&&(fa==Z_FILTERED||Z==MIN_MATCH&&4096<f-O)))Z=MIN_MATCH-1;if(ba>=MIN_MATCH&&Z<=ba){h=f+Y-MIN_MATCH;A=m(f-1-R,ba-MIN_MATCH);Y-=ba-1;ba-=2;do++f<=h&&(L=(L<<N^J[f+(MIN_MATCH-1)]&255)&E,g=V[L]&65535,U[f&F]=V[L],V[L]=f);while(0!==--ba);aa=0;Z=MIN_MATCH-1;f++;if(A&&(v(!1),0===q.avail_out))return NeedMore}else if(0!==aa){if((A=m(0,J[f-1]&255))&&v(!1),f++,Y--,0===q.avail_out)return NeedMore}else aa=1,f++,Y--}0!==aa&&(m(0,J[f-1]&255),aa=0);v(c==Z_FINISH);return 0===q.avail_out?c==Z_FINISH?FinishStarted:
NeedMore:c==Z_FINISH?FinishDone:BlockDone}var z=this,q,C,y,G,I,D,F,J,Q,U,V,L,S,W,E,N,M,Z,R,aa,f,O,Y,ba,ia,da,ca,fa,A,T,K,X,P,ha=new Tree,na=new Tree,ea=new Tree;z.depth=[];var qa,ra,ka,la,ma,ta,ja,ga;z.bl_count=[];z.heap=[];K=[];X=[];P=[];z.pqdownheap=function(f,c){for(var g=z.heap,A=g[c],h=c<<1;h<=z.heap_len;){h<z.heap_len&&smaller(f,g[h+1],g[h],z.depth)&&h++;if(smaller(f,A,g[h],z.depth))break;g[c]=g[h];c=h;h<<=1}g[c]=A};z.deflateInit=function(g,h,k,j,l,m){j||(j=Z_DEFLATED);l||(l=DEF_MEM_LEVEL);
m||(m=Z_DEFAULT_STRATEGY);g.msg=null;h==Z_DEFAULT_COMPRESSION&&(h=6);if(1>l||l>MAX_MEM_LEVEL||j!=Z_DEFLATED||9>k||15<k||0>h||9<h||0>m||m>Z_HUFFMAN_ONLY)return Z_STREAM_ERROR;g.dstate=z;D=k;I=1<<D;F=I-1;W=l+7;S=1<<W;E=S-1;N=Math.floor((W+MIN_MATCH-1)/MIN_MATCH);J=new Uint8Array(2*I);U=[];V=[];ra=1<<l+6;z.pending_buf=new Uint8Array(4*ra);y=4*ra;la=Math.floor(ra/2);qa=3*ra;ca=h;fa=m;g.total_in=g.total_out=0;g.msg=null;z.pending=0;z.pending_out=0;C=BUSY_STATE;G=Z_NO_FLUSH;ha.dyn_tree=K;ha.stat_desc=StaticTree.static_l_desc;
na.dyn_tree=X;na.stat_desc=StaticTree.static_d_desc;ea.dyn_tree=P;ea.stat_desc=StaticTree.static_bl_desc;ga=ja=0;ta=8;c();Q=2*I;for(g=V[S-1]=0;g<S-1;g++)V[g]=0;da=config_table[ca].max_lazy;A=config_table[ca].good_length;T=config_table[ca].nice_length;ia=config_table[ca].max_chain;Y=M=f=0;Z=ba=MIN_MATCH-1;L=aa=0;return Z_OK};z.deflateEnd=function(){if(C!=INIT_STATE&&C!=BUSY_STATE&&C!=FINISH_STATE)return Z_STREAM_ERROR;J=U=V=z.pending_buf=null;z.dstate=null;return C==BUSY_STATE?Z_DATA_ERROR:Z_OK};z.deflateParams=
function(f,c,g){var h=Z_OK;c==Z_DEFAULT_COMPRESSION&&(c=6);if(0>c||9<c||0>g||g>Z_HUFFMAN_ONLY)return Z_STREAM_ERROR;config_table[ca].func!=config_table[c].func&&0!==f.total_in&&(h=f.deflate(Z_PARTIAL_FLUSH));ca!=c&&(ca=c,da=config_table[ca].max_lazy,A=config_table[ca].good_length,T=config_table[ca].nice_length,ia=config_table[ca].max_chain);fa=g;return h};z.deflateSetDictionary=function(c,g,A){var c=A,h=0;if(!g||C!=INIT_STATE)return Z_STREAM_ERROR;if(c<MIN_MATCH)return Z_OK;c>I-MIN_LOOKAHEAD&&(c=
I-MIN_LOOKAHEAD,h=A-c);J.set(g.subarray(h,h+c),0);M=f=c;L=J[0]&255;L=(L<<N^J[1]&255)&E;for(g=0;g<=c-MIN_MATCH;g++)L=(L<<N^J[g+(MIN_MATCH-1)]&255)&E,U[g&F]=V[L],V[L]=g;return Z_OK};z.deflate=function(c,g){var A,K,j;if(g>Z_FINISH||0>g)return Z_STREAM_ERROR;if(!c.next_out||!c.next_in&&0!==c.avail_in||C==FINISH_STATE&&g!=Z_FINISH)return c.msg=z_errmsg[Z_NEED_DICT-Z_STREAM_ERROR],Z_STREAM_ERROR;if(0===c.avail_out)return c.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR],Z_BUF_ERROR;q=c;A=G;G=g;C==INIT_STATE&&(K=
Z_DEFLATED+(D-8<<4)<<8,j=(ca-1&255)>>1,3<j&&(j=3),K|=j<<6,0!==f&&(K|=PRESET_DICT),C=BUSY_STATE,K+=31-K%31,h(K>>8&255),h(K&255));if(0!==z.pending){if(q.flush_pending(),0===q.avail_out)return G=-1,Z_OK}else if(0===q.avail_in&&g<=A&&g!=Z_FINISH)return q.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR],Z_BUF_ERROR;if(C==FINISH_STATE&&0!==q.avail_in)return c.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR],Z_BUF_ERROR;if(0!==q.avail_in||0!==Y||g!=Z_NO_FLUSH&&C!=FINISH_STATE){A=-1;switch(config_table[ca].func){case STORED:A=
B(g);break;case FAST:a:{for(A=0;;){if(Y<MIN_LOOKAHEAD){x();if(Y<MIN_LOOKAHEAD&&g==Z_NO_FLUSH){A=NeedMore;break a}if(0===Y)break}Y>=MIN_MATCH&&(L=(L<<N^J[f+(MIN_MATCH-1)]&255)&E,A=V[L]&65535,U[f&F]=V[L],V[L]=f);0!==A&&(f-A&65535)<=I-MIN_LOOKAHEAD&&fa!=Z_HUFFMAN_ONLY&&(Z=H(A));if(Z>=MIN_MATCH)if(K=m(f-O,Z-MIN_MATCH),Y-=Z,Z<=da&&Y>=MIN_MATCH){Z--;do f++,L=(L<<N^J[f+(MIN_MATCH-1)]&255)&E,A=V[L]&65535,U[f&F]=V[L],V[L]=f;while(0!==--Z);f++}else f+=Z,Z=0,L=J[f]&255,L=(L<<N^J[f+1]&255)&E;else K=m(0,J[f]&
255),Y--,f++;if(K&&(v(!1),0===q.avail_out)){A=NeedMore;break a}}v(g==Z_FINISH);A=0===q.avail_out?g==Z_FINISH?FinishStarted:NeedMore:g==Z_FINISH?FinishDone:BlockDone}break;case SLOW:A=w(g)}if(A==FinishStarted||A==FinishDone)C=FINISH_STATE;if(A==NeedMore||A==FinishStarted)return 0===q.avail_out&&(G=-1),Z_OK;if(A==BlockDone){if(g==Z_PARTIAL_FLUSH)k(STATIC_TREES<<1,3),l(END_BLOCK,StaticTree.static_ltree),o(),9>1+ta+10-ga&&(k(STATIC_TREES<<1,3),l(END_BLOCK,StaticTree.static_ltree),o()),ta=7;else if(k((STORED_BLOCK<<
1)+0,3),u(0,0,!0),g==Z_FULL_FLUSH)for(A=0;A<S;A++)V[A]=0;q.flush_pending();if(0===q.avail_out)return G=-1,Z_OK}}return g!=Z_FINISH?Z_OK:Z_STREAM_END}},ZStream=function(){this.total_out=this.avail_out=this.total_in=this.avail_in=this.next_out_index=this.next_in_index=0};ZStream.prototype={deflateInit:function(c,g){this.dstate=new Deflate;g||(g=MAX_BITS);return this.dstate.deflateInit(this,c,g)},deflate:function(c){return!this.dstate?Z_STREAM_ERROR:this.dstate.deflate(this,c)},deflateEnd:function(){if(!this.dstate)return Z_STREAM_ERROR;
var c=this.dstate.deflateEnd();this.dstate=null;return c},deflateParams:function(c,g){return!this.dstate?Z_STREAM_ERROR:this.dstate.deflateParams(this,c,g)},deflateSetDictionary:function(c,g){return!this.dstate?Z_STREAM_ERROR:this.dstate.deflateSetDictionary(this,c,g)},read_buf:function(c,g,h){var j=this.avail_in;j>h&&(j=h);if(0===j)return 0;this.avail_in-=j;c.set(this.next_in.subarray(this.next_in_index,this.next_in_index+j),g);this.next_in_index+=j;this.total_in+=j;return j},flush_pending:function(){var c=
this.dstate.pending;c>this.avail_out&&(c=this.avail_out);0!==c&&(this.next_out.set(this.dstate.pending_buf.subarray(this.dstate.pending_out,this.dstate.pending_out+c),this.next_out_index),this.next_out_index+=c,this.dstate.pending_out+=c,this.total_out+=c,this.avail_out-=c,this.dstate.pending-=c,0===this.dstate.pending&&(this.dstate.pending_out=0))}};var Deflater=function(c){var g=new ZStream,h=Z_NO_FLUSH,j=new Uint8Array(512);"undefined"==typeof c&&(c=Z_DEFAULT_COMPRESSION);g.deflateInit(c);g.next_out=
j;this.append=function(c,l){var n,o=[],m=0,r=0,t=0,u;if(c.length){g.next_in_index=0;g.next_in=c;g.avail_in=c.length;do{g.next_out_index=0;g.avail_out=512;n=g.deflate(h);if(n!=Z_OK)throw"deflating: "+g.msg;g.next_out_index&&(512==g.next_out_index?o.push(new Uint8Array(j)):o.push(new Uint8Array(j.subarray(0,g.next_out_index))));t+=g.next_out_index;l&&(0<g.next_in_index&&g.next_in_index!=m)&&(l(g.next_in_index),m=g.next_in_index)}while(0<g.avail_in||0===g.avail_out);u=new Uint8Array(t);o.forEach(function(c){u.set(c,
r);r+=c.length});return u}};this.flush=function(){var c,h=[],n=0,o=0,m;do{g.next_out_index=0;g.avail_out=512;c=g.deflate(Z_FINISH);if(c!=Z_STREAM_END&&c!=Z_OK)throw"deflating: "+g.msg;0<512-g.avail_out&&h.push(new Uint8Array(j.subarray(0,g.next_out_index)));o+=g.next_out_index}while(0<g.avail_in||0===g.avail_out);g.deflateEnd();m=new Uint8Array(o);h.forEach(function(c){m.set(c,n);n+=c.length});return m}},fVoid=function(c,g){"object"===typeof module?module.exports=g():"function"===typeof define?define(g):
c.adler32cs=g()}(this,function(){var c="function"===typeof ArrayBuffer&&"function"===typeof Uint8Array,g=null,h=function(){if(!c)return function(){return!1};try{var h=require("buffer");"function"===typeof h.Buffer&&(g=h.Buffer)}catch(k){}return function(c){return c instanceof ArrayBuffer||null!==g&&c instanceof g}}(),j=function(){return null!==g?function(c){return(new g(c,"utf8")).toString("binary")}:function(c){return unescape(encodeURIComponent(c))}}(),k=function(c,g){for(var h=c&65535,k=c>>>16,
j=0,l=g.length;j<l;j++)h=(h+(g.charCodeAt(j)&255))%65521,k=(k+h)%65521;return(k<<16|h)>>>0},l=function(c,g){for(var h=c&65535,k=c>>>16,j=0,l=g.length;j<l;j++)h=(h+g[j])%65521,k=(k+h)%65521;return(k<<16|h)>>>0},n={},o=n.Adler32=function(){var g=function(c){if(!(this instanceof g))throw new TypeError("Constructor cannot called be as a function.");if(!isFinite(c=null==c?1:+c))throw Error("First arguments needs to be a finite number.");this.checksum=c>>>0},n=g.prototype={};n.constructor=g;g.from=function(c){c.prototype=
n;return c}(function(c){if(!(this instanceof g))throw new TypeError("Constructor cannot called be as a function.");if(null==c)throw Error("First argument needs to be a string.");this.checksum=k(1,c.toString())});g.fromUtf8=function(c){c.prototype=n;return c}(function(c){if(!(this instanceof g))throw new TypeError("Constructor cannot called be as a function.");if(null==c)throw Error("First argument needs to be a string.");c=j(c.toString());this.checksum=k(1,c)});c&&(g.fromBuffer=function(c){c.prototype=
n;return c}(function(c){if(!(this instanceof g))throw new TypeError("Constructor cannot called be as a function.");if(!h(c))throw Error("First argument needs to be ArrayBuffer.");c=new Uint8Array(c);return this.checksum=l(1,c)}));n.update=function(c){if(c==null)throw Error("First argument needs to be a string.");c=c.toString();return this.checksum=k(this.checksum,c)};n.updateUtf8=function(c){if(c==null)throw Error("First argument needs to be a string.");c=j(c.toString());return this.checksum=k(this.checksum,
c)};c&&(n.updateBuffer=function(c){if(!h(c))throw Error("First argument needs to be ArrayBuffer.");c=new Uint8Array(c);return this.checksum=l(this.checksum,c)});n.clone=function(){return new o(this.checksum)};return g}();n.from=function(c){if(null==c)throw Error("First argument needs to be a string.");return k(1,c.toString())};n.fromUtf8=function(c){if(null==c)throw Error("First argument needs to be a string.");c=j(c.toString());return k(1,c)};c&&(n.fromBuffer=function(c){if(!h(c))throw Error("First argument need to be ArrayBuffer.");
c=new Uint8Array(c);return l(1,c)});return n}),JSZip=function(c,g){this.files={};this.root="";c&&this.load(c,g)};JSZip.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK"};JSZip.defaults={base64:!1,binary:!1,dir:!1,date:null};JSZip.prototype=function(){var c=function(c,g,h){this.name=c;this.data=g;this.options=h};c.prototype={asText:function(){return this.options.binary?
JSZip.prototype.utf8decode(this.data):this.data},asBinary:function(){return this.options.binary?this.data:JSZip.prototype.utf8encode(this.data)}};var g=function(c,g){var h="",k;for(k=0;k<g;k++)h+=String.fromCharCode(c&255),c>>>=8;return h},h=function(){var c={},g,h;for(g=0;g<arguments.length;g++)for(h in arguments[g])"undefined"===typeof c[h]&&(c[h]=arguments[g][h]);return c},j=function(c,g,j){var r=k(c);r&&l.call(this,r);j=j||{};!0===j.base64&&null==j.binary&&(j.binary=!0);j=h(j,JSZip.defaults);
j.date=j.date||new Date;return this.files[c]={name:c,data:g,options:j}},k=function(c){"/"==c.slice(-1)&&(c=c.substring(0,c.length-1));var g=c.lastIndexOf("/");return 0<g?c.substring(0,g):""},l=function(c){"/"!=c.slice(-1)&&(c+="/");if(!this.files[c]){var g=k(c);g&&l.call(this,g);j.call(this,c,"",{dir:!0})}return this.files[c]};return{load:function(){throw Error("Load method is not defined. Is the file jszip-load.js included ?");},filter:function(g){var k=[],j,l,t;for(j in this.files)l=this.files[j],
t=new c(l.name,l.data,h(l.options)),l=j.slice(this.root.length,j.length),j.slice(0,this.root.length)===this.root&&g(l,t)&&k.push(t);return k},file:function(c,g,h){if(1===arguments.length){if(c instanceof RegExp){var k=c;return this.filter(function(c,g){return!g.options.dir&&k.test(c)})}return this.filter(function(g,h){return!h.options.dir&&g===c})[0]||null}c=this.root+c;j.call(this,c,g,h);return this},folder:function(c){if(!c)throw Error("folder : wrong argument");if(c instanceof RegExp)return this.filter(function(g,
h){return h.options.dir&&c.test(g)});var g=l.call(this,this.root+c),h=this.clone();h.root=g.name;return h},remove:function(c){var c=this.root+c,g=this.files[c];g||("/"!=c.slice(-1)&&(c+="/"),g=this.files[c]);if(g)if(g.options.dir)for(var g=this.filter(function(g,h){return h.name.slice(0,c.length)===c}),h=0;h<g.length;h++)delete this.files[g[h].name];else delete this.files[c];return this},generate:function(c){var k,j,c=h(c||{},{base64:!0,compression:"STORE"}),l=c.compression.toUpperCase(),t=[],u=[],
v=0;if(!JSZip.compressions[l])throw l+" is not a valid compression method !";for(var x in this.files)if(this.files.hasOwnProperty(x)){var B=this.files[x],H=this.utf8encode(B.name);k=j="";k=H;var w=l;j=k!==B.name;var z=B.data,q=B.options,C=B=void 0,B=q.date.getHours(),B=B<<6,B=B|q.date.getMinutes(),B=B<<5,B=B|q.date.getSeconds()/2,C=q.date.getFullYear()-1980,C=C<<4,C=C|q.date.getMonth()+1,C=C<<5,C=C|q.date.getDate();!0===q.base64&&(z=JSZipBase64.decode(z));!1===q.binary&&(z=this.utf8encode(z));var q=
JSZip.compressions[w],w=q.compress(z),y="",y=y+"\n\x00",y=y+(j?"\x00":"\x00\x00"),y=y+q.magic,y=y+g(B,2),y=y+g(C,2),y=y+g(this.crc32(z),4),y=y+g(w.length,4),y=y+g(z.length,4),y=y+g(k.length,2);k=y+="\x00\x00";j=w;j=JSZip.signature.LOCAL_FILE_HEADER+k+H+j;k=JSZip.signature.CENTRAL_FILE_HEADER+"\x00"+k+"\x00\x00\x00\x00\x00\x00"+(!0===this.files[x].dir?"\x00\x00\x00":"\x00\x00\x00\x00")+g(v,4)+H;v+=j.length;u.push(j);t.push(k)}l=u.join("");t=t.join("");v="";v=JSZip.signature.CENTRAL_DIRECTORY_END+
"\x00\x00\x00\x00"+g(u.length,2)+g(u.length,2)+g(t.length,4)+g(l.length,4)+"\x00\x00";u=l+t+v;return c.base64?JSZipBase64.encode(u):u},crc32:function(c,g){if(""===c||"undefined"===typeof c)return 0;"undefined"==typeof g&&(g=0);for(var h=0,h=0,g=g^-1,k=0,j=c.length;k<j;k++)h=(g^c.charCodeAt(k))&255,h="0x"+"00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".substr(9*
h,8),g=g>>>8^h;return g^-1},clone:function(){var c=new JSZip,g;for(g in this)"function"!==typeof this[g]&&(c[g]=this[g]);return c},utf8encode:function(c){for(var c=c.replace(/\r\n/g,"\n"),g="",h=0;h<c.length;h++){var k=c.charCodeAt(h);128>k?g+=String.fromCharCode(k):(127<k&&2048>k?g+=String.fromCharCode(k>>6|192):(g+=String.fromCharCode(k>>12|224),g+=String.fromCharCode(k>>6&63|128)),g+=String.fromCharCode(k&63|128))}return g},utf8decode:function(c){for(var g="",h=0,k=0,j=0,l=0;h<c.length;)k=c.charCodeAt(h),
128>k?(g+=String.fromCharCode(k),h++):191<k&&224>k?(j=c.charCodeAt(h+1),g+=String.fromCharCode((k&31)<<6|j&63),h+=2):(j=c.charCodeAt(h+1),l=c.charCodeAt(h+2),g+=String.fromCharCode((k&15)<<12|(j&63)<<6|l&63),h+=3);return g}}}();JSZip.compressions={STORE:{magic:"\x00\x00",compress:function(c){return c},uncompress:function(c){return c}}};var JSZipBase64=function(){return{encode:function(c){for(var g="",h,j,k,l,n,o,m=0;m<c.length;)h=c.charCodeAt(m++),j=c.charCodeAt(m++),k=c.charCodeAt(m++),l=h>>2,h=
(h&3)<<4|j>>4,n=(j&15)<<2|k>>6,o=k&63,isNaN(j)?n=o=64:isNaN(k)&&(o=64),g=g+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(o);return g},decode:function(c){for(var g="",h,j,k,l,n,o=0,c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");o<c.length;)h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(o++)),
j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(o++)),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(o++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(o++)),h=h<<2|j>>4,j=(j&15)<<4|l>>2,k=(l&3)<<6|n,g+=String.fromCharCode(h),64!=l&&(g+=String.fromCharCode(j)),64!=n&&(g+=String.fromCharCode(k));return g}}}();if(!JSZip)throw"JSZip not defined";(function(){var c,g,h,j,k=null,l,n,
o,m,r,t,u,v,x,B,H,w,z,q,C,y,G,I,D,F,J,Q,U,V,L,S,W,E,N,M,Z,R,aa,f,O,Y,ba,ia,da,ca,fa,A,T,K,X,P,ha,na,ea,qa,ra,ka=function(){this.dl=this.fc=0},la=function(){this.extra_bits=this.static_tree=this.dyn_tree=null;this.max_code=this.max_length=this.elems=this.extra_base=0},ma=function(f,c,g,A){this.good_length=f;this.max_lazy=c;this.nice_length=g;this.max_chain=A},ta=function(){this.next=null;this.len=0;this.ptr=Array(8192);this.off=0},ja=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ga=[0,
0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Oa=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Fa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ba=[new ma(0,0,0,0),new ma(4,4,8,4),new ma(4,5,16,8),new ma(4,6,32,32),new ma(4,4,16,16),new ma(8,16,32,32),new ma(8,16,128,128),new ma(8,32,128,256),new ma(32,128,258,1024),new ma(32,258,258,4096)],xa=function(f){k[n+l++]=f;if(8192==n+l&&0!=l){var A;null!=c?(f=c,c=c.next):f=new ta;f.next=null;f.len=f.off=0;null==g?g=h=f:h=h.next=f;f.len=
l-n;for(A=0;A<f.len;A++)f.ptr[A]=k[n+A];l=n=0}},ya=function(f){f&=65535;8190>n+l?(k[n+l++]=f&255,k[n+l++]=f>>>8):(xa(f&255),xa(f>>>8))},za=function(){H=(H<<5^m[G+3-1]&255)&8191;w=u[32768+H];u[G&32767]=w;u[32768+H]=G},sa=function(f,c){oa(c[f].fc,c[f].dl)},Ga=function(f,c,g){return f[c].fc<f[g].fc||f[c].fc==f[g].fc&&ba[c]<=ba[g]},Ha=function(f,c,g){var A;for(A=0;A<g&&ra<qa.length;A++)f[c+A]=qa.charCodeAt(ra++)&255;return A},Ia=function(f){var c=J,g=G,A,h=y,k=32506<G?G-32506:0,j=G+258,K=m[g+h-1],T=m[g+
h];y>=V&&(c>>=2);do if(A=f,!(m[A+h]!=T||m[A+h-1]!=K||m[A]!=m[g]||m[++A]!=m[g+1])){g+=2;A++;do;while(m[++g]==m[++A]&&m[++g]==m[++A]&&m[++g]==m[++A]&&m[++g]==m[++A]&&m[++g]==m[++A]&&m[++g]==m[++A]&&m[++g]==m[++A]&&m[++g]==m[++A]&&g<j);A=258-(j-g);g=j-258;if(A>h){I=f;h=A;if(258<=A)break;K=m[g+h-1];T=m[g+h]}}while((f=u[f&32767])>k&&0!=--c);return h},Ca=function(){var f,c,g=65536-F-G;if(-1==g)g--;else if(65274<=G){for(f=0;32768>f;f++)m[f]=m[f+32768];I-=32768;G-=32768;B-=32768;for(f=0;8192>f;f++)c=u[32768+
f],u[32768+f]=32768<=c?c-32768:0;for(f=0;32768>f;f++)c=u[f],u[f]=32768<=c?c-32768:0;g+=32768}D||(f=Ha(m,G+F,g),0>=f?D=!0:F+=f)},Pa=function(f,c,A){var h;if(!j){if(!D){x=v=0;var k,K;if(0==E[0].dl){M.dyn_tree=L;M.static_tree=W;M.extra_bits=ja;M.extra_base=257;M.elems=286;M.max_length=15;M.max_code=0;Z.dyn_tree=S;Z.static_tree=E;Z.extra_bits=ga;Z.extra_base=0;Z.elems=30;Z.max_length=15;Z.max_code=0;R.dyn_tree=N;R.static_tree=null;R.extra_bits=Oa;R.extra_base=0;R.elems=19;R.max_length=7;for(K=k=R.max_code=
0;28>K;K++){ca[K]=k;for(h=0;h<1<<ja[K];h++)ia[k++]=K}ia[k-1]=K;for(K=k=0;16>K;K++){fa[K]=k;for(h=0;h<1<<ga[K];h++)da[k++]=K}for(k>>=7;30>K;K++){fa[K]=k<<7;for(h=0;h<1<<ga[K]-7;h++)da[256+k++]=K}for(h=0;15>=h;h++)aa[h]=0;for(h=0;143>=h;)W[h++].dl=8,aa[8]++;for(;255>=h;)W[h++].dl=9,aa[9]++;for(;279>=h;)W[h++].dl=7,aa[7]++;for(;287>=h;)W[h++].dl=8,aa[8]++;Ja(W,287);for(h=0;30>h;h++)E[h].dl=5,E[h].fc=ua(h,5);Ka()}for(h=0;8192>h;h++)u[32768+h]=0;Q=Ba[U].max_lazy;V=Ba[U].good_length;J=Ba[U].max_chain;B=
G=0;F=Ha(m,0,65536);if(0>=F)D=!0,F=0;else{for(D=!1;262>F&&!D;)Ca();for(h=H=0;2>h;h++)H=(H<<5^m[h]&255)&8191}g=null;n=l=0;3>=U?(y=2,C=0):(C=2,q=0);o=!1}j=!0;if(0==F)return o=!0,0}if((h=La(f,c,A))==A)return A;if(o)return h;if(3>=U)for(;0!=F&&null==g;){za();0!=w&&32506>=G-w&&(C=Ia(w),C>F&&(C=F));if(3<=C)if(K=va(G-I,C-3),F-=C,C<=Q){C--;do G++,za();while(0!=--C);G++}else G+=C,C=0,H=m[G]&255,H=(H<<5^m[G+1]&255)&8191;else K=va(0,m[G]&255),F--,G++;K&&(Aa(0),B=G);for(;262>F&&!D;)Ca()}else for(;0!=F&&null==
g;){za();y=C;z=I;C=2;0!=w&&(y<Q&&32506>=G-w)&&(C=Ia(w),C>F&&(C=F),3==C&&4096<G-I&&C--);if(3<=y&&C<=y){K=va(G-1-z,y-3);F-=y-1;y-=2;do G++,za();while(0!=--y);q=0;C=2;G++;K&&(Aa(0),B=G)}else 0!=q?va(0,m[G-1]&255)&&(Aa(0),B=G):q=1,G++,F--;for(;262>F&&!D;)Ca()}0==F&&(0!=q&&va(0,m[G-1]&255),Aa(1),o=!0);return h+La(f,h+c,A-h)},La=function(f,A,h){var K,j,T;for(K=0;null!=g&&K<h;){j=h-K;j>g.len&&(j=g.len);for(T=0;T<j;T++)f[A+K+T]=g.ptr[g.off+T];g.off+=j;g.len-=j;K+=j;0==g.len&&(j=g,g=g.next,j.next=c,c=j)}if(K==
h)return K;if(n<l){j=h-K;j>l-n&&(j=l-n);for(T=0;T<j;T++)f[A+K+T]=k[n+T];n+=j;K+=j;l==n&&(l=n=0)}return K},Ka=function(){var f;for(f=0;286>f;f++)L[f].fc=0;for(f=0;30>f;f++)S[f].fc=0;for(f=0;19>f;f++)N[f].fc=0;L[256].fc=1;P=T=K=X=na=ea=0;ha=1},Da=function(c,g){for(var A=f[g],h=g<<1;h<=O;){h<O&&Ga(c,f[h+1],f[h])&&h++;if(Ga(c,A,f[h]))break;f[g]=f[h];g=h;h<<=1}f[g]=A},Ja=function(f,c){var g=Array(16),A=0,h;for(h=1;15>=h;h++)A=A+aa[h-1]<<1,g[h]=A;for(A=0;A<=c;A++)h=f[A].dl,0!=h&&(f[A].fc=ua(g[h]++,h))},
Ea=function(c){var g=c.dyn_tree,A=c.static_tree,h=c.elems,k,j=-1,K=h;O=0;Y=573;for(k=0;k<h;k++)0!=g[k].fc?(f[++O]=j=k,ba[k]=0):g[k].dl=0;for(;2>O;)k=f[++O]=2>j?++j:0,g[k].fc=1,ba[k]=0,na--,null!=A&&(ea-=A[k].dl);c.max_code=j;for(k=O>>1;1<=k;k--)Da(g,k);do k=f[1],f[1]=f[O--],Da(g,1),A=f[1],f[--Y]=k,f[--Y]=A,g[K].fc=g[k].fc+g[A].fc,ba[K]=ba[k]>ba[A]+1?ba[k]:ba[A]+1,g[k].dl=g[A].dl=K,f[1]=K++,Da(g,1);while(2<=O);f[--Y]=f[1];K=c.dyn_tree;k=c.extra_bits;var h=c.extra_base,A=c.max_code,T=c.max_length,X=
c.static_tree,l,P,m,n,o=0;for(P=0;15>=P;P++)aa[P]=0;K[f[Y]].dl=0;for(c=Y+1;573>c;c++)if(l=f[c],P=K[K[l].dl].dl+1,P>T&&(P=T,o++),K[l].dl=P,!(l>A))aa[P]++,m=0,l>=h&&(m=k[l-h]),n=K[l].fc,na+=n*(P+m),null!=X&&(ea+=n*(X[l].dl+m));if(0!=o){do{for(P=T-1;0==aa[P];)P--;aa[P]--;aa[P+1]+=2;aa[T]--;o-=2}while(0<o);for(P=T;0!=P;P--)for(l=aa[P];0!=l;)k=f[--c],k>A||(K[k].dl!=P&&(na+=(P-K[k].dl)*K[k].fc,K[k].fc=P),l--)}Ja(g,j)},Ma=function(f,c){var g,A=-1,h,k=f[0].dl,K=0,j=7,T=4;0==k&&(j=138,T=3);f[c+1].dl=65535;
for(g=0;g<=c;g++)if(h=k,k=f[g+1].dl,!(++K<j&&h==k))(K<T?N[h].fc+=K:0!=h?(h!=A&&N[h].fc++,N[16].fc++):10>=K?N[17].fc++:N[18].fc++,K=0,A=h,0==k)?(j=138,T=3):h==k?(j=6,T=3):(j=7,T=4)},Na=function(f,c){var g,A=-1,h,k=f[0].dl,K=0,j=7,T=4;0==k&&(j=138,T=3);for(g=0;g<=c;g++)if(h=k,k=f[g+1].dl,!(++K<j&&h==k)){if(K<T){do sa(h,N);while(0!=--K)}else 0!=h?(h!=A&&(sa(h,N),K--),sa(16,N),oa(K-3,2)):10>=K?(sa(17,N),oa(K-3,3)):(sa(18,N),oa(K-11,7));K=0;A=h;0==k?(j=138,T=3):h==k?(j=6,T=3):(j=7,T=4)}},Aa=function(f){var c,
g,h,k;k=G-B;A[X]=P;Ea(M);Ea(Z);Ma(L,M.max_code);Ma(S,Z.max_code);Ea(R);for(h=18;3<=h&&0==N[Fa[h]].dl;h--);na+=3*(h+1)+14;c=na+3+7>>3;g=ea+3+7>>3;g<=c&&(c=g);if(k+4<=c&&0<=B){oa(0+f,3);wa();ya(k);ya(~k);for(h=0;h<k;h++)xa(m[B+h])}else if(g==c)oa(2+f,3),pa(W,E);else{oa(4+f,3);k=M.max_code+1;c=Z.max_code+1;h+=1;oa(k-257,5);oa(c-1,5);oa(h-4,4);for(g=0;g<h;g++)oa(N[Fa[g]].dl,3);Na(L,k-1);Na(S,c-1);pa(L,S)}Ka();0!=f&&wa()},va=function(f,c){t[T++]=c;0==f?L[c].fc++:(f--,L[ia[c]+256+1].fc++,S[(256>f?da[f]:
da[256+(f>>7)])&255].fc++,r[K++]=f,P|=ha);ha<<=1;0==(T&7)&&(A[X++]=P,P=0,ha=1);if(2<U&&0==(T&4095)){var g=8*T,h=G-B,k;for(k=0;30>k;k++)g+=S[k].fc*(5+ga[k]);g>>=3;if(K<parseInt(T/2)&&g<parseInt(h/2))return!0}return 8191==T||8192==K},pa=function(f,c){var g,h=0,k=0,K=0,j=0,P,X;if(0!=T){do{0==(h&7)&&(j=A[K++]);g=t[h++]&255;if(0==(j&1))sa(g,f);else if(P=ia[g],sa(P+256+1,f),X=ja[P],0!=X&&(g-=ca[P],oa(g,X)),g=r[k++],P=(256>g?da[g]:da[256+(g>>7)])&255,sa(P,c),X=ga[P],0!=X)g-=fa[P],oa(g,X);j>>=1}while(h<T)
}sa(256,f)},oa=function(f,c){x>16-c?(v|=f<<x,ya(v),v=f>>16-x,x+=c-16):(v|=f<<x,x+=c)},ua=function(f,c){var g=0;do g|=f&1,f>>=1,g<<=1;while(0<--c);return g>>1},wa=function(){8<x?ya(v):0<x&&xa(v);x=v=0},ma=function(K,T){var P,X;qa=K;ra=0;"undefined"==typeof T&&(T=6);(P=T)?1>P?P=1:9<P&&(P=9):P=6;U=P;D=j=!1;if(null==k){c=g=h=null;k=Array(8192);m=Array(65536);r=Array(8192);t=Array(32832);u=Array(65536);L=Array(573);for(P=0;573>P;P++)L[P]=new ka;S=Array(61);for(P=0;61>P;P++)S[P]=new ka;W=Array(288);for(P=
0;288>P;P++)W[P]=new ka;E=Array(30);for(P=0;30>P;P++)E[P]=new ka;N=Array(39);for(P=0;39>P;P++)N[P]=new ka;M=new la;Z=new la;R=new la;aa=Array(16);f=Array(573);ba=Array(573);ia=Array(256);da=Array(512);ca=Array(29);fa=Array(30);A=Array(1024)}for(var l=Array(1024),n=[];0<(P=Pa(l,0,l.length));){var o=Array(P);for(X=0;X<P;X++)o[X]=String.fromCharCode(l[X]);n[n.length]=o.join("")}qa=null;return n.join("")};JSZip.compressions.DEFLATE?JSZip.compressions.DEFLATE.compress=ma:JSZip.compressions.DEFLATE={magic:"\x00",
compress:ma}})();if(!JSZip)throw"JSZip not defined";(function(){function c(){this.list=this.next=null}function g(){this.n=this.b=this.e=0;this.t=null}function h(f,h,k,j,l,m){this.BMAX=16;this.N_MAX=288;this.status=0;this.root=null;this.m=0;var n=Array(this.BMAX+1),o,A,T,K,X,P,ha,q=Array(this.BMAX+1),ea,y,r,t=new g,la=Array(this.BMAX);K=Array(this.N_MAX);var u,v=Array(this.BMAX+1),w,C,x;x=this.root=null;for(X=0;X<n.length;X++)n[X]=0;for(X=0;X<q.length;X++)q[X]=0;for(X=0;X<la.length;X++)la[X]=null;
for(X=0;X<K.length;X++)K[X]=0;for(X=0;X<v.length;X++)v[X]=0;o=256<h?f[256]:this.BMAX;ea=f;y=0;X=h;do n[ea[y]]++,y++;while(0<--X);if(n[0]==h)this.root=null,this.status=this.m=0;else{for(P=1;P<=this.BMAX&&0==n[P];P++);ha=P;m<P&&(m=P);for(X=this.BMAX;0!=X&&0==n[X];X--);T=X;m>X&&(m=X);for(w=1<<P;P<X;P++,w<<=1)if(0>(w-=n[P])){this.status=2;this.m=m;return}if(0>(w-=n[X]))this.status=2,this.m=m;else{n[X]+=w;v[1]=P=0;ea=n;y=1;for(r=2;0<--X;)v[r++]=P+=ea[y++];ea=f;X=y=0;do if(0!=(P=ea[y++]))K[v[P]++]=X;while(++X<
h);h=v[T];v[0]=X=0;ea=K;y=0;K=-1;u=q[0]=0;r=null;for(C=0;ha<=T;ha++)for(f=n[ha];0<f--;){for(;ha>u+q[1+K];){u+=q[1+K];K++;C=(C=T-u)>m?m:C;if((A=1<<(P=ha-u))>f+1){A-=f+1;for(r=ha;++P<C&&!((A<<=1)<=n[++r]);)A-=n[r]}u+P>o&&u<o&&(P=o-u);C=1<<P;q[1+K]=P;r=Array(C);for(A=0;A<C;A++)r[A]=new g;x=null==x?this.root=new c:x.next=new c;x.next=null;x.list=r;la[K]=r;0<K&&(v[K]=X,t.b=q[K],t.e=16+P,t.t=r,P=(X&(1<<u)-1)>>u-q[K],la[K-1][P].e=t.e,la[K-1][P].b=t.b,la[K-1][P].n=t.n,la[K-1][P].t=t.t)}t.b=ha-u;y>=h?t.e=
99:ea[y]<k?(t.e=256>ea[y]?16:15,t.n=ea[y++]):(t.e=l[ea[y]-k],t.n=j[ea[y++]-k]);A=1<<ha-u;for(P=X>>u;P<C;P+=A)r[P].e=t.e,r[P].b=t.b,r[P].n=t.n,r[P].t=t.t;for(P=1<<ha-1;0!=(X&P);P>>=1)X^=P;for(X^=P;(X&(1<<u)-1)!=v[K];)u-=q[K],K--}this.m=q[1];this.status=0!=w&&1!=T?1:0}}}function j(f){for(;G<f;){var c=y,g;g=S.length==W?-1:S.charCodeAt(W++)&255;y=c|g<<G;G+=8}}function k(f){return y&E[f]}function l(f){y>>=f;G-=f}function n(f,c,g){var h,m,n;if(0==g)return 0;for(n=0;;){j(V);m=Q.list[k(V)];for(h=m.e;16<h;){if(99==
h)return-1;l(m.b);h-=16;j(h);m=m.t[k(h)];h=m.e}l(m.b);if(16==h)w&=u-1,f[c+n++]=H[w++]=m.n;else{if(15==h)break;j(h);F=m.n+k(h);l(h);j(L);m=U.list[k(L)];for(h=m.e;16<h;){if(99==h)return-1;l(m.b);h-=16;j(h);m=m.t[k(h)];h=m.e}l(m.b);j(h);J=w-m.n-k(h);for(l(h);0<F&&n<g;)F--,J&=u-1,w&=u-1,f[c+n++]=H[w++]=H[J++]}if(n==g)return g}I=-1;return n}function o(f,c,g){var m,o,q,y,r,A,T,K=Array(316);for(m=0;m<K.length;m++)K[m]=0;j(5);A=257+k(5);l(5);j(5);T=1+k(5);l(5);j(4);m=4+k(4);l(4);if(286<A||30<T)return-1;for(o=
0;o<m;o++)j(3),K[aa[o]]=k(3),l(3);for(;19>o;o++)K[aa[o]]=0;V=7;o=new h(K,19,19,null,null,V);if(0!=o.status)return-1;Q=o.root;V=o.m;y=A+T;for(m=q=0;m<y;)if(j(V),r=Q.list[k(V)],o=r.b,l(o),o=r.n,16>o)K[m++]=q=o;else if(16==o){j(2);o=3+k(2);l(2);if(m+o>y)return-1;for(;0<o--;)K[m++]=q}else{17==o?(j(3),o=3+k(3),l(3)):(j(7),o=11+k(7),l(7));if(m+o>y)return-1;for(;0<o--;)K[m++]=0;q=0}V=x;o=new h(K,A,257,N,M,V);0==V&&(o.status=1);if(0!=o.status)return-1;Q=o.root;V=o.m;for(m=0;m<T;m++)K[m]=K[m+A];L=B;o=new h(K,
T,0,Z,R,L);U=o.root;L=o.m;return 0==L&&257<A||0!=o.status?-1:n(f,c,g)}function m(f,c,g){var m,r;for(m=0;m<g&&!(D&&-1==I);){if(0<F){if(I!=v)for(;0<F&&m<g;)F--,J&=u-1,w&=u-1,f[c+m++]=H[w++]=H[J++];else{for(;0<F&&m<g;)F--,w&=u-1,j(8),f[c+m++]=H[w++]=k(8),l(8);0==F&&(I=-1)}if(m==g)break}if(-1==I){if(D)break;j(1);0!=k(1)&&(D=!0);l(1);j(2);I=k(2);l(2);Q=null;F=0}switch(I){case 0:r=f;var x=c+m,B=g-m,E=void 0,E=G&7;l(E);j(16);E=k(16);l(16);j(16);if(E!=(~y&65535))r=-1;else{l(16);F=E;for(E=0;0<F&&E<B;)F--,
w&=u-1,j(8),r[x+E++]=H[w++]=k(8),l(8);0==F&&(I=-1);r=E}break;case 1:if(null!=Q)r=n(f,c+m,g-m);else a:{r=f;x=c+m;B=g-m;if(null==z){for(var A=void 0,E=Array(288),A=void 0,A=0;144>A;A++)E[A]=8;for(;256>A;A++)E[A]=9;for(;280>A;A++)E[A]=7;for(;288>A;A++)E[A]=8;C=7;A=new h(E,288,257,N,M,C);if(0!=A.status){alert("HufBuild error: "+A.status);r=-1;break a}z=A.root;C=A.m;for(A=0;30>A;A++)E[A]=5;t=5;A=new h(E,30,0,Z,R,t);if(1<A.status){z=null;alert("HufBuild error: "+A.status);r=-1;break a}q=A.root;t=A.m}Q=
z;U=q;V=C;L=t;r=n(r,x,B)}break;case 2:r=null!=Q?n(f,c+m,g-m):o(f,c+m,g-m);break;default:r=-1}if(-1==r)return D?0:-1;m+=r}return m}function r(f){var c,g,h;null==H&&(H=Array(2*u));G=y=w=0;I=-1;D=!1;F=J=0;Q=null;S=f;W=0;c=Array(1024);for(f="";0<(g=m(c,0,c.length));)for(h=0;h<g;h++)f+=String.fromCharCode(c[h]);S=null;return f}var t,u=32768,v=0,x=9,B=6,H,w,z=null,q,C,y,G,I,D,F,J,Q,U,V,L,S,W,E=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],N=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,
31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],aa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];JSZip.compressions.DEFLATE?JSZip.compressions.DEFLATE.uncompress=r:JSZip.compressions.DEFLATE={magic:"\x00",uncompress:r}})();(function(){function c(c){this.stream=
c;this.index=0}function g(c,g){this.options=c;this.loadOptions=g}function h(c,g){this.files=[];this.loadOptions=g;c&&this.load(c)}var j=function(c){var g="",h,j;for(j=0;j<c.length;j++)h=c.charCodeAt(j),g+="\\x"+(10>h?"0":"")+h.toString(16);return g};c.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.stream.length<c||0>c)throw Error("End of stream reached (stream length = "+this.stream.length+", asked index = "+c+"). Corrupted zip ?");},setIndex:function(c){this.checkIndex(c);
this.index=c},eof:function(){return this.index>=this.stream.length},byteAt:function(c){return this.stream.charCodeAt(c)&255},readByte:function(){this.checkOffset(1);return this.byteAt(1+this.index++)},readInt:function(c){var g=0,h;this.checkOffset(c);for(h=c-1;0<=h;h--)g=(g<<8)+this.byteAt(this.index+h);this.index+=c;return g},readString:function(c){var g="",h,j;this.checkOffset(c);for(h=0;h<c;h++)j=this.byteAt(this.index+h),g+=String.fromCharCode(j);this.index+=c;return g},readDate:function(){var c=
this.readInt(4);return new Date((c>>25&127)+1980,(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(c&31)<<1)}};g.prototype={isEncrypted:function(){return 1===(this.bitFlag&1)},hasDataDescriptor:function(){return 8===(this.bitFlag&8)},useUTF8:function(){return 2048===(this.bitFlag&2048)},isZIP64:function(){return this.options.zip64},readLocalPartHeader:function(c){this.versionNeeded=c.readInt(2);this.bitFlag=c.readInt(2);this.compressionMethod=c.readString(2);this.date=c.readDate();this.crc32=c.readInt(4);this.compressedSize=
c.readInt(4);this.uncompressedSize=c.readInt(4);this.fileNameLength=c.readInt(2);this.extraFieldsLength=c.readInt(2);if(this.isEncrypted())throw Error("Encrypted zip are not supported");},readLocalPart:function(c){this.readLocalPartHeader(c);this.fileName=c.readString(this.fileNameLength);this.readExtraFields(c);if(this.hasDataDescriptor()){if(this.compressedFileData=this.findDataUntilDataDescriptor(c),this.crc32=c.readInt(4),this.compressedSize=c.readInt(this.isZIP64()?8:4),this.uncompressedSize=
c.readInt(this.isZIP64()?8:4),this.compressedFileData.length!==this.compressedSize)throw Error("Bug : data descriptor incorrectly read (size mismatch)");}else this.compressedFileData=c.readString(this.compressedSize);this.uncompressedFileData=null;a:{for(var g in JSZip.compressions)if(JSZip.compressions[g].magic===this.compressionMethod){c=JSZip.compressions[g];break a}c=null}if(null===c)throw Error("Corrupted zip : compression "+j(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");
this.uncompressedFileData=c.uncompress(this.compressedFileData);if(this.loadOptions.checkCRC32&&JSZip.prototype.crc32(this.uncompressedFileData)!==this.crc32)throw Error("Corrupted zip : CRC32 mismatch");this.useUTF8()&&(this.fileName=JSZip.prototype.utf8decode(this.fileName))},findDataUntilDataDescriptor:function(c){for(var g="",h=c.readString(4),j;h!==JSZip.signature.DATA_DESCRIPTOR;)j=c.readString(1),g+=h.slice(0,1),h=(h+j).slice(-4);return g},readCentralPart:function(c){this.versionMadeBy=c.readString(2);
this.readLocalPartHeader(c);this.fileCommentLength=c.readInt(2);this.diskNumberStart=c.readInt(2);this.internalFileAttributes=c.readInt(2);this.externalFileAttributes=c.readInt(4);this.localHeaderOffset=c.readInt(4);this.fileName=c.readString(this.fileNameLength);this.readExtraFields(c);this.fileComment=c.readString(this.fileCommentLength);this.useUTF8()&&(this.fileName=JSZip.prototype.utf8decode(this.fileName),this.fileComment=JSZip.prototype.utf8decode(this.fileComment));this.dir=this.externalFileAttributes&
16?!0:!1},parseZIP64ExtraField:function(){var g=new c(this.extraFields[1].value);-1===this.uncompressedSize&&(this.uncompressedSize=g.readInt(8));-1===this.compressedSize&&(this.compressedSize=g.readInt(8));-1===this.localHeaderOffset&&(this.localHeaderOffset=g.readInt(8));-1===this.diskNumberStart&&(this.diskNumberStart=g.readInt(4))},readExtraFields:function(c){var g=c.index,h,j,m;for(this.extraFields=this.extraFields||{};c.index<g+this.extraFieldsLength;)h=c.readInt(2),j=c.readInt(2),m=c.readString(j),
this.extraFields[h]={id:h,length:j,value:m};this.isZIP64()&&this.extraFields[1]&&this.parseZIP64ExtraField(c)}};h.prototype={checkSignature:function(c){var g=this.reader.readString(4);if(g!==c)throw Error("Corrupted zip or bug : unexpected signature ("+j(g)+", expected "+j(c)+")");},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);
this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);
this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};for(var c=this.zip64EndOfCentralSize-44,g,h,j;0<c;)g=this.reader.readInt(2),h=this.reader.readInt(4),j=this.reader.readString(h),this.zip64ExtensibleData[g]={id:g,length:h,value:j}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);
this.disksCount=this.reader.readInt(4);if(1<this.disksCount)throw Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var c,g;for(c=0;c<this.files.length;c++)g=this.files[c],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(JSZip.signature.LOCAL_FILE_HEADER),g.readLocalPart(this.reader)},readCentralDir:function(){var c;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===JSZip.signature.CENTRAL_FILE_HEADER;)c=new g({zip64:this.zip64},this.loadOptions),
c.readCentralPart(this.reader),this.files.push(c)},readEndOfCentral:function(){var c=this.reader.stream.lastIndexOf(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(-1===c){this.zip64=!1;c=this.reader.stream.lastIndexOf(JSZip.signature.CENTRAL_DIRECTORY_END);if(-1===c)throw Error("Corrupted zip : can't find end of central directory");this.reader.setIndex(c);this.checkSignature(JSZip.signature.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral()}else this.zip64=!0,this.reader.setIndex(c),this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR),
this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()},load:function(g){this.reader=new c(g);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};JSZip.prototype.load=function(c,g){var j,o,m,g=g||{};g.base64&&(c=JSZipBase64.decode(c));j=(new h(c,g)).files;for(o in j)m=j[o],this.file(m.fileName,m.uncompressedFileData,{binary:!0,date:m.date,
dir:m.dir});return this}})();var xlsx=function(c){function g(f){var c=Math.floor(f/26)-1;return(-1<c?g(c):"")+R.charAt(f%26)}function h(f){return{}.toString.call(f).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function j(f){return(f||"").replace(/&(?!(lt|gt))/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function k(f,c,g){if(void 0==f||""==f.trim())f="";else if("date"==c.genexusType){var g=g?["DMY","YMD","YDM"]:"99/99/99"==c.genexusPicture?["dd/mm/yy",
"yy/mm/dd","yyyy/dd/mm"]:["dd/mm/yyyy","yyyy/mm/dd","yyyy/dd/mm"],h=f.split("-");if(!c.genexusPicture||"99/99/99"==c.genexusPicture)f=h[1]+"/"+h[2]+"/"+h[0].substring(2),c.formatCode==g[0]&&(f=h[2]+"/"+h[1]+"/"+h[0].substring(2)),c.formatCode==g[1]&&(f=h[0].substring(2)+"/"+h[1]+"/"+h[2]);"99/99/9999"==c.genexusPicture&&(f=h[1]+"/"+h[2]+"/"+h[0],c.formatCode==g[0]&&(f=h[2]+"/"+h[1]+"/"+h[0]),c.formatCode==g[1]&&(f=h[0]+"/"+h[1]+"/"+h[2]));"9999/99/99"==c.genexusPicture&&(f=h[0]+"/"+h[1]+"/"+h[2],
c.formatCode==g[2]&&(f=h[0]+"/"+h[2]+"/"+h[1]),c.formatCode==g[1]&&(f=h[0]+"/"+h[1]+"/"+h[2]))}else{var k=f.split(" "),h=k[0].split("-");Y=k[1].split(":");c.genexusPicture?(k=c.genexusPicture.split(" "),g=g?["DMY","YMD","YDM"]:"99/99/99"==k[0]?["dd/mm/yy","yy/mm/dd","yyyy/dd/mm"]:["dd/mm/yyyy","yyyy/mm/dd","yyyy/dd/mm"],"99/99/99"==k[0]&&(f=h[1]+"/"+h[2]+"/"+h[0].substring(2),c.formatCode==g[0]&&(f=h[2]+"/"+h[1]+"/"+h[0].substring(2)),c.formatCode==g[1]&&(f=h[0].substring(2)+"/"+h[1]+"/"+h[2])),"99/99/9999"==
k[0]&&(f=h[1]+"/"+h[2]+"/"+h[0],c.formatCode==g[0]&&(f=h[2]+"/"+h[1]+"/"+h[0]),c.formatCode==g[1]&&(f=h[0]+"/"+h[1]+"/"+h[2])),"9999/99/99"==k[0]&&(f=h[0]+"/"+h[1]+"/"+h[2],c.formatCode==g[2]&&(f=h[0]+"/"+h[2]+"/"+h[1]),c.formatCode==g[1]&&(f=h[0]+"/"+h[1]+"/"+h[2])),"99"==k[1]&&(f=f+" "+Y[0]),"99:99"==k[1]&&(f=f+" "+Y[0]+":"+Y[1]),"99:99:99"==k[1]&&(f=f+" "+Y[0]+":"+Y[1]+":"+Y[2].split(".")[0]),"99:99:99.999"==k[1]&&(f=f+" "+Y[0]+":"+Y[1]+":"+Y[2])):f=h[1]+"/"+h[2]+"/"+h[0].substring(2)+" "+Y[0]+
":"+Y[1]}return f}var l;l=new JSZip;var n,o,m,r,t,u,v,x,B,H,w,z,q,C,y,G,I,D,F,J,Q=[[],[]],U=[],V=[],L=[],S,W,E,N,M,Z=["General","0","0.00","#,##0","#,##0.00",,,,,"0%","0.00%","0.00E+00","# ?/?","# ??/??","mm-dd-yy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","m/d/yy h:mm",,,,,,,,,,,,,,,"#,##0 ;(#,##0)","#,##0 ;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)",,,,,"mm:ss","[h]:mm:ss","mmss.0","##0.0E+0","@"],R="ABCDEFGHIJKLMNOPQRSTUVWXYZ";if(c.pivot){n=Date.now();
l.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/></Relationships>');
I=l.folder("docProps");I.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>gonzalo</dc:creator><dcterms:created xsi:type="dcterms:W3CDTF">2010-12-23T01:32:21Z</dcterms:created><cp:lastModifiedBy>xperTools</cp:lastModifiedBy><dcterms:modified xsi:type="dcterms:W3CDTF">2010-02-23T01:32:21Z</dcterms:modified></cp:coreProperties>');
I.file("app.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Hojas de cálculo</vt:lpstr></vt:variant><vt:variant><vt:i4>2</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="2" baseType="lpstr"><vt:lpstr>PivotTable</vt:lpstr><vt:lpstr>SourceData</vt:lpstr></vt:vector></TitlesOfParts><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>12.0000</AppVersion></Properties>');
l.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml"/><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/><Override PartName="/xl/worksheets/sheet2.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/><Override PartName="/xl/pivotTables/pivotTable1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml"/><Override PartName="/xl/pivotCache/pivotCacheDefinition1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml"/><Override PartName="/xl/pivotCache/pivotCacheRecords1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml"/></Types>');
D=l.folder("xl");D.folder("_rels").file("workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet2.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition" Target="pivotCache/pivotCacheDefinition1.xml"/><Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/><Relationship Id="rId5" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId6" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/></Relationships>');
F=D.folder("pivotCache").file("pivotCacheRecords1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><pivotCacheRecords xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"></pivotCacheRecords>');F.file("pivotCacheDefinition1.xml",c.pivotCacheDefinition);F.folder("_rels").file("pivotCacheDefinition1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords" Target="pivotCacheRecords1.xml"/></Relationships>');
D.folder("pivotTables").file("pivotTable1.xml",c.pivotTable1).folder("_rels").file("pivotTable1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition" Target="../pivotCache/pivotCacheDefinition1.xml"/></Relationships>');D.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><a:theme name="Tema de Office" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"/>');
F=D.folder("worksheets");F.file("sheet1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheetData/></worksheet>');H=Array(1);y=Array(1);G=Array(1);var aa="",f=1;for(x=c.worksheets.length;x--;){S=x+1;J=c.worksheets[x];z=J.data;o="";W=[];M=[];m=-1;for(u=z.length;++m<u;){r=-1;t=z[m].length;for(o+='<row r="'+(m+1)+'" x14ac:dyDescent="0.25">';++r<
t;){B=!1;N=z[m][r];q=N.hasOwnProperty("value")?N.value:N;v="";C={borders:N.borders,hAlign:N.hAlign,vAlign:N.vAlign,bold:N.bold,italic:N.italic,fontColor:N.fontColor,fontName:N.fontName,fontSize:N.fontSize,fill:N.fill,formatCode:N.formatCode||"General"};E=0;(N.isString||q&&"string"===typeof q&&!isFinite(q))&&"date"!=N.genexusType&&"datetime"!=N.genexusType||"character"==N.genexusType?(q=j(q),v="inlineStr",B=!0):"boolean"===typeof q?(q=q?1:0,v="b",E=1):"date"===h(q)||"date"==N.genexusType||"datetime"==
N.genexusType?(q=k(q,N,!0),v="inlineStr",B=!0,C.hAlign="right"):"object"===typeof q?q=null:E=(""+q).length;C=JSON.stringify(C);w=H.indexOf(C);C=0>w?H.push(C)-1:w;null==W[r]&&(W[r]={autoWidth:!1,max:0});N.autoWidth&&(W[r].autoWidth=!0);E>W[r].max&&(W[r].max=E);if(1<N.colSpan){M.push([g(r)+(m+1),g(r+N.colSpan-1)+(m+1)]);w=[r,0];for(E=0;E<N.colSpan-1;E++)w.push(N);z[m].splice.apply(z[m],w);t+=N.colSpan-1}else if(1<N.rowSpan){for(E=1;E<N.rowSpan;E++)if(z[m+E])z[m+E].splice(r,0,N);else{N.rowSpan=E;break}M.push([g(r)+
(m+1),g(r)+(m+N.rowSpan)])}if(1<N.rowSpan||1<N.colSpan)delete N.value,delete N.rowSpan,delete N.colSpan;o+='<c r="'+g(r)+(m+1)+'"'+(C?' s="'+C+'"':"")+(v?' t="'+v+'"':"");o=null!=q?B?o+(">"+(N.formula?"<f>"+N.formula+"</f>":"")+"<is><t>"+q+"</t></is></c>"):o+(">"+(N.formula?"<f>"+N.formula+"</f>":"")+"<v>"+q+"</v></c>"):o+"/>"}o+="</row>"}v=[];for(m=0;m<W.length;m++)W[m].autoWidth&&v.push('<col min="',m+1,'" max="',m+1,'" width="',W[m].max,'" bestFit="1"/>');0<v.length&&(v=["<cols>"].concat(v,["</cols>"]).join(""));
o='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><dimension ref="A1:'+g(z[0].length-1)+z.length+'"/><sheetViews><sheetView '+(x===c.activeWorksheet?'tabSelected="1" ':"")+
' workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'+v+"<sheetData>"+o+"</sheetData>";if(0<M.length){o+='<mergeCells count="'+M.length+'">';for(m=0;m<M.length;m++)o+='<mergeCell ref="'+M[m].join(":")+'"/>';o+="</mergeCells>"}o+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>';J.table&&(o+='<tableParts count="1"><tablePart r:id="rId1"/></tableParts>');F.file("sheet2.xml",o+"</worksheet>")}m=H.length;v=[];for(z=0;--m;){C=
JSON.parse(H[m]);"General"!==C.formatCode?(w=Z.indexOf(C.formatCode),0>w&&(w=164+v.length,v.push('<numFmt formatCode="'+C.formatCode+'" numFmtId="'+w+'"/>')),C.formatCode=w):C.formatCode=0;o=0;if(C.borders){x=["<border>"];for(var O in{left:0,right:0,top:0,bottom:0,diagonal:0})C.borders[O]?(o=C.borders[O],6===o.length&&(o="FF"+o),x.push("<",O,' style="thin">','<color rgb="',C.borders[O],'"/></',O,">")):x.push("<",O,"/>");x.push("</border>");x=x.join("");o=y.indexOf(x);0>o&&(o=y.push(x)-1)}x=0;if(C.bold||
C.italic||C.fontSize||C.fontName||C.fontColor)z=["<font>"],C.bold&&z.push("<b/>"),C.italic&&z.push("<i/>"),z.push('<sz val="',C.fontSize||11,'"/>'),z.push('<color rgb="FF',C.fontColor||"000000",'"/>'),z.push('<name val="',C.fontName||"Calibri",'"/>'),z.push('<family val="2"/>',"</font>"),z=z.join(""),x=G.indexOf(z),0>x&&(x=G.push(z)-1);z=0;C.fill&&(aa=aa+'<fill><patternFill patternType="solid"><fgColor rgb="FF'+C.fill+'"/><bgColor indexed="64"/></patternFill></fill>',f++,z=f);H[m]=['<xf xfId="0" borderId="',
o,'" fontId="',x,'" numFmtId="',C.formatCode,'" fillId="',z,'" ',C.hAlign||C.vAlign?'applyAlignment="1" ':" ",0<C.formatCode?'applyNumberFormat="1" ':" ",0<o?'applyBorder="1" ':" ",0<x?'applyFont="1" ':" ",0<z?'applyFill="1" ':" ",">"];if(C.hAlign||C.vAlign)H[m].push("<alignment"),C.hAlign&&H[m].push(' horizontal="',C.hAlign,'"'),C.vAlign&&H[m].push(' vertical="',C.vAlign,'"'),H[m].push("/>");H[m].push("</xf>");H[m]=H[m].join("")}v=v.length?'<numFmts count="'+v.length+'">'+v.join("")+"</numFmts>":
"";""!=c.style&&(v=c.style);Z='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+v+'<fonts count="'+G.length+'" x14ac:knownFonts="1"><font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font>'+G.join("")+
'</fonts><fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>'+aa+'</fills><borders count="'+y.length+'"><border><left/><right/><top/><bottom/><diagonal/></border>'+y.join("")+'</borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+H.length+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>'+H.join("")+'</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>';
Z=void 0!=c.dfx?Z+"<dxfs>"+c.dfx+"</dxfs>":Z+'<dxfs count="0"/>';D.file("styles.xml",Z+'<tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/><extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"><x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext></extLst></styleSheet>');F.folder("_rels").file("sheet1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable" Target="../pivotTables/pivotTable1.xml"/></Relationships>');
D.file("sharedStrings.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"></sst>');D.file("workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="4" lowestEdited="4" rupBuild="4506"/><workbookPr defaultThemeVersion="124226"/><bookViews><workbookView xWindow="360" yWindow="555" windowWidth="21015" windowHeight="9405"/></bookViews><sheets><sheet name="PivotTable" sheetId="1" r:id="rId1"/><sheet name="SourceData" sheetId="2" r:id="rId2"/></sheets><calcPr calcId="125725"/><pivotCaches><pivotCache cacheId="5" r:id="rId3"/></pivotCaches><fileRecoveryPr repairLoad="1"/></workbook>');
n=Date.now()-n;c=Date.now();l={base64:l.generate({compression:"STORE"}),zipTime:Date.now()-c,processTime:n,href:function(){return"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+this.base64}}}else{n=Date.now();B=[[],0];l.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>');
I=l.folder("docProps");D=l.folder("xl");D.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>');
F=D.folder("worksheets");I.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>'+(c.creator||"XLSX.js")+"</dc:creator><cp:lastModifiedBy>"+(c.lastModifiedBy||"XLSX.js")+'</cp:lastModifiedBy><dcterms:created xsi:type="dcterms:W3CDTF">'+
(c.created||new Date).toISOString()+'</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">'+(c.modified||new Date).toISOString()+"</dcterms:modified></cp:coreProperties>");H=Array(1);y=Array(1);G=Array(1);aa="";f=1;for(x=c.worksheets.length;x--;){S=x+1;J=c.worksheets[x];z=J.data;o="";W=[];M=[];m=-1;for(u=z.length;++m<u;){r=-1;t=z[m].length;for(o+='<row r="'+(m+1)+'" x14ac:dyDescent="0.25">';++r<t;){N=z[m][r];q=N.hasOwnProperty("value")?N.value:N;v="";C={borders:N.borders,hAlign:N.hAlign,
vAlign:N.vAlign,bold:N.bold,italic:N.italic,fontColor:N.fontColor,fontName:N.fontName,fontSize:N.fontSize,fill:N.fill,formatCode:N.formatCode||"General"};E=0;if(q&&"string"===typeof q&&!isFinite(q)&&"date"!=N.genexusType&&"datetime"!=N.genexusType||"character"==N.genexusType)q=j(q),B[1]++,w=B[0].indexOf(q),E=q.length,0>w&&(w=B[0].push(q)-1),q=w,v="s";else if("boolean"===typeof q)q=q?1:0,v="b",E=1;else if("date"===h(q)){w=q.split("-");var Y;"datetime"==N.genexusType&&(q=q.split(" "),w=q[0].split("-"),
Y=q[1].split(":"));q=null;q="datetime"==N.genexusType?new Date(w[0],parseInt(w[1])-1,parseInt(w[2]),parseInt(Y[0])+1,parseInt(Y[1])-15,parseInt(Y[2])-9):new Date(w[0],parseInt(w[1])-1,parseInt(w[2])+1);q="object"===typeof q?(q-new Date(1900,0,0))/864E5+1:new Date(+new Date(1900,0,0)+864E5*(q-1));"date"==N.genexusType?(q=parseInt(q),C.formatCode=N.formatCode||"mm/dd/yy"):C.formatCode=N.formatCode||"mm/dd/yy hh:mm";E=N.formatCode.length+1}else if("date"==N.genexusType||"datetime"==N.genexusType)q=k(q,
N,!1),q=j(q),B[1]++,w=B[0].indexOf(q),E=q.length,0>w&&(w=B[0].push(q)-1),q=w,v="s",C.formatCode="General",C.hAlign="right";else if("object"===typeof q)q=null;else if(E=(""+q).length,void 0==q||""==q.trim())q=j(q),B[1]++,w=B[0].indexOf(q),E=q.length,0>w&&(w=B[0].push(q)-1),q=w,v="s";C=JSON.stringify(C);w=H.indexOf(C);C=0>w?H.push(C)-1:w;null==W[r]&&(W[r]={autoWidth:!1,max:0});if(N.autoWidth||"date"==N.genexusType||"datetime"==N.genexusType)W[r].autoWidth=!0;E>W[r].max&&(W[r].max=E);if(1<N.colSpan){M.push([g(r)+
(m+1),g(r+N.colSpan-1)+(m+1)]);w=[r,0];for(E=0;E<N.colSpan-1;E++)w.push(N);z[m].splice.apply(z[m],w);t+=N.colSpan-1}else if(1<N.rowSpan){for(E=1;E<N.rowSpan;E++)if(z[m+E])z[m+E].splice(r,0,N);else{N.rowSpan=E;break}M.push([g(r)+(m+1),g(r)+(m+N.rowSpan)])}if(1<N.rowSpan||1<N.colSpan)delete N.value,delete N.rowSpan,delete N.colSpan;o+='<c r="'+g(r)+(m+1)+'"'+(C?' s="'+C+'"':"")+(v?' t="'+v+'"':"");o=null!=q?o+(">"+(N.formula?"<f>"+N.formula+"</f>":"")+"<v>"+q+"</v></c>"):o+"/>"}o+="</row>"}v=[];for(m=
0;m<W.length;m++)W[m].autoWidth&&v.push('<col min="',m+1,'" max="',m+1,'" width="',W[m].max,'" bestFit="1"/>');0<v.length&&(v=["<cols>"].concat(v,["</cols>"]).join(""));o='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><dimension ref="A1:'+
g(z[0].length-1)+z.length+'"/><sheetViews><sheetView '+(x===c.activeWorksheet?'tabSelected="1" ':"")+' workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'+v+"<sheetData>"+o+"</sheetData>";if(0<M.length){o+='<mergeCells count="'+M.length+'">';for(m=0;m<M.length;m++)o+='<mergeCell ref="'+M[m].join(":")+'"/>';o+="</mergeCells>"}o+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>';J.table&&(o+='<tableParts count="1"><tablePart r:id="rId1"/></tableParts>');
F.file("sheet"+S+".xml",o+"</worksheet>");if(J.table){m=-1;u=z[0].length;v=g(z[0].length-1)+z.length;for(o='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><table xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" id="'+S+'" name="Table'+S+'" displayName="Table'+S+'" ref="A1:'+v+'" totalsRowShown="0"><autoFilter ref="A1:'+v+'"/><tableColumns count="'+z[0].length+'">';++m<u;)o+='<tableColumn id="'+(m+1)+'" name="'+(z[0][m].hasOwnProperty("value")?z[0][m].value:z[0][m])+'"/>';
o+='</tableColumns><tableStyleInfo name="TableStyleMedium2" showFirstColumn="0" showLastColumn="0" showRowStripes="1" showColumnStripes="0"/></table>';D.folder("tables").file("table"+S+".xml",o);F.folder("_rels").file("sheet"+S+".xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table" Target="../tables/table'+
S+'.xml"/></Relationships>');Q[1].unshift('<Override PartName="/xl/tables/table'+S+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"/>')}Q[0].unshift('<Override PartName="/xl/worksheets/sheet'+S+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>');U.unshift(j(J.name)||"Sheet"+S);V.unshift('<Relationship Id="rId'+S+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+
S+'.xml"/>');L.unshift('<sheet name="'+(j(J.name)||"Sheet"+S)+'" sheetId="'+S+'" r:id="rId'+S+'"/>')}m=H.length;v=[];for(z=0;--m;){C=JSON.parse(H[m]);"General"!==C.formatCode?(w=Z.indexOf(C.formatCode),0>w&&(w=164+v.length,v.push('<numFmt formatCode="'+C.formatCode+'" numFmtId="'+w+'"/>')),C.formatCode=w):C.formatCode=0;o=0;if(C.borders){x=["<border>"];for(O in{left:0,right:0,top:0,bottom:0,diagonal:0})C.borders[O]?(o=C.borders[O],6===o.length&&(o="FF"+o),x.push("<",O,' style="thin">','<color rgb="',
C.borders[O],'"/></',O,">")):x.push("<",O,"/>");x.push("</border>");x=x.join("");o=y.indexOf(x);0>o&&(o=y.push(x)-1)}x=0;if(C.bold||C.italic||C.fontSize||C.fontName||C.fontColor)z=["<font>"],C.bold&&z.push("<b/>"),C.italic&&z.push("<i/>"),z.push('<sz val="',C.fontSize||11,'"/>'),z.push('<color rgb="FF',C.fontColor||"000000",'"/>'),z.push('<name val="',C.fontName||"Calibri",'"/>'),z.push('<family val="2"/>',"</font>"),z=z.join(""),x=G.indexOf(z),0>x&&(x=G.push(z)-1);z=0;C.fill&&(aa=aa+'<fill><patternFill patternType="solid"><fgColor rgb="FF'+
C.fill+'"/><bgColor indexed="64"/></patternFill></fill>',f++,z=f);H[m]=['<xf xfId="0" borderId="',o,'" fontId="',x,'" numFmtId="',C.formatCode,'" fillId="',z,'" ',C.hAlign||C.vAlign?'applyAlignment="1" ':" ",0<C.formatCode?'applyNumberFormat="1" ':" ",0<o?'applyBorder="1" ':" ",0<x?'applyFont="1" ':" ",0<z?'applyFill="1" ':" ",">"];if(C.hAlign||C.vAlign)H[m].push("<alignment"),C.hAlign&&H[m].push(' horizontal="',C.hAlign,'"'),C.vAlign&&H[m].push(' vertical="',C.vAlign,'"'),H[m].push("/>");H[m].push("</xf>");
H[m]=H[m].join("")}v=v.length?'<numFmts count="'+v.length+'">'+v.join("")+"</numFmts>":"";D.file("styles.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+v+'<fonts count="'+G.length+'" x14ac:knownFonts="1"><font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font>'+
G.join("")+'</fonts><fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>'+aa+'</fills><borders count="'+y.length+'"><border><left/><right/><top/><bottom/><diagonal/></border>'+y.join("")+'</borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+H.length+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>'+H.join("")+'</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles><dxfs count="0"/><tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/><extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"><x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext></extLst></styleSheet>');
l.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>'+Q[0].join("")+'<Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>'+
Q[1].join("")+'<Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>');I.file("app.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>XLSX.js</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>'+
c.worksheets.length+'</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="'+U.length+'" baseType="lpstr"><vt:lpstr>'+U.join("</vt:lpstr><vt:lpstr>")+"</vt:lpstr></vt:vector></TitlesOfParts><Manager></Manager><Company>Microsoft Corporation</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>1.0</AppVersion></Properties>");D.folder("_rels").file("workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+
V.join("")+'<Relationship Id="rId'+(V.length+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/><Relationship Id="rId'+(V.length+2)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId'+(V.length+3)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/></Relationships>');D.file("sharedStrings.xml",
'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="'+B[1]+'" uniqueCount="'+B[0].length+'"><si><t>'+B[0].join("</t></si><si><t>")+"</t></si></sst>");D.file("workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303"/><workbookPr defaultThemeVersion="124226"/><bookViews><workbookView '+
(c.activeWorksheet?'activeTab="'+c.activeWorksheet+'" ':"")+'xWindow="480" yWindow="60" windowWidth="18195" windowHeight="8505"/></bookViews><sheets>'+L.join("")+'</sheets><calcPr calcId="145621"/></workbook>');n=Date.now()-n;c=Date.now();l={base64:l.generate({compression:"DEFLATE"}),zipTime:Date.now()-c,processTime:n,href:function(){return"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+this.base64}}}return l};"object"===typeof exports&&"object"===typeof module&&(module.exports=
xlsx);OAT.GeneratePDFOutput=function(c,g){var h=-1,j=-1,k=jQuery("#"+c.controlName+"_"+c.query+" tr").length*30+18;k<841&&(k=841);for(var l=0,k=true,n=0;k&&n<jQuery("#"+c.controlName+"_"+c.query+" tr").length;)jQuery("#"+c.controlName+"_"+c.query+" tr")[n].getAttribute("title_row")!="true"?k=false:n++;var o=jQuery("#"+c.controlName+"_"+c.query+" tr")[n];o==void 0&&(o=jQuery("#"+c.controlName+"_"+c.query+" tr")[0]);for(var m=0;m<o.children.length;m++)l=o.children[m].getAttribute("colspan")!=null?l+
parseInt(o.children[m].getAttribute("colspan")):l+1;l=l*73+15;l<595&&(l=595);for(var k=[],n=[],r=0;r<o.childNodes.length;r++)n[r]=0;for(var t=0;t<jQuery("#"+c.controlName+"_"+c.query+" tr").length;t++){var u=-1,h=-1,v=0;if(c.colConditions.length==0)for(o=0;o<n.length;o++){if(n[o]>0){v=1+v;n[o]=n[o]-1}}else for(o=0;o<t;o++){m=jQuery("#"+c.controlName+"_"+c.query+" tr")[o];for(u=0;u<m.children.length;u++){var x=m.children[u].getAttribute("rowspan");if(x!=null&&parseInt(x)>t-o){x=m.children[u].getAttribute("colspan");
v=x===null?1+v:parseInt(x)+v}}}u=v-1;o=jQuery("#"+c.controlName+"_"+c.query+" tr")[t];if(c.colConditions.length==0)for(m=0;m<o.children.length;m++){x=o.children[m].getAttribute("rowspan");x==null&&(x=0);n[v+m]=parseInt(x)-1}for(m=0;m<o.children.length;m++){u++;var h=OAT.removeIconFont(o.children[m].textContent.replace(/^\s+|\s+$/g,"")),B=o.children[m].getAttribute("hidden");if(B===null){var H=o.children[m].getAttribute("rowspan"),B=o.children[m].getAttribute("colspan"),w=u;k[w]==void 0&&(k[w]=25);
H===null&&B===null||m===o.children.length-1&&B==="3"?B!=null&&h===""&&(u=parseInt(B)+u-1):B!==null&&(u=parseInt(B)+u-1);for(var z=0,q=z=0;q<h.length&&h.charCodeAt(q)<1E3;){z++;q++}z=h.length-z;if(z==0){if(h.length>14&&(B==null||t==0||parseInt(B)<2))h.length*1.98>k[w]&&(k[w]=h.length*1.98)}else{z=z*3.1+(h.length-z)*2;if(z>k[w]&&(B==null||t==0||parseInt(B)<2))k[w]=z}}h=u}}for(t=n=0;t<k.length;t++)n=n+k[t]*2.5+48;n=10+n+5;n>l&&(l=n);z=function(c,g){if(c>g.length)c=g.length;for(var h=0,k=0;k<c;k++)h=
h+g[k];return h};l=l<=595?new jsPDF("portrait","mm","a4",false,l,792):l>595&&l<792?new jsPDF("landscape","mm","a4",false,793,792):new jsPDF("landscape","mm","a4",false,l,792);l.setFontSize(8);q=[];if(jQuery("#"+c.controlName+"_"+c.query+" tr")[1+c.colConditions.length]!=void 0)for(n=0;n<jQuery("#"+c.controlName+"_"+c.query+" tr")[1+c.colConditions.length].children.length;n++)q[n]=0;else for(n=0;n<jQuery("#"+c.controlName+"_"+c.query+" tr")[c.colConditions.length].children.length;n++)q[n]=0;n=[];for(r=
0;r<k.length;r++)n[r]=0;for(t=0;t<jQuery("#"+c.controlName+"_"+c.query+" tr").length;t++){h=u=-1;j++;v=0;if(c.colConditions.length==0)for(o=0;o<n.length;o++){if(n[o]>0){v=1+v;n[o]=n[o]-1}}else for(o=0;o<t;o++){m=jQuery("#"+c.controlName+"_"+c.query+" tr")[o];for(u=0;u<m.children.length;u++){x=m.children[u].getAttribute("rowspan");if(x!=null&&parseInt(x)>t-o){x=m.children[u].getAttribute("colspan");v=x===null?1+v:parseInt(x)+v}}}u=v-1;o=jQuery("#"+c.controlName+"_"+c.query+" tr")[t];if(c.colConditions.length==
0)for(m=0;m<o.children.length;m++){x=o.children[m].getAttribute("rowspan");x==null&&(x=0);n[v+m]=parseInt(x)-1}x=-1;for(m=0;m<o.children.length;m++){var h=OAT.removeIconFont(o.children[m].textContent.replace(/^\s+|\s+$/g,"")),B=o.children[m].getAttribute("hidden"),w=o.children[m].getAttribute("pivotcorrect"),C=false;l.setDrawColor(0,0,0);l.setTextColor(0,0,0);l.setFontStyle("normal");var y=!isNaN(parseFloat(h))||h=="-"&&(o.children[m].getAttribute("style")==void 0||o.children[m].getAttribute("style").indexOf("text-align: left")==
-1),G=0,G=l.getStringUnitWidth(h);if(o.children[m].getAttribute("style")!=void 0&&o.children[m].getAttribute("style")!=null)for(var I=o.children[m].getAttribute("style").split(";"),D=0;D<I.length;D++){var F=I[D].split(":");if(F[0].replace(/^\s+|\s+$/g,"")==="color"){F=F[1].replace(/^\s+|\s+$/g,"");F=F.substring(4,F.length);F=F.substring(0,F.length-1);l.setTextColor(parseInt(F.split(",")[0]),parseInt(F.split(",")[1]),parseInt(F.split(",")[2]))}else if(F[0].replace(/^\s+|\s+$/g,"")==="text-align")y=
F[1].replace(/^\s+|\s+$/g,"")=="right";else if(F[0].replace(/^\s+|\s+$/g,"")==="font-style")l.setFontStyle("italic");else if(F[0].replace(/^\s+|\s+$/g,"")==="font-weight")F[1].replace(/^\s+|\s+$/g,"")==="bold"&&l.setFontStyle("bold");else if(F[0].replace(/^\s+|\s+$/g,"")==="background-color"){F=F[1].replace(/^\s+|\s+$/g,"");F=F.substring(4,F.length);F=F.substring(0,F.length-1);l.setFillColor(parseInt(F.split(",")[0]),parseInt(F.split(",")[1]),parseInt(F.split(",")[2]));C=true}else if(F[0].replace(/^\s+|\s+$/g,
"")==="border-color"){F=F[1].replace(/^\s+|\s+$/g,"");F=F.substring(4,F.length);F=F.substring(0,F.length-1);l.setDrawColor(parseInt(F.split(",")[0]),parseInt(F.split(",")[1]),parseInt(F.split(",")[2]))}}I=[];D="";F=-1;H=0;if(h.charCodeAt(0)>1E3)for(r=0;r<h.length;r++){if((H==58||H==65306)&&h.charCodeAt(r)==32)I[r]="ToDelete";else{I[r]=OAT.getCharacterImg(h.charCodeAt(r));H=h.charCodeAt(r)}if(h.charCodeAt(r)<1E3){D=D+h[r];F==-1&&(F=r)}else{D="";F=-1}}else{for(var J=-1,r=1;r<h.length;r++)if(h.charCodeAt(r)>
1E3){J=r;break}if(J>0){for(var Q=h.substring(0,J),U=0,r=J;r<h.length;r++){if(h.charCodeAt(r)<1E3){D=D+h[r];F==-1&&(F=r-J)}else{D="";F=-1}if((H==58||H==65306)&&h.charCodeAt(r)==32)I[U]="ToDelete";else{I[U]=OAT.getCharacterImg(h.charCodeAt(r));H=h.charCodeAt(r)}U++}h=Q}}try{F!=-1&&!y&&(I=I.slice(0,F))}catch(V){}for(;I.length>0&&I.indexOf("ToDelete")!=-1;){r=I.indexOf("ToDelete");I.splice(r,1)}if(B===null&&!w){u++;H=o.children[m].getAttribute("rowspan");B=o.children[m].getAttribute("colspan");x=x+1;
if(H&&j+parseInt(H)>26){w=j+parseInt(H)-26;H=parseInt(H)-w;q[x+v]=w}w=1;B!=null&&(w=parseInt(B));m===o.children.length-1&&(w===3&&c.colConditions.length==0)&&(w=1);w=u;if(H===null&&B===null||m===o.children.length-1&&B==="3"&&c.colConditions.length==0){if(C){C=u;B!=null&&h===""&&(C=parseInt(B)+u-1);l.rect(8+z(w,k),13+j*10-7,z(C+1,k)-z(w,k),10,"F")}C=0;if(h.charCodeAt(0)<1E3){C=h.length*1.4+2;y?l.text(10+z(u+1,k)-G*3-4,13+j*10,h):l.text(10+z(u,k),13+j*10,h)}if(I.length>0)for(r=0;r<I.length;r++)l.addImage(I[r],
"JPEG",10+z(u,k)+C+r*2.5,13+j*10-2.3,2.5,2.5);F!=-1&&!y&&l.text(10+z(u,k)+C+I.length*2.5,13+j*10,D);B!=null&&h===""&&(u=parseInt(B)+u-1);l.line(8+z(w,k),13+j*10-7,8+z(u+1,k),13+j*10-7);l.line(8+z(w,k),13+j*10-7,8+z(w,k),j*10+16)}else if(B===null){C&&(H===null?l.rect(8+z(u,k),13+j*10-7,25,10,"F"):l.rect(8+z(u,k),13+j*10-7,25,10+(parseInt(H)-1)*10,"F"));C=0;if(h.charCodeAt(0)<1E3){C=h.length*1.4+2;l.text(10+z(u,k),13+j*10,h)}if(I.length>0)for(r=0;r<I.length;r++)l.addImage(I[r],"JPEG",10+z(u,k)+C+r*
2.5,13+j*10-2.3,2.5,2.5);F!=-1&&!y&&l.text(10+z(u,k)+C+I.length*2.5,13+j*10,D);l.line(8+z(u,k),13+j*10-7,8+z(u+1,k),13+j*10-7);H===null?l.line(8+z(u,k),13+j*10-7,8+z(u,k),j*10+16):l.line(8+z(w,k),13+j*10-7,8+z(w,k),(j+parseInt(H)-1)*10+16)}else if(H===null){if(C){G=parseInt(B)+u-1;l.rect(8+z(w,k),13+j*10-7,z(G+1,k)-z(w,k),10,"F")}C=0;if(h.charCodeAt(0)<1E3){C=h.length*1.4+2;l.text(10+z(u,k),13+j*10,h)}if(I.length>0)for(r=0;r<I.length;r++)l.addImage(I[r],"JPEG",10+z(u,k)+C+r*2.5,13+j*10-2.3,2.5,2.5);
F!=-1&&!y&&l.text(10+z(u,k)+C+I.length*2.5,13+j*10,D);u=parseInt(B)+u-1;l.line(8+z(w,k),13+j*10-7,8+z(u+1,k),13+j*10-7);l.line(8+z(w,k),13+j*10-7,8+z(w,k),j*10+16)}else{if(C){G=parseInt(B)+u-1;H===null?l.rect(8+z(w,k),13+j*10-7,z(G+1,k)-z(w,k),10,"F"):l.rect(8+z(w,k),13+j*10-7,z(G+1,k)-z(w,k),(parseInt(H)-1)*10,"F")}C=0;if(h.charCodeAt(0)<1E3){C=h.length*1.4+2;l.text(10+z(u,k),13+j*10,h)}if(I.length>0)for(r=0;r<I.length;r++)l.addImage(I[r],"JPEG",10+z(u,k)+C+r*2.5,13+j*10-2.3,2.5,2.5);F!=-1&&!y&&
l.text(10+z(u,k)+C+I.length*2.5,13+j*10,D);u=parseInt(B)+u-1;l.line(8+z(w,k),13+j*10-7,8+z(u+1,k),13+j*10-7);H===null?l.line(8+z(w,k),13+j*10-7,8+z(w,k),j*10+16):l.line(8+z(w,k),13+j*10-7,8+z(w,k),(j+parseInt(H)-1)*10+16)}}l.setFontSize(8);h=u;m===o.children.length-1&&l.line(8+z(u+1,k),13+j*10-7,8+z(u+1,k),j*10+16)}if(j>=25){l.setDrawColor(0,0,0);l.line(8,13+(j+1)*10-7,8+z(h+1,k),13+(j+1)*10-7);j=0;l.addPage();for(v=0;v<q.length;v++)if(!isNaN(q[v]))if(q[v]>=25){q[v]=q[v]-25;l.line(8+z(v,k),16,8+z(v+
1,k),16);l.line(8+z(v,k),16,8+z(v,k),266)}else{l.line(8+z(v,k),16,8+z(v+1,k),16);l.line(8+z(v,k),16,8+z(v,k),(1+q[v]-1)*10+16);q[v]=0}}}l.setDrawColor(0,0,0);l.line(8,13+(j+1)*10-7,8+z(h+1,k),13+(j+1)*10-7);if(gx.util.browser.webkit&&!gx.util.browser.chrome||c.isSD)l.output("dataurlnewwindow");else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())l.save(g+".pdf");else return l.output()};removeComas=function(c,g){var h="";actPos=0;for(var j=g.defaultPicture.getAttribute("decimalSeparator"),
k=0;k<c.length;k++)if(c[k]=="0"||c[k]=="1"||c[k]=="2"||c[k]=="3"||c[k]=="4"||c[k]=="5"||c[k]=="6"||c[k]=="7"||c[k]=="8"||c[k]=="9"||c[k]==j||c[k]=="-")h=h+c[k];if(j!="."){for(var l="",k=0;k<h.length;k++)l=h[k]==j?l+".":l+h[k];h=l}return h};cleanDistinctValue=function(c,g,h){if(c=="#NuN#")return" ";g=true;if(c.indexOf(">")>-1){c=c.replace(/\>/g,"&lt;");g=false}if(c.indexOf("<")>-1){c=c.replace(/\</g,"&gt;");g=false}if(c.indexOf("%")>-1&&h!=void 0)return c.replace(/\&/g,"&amp;").replace(/"/g,"&quot;").replace(/\%/g,
"%"+h).trimpivot();c=c.replace(/"/g,"&quot;");g&&(c=c.replace(/\&/g,"&amp;"));c.indexOf("&amp;lt;")>-1&&(c=c.replace(/\&amp\;lt\;/g,"&lt;"));return c.trimpivot()};var headers=[];getMeasureTitle=function(c,g){return headers[g]!=void 0?headers[g]:c};createExcelROWITEMS=function(c,g,h,j,k){if(g===0){c=h[j].indexOf(c.value);g="";g=k===0?"<i>":'<i r="'+k+'">';return c>0?g+'<x v="'+c+'"/></i>':g+"<x/></i>"}g--;for(var l="",n=0;n<c.items.length;n++)l=l+createExcelROWITEMS(c.items[n],g,h,j,k);return l};createExcelCOLITEMS=
function(c,g,h,j,k){if(g===0){c=h[j].indexOf(c.value.trimpivot());g="";for(h=0;h<measures.length;h++){g=k===0?"<i>":'<i r="'+k+'">';g=g+'<x v="'+c+'"/>';measures.length>1&&(g=g+"<x/>");g=g+"</i>"}return g}g--;for(var l="",n=0;n<c.items.length;n++)l=l+createExcelROWITEMS(c.items[n],g,h,j,k);return l};OAT.GenerateExcelOutput=function(c,g,h){function j(c){c=c.toString(16);return c.length==1?"0"+c:c}function k(c,g,h){return j(c)+j(g)+j(h)}function l(c){for(var g={},h=0;h<c.length;h++){var j=c[h].split(":");
if(j[0].replace(/^\s+|\s+$/g,"")==="color"){j=j[1].replace(/^\s+|\s+$/g,"");j=j.substring(4,j.length);j=j.substring(0,j.length-1);j=k(parseInt(j.split(",")[0]),parseInt(j.split(",")[1]),parseInt(j.split(",")[2]));g.fontColor=j}else if(j[0].replace(/^\s+|\s+$/g,"")==="text-align"){j=j[1].replace(/^\s+|\s+$/g,"");g.vAlign=j}else if(j[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(j[1].replace(/^\s+|\s+$/g,"")==="italic")g.italic=1}else if(j[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(j[1].replace(/^\s+|\s+$/g,
"")==="bold")g.bold=1}else if(j[0].replace(/^\s+|\s+$/g,"")==="background-color"){j=j[1].replace(/^\s+|\s+$/g,"");j=j.substring(4,j.length);j=j.substring(0,j.length-1);j=k(parseInt(j.split(",")[0]),parseInt(j.split(",")[1]),parseInt(j.split(",")[2]));g.fill=j}}return g}var n=function(c,g){for(var h in c.formulaInfo.itemPosition)if(c.formulaInfo.itemPosition[h]==g)return h};headers=[];for(var o=[],m=0;m<h.length;m++){for(var r=0;r<o.length;r++)o[r]==cleanDistinctValue(h[m].getAttribute("displayName"),
g,h[m].getAttribute("name"))&&(headers[m]=cleanDistinctValue(h[m].getAttribute("displayName"),g,h[m].getAttribute("name"))+" ("+h[m].getAttribute("dataField")+")");o.push(cleanDistinctValue(h[m].getAttribute("displayName"),g,h[m].getAttribute("name")))}dataTable=[];dataRow=[];for(m=0;m<g.columns.length;m++){var t={value:cleanDistinctValue(g.columns[m].getAttribute("displayName"),g,g.columns[m].getAttribute("name")),isString:1};dataRow.push(t)}for(m=0;m<h.length;m++)if(!g.formulaInfo.measureFormula[m].hasFormula){t=
{value:cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name"))};dataRow.push(t)}var u=[];if(g.formulaInfo.cantFormulaMeasures>0){for(o=0;o<g.formulaInfo.measureFormula.length;o++)if(g.formulaInfo.measureFormula[o].hasFormula)for(var v=0;v<g.formulaInfo.measureFormula[o].relatedMeasures.length;v++){var x=g.formulaInfo.measureFormula[o].relatedMeasures[v];u.indexOf(x)==-1&&u.push(x)}u.sort();for(m=0;m<u.length;m++){t={value:n(g,u[m])};dataRow.push(t)}}dataTable.push(dataRow);
o=g.GeneralDataRows;if(g.autoPaging)o=g.RowsWhenMoveToFilter;if(g.formulaInfo.cantFormulaMeasures>0)o=g.recordForFormula;for(var x=function(c,g){if(c.getAttribute("style")!=void 0)for(var h=c.getAttribute("style").split(";"),j=0;j<h.length;j++){var l=h[j].split(":");if(l[0].replace(/^\s+|\s+$/g,"")==="color"){l=l[1].replace(/^\s+|\s+$/g,"");l=l.substring(4,l.length);l=l.substring(0,l.length-1);l=k(parseInt(l.split(",")[0]),parseInt(l.split(",")[1]),parseInt(l.split(",")[2]));g.fontColor=l}else if(l[0].replace(/^\s+|\s+$/g,
"")==="text-align"){l=l[1].replace(/^\s+|\s+$/g,"");g.vAlign=l}else if(l[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(l[1].replace(/^\s+|\s+$/g,"")==="italic")g.italic=1}else if(l[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(l[1].replace(/^\s+|\s+$/g,"")==="bold")g.bold=1}else if(l[0].replace(/^\s+|\s+$/g,"")==="background-color"){l=l[1].replace(/^\s+|\s+$/g,"");l=l.substring(4,l.length);l=l.substring(0,l.length-1);l=k(parseInt(l.split(",")[0]),parseInt(l.split(",")[1]),parseInt(l.split(",")[2]));
g.fill=l}}return g},B=0;B<o.length;B++){dataRow=[];for(m=0;m<g.columns.length;m++){var r=g.conditions[m].dataRowPosition,H=o[B][r];H=="#NuN#"&&(H=" ");t={value:H,isString:1};v=OAT.Dom.create("th",{},"");v=g.applyFormatValues(v,o[B][r],r);t=x(v,t);t.formatCode=g.defaultPicture.getAttribute("dateFormat");t.genexusType=g.columns[m].getAttribute("dataType");t.genexusPicture=g.columns[m].getAttribute("picture");dataRow.push(t)}for(m=0;m<h.length;m++)if(!g.formulaInfo.measureFormula[m].hasFormula){r=g.columns.length+
m;H=o[B][r];H=g.defaultPictureValue(H,m==h.length-1,m);H=removeComas(H,g);t={value:H};v=OAT.Dom.create("td",{},"");v=g.applyConditionalFormats(v,o[B][r],m===h.length-1?true:false,m);t=x(v,t);t.formatCode=g.defaultPicture.getAttribute("dateFormat");t.genexusType=h[m].getAttribute("dataType");t.genexusPicture=h[m].getAttribute("picture");dataRow.push(t)}for(v=0;v<u.length;v++)dataRow.push({value:o[B][u[v]]});dataTable.push(dataRow)}B=[];H=[];x=1;for(m=0;m<g.columns.length;m++){H[m]=0;v=OAT.Dom.create("th",
{},"");r=g.conditions[m].dataRowPosition;v=g.applyFormatValues(v,o[0][r],r);if(v.getAttribute("style")!=void 0){v=v.getAttribute("style").split(";");v=l(v);if(v.fontColor!=void 0||v.italic!=void 0||v.bold!=void 0){H[m]=x;x++;B.push(v)}}}for(var w=[],t=0;t<h.length;t++){w[t]=0;v=OAT.Dom.create("td",{},"");r=g.columns.length+t;v=g.applyConditionalFormats(v,o[0][r],t===h.length-1?true:false,t);if(v.getAttribute("style")!=void 0){v=v.getAttribute("style").split(";");v=l(v);if(v.fontColor!=void 0||v.italic!=
void 0||v.bold!=void 0){w[t]=x;x++;B.push(v)}}}for(var v='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<pivotCacheDefinition r:id="rId1" refreshOnLoad="1" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\n<cacheSource type="worksheet">\n',x=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","AA","AB","AC","AD"],z=B.length>0,q=x[h.length+
g.columns.length-1]+(o.length+1+2),t=g.colConditions.length+2,m=g.colConditions.length>0?g.colConditions.length:1,o=0;o<g.formulaInfo.measureFormula.length;o++);o=g.GeneralDataRows;if(g.autoPaging)o=g.RowsWhenMoveToFilter;if(g.columns.length<0){for(var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><pivotTableDefinition name="Tabla dinamica1" cacheId="5" dataCaption="'+gx.getMessage("GXPL_QViewerJSValue")+'" createdVersion="3" updatedVersion="3" minRefreshableVersion="3" applyNumberFormats="0" applyBorderFormats="0" applyFontFormats="0" applyPatternFormats="0" applyAlignmentFormats="0" applyWidthHeightFormats="1" showCalcMbrs="0" useAutoFormatting="1" itemPrintTitles="1" indent="0" outline="1" outlineData="1" multipleFieldFilters="0" rowHeaderCaption="Make"  xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><location ref="A1:'+
q+'" firstHeaderRow="1" firstDataRow="'+t+'" firstDataCol="'+m+'"/><pivotFields>',C=[],q=[],y=-1,G=0,I=-1,D=0,m=0;m<g.columns.length;m++){r="axisRow";if(g.rowConditions.findIndex(m)!=-1){r="axisRow";y++;G=m}else if(g.colConditions.findIndex(m)!=-1){r="axisCol";I++;D=m}else{r="axisRow";y++;G=m}var F="",J='<item t="default"/>',t=t+'<pivotField axis="'+r+'" showAll="0" '+F+"><items>",Q,U;if(g.conditions[m].distinctValues!=void 0){Q=[];U=[];for(F=0;F<g.conditions[m].distinctValues.length;F++){Q.push(cleanDistinctValue(g.conditions[m].distinctValues[F],
g));var V="";if(g.conditions[m].blackList.findIndex(g.conditions[m].distinctValues[F])!=-1){V=' h="1"';U.push(cleanDistinctValue(g.conditions[m].distinctValues[F],g))}t=t+'<item x="'+F+'" '+V+" />"}t=t+J+"</items></pivotField>"}q[m]=Q;C.push(m)}for(m=0;m<h.length;m++){t=t+'<pivotField dataField="1" showAll="0"/>';C.push(cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name")))}t=t+"</pivotFields><rowFields>";for(m=0;m<g.columns.length;m++)if(g.rowConditions.findIndex(m)!=
-1||g.filterIndexes.findIndex(m)!=-1)t=t+'<field x="0"/>';for(var t=t+"</rowFields><rowItems>",L=0;L<g.rowStructure.items.length;L++)t=t+createExcelROWITEMS(g.rowStructure.items[L],y,q,G,y);t=t+'<i t="grand"><x/></i></rowItems>';if(I>-1||h.length>1){t=t+"<colFields>";for(m=0;m<g.columns.length;m++)if(g.colConditions.findIndex(m)!=-1){r=C.indexOf(m);t=t+'<field x="'+r+'"/>'}h.length>1&&(t=t+'<field x="-2"/>');t=t+"</colFields>"}t=t+"<colItems>";if(g.colStructure.items)for(L=0;L<g.colStructure.items.length;L++)t=
t+createExcelCOLITEMS(g.colStructure.items[L],I,q,D,I);else for(m=0;m<h.length;m++)t=t+"<i/>";t=t+"</colItems><dataFields>";for(m=0;m<h.length;m++)t=t+'<dataField name="'+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name"))+'" fld="'+(m+g.columns.length)+'"/>';t=t+"</dataFields>";if(z){t=t+"<formats>";for(m=0;m<g.columns.length;m++)if(H[m]>0){t=t+'<format dxfId="'+H[m]+'"><pivotArea dataOnly="0" labelOnly="1" fieldPosition="0"><references ><reference field="0">';
if(g.conditions[m].distinctValues!=void 0)for(F=0;F<g.conditions[m].distinctValues.length;F++)t=t+'<x v="'+F+'"/>';t=t+"</reference></references></pivotArea></format>"}for(L=0;L<h.length;L++)if(w[L]>0){t=t+'<format dxfId="'+w[L]+'">';t=t+'<pivotArea  fieldPosition="0">';t=t+"<references>";t=t+'<reference field="4294967294" selected="0">';t=t+'<x v="'+L+'"/></reference>';t=t+'<reference field="0">';for(n=0;n<g.rowStructure.items.length;n++)t=t+'<x v="'+n+'"/>';t=t+"</reference>";t=t+"</references></pivotArea>";
t=t+"</format>"}t=t+"</formats>"}t=t+'<pivotTableStyleInfo name="PivotStyleLight16" showRowHeaders="1" showColHeaders="1" showRowStripes="0" showColStripes="0" showLastColumn="1"/></pivotTableDefinition>';n='<dxf><font><color rgb="FFCCCCCC" /></font></dxf>';if(z)for(L=0;L<B.length;L++){n=n+"<dxf><font>";B[L].bold!=void 0&&(n=n+"<b/>");B[L].italic!=void 0&&(n=n+"<i/>");B[L].fontColor!=void 0&&(n=n+'<color rgb="FF'+B[L].fontColor+'"/>');n=n+"</font></dxf>"}L=n;for(B=0;B<o.length;B++){for(m=0;m<g.columns.length;m++)q[m].indexOf(o[B][m]);
for(m=0;m<h.length;m++){r=g.columns.length+m;H=g.defaultPictureValue(o[B][r],m==h.length-1,m);H=removeComas(H,g);H=cleanDistinctValue(H,g)}}v=v+'<worksheetSource ref="A1:'+x[g.columns.length+h.length-1]+(o.length+1)+'" sheet="SourceData"/>';v=v+'</cacheSource><cacheFields count="'+(g.columns.length+h.length)+'">';for(m=0;m<g.columns.length;m++){v=v+'<cacheField name="'+cleanDistinctValue(g.columns[m].getAttribute("displayName"),g,g.columns[m].getAttribute("name")).replace(/</g,"&lt;").replace(/>/g,
"&gt;")+'" numFmtId="0">';v=v+'<sharedItems count="'+g.conditions[m].distinctValues.length+'">';for(F=0;F<g.conditions[m].distinctValues.length;F++)v=v+'<s v="'+cleanDistinctValue(g.conditions[m].distinctValues[F],g)+'"/>';v=v+"</sharedItems>";v=v+"</cacheField>"}for(m=0;m<h.length;m++){v=v+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name"))+'" numFmtId="0">';v=v+"<sharedItems/>";v=v+"</cacheField>"}var v=v+"</cacheFields></pivotCacheDefinition>",
u='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><dimension ref="A1:'+x[g.columns.length+h.length-1]+(o.length+1)+'"/><sheetViews><sheetView workbookViewId="0"/></sheetViews><sheetData>',S=1;Q=0;u=u+'<row r="'+S+'" span="1:3">';for(m=0;m<g.columns.length;m++){u=u+'<c t="inlineStr" r="'+x[Q]+S+'">';u=u+"<is><t>"+cleanDistinctValue(g.columns[m].getAttribute("displayName"),
g,g.columns[m].getAttribute("name"))+"</t></is>";u=u+"</c>";Q++}for(m=0;m<h.length;m++){u=u+'<c t="inlineStr" r="'+x[Q]+S+'">';u=u+"<is><t>"+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name"))+"</t></is>";u=u+"</c>";Q++}u=u+"</row>";for(B=0;B<o.length;B++){Q=0;S++;u=u+'<row r="'+S+'" span="1:3">';for(m=0;m<g.columns.length;m++){r=g.conditions[m].dataRowPosition;H=cleanDistinctValue(o[B][r],g);u=u+'<c t="inlineStr" r="'+x[Q]+S+'">';u=u+"<is><t>"+H+"</t></is>";
u=u+"</c>";Q++}for(m=0;m<h.length;m++){r=g.columns.length+m;H=g.defaultPictureValue(o[B][r],m==h.length-1,m);H=removeComas(H,g);H=cleanDistinctValue(H);if(h[m].getAttribute("dataType")==="real"||h[m].getAttribute("dataType")==="integer"){u=u+'<c r="'+x[Q]+S+'">';u=u+"<v>"+H+"</v>"}else{u=u+'<c t="inlineStr" r="'+x[Q]+S+'">';u=u+"<is><t>"+H+"</t></is>"}u=u+"</c>";Q++}u=u+"</row>"}h=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:true,pivotCacheDefinition:v,pivotTable1:t,Sheet2:u+"</sheetData></worksheet>",
style:n,dfx:L,worksheets:[{data:dataTable,name:"Sheet 1"}]})}else{t=g.colConditions.length+1;m=g.colConditions.length>0?g.colConditions.length:1;g.filterIndexes.length>0&&g.rowConditions.length+1==h.length&&(m=0);if(g.rowConditions.length+g.filterIndexes.length==0)m=t=1;q="1";r="";if(g.filterIndexes.length>0){t=t+g.filterIndexes.length;r=' rowPageCount="'+g.filterIndexes.length+'\'" colPageCount="1" ';q=t+1}B="";if(g.rowConditions.length>0){H=g.rowConditions[0];g.columns.length>H&&(B=' rowHeaderCaption="'+
cleanDistinctValue(g.columns[H].getAttribute("displayName"),g,g.columns[H].getAttribute("name"))+'" ')}if(g.colConditions.length>0){H=g.colConditions[0];g.columns.length>H&&(B=B+' colHeaderCaption="'+cleanDistinctValue(g.columns[H].getAttribute("displayName"),g,g.columns[H].getAttribute("name"))+'" ')}t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<pivotTableDefinition name="Tabla dinamica1" cacheId="5" dataCaption="'+gx.getMessage("GXPL_QViewerJSValue")+'" createdVersion="3" updatedVersion="3" minRefreshableVersion="3" applyNumberFormats="0" applyBorderFormats="0" applyFontFormats="0" applyPatternFormats="0" applyAlignmentFormats="0" applyWidthHeightFormats="1" showCalcMbrs="0" useAutoFormatting="1" itemPrintTitles="1" indent="0" outline="1" outlineData="1" multipleFieldFilters="0" '+
B+'   xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">\n<location ref="A'+q+'" firstHeaderRow="1" firstDataRow="'+t+'" firstDataCol="'+m+'" '+r+"/>\n<pivotFields>\n";C=[];q=[];H="";if(g.formulaInfo.cantFormulaMeasures==0)for(m=0;m<h.length;m++){L=163;h[m].getAttribute("picture")!=""&&(L=164+m);g.rowConditions.length>0||g.colConditions.length==0?t=t+'<pivotField dataField="1" showAll="0"  numFmtId="'+L+'"/>\n':H=H+'<pivotField dataField="1" showAll="0"  numFmtId="'+L+'"/>\n';C.push(cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),
m),g,h[m].getAttribute("name")))}y=-1;G=0;I=-1;for(B=D=0;B<g.filterIndexes.length;B++){m=g.filterIndexes[B];r="axisPage";F='numFmtId="163"';J='<item t="default"/>\n';t=t+'<pivotField axis="'+r+'" showAll="0" '+F+" >\n<items>\n";if(g.conditions[m].distinctValues!=void 0){Q=[];U=[];w=g.conditions[m].distinctValues;for(F=r=0;F<w.length;F++)if(!(w[F]==""&&w.findIndex("#NuN#")!=-1)){Q.push(cleanDistinctValue(w[F],g));V="";if(g.conditions[m].blackList.findIndex(w[F])!=-1){V=' h="1"';U.push(cleanDistinctValue(w[F],
g))}t=t+'<item x="'+r+'" '+V+" />\n";r=r+1}t=t+J+"</items>\n</pivotField>\n"}q[m]=Q;C.push(m)}for(m=0;m<g.columns.length;m++)if(g.filterIndexes.indexOf(m)==-1){r="axisRow";if(g.rowConditions.length>0&&g.rowConditions.indexOf(m)!=-1||g.rowConditions.length+g.filterIndexes.length+g.colConditions.length==0){r="axisRow";y++;G=m}else if(g.colConditions.indexOf(m)!=-1){r="axisCol";I++;D=m}else r="axisPage";F='numFmtId="163"';J='<item t="default"/>\n';t=t+'<pivotField axis="'+r+'" showAll="0" '+F+" >\n<items>\n";
if(g.conditions[m].distinctValues!=void 0){Q=[];U=[];w=g.conditions[m].distinctValues;for(F=r=0;F<w.length;F++)if(!(w[F]==""&&w.findIndex("#NuN#")!=-1)){Q.push(cleanDistinctValue(w[F],g));V="";if(g.conditions[m].blackList.findIndex(w[F])!=-1){V=' h="1"';U.push(cleanDistinctValue(w[F],g))}t=t+'<item x="'+r+'" '+V+" />";r=r+1}t=t+J+"</items>\n</pivotField>\n"}q[m]=Q;C.push(m)}if(g.formulaInfo.cantFormulaMeasures>0){for(m=0;m<h.length;m++){L=163;h[m].getAttribute("picture")!=""&&(L=164+m);if(!g.formulaInfo.measureFormula[m].hasFormula){t=
t+'<pivotField dataField="1" showAll="0"  numFmtId="'+L+'"/>\n';C.push(cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name")))}}for(m=0;m<u.length;m++)t=t+'<pivotField showAll="0" defaultSubtotal="0"/>\n';for(m=0;m<h.length;m++)g.formulaInfo.measureFormula[m].hasFormula&&(t=t+'<pivotField dataField="1" dragToRow="0" dragToCol="0" dragToPage="0" showAll="0" defaultSubtotal="0" numFmtId="'+L+'"/>\n')}g.rowConditions.length==0&&g.colConditions.length>0&&(t=
t+H);t=t+"</pivotFields>\n";if(g.rowConditions.length+1!=h.length){t=t+"<rowFields>\n";for(m=0;m<g.columns.length;m++)if(g.rowConditions.findIndex(m)!=-1||g.rowConditions.length+g.filterIndexes.length==0){r=C.indexOf(m);t=t+'<field x="'+r+'"/>\n'}t=t+"</rowFields>\n"}t=t+"<rowItems>\n";for(L=0;L<g.rowStructure.items.length;L++)t=t+createExcelROWITEMS(g.rowStructure.items[L],y,q,G,y);t=g.rowConditions.length==0&&g.colConditions.length>0?t+"<i/>\n</rowItems>\n":t+'<i t="grand"><x/></i>\n</rowItems>\n';
if(I>-1||h.length>1){t=t+"<colFields>\n";for(m=0;m<g.columns.length;m++)if(g.colConditions.findIndex(m)!=-1&&g.rowConditions.length+g.filterIndexes.length!=0){r=C.indexOf(m);t=t+'<field x="'+r+'"/>\n'}else if(g.colConditions.findIndex(m)!=-1&&g.rowConditions.length+g.filterIndexes.length==0){r=C.indexOf(m);g.rowConditions.length==0&&(r=C.indexOf(m)-h.length);t=t+'<field x="'+r+'"/>\n'}h.length>1&&(t=t+'<field x="-2"/>\n');t=t+"</colFields>\n"}t=t+"<colItems>\n";if(g.colStructure.items){for(L=0;L<
g.colStructure.items.length;L++)t=t+createExcelCOLITEMS(g.colStructure.items[L],I,q,D,I);g.rowConditions.length==0&&(t=t+'<i t="grand"><x/></i>')}else for(m=0;m<h.length;m++)t=t+"<i/>\n";t=t+"</colItems>\n";if(g.filterIndexes.length>0){t=t+"<pageFields>\n";for(L=0;L<g.filterIndexes.length;L++)t=t+'<pageField fld="'+(h.length+L)+'" hier="-1"/>\n';t=t+"</pageFields>\n"}t=t+"<dataFields>\n";for(m=r=Q=0;m<h.length;m++){L=163;h[m].getAttribute("picture")!=""&&(L=164+m);if(g.formulaInfo.measureFormula[m].hasFormula){Q++;
L=163;h[m].getAttribute("picture")!=""&&(L=164+m);if(g.formulaInfo.measureFormula[m].hasFormula)if(h[m].getAttribute("displayName").indexOf("%")>-1){for(B=0;B<m;B++)S=S+" ";t=t+'<dataField name="'+h[m].getAttribute("displayName").replace(/</g,"&lt;").replace(/>/g,"&gt;")+S+' " fld="'+(m+g.columns.length+u.length)+'" numFmtId="'+L+'" baseField="0" baseItem="0"/>\n'}else{for(B=w=H=0;B<g.formulaInfo.measureFormula.length;B++)g.formulaInfo.measureFormula[B].hasFormula?H=H+g.formulaInfo.measureFormula[B].relatedMeasures.length:
w++;B=H+w+g.columns.length+r;t=t+'<dataField name="'+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name"))+' " fld="'+B+'" numFmtId="'+L+'" baseField="0" baseItem="0"/>\n';r++}}else{H=0;g.formulaInfo.cantFormulaMeasures>0&&(H=g.columns.length-Q);S="";if(h[m].getAttribute("displayName").indexOf("%")>-1){for(B=0;B<m;B++)S=S+" ";t=t+'<dataField name="'+h[m].getAttribute("displayName")+S+'" fld="'+(m+H)+'" subtotal="'+h[m].getAttribute("aggregation")+'" numFmtId="'+
L+'"/>\n'}else t=g.rowConditions.length>0?t+'<dataField name="'+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name")).replace(/</g,"&lt;").replace(/>/g,"&gt;")+'" fld="'+(m+H)+'" subtotal="'+h[m].getAttribute("aggregation")+'" numFmtId="'+L+'"/>\n':t+'<dataField name="'+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name")).replace(/</g,"&lt;").replace(/>/g,"&gt;")+'" fld="'+(m+H+g.colConditions.length)+'" numFmtId="'+
L+'"/>\n'}}t=t+'</dataFields>\n<pivotTableStyleInfo name="PivotStyleLight16" showRowHeaders="1" showColHeaders="1" showRowStripes="0" showColStripes="0" showLastColumn="1"/>\n</pivotTableDefinition>\n';for(B=0;B<o.length;B++){for(m=0;m<g.columns.length;m++)q[m].indexOf(cleanDistinctValue(o[B][m],g));for(m=0;m<h.length;m++){r=g.columns.length+m;H=g.defaultPictureValue(o[B][r],m==h.length-1,m);H=removeComas(H,g);H=cleanDistinctValue(H,g)}}v=v+'<worksheetSource ref="A1:'+x[g.columns.length+h.length-
1-g.formulaInfo.cantFormulaMeasures+u.length]+(o.length+1)+'" sheet="SourceData"/>\n';v=v+'</cacheSource>\n<cacheFields count="'+(g.columns.length+h.length+u.length)+'">\n';if(g.formulaInfo.cantFormulaMeasures==0&&(g.rowConditions.length>0||g.colConditions.length==0))for(m=0;m<h.length;m++){v=v+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name")).replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+'" numFmtId="0">\n';v=v+"<sharedItems/>\n";
v=v+"</cacheField>\n"}for(B=0;B<g.filterIndexes.length;B++){m=g.filterIndexes[B];L="";for(F=0;F<g.GeneralDistinctValues[m].length;F++)if(!isNaN(g.GeneralDistinctValues[m][F])){L=' containsMixedTypes="1" containsString="1" containsNumber="1" containsInteger="1" ';break}if(L!=""){o=true;for(F=0;F<g.GeneralDistinctValues[m].length;F++)if(isNaN(g.GeneralDistinctValues[m][F])){o=false;break}o&&(L=' containsSemiMixedTypes="0" containsString="0" containsNumber="1" containsInteger="1" ')}v=v+'<cacheField name="'+
cleanDistinctValue(g.columns[m].getAttribute("displayName"),g,g.columns[m].getAttribute("name"))+'" numFmtId="0">\n';v=v+"<sharedItems "+L+' count="'+g.GeneralDistinctValues[m].length+'">\n';for(F=0;F<g.GeneralDistinctValues[m].length;F++)v=isNaN(g.GeneralDistinctValues[m][F])?v+'<s v="'+cleanDistinctValue(g.GeneralDistinctValues[m][F],g)+'"/>\n':v+'<n v="'+cleanDistinctValue(g.GeneralDistinctValues[m][F],g)+'"/>\n';v=v+"</sharedItems>\n";v=v+"</cacheField>\n"}for(m=0;m<g.columns.length;m++)if(g.filterIndexes.indexOf(m)==
-1){v=v+'<cacheField name="'+cleanDistinctValue(g.columns[m].getAttribute("displayName"),g,g.columns[m].getAttribute("name"))+'" numFmtId="0">\n';v=v+'<sharedItems count="'+g.conditions[m].distinctValues.length+'">\n';for(F=0;F<g.conditions[m].distinctValues.length;F++)v=v+'<s v="'+cleanDistinctValue(g.conditions[m].distinctValues[F],g)+'"/>\n';v=v+"</sharedItems>\n";v=v+"</cacheField>\n"}if(g.formulaInfo.cantFormulaMeasures>0){for(m=0;m<h.length;m++)if(!g.formulaInfo.measureFormula[m].hasFormula){v=
v+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name"))+'" numFmtId="165">\n';v=v+"<sharedItems/>\n";v=v+"</cacheField>\n"}for(m=0;m<u.length;m++)v=v+'<cacheField name="'+n(g,u[m])+'" numFmtId="0">\n</cacheField>\n';for(m=0;m<h.length;m++)g.formulaInfo.measureFormula[m].hasFormula&&(v=v+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name"))+'" numFmtId="165" formula="'+
g.formulaInfo.measureFormula[m].textFormula+'" databaseField="0"/>\n')}if(g.formulaInfo.cantFormulaMeasures==0&&g.rowConditions.length==0&&g.colConditions.length>0)for(m=0;m<h.length;m++){v=v+'<cacheField name="'+cleanDistinctValue(getMeasureTitle(h[m].getAttribute("displayName"),m),g,h[m].getAttribute("name")).replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+'" numFmtId="164">\n';v=v+"<sharedItems/>\n";v=v+"</cacheField>\n"}v=v+"</cacheFields>\n</pivotCacheDefinition>\n";n="<numFmts>";L=false;for(o=0;o<
h.length;o++)if(h[o].getAttribute("picture")!=""){u=h[o].getAttribute("picture");L=164+o;S="";for(x=0;x<u.length;x++)S=u[x]=="Z"?S+"#":u[x]=="9"?S+"0":u[x]=="."||u[x]==","?S+u[x]:S+"\\"+u[x];n=n+'<numFmt formatCode="'+S+'" numFmtId="'+L+'"/>';L=true}h=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:true,pivotCacheDefinition:v,pivotTable1:t,Sheet2:"",style:L?n+"</numFmts>":"",worksheets:[{data:dataTable,name:"Sheet 1"}]})}if(gx.util.browser.webkit&&!gx.util.browser.chrome||g.isSD)window.location=
h.href();else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){g=atob(h.base64);g=Array.prototype.map.call(g,function(c){return c.charCodeAt(0)});g=new Uint8Array(g);g=new Blob([g],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});saveAs(g,c+".xlsx")}else return h.base64}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){OAT.Dialog=function(c,g,h){var j=this,k={width:0,height:0,modal:0,onshow:function(){},onhide:function(){},zIndex:1E3,buttons:1,resize:1,close:1,autoEnter:1,imagePath:OAT.Preferences.imagePath};if(h)for(var l in h)k[l]=h[l];var n=new OAT.Window({close:k.close,max:0,min:0,width:k.width,height:k.height,x:0,y:0,title:c,resize:k.resize,imagePath:k.imagePath});OAT.Dom.hide(n.div);try{OAT.$(g).style.margin="10px"}catch(o){}c=OAT.Dom.create("table",
{marginTop:"1em",width:"90%",textAlign:"center"});h=OAT.Dom.create("tbody");l=OAT.Dom.create("tr");var m=OAT.Dom.create("td",{border:"none"}),r=OAT.Dom.create("input");r.setAttribute("type","button");r.value=" OK ";m.appendChild(r);var t=OAT.Dom.create("input",{marginLeft:"2em"});t.setAttribute("type","button");t.value="Cancel";m.appendChild(t);l.appendChild(m);h.appendChild(l);c.appendChild(h);k.buttons&&OAT.$(g).appendChild(c);document.body.appendChild(n.div);n.content.appendChild(OAT.$(g));n.div.style.zIndex=
k.zIndex;k.modal?(this.show=function(){OAT.Dimmer.show(n.div,{});n.accomodate();OAT.Dom.center(n.div,1,1);k.onshow()},this.hide=function(){OAT.Dimmer.hide();k.onhide()}):(this.show=function(){OAT.Dom.show(n.div);n.accomodate();OAT.Dom.center(n.div,1,1);k.onshow()},this.hide=function(){OAT.Dom.hide(n.div);k.onhide()});n.onclose=this.hide;this.accomodate=n.accomodate;this.ok=function(){};this.cancel=function(){};this.okBtn=r;this.cancelBtn=t;OAT.Dom.attach(r,"click",function(){j.ok()});OAT.Dom.attach(t,
"click",function(){j.cancel()});g=function(c){"disabled"!=j.okBtn.getAttribute("disabled")&&(13==c.keyCode&&j.ok(),27==c.keyCode&&j.cancel())};k.autoEnter&&OAT.Dom.attach(n.div,"keypress",g)};try{OAT.Loader.featureLoaded("dialog")}catch(ERROR){}OAT.Drag={TYPE_X:1,TYPE_Y:2,TYPE_XY:3,elm:!1,mouse_x:0,mouse_y:0,move:function(c){function g(c,g){return Math.abs(c-g)<=t}if(OAT.Drag.elm){OAT.Dom.removeSelection();var h=OAT.Dom.getViewport(),j=OAT.Dom.position(OAT.Drag.elm);OAT.Dom.eventPos(c);OAT.Dom.getWH(OAT.Drag.elm);
if(!(c.clientX>h[0]||0>c.clientX||c.clientY>h[1]||0>c.clientY)){for(var h=c.clientX-OAT.Drag.mouse_x,k=c.clientY-OAT.Drag.mouse_y,l=!0,n=OAT.Drag.elm._Drag_movers,o=0;o<n.length;o++){var j=n[o][0],m=n[o][1],j=OAT.Dom.getLT(j);m.restrictionFunction(j[0]+h,j[1]+k)&&(l=!1)}for(var r=!0,t=10,o=0;o<n.length;o++){for(var j=n[o][0],m=n[o][1],u=OAT.Dom.getWH(j),v=OAT.Dom.position(j),x=v[0]+h,v=v[1]+k,B=0;B<m.magnetsH.length;B++){var H=OAT.$(m.magnetsH[B]),w=OAT.Dom.position(H),H=OAT.Dom.getWH(H);if(g(x,w[0])){j.style.left=
w[0]+"px";r=!1;break}if(g(x+u[0],w[0])){j.style.left=w[0]-u[0]+"px";r=!1;break}if(g(x,w[0]+H[0])){j.style.left=w[0]+H[0]+"px";r=!1;break}if(g(x+u[0],w[0]+H[0])){j.style.left=w[0]+H[0]-u[0]+"px";r=!1;break}}for(B=0;B<m.magnetsV.length;B++){H=OAT.$(m.magnetsV[B]);w=OAT.Dom.position(H);H=OAT.Dom.getWH(H);if(g(v,w[1])){j.style.top=w[1]+"px";r=!1;break}if(g(v+u[1],w[1])){j.style.top=w[1]-u[1]+"px";r=!1;break}if(g(v,w[1]+H[1])){j.style.top=w[1]+H[1]+"px";r=!1;break}if(g(v+u[1],w[1]+H[1])){j.style.top=w[1]+
H[1]-u[1]+"px";r=!1;break}}}if(l&&r){for(o=0;o<n.length;o++)if(j=n[o][0],m=n[o][1],m.moveFunction)m.moveFunction(h,k);else switch(m.type){case OAT.Drag.TYPE_X:OAT.Dom.moveBy(j,h,0);break;case OAT.Drag.TYPE_Y:OAT.Dom.moveBy(j,0,k);break;case OAT.Drag.TYPE_XY:OAT.Dom.moveBy(j,h,k)}OAT.Drag.mouse_x=c.clientX;OAT.Drag.mouse_y=c.clientY}}}},up:function(){if(OAT.Drag.elm){for(var c=OAT.Drag.elm._Drag_movers,g=0;g<c.length;g++)c[g][1].endFunction(c[g][0]);OAT.Drag.elm=!1}},create:function(c,g,h){var j={type:OAT.Drag.TYPE_XY,
restrictionFunction:function(){return!1},endFunction:function(){},moveFunction:!1,magnetsH:[],magnetsV:[],cursor:!0};if(h)for(p in h)j[p]=h[p];var k=OAT.$(c),c=OAT.$(g),g=function(c){OAT.Drag.initiate(c,k)};k._Drag_movers||(OAT.Dom.attach(k,"mousedown",g),k._Drag_movers=[],k._Drag_cursor=k.style.cursor);j.cursor&&(k.style.cursor="move");k._Drag_movers.push([c,j])},initiate:function(c,g){OAT.Drag.elm=g;OAT.Drag.mouse_x=c.clientX;OAT.Drag.mouse_y=c.clientY},remove:function(c,g){var h=OAT.$(c);OAT.$(g);
if(h._Drag_movers){for(var j=-1,k=0;k<h._Drag_movers.length;k++)h._Drag_movers[k][0]==g&&(j=k);-1!=j&&h._Drag_movers.splice(j,1)}},removeAll:function(c){c=OAT.$(c);c._Drag_movers&&(c._Drag_movers=[],c.style.cursor=c._Drag_cursor)},createDefault:function(c,g){if(OAT.Preferences.allowDefaultDrag){var h=OAT.$(c),j=OAT.Dom.create("div",{position:"absolute",width:"21px",height:"21px"}),k=OAT.Dom.getLT(h);j.style.left=k[0]-21+"px";j.style.top=k[1]-21+"px";if(g){h.parentNode.appendChild(j);k=function(c,
g){var k=OAT.Dom.getWH(h),j=OAT.Dom.getWH(h.parentNode),l=c+k[0],k=g+k[1];return 20>c||20>g||l>j[0]||k>j[1]};OAT.Drag.create(j,j);OAT.Drag.create(j,h,{restrictionFunction:k});OAT.Dom.hide(j);var l=function(){j._Drag_pending&&OAT.Dom.hide(j)};OAT.Dom.attach(h,"mouseover",function(){OAT.Dom.show(j);j._Drag_pending=0});OAT.Dom.attach(h,"mouseout",function(){j._Drag_pending=1;setTimeout(l,3E3)})}else k=function(c,g){var k=OAT.Dom.getWH(h),j=OAT.Dom.getWH(h.parentNode),l=c+k[0],k=g+k[1];return 0>c||0>
g||l>j[0]||k>j[1]},OAT.Drag.create(h,h,{restrictionFunction:k})}}};OAT.Dom.attach(document,"mousemove",OAT.Drag.move);OAT.Dom.attach(document,"mouseup",OAT.Drag.up);try{OAT.Loader.featureLoaded("drag")}catch(ERROR$$1){}OAT.GhostDragData={lock:!1,up:function(c){if(OAT.GhostDragData.lock){var g=OAT.GhostDragData.lock,h=g.object;if(h.pending)h.pending=0,OAT.GhostDragData.lock=!1;else{OAT.GhostDragData.lock=!1;for(var j=OAT.Dom.eventPos(c),c=j[0],j=j[1],k=0,l=0;l<h.targets.length;l++){var n=h.targets[l],
o=n[1]?n[1](c,j):OAT.GhostDragData.pos(n[0],c,j);!k&&o&&(k=1,h.callback(n[0],c,j))}k?(OAT.Dom.unlink(g),OAT.MSG.send(h,OAT.MSG.GD_END,g)):(OAT.MSG.send(h,OAT.MSG.GD_ABORT,g),h.onFail(),h=OAT.Dom.position(h.originalElement),c=h[0],j=h[1],h=new OAT.AnimationPosition(g,{speed:10,delay:10,left:c,top:j}),OAT.MSG.attach(h.animation,OAT.MSG.ANIMATION_STOP,function(){OAT.Dom.unlink(g)}),h.start())}}},move:function(c){if(OAT.GhostDragData.lock){var g=OAT.GhostDragData.lock,h=g.object;h.pending&&(document.body.appendChild(g),
g.style.zIndex=2E3,h.process&&h.process(g),h.pending=0,OAT.MSG.send(h,OAT.MSG.GD_START,g));OAT.Dom.removeSelection();var j=c.clientX-g.mouse_x,h=c.clientY-g.mouse_y,j=parseInt(OAT.Dom.style(g,"left"))+j,h=parseInt(OAT.Dom.style(g,"top"))+h;g.style.left=j+"px";g.style.top=h+"px";g.mouse_x=c.clientX;g.mouse_y=c.clientY}},pos:function(c,g,h){if(!c||"none"==c.style.display.toLowerCase())return 0;var j=OAT.Dom.position(c),k=j[0]-2,j=j[1]-2,l=parseInt(c.offsetWidth)+2,c=parseInt(c.offsetHeight)+2;return g>=
k&&g<=k+l&&h>=j&&h<=j+c}};OAT.GhostDrag=function(){var c=this;this.onFail=function(){};this.sources=[];this.processes=[];this.callbacks=[];this.targets=[];this.pending=0;this.addSource=function(g,h,j){var k=OAT.$(g);c.sources.push(k);c.processes.push(h);c.callbacks.push(j);OAT.Dom.attach(k,"mousedown",function(g){OAT.Dom.prevent(g);var h=c.sources.indexOf(k);-1!=h&&c.startDrag(c.sources[h],c.processes[h],c.callbacks[h],g.clientX,g.clientY)})};this.delSource=function(g){g=$(g);g=c.sources.indexOf(g);
-1!=g&&(c.sources.splice(g,1),c.processes.splice(g,1),c.callbacks.splice(g,1))};this.clearSources=function(){c.sources=[];c.processes=[];c.callbacks=[]};this.addTarget=function(g,h,j){g=[OAT.$(g),h,j];c.targets.length&&c.targets[c.targets.length-1][2]?c.targets.splice(c.targets.length-1,0,g):c.targets.push(g)};this.delTarget=function(g){for(var g=OAT.$(g),h=-1,j=0;j<c.targets.length;j++)c.targets[j][0]==g&&(h=j);-1!=h&&c.targets.splice(h,1)};this.clearTargets=function(){c.targets=[]};this.startDrag=
function(g,h,j,k,l){OAT.GhostDragData.lock||(c.pending=1,c.originalElement=g,c.callback=j,j=OAT.Dom.create("div",{position:"absolute"}),c.process=h,h=OAT.Dom.position(g),j.style.left=h[0]+"px",j.style.top=h[1]+"px",OAT.Style.opacity(j,0.5),j.appendChild(g.cloneNode(!0)),j.mouse_x=k,j.mouse_y=l,j.object=c,OAT.GhostDragData.lock=j)}};OAT.Dom.attach(document,"mousemove",OAT.GhostDragData.move);OAT.Dom.attach(document,"mouseup",OAT.GhostDragData.up);try{OAT.Loader.featureLoaded("ghostdrag")}catch(ERROR$$2){}OAT.Instant=
function(c,g){var h=this;this.options={showCallback:!1,hideCallback:!1};for(var j in g)h.options[j]=g[j];this.state=1;this.elm=OAT.$(c);this.handles=[];this.hide=function(){h.state=0;OAT.Dom.hide(h.elm)};this.show=function(){h.options.showCallback&&h.options.showCallback();OAT.Dom.show(h.elm);h.state=1};this.check=function(c){h.state&&(c=OAT.Event.source(c),c==h.elm||OAT.Dom.isChild(c,h.elm)||(h.options.hideCallback&&h.options.hideCallback(),h.hide()))};this.createHandle=function(c){var g=OAT.$(c);
h.handles.push(g);OAT.Event.attach(g,"mousedown",function(c){-1!=h.handles.indexOf(g)&&!h.state&&(OAT.Event.cancel(c),h.show())})};this.removeHandle=function(c){c=OAT.$(c);c=h.handles.indexOf(c);-1!=c&&h.handles.splice(c,1)};h.elm._Instant_show=h.show;h.elm._Instant_hide=h.hide;h.hide();OAT.Dom.attach(document,"mousedown",h.check)};OAT.Instant.assign=function(c,g){new OAT.Instant(c,{hideCallback:g})};try{OAT.Loader.featureLoaded("instant")}catch(ERROR$$3){}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){OAT.GridData={index:0,LIMIT:15,ALIGN_CENTER:1,ALIGN_LEFT:2,ALIGN_RIGHT:3,SORT_NONE:1,SORT_ASC:2,SORT_DESC:3,TYPE_STRING:1,TYPE_NUMERIC:2,TYPE_AUTO:3};OAT.Grid=function(c,g,h,j,k,l,n,o,m,r,t,u,v,x,B,H,w,z){var q=this;q.controlName=g;q.columnsDataType=j;q.query=h;q.rowsPerPage="";q.columns=k;q.QueryViewerCollection=l;q.InitPageSize=n;q.disableColumnSort=o;q.UcId=m;q.IdForQueryViewerCollection=r;q.rememberLayout=t;q.serverPaging=u;q.HideDataFilds=
v;q.OrderFildsHidden=x;q.TableDataFilds=B;q.relativePath=H;q.selection=w;q.Debugg=!1;q.isSD=!1;g=-1<navigator.userAgent.toLowerCase().indexOf("android");if(gx.util.browser.isIPad()||(gx.util.browser.isIPhone()||g)||q.Debugg)q.isSD=!0;q.conditions=Array(j.length);for(iC=0;iC<j.length;iC++)q.conditions[iC]={blackList:[],sort:1};this.init=function(){var g;if(0==jQuery("#"+q.controlName+"_grid_top_div").length||void 0==q.QueryViewerCollection[q.IdForQueryViewerCollection]._ControlRenderedTo){g=OAT.$(c);
q.ContainerName=g.getAttribute("id");OAT.Dom.clear(g);var h=document.createElement("div");h.setAttribute("class","divIeContainer");h.setAttribute("style","position: relative;opacity: 0");g.appendChild(h);q.div=h;g=OAT.Dom.create("div");q.isSD?g.setAttribute("class","oatgrid_top_div oatgrid_top_div_small"):g.setAttribute("class","oatgrid_top_div");z?OAT.addTextNode(g," "+z):OAT.addTextNode(g,"");g.setAttribute("id",q.controlName+"_grid_top_div");h=OAT.Dom.create("a");h.href="#";OAT.addTextNode(h,document.createTextNode("GXPL_QViewerJSVisibleColumns"));
q.div.appendChild(g);OAT.Dom.makePosition(q.div);q.html=OAT.Dom.create("table");OAT.Dom.addClass(q.html,"oatgrid");OAT.Dom.setIdPropertyValue(q.html,q.controlName);q.header=new OAT.GridHeader(q);q.rows=[];q.rowBlock=OAT.Dom.create("tbody");OAT.Dom.append([q.div,q.html],[q.html,q.header.html,q.rowBlock])}else g=OAT.$(c),q.ContainerName=g.getAttribute("id"),q.div=jQuery("#"+q.ContainerName).find(".divIeContainer")[0],g=jQuery("#"+q.ContainerName).find(".oatgrid_top_div")[0],OAT.Dom.clear(g),z?OAT.addTextNode(g,
" "+z):OAT.addTextNode(g,""),q.html=jQuery("#"+q.ContainerName).find("table")[0],h=jQuery("#"+q.ContainerName).find("thead")[0],OAT.Dom.clear(h),q.header=new OAT.GridHeader(q,h),q.rows=[],q.rowBlock=jQuery("#"+q.ContainerName).find("tbody")[0],OAT.Dom.clear(q.rowBlock);h=OAT.Dom.create("div");h.href="#";q.isSD?h.setAttribute("class","exportOptionsAnchor exportOptionsAnchor_small"):h.setAttribute("class","exportOptionsAnchor");q.exportPage=OAT.Dom.create("div",{padding:"0px"});OAT.addImageNode(h,"menu",
"");OAT.Dom.attach(document,"mousedown",function(c){source=OAT.Event.source(c);for(var g=c=!1,h=0;h<jQuery(".oat_winrect_container").length;h++){var k=jQuery(".oat_winrect_container")[h];if(source!=k&&!OAT.Dom.isChild(source,k))c=!0;else{c=!1;break}}for(h=0;h<jQuery(".oat_winrect_container").length;h++)"none"!=jQuery(".oat_winrect_container")[h].style.display&&(g=!0);q.serverPaging&&(("oat_winrect_close_b"==source.getAttribute("class")||!OAT.Dom.isChild(source,k))&&g)&&q.oat_component.resetAllScrollValue(q.UcId);
c&&jQuery(".oat_winrect_container").css({display:"none"})});OAT.Anchor.assign(h,{title:" ",content:q.exportPage,result_control:!1,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(q.QueryViewerCollection[r])+" ExportPopup "});var k=function(c){if("Never"!=OAT_JS.grid.gridData[q.UcId].rowsMetadata.columns[c].getAttribute("visible")){var g="none"!=q.header.cells[c].html.style.display,h=OAT.Dom.create("div"),k=g?"check_item_img":"uncheck_item_img";
q.isSD&&(k=g?"check_item_img_small":"uncheck_item_img_small");OAT.addImageNode(h,g?"check_box":"check_box_outline_blank","");h.setAttribute("class",k);g=OAT.Dom.create("span");OAT.addTextNode(g," "+q.header.cells[c].value.textContent);h.appendChild(g);OAT.Event.attach(h,"click",function(){var g="check_item_img",h="uncheck_item_img";q.isSD&&(g="check_item_img_small",h="uncheck_item_img_small");this.setAttribute("class",this.getAttribute("class")===g?h:g);jQuery(this).find("i")[0].textContent=this.getAttribute("class")===
g?"check_box":"check_box_outline_blank";g="none"==q.header.cells[c].html.style.display?"":"none";q.header.cells[c].html.style.display=g;for(h=0;h<q.rows.length;h++)q.rows[h].cells[c].html.style.display=g;OAT.saveState({grid:q},!1);q.serverPaging&&OAT_JS.grid.setColumnVisibleValue(q.UcId,c,""==g)});return h}return!1};OAT.Event.attach(h,"click",function(c){var g=OAT.Event.position(c);q.exportPage.style.left=g[0]+"px";q.exportPage.style.top=g[1]+"px";q.exportPage.id="exportOptionsContainer";gx.util.browser.isIE()&&
(q.exportPage.id="exportOptionsContainerGrid");Math.max(jQuery(".ExportPopup")[0].clientWidth,300);jQuery(c.currentTarget).offset();var h=c.currentTarget;jQuery(".ExportPopup").css({left:"-2500px",top:"0px"});jQuery(".oat_winrect_title").find(".winrect_title_label").remove();c=OAT.Dom.create("label");q.isSD?(jQuery(".oat_winrect_container").addClass("oat_winrect_container_small"),c.setAttribute("class","winrect_title_label winrect_title_label_small")):c.setAttribute("class","winrect_title_label");
OAT.addTextNode(c,gx.getMessage("GXPL_QViewerPopupTitle"));jQuery(".oat_winrect_title").append(c);OAT.Dom.clear(q.exportPage);c=!1;g=document.createElement("div");g.setAttribute("class","upper_container");jQuery("#divtoxml").remove();jQuery("#divtoxls").remove();jQuery("#divtoxlsx").remove();jQuery("#divtoexport").remove();jQuery("#divtohtml").remove();c=q.appendExportToXmlOption(g,c);c=q.appendExportToHtmlOption(g,c);c=q.appendExportToPdfOption(g,c);c=q.appendExportToExcelOption(g,c);c=q.appendExportToExcel2010Option(g,
c);q.exportPage.appendChild(g);c&&(c=OAT.Dom.create("hr",{}),q.exportPage.appendChild(c));c=document.createElement("div");c.setAttribute("class","down_container");q.exportPage.appendChild(c);g=document.createElement("span");g.textContent=gx.getMessage("GXPL_QViewerJSVisibleColumns");var j=document.createElement("div");j.setAttribute("class","div_label_win");j.appendChild(g);c.appendChild(j);for(g=0;g<q.columns.length;g++)for(j=0;j<q.header.cells.length;j++)if(q.header.cells[j].dataField==q.columns[g].getAttribute("dataField")){var l=
k(j);l&&c.appendChild(l)}setTimeout(function(){var c=window.innerWidth,g=jQuery(".ExportPopup")[0].clientWidth;if(g==0){g=jQuery(".ExportPopup").length;g=jQuery(".ExportPopup")[g-1].clientWidth}if(q.isSD){g<235&&(g=235);c=(c-g)/2+jQuery(window).scrollLeft();jQuery(".ExportPopup").css({left:c+"px",top:jQuery(h).offset().top+"px",width:g+"px"})}else{var k=jQuery(h).offset().left;k+g+15<c?jQuery(".ExportPopup").css({left:jQuery(h).offset().left+"px",top:jQuery(h).offset().top+"px"}):jQuery(".ExportPopup").css({left:k-
g+16+"px",top:jQuery(h).offset().top+"px"})}},50)});g.appendChild(h)};this.appendExportToXmlOption=function(c,g){var h,k=this.query;if(""==k)try{k=q.controlName.substr(4).split("_")[0]}catch(j){}if(q.QueryViewerCollection[q.IdForQueryViewerCollection].ExportToXML){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");var l=q.createExportButton(h),m=OAT.Dom.create("label");OAT.addTextNode(m,gx.getMessage("GXPL_QViewerContextMenuExportXml"));m.htmlFor="pivot_checkbox_restoreview";
h.appendChild(m);OAT.Dom.attach(l,"click",function(){q.serverPaging?OAT_JS.grid.getAllDataRowsForExport(q.UcId,{grid:q},k,"xml"):str=OAT.ExportToXML({grid:q},k)})}else h=document.createElement("div"),h.style.marginBottom="10px",exportXMLButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"}),exportXMLButtonSub.setAttribute("id","divtoxml"),setTimeout(function(){jQuery("#divtoxml").downloadify({filename:function(){return k+".xml"},data:function(){return OAT.ExportToXML({grid:q})},
onComplete:function(){},onCancel:function(){},onError:function(){},swf:gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),downloadImage:gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/images/download_file.png"),width:21,height:21,transparent:!0,append:!1})},100),h.appendChild(exportXMLButtonSub),m=OAT.Dom.create("label"),OAT.addTextNode(m,gx.getMessage("GXPL_QViewerContextMenuExportXml")),m.style.paddingLeft="9px",m.htmlFor="pivot_checkbox_restoreview",
h.appendChild(m);c.appendChild(h);g||(g=!0)}return g};this.appendExportToHtmlOption=function(c,g){var h,k=this.query;if(""==k)try{k=q.controlName.substr(4).split("_")[0]}catch(j){}if(q.QueryViewerCollection[q.IdForQueryViewerCollection].ExportToHTML){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");var l=q.createExportButton(h),m=OAT.Dom.create("label");OAT.addTextNode(m,gx.getMessage("GXPL_QViewerContextMenuExportHtml"));m.htmlFor="pivot_checkbox_restoreview";h.appendChild(m);
OAT.Dom.attach(l,"click",function(){q.serverPaging?OAT_JS.grid.getAllDataRowsForExport(q.UcId,q,k,"html"):q.ExportToHtml(q,k)})}else h=document.createElement("div"),h.style.marginBottom="10px",exportHTMLButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"}),exportHTMLButtonSub.setAttribute("id","divtohtml"),setTimeout(function(){jQuery("#divtohtml").downloadify({filename:function(){return k+".html"},data:function(){var c=gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/css/grid.css"),
c='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+c+'" /></STYLE></HEAD>'+jQuery("#"+q.controlName)[0].outerHTML.replace(/display: none;/g,"");return c+"</BODY></HTML>"},onComplete:function(){},onCancel:function(){},onError:function(){},swf:gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),downloadImage:gx.util.resourceUrl(q.relativePath+
"QueryViewer/oatPivot/images/download_file.png"),width:21,height:21,transparent:!0,append:!1})},100),h.appendChild(exportHTMLButtonSub),m=OAT.Dom.create("label"),OAT.addTextNode(m,gx.getMessage("GXPL_QViewerContextMenuExportHtml")),m.style.paddingLeft="9px",m.htmlFor="pivot_checkbox_restoreview",h.appendChild(m);c.appendChild(h);g||(g=!0)}return g};this.ExportToHtml=function(c,g){for(var h=gx.util.resourceUrl(c.relativePath+"QueryViewer/oatPivot/css/grid.css"),h='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+
h+'" />',k=0;k<jQuery("link").length;k++)0>jQuery("link")[k].href.indexOf("QueryViewer.css")&&(h=h+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+jQuery("link")[k].href+'" />');h=h+'</STYLE></HEAD><div class="gx_usercontrol qv-table QueryViewer-table"><table class="oatgrid"  style="width: 100%;">'+OAT.removeIconFont(jQuery("#"+c.controlName)[0].innerHTML.replace(/visibility: collapse;/g,"").replace(/visibility:collapse;/g,""));h+="</table></div></BODY></HTML>";isSD=!1;
k=-1<navigator.userAgent.toLowerCase().indexOf("android");if(gx.util.browser.isIPad()||gx.util.browser.isIPhone()||k)isSD=!0;gx.util.browser.webkit&&!gx.util.browser.chrome||isSD?window.open("data:text/html,"+h):(h=new Blob([h],{type:"text/html"}),saveAs(h,g+".html"))};this.appendExportToPdfOption=function(c,g){var h=this.query;if(""==h)try{h=q.controlName.substr(4).split("_")[0]}catch(k){}var j;if(q.QueryViewerCollection[q.IdForQueryViewerCollection].ExportToPDF){if(gx.util.browser.isIE()&&9>=gx.util.browser.ieVersion()){j=
document.createElement("div");j.style.marginBottom="10px";exportPDFButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportPDFButtonSub.setAttribute("id","divtoexport");setTimeout(function(){jQuery("#divtoexport").downloadify({filename:function(){return h+".pdf"},data:function(){return btoa(OAT.ExportToPdf({grid:q}))},onComplete:function(){},onCancel:function(){},onError:function(){},dataType:"base64",swf:gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),
downloadImage:gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/images/download_file.png"),width:21,height:21,transparent:!0,append:!1})},100);j.appendChild(exportPDFButtonSub);var l=OAT.Dom.create("label");OAT.addTextNode(l,gx.getMessage("GXPL_QViewerContextMenuExportPdf"));l.style.paddingLeft="9px";l.htmlFor="pivot_checkbox_restoreview";j.appendChild(l)}else{j=OAT.Dom.create("div");var m=q.createExportButton(j),l=OAT.Dom.create("label");OAT.addTextNode(l,gx.getMessage("GXPL_QViewerContextMenuExportPdf"));
l.htmlFor="pivot_checkbox_restoreview";j.appendChild(l);q.serverPaging?OAT.Dom.attach(m,"click",function(){OAT_JS.grid.getAllDataRowsForExport(q.UcId,{grid:q},h,"pdf")}):OAT.Dom.attach(m,"click",function(){OAT.ExportToPdf({grid:q},h)})}c.appendChild(j);g||(g=!0)}return g};this.appendExportToExcelOption=function(c,g){var h=this.query;if(""==h)try{h=q.controlName.substr(4).split("_")[0]}catch(k){}var j;if(q.QueryViewerCollection[q.IdForQueryViewerCollection].ExportToXLS){if(!gx.util.browser.isIE()||
9<gx.util.browser.ieVersion()){j=OAT.Dom.create("div");var l=q.createExportButton(j),m=OAT.Dom.create("label");OAT.addTextNode(m,gx.getMessage("GXPL_QViewerContextMenuExportXls2003"));m.htmlFor="pivot_checkbox_restoreview";j.appendChild(m);OAT.Dom.attach(l,"click",function(){q.serverPaging?OAT_JS.grid.getAllDataRowsForExport(q.UcId,{grid:q},h,"xls"):OAT.ExportToExcel({grid:q},h)})}else j=document.createElement("div"),j.style.marginBottom="10px",exportXLSButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",
position:"relative",cssFloat:"left"}),exportXLSButtonSub.setAttribute("id","divtoxls"),setTimeout(function(){jQuery("#divtoxls").downloadify({filename:function(){return h+".xls"},data:function(){return OAT.ExportToExcel({grid:q})},onComplete:function(){},onCancel:function(){},onError:function(){},swf:gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),downloadImage:gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/images/download_file.png"),width:21,
height:21,transparent:!0,append:!1})},100),j.appendChild(exportXLSButtonSub),m=OAT.Dom.create("label"),OAT.addTextNode(m,gx.getMessage("GXPL_QViewerContextMenuExportXls2003")),m.style.paddingLeft="9px",m.htmlFor="pivot_checkbox_restoreview",j.appendChild(m);c.appendChild(j);g||(g=!0)}return g};this.appendExportToExcel2010Option=function(c,g){var h=this.query;if(""==h)try{h=q.controlName.substr(4).split("_")[0]}catch(k){}var j;if(q.QueryViewerCollection[q.IdForQueryViewerCollection].ExportToXLSX){if(!gx.util.browser.isIE()||
9<gx.util.browser.ieVersion()){j=OAT.Dom.create("div");var l=q.createExportButton(j),m=OAT.Dom.create("label");OAT.addTextNode(m,gx.getMessage("GXPL_QViewerContextMenuExportXlsx"));m.htmlFor="pivot_checkbox_restoreview";j.appendChild(m);OAT.Dom.attach(l,"click",function(){q.serverPaging?OAT_JS.grid.getAllDataRowsForExport(q.UcId,{grid:q},h,"xlsx"):OAT.ExportToExcel2010({grid:q},h)})}else j=document.createElement("div"),j.style.marginBottom="10px",exportXLSButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",
position:"relative",cssFloat:"left"}),exportXLSButtonSub.setAttribute("id","divtoxlsx"),setTimeout(function(){jQuery("#divtoxlsx").downloadify({filename:function(){return h+".xlsx"},data:function(){return OAT.ExportToExcel2010({grid:q})},onComplete:function(){},onCancel:function(){},onError:function(){},dataType:"base64",swf:gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),downloadImage:gx.util.resourceUrl(q.relativePath+"QueryViewer/oatPivot/images/download_file.png"),
width:21,height:21,transparent:!0,append:!1})},100),j.appendChild(exportXLSButtonSub),m=OAT.Dom.create("label"),OAT.addTextNode(m,gx.getMessage("GXPL_QViewerContextMenuExportXlsx")),m.style.paddingLeft="9px",m.htmlFor="pivot_checkbox_restoreview",j.appendChild(m);c.appendChild(j);g||(g=!0)}return g};this.createExportButton=function(c){var g=OAT.Dom.create("div",{});g.setAttribute("id","divtoxml");c.appendChild(g);q.isSD?g.setAttribute("class","download_file_img_small"):g.setAttribute("class","download_file_img");
OAT.addImageNode(g,"save_alt","");c.setAttribute("class","export_item_div");q.isSD&&c.setAttribute("class","export_item_div export_item_div_small");return c};this.clearData=function(){q.rows=[];OAT.Dom.clear(q.rowBlock)};this.appendHeader=function(c,g,h){h=!h?q.header.cells.length:h;c=q.header.addCell(c,"character",h,g);for(h=0;h<q.header.cells.length;h++)q.header.cells[h].number=h;return c};this.ieFix=function(){for(var c=0;c<q.header.cells.length;c++){var g=q.header.cells[c].html;OAT.Dom.addClass(g,
"hover");OAT.Dom.removeClass(g,"hover");OAT.Dom.getWH(q.header.cells[c].value)}};this.createHeader=function(c,g){q.header.clear();for(var h=0;h<c.length;h++)q.appendHeader(c[h],g[h]);OAT.Browser.isIE&&q.ieFix()};this.getHeaders=function(){for(var c=[],g=0;g<q.header.cells.length;g++)c.push(q.header.cells[g].value.textContent);return c};this.createRow=function(c,g,h,k,j,l,m,n,o,r){var n=!o?q.rows.length:o,t=new OAT.GridRow(q,n);o==n||n==q.rows.length?q.rowBlock.appendChild(t.html):q.rowBlock.insertBefore(t.html,
q.rowBlock.childNodes[n]);OAT.underRecursionStyle=[];for(var u=0;u<c.length;u++)t.addCell(c[u],g[u],h,k[u],j,l,m,u,o,r[u]);q.rows.splice(n,0,t);return t.html};this.loadDifferentValues=function(c,g){q.conditions[c].differentValue=[];for(var h=0;h<g.length;h++)q.conditions[c].differentValue.push(g[h])};this.removeAllRows=function(){for(var c=q.rows.length,g=0;g<c;g++)q.removeRow(0)};this.removeAllHiddenRows=function(){for(var c=q.rows.length-1;0<c&&"none"==q.rows[c].html.style.display;)q.removeRow(c),
c--};this.removeAllCollapseRows=function(){for(var c=q.rows.length-1;0<c&&"collapse"==q.rows[c].html.style.visibility;)q.removeRow(c),c--};this.removeRow=function(c){jQuery(q.rows[c].html).remove();q.rows.splice(c,1)};this.removeColumn=function(c){q.header.removeColumn(c);for(var g=0;g<q.rows.length;g++)q.rows[g].removeColumn(c)};this.hideColumnHeader=function(c){q.header.cells[c].html.style.display="none"};this.showColumnHeader=function(c){q.header.cells[c].html.style.display=""};this.sort=function(c,
g,h){for(var k=0;k<q.header.cells.length;k++)q.conditions[k].sort=1,q.header.cells[k].changeSort(OAT.GridData.SORT_NONE);q.conditions[c].sort=g;q.header.cells[h].changeSort(g);var k=q.header.cells[h].options.type,j,l;switch(g){case OAT.GridData.SORT_ASC:j=1;l=-1;break;case OAT.GridData.SORT_DESC:j=-1,l=1}var g=OAT_JS.grid.gridData[q.UcId].customOrderValues&&!1!=OAT_JS.grid.gridData[q.UcId].customOrderValues[c]&&0<OAT_JS.grid.gridData[q.UcId].customOrderValues[c].length,h=function(g,h){var k=g.cells[c].options.value,
m=h.cells[c].options.value;return k==m?0:parseFloat(k)>parseFloat(m)?j:l},m=function(g,h){var k=g.cells[c].options.value,m=h.cells[c].options.value;return k==m?0:k>m?j:l},n=function(g,h){var k=h.cells[c].options.value,m=OAT_JS.grid.gridData[q.UcId].customOrderValues[c].indexOf(g.cells[c].options.value),k=OAT_JS.grid.gridData[q.UcId].customOrderValues[c].indexOf(k);return m==k?0:m>k?j:l},o;if(q.rows.length&&!q.serverPaging){var r=q.rows[0].cells[c].options.value;switch(k){case OAT.GridData.TYPE_STRING:o=
m;break;case OAT.GridData.TYPE_NUMERIC:o=h;break;case OAT.GridData.TYPE_AUTO:o=r==parseFloat(r)?h:m}g&&(o=n);q.rows.sort(o);for(k=0;k<q.rows.length;k++)q.rowBlock.appendChild(q.rows[k].html),o=q.rows[k].html,OAT.Dom.removeClass(o,"WorkWithEven"),OAT.Dom.removeClass(o,"WorkWithOdd"),OAT.Dom.addClass(q.rows[k].html,k%2?"WorkWithEven":"WorkWithOdd")}};this.applySaveState=function(c){if(q.rememberLayout&&"false"!=q.rememberLayout&&(q=this,OAT.getState(q,c))){OAT.filterRows(q);for(c=0;c<q.columnsDataType.length;c++)1!=
q.conditions[c].sort&&q.sort(c,q.conditions[c].sort,c)}};this.applySortOrderType=function(c,g){q.sort(c,g,c)};this.applyCustomSort=function(c,g,h){for(var k=[],j=0;j<g.childNodes.length;j++)if(void 0!=g.childNodes[j]&&void 0!=g.childNodes[j].localName&&"customOrder"===g.childNodes[j].localName)for(var l=0;l<g.childNodes[j].childNodes.length;l++)"Value"==g.childNodes[j].childNodes[l].localName&&k.push(g.childNodes[j].childNodes[l].textContent.trimpivot());for(g=0;g<h.length;g++)-1==k.indexOf(h[g][c].trimpivot())&&
k.push(h[g][c]);g=h;h=[];for(j=0;j<k.length;j++)for(l=0;l<g.length;l++)g[l][c].trimpivot()===k[j].trimpivot()&&h.push(g[l]);return[h,k]};this.applyCustomFilter=function(c,g){try{for(var h=[],k=!1,j=0;j<g.childNodes.length;j++)if(void 0!=g.childNodes[j]&&void 0!=g.childNodes[j].localName&&"include"===g.childNodes[j].localName)for(var k=!0,l=0;l<g.childNodes[j].childNodes.length;l++)null!=g.childNodes[j].childNodes[l].localName&&"value"===g.childNodes[j].childNodes[l].localName.toLowerCase()&&h.push(g.childNodes[j].childNodes[l].textContent);
if(k){q.conditions[c].blackList=[];var m=OAT_JS.grid.gridData[q.UcId].columnDataField[c];OAT_JS.grid.gridData[q.UcId].blackLists[m].state="";OAT_JS.grid.gridData[q.UcId].blackLists[m].defaultAction="Exclude";OAT_JS.grid.gridData[q.UcId].blackLists[m].hiddens=[];for(k=0;k<h.length;k++)"TOTAL"!=h[k]&&OAT_JS.grid.gridData[q.UcId].blackLists[m].visibles.push(h[k]);for(k=0;k<q.rows.length;k++)m=c,-1===h.findIndex(q.rows[k].cells[m].options.value)&&(-1===h.findIndex(q.rows[k].cells[m].options.value.trimpivot())&&
-1===q.conditions[m].blackList.findIndex(q.rows[k].cells[m].options.value))&&(q.conditions[m].blackList.push(q.rows[k].cells[m].options.value),OAT.HideGridRow({grid:q},c,q.rows[k].cells[c].options.value),OAT.actualizeBlackList("push",q,c,q.rows[k].cells[c].options.value,!1))}}catch(n){}};this.moveToNextPage=function(){q.oat_component.moveToNextPage(q.UcId)};this.moveToFirstPage=function(){q.oat_component.moveToFirstPage(q.UcId)};this.moveToLastPage=function(){q.oat_component.moveToLastPage(q.UcId)};
this.moveToPreviousPage=function(){q.oat_component.moveToPreviousPage(q.UcId)};this.selectValue=function(c){OAT_JS.grid.gridData[q.UcId].selection.SelectedNode=[];OAT.ClearSelectedNodes(jQuery(q.html));var g=OAT_JS.grid.gridData[q.UcId].columnDataField.indexOf(c[0].DataField);OAT.SelectNodes({grid:q},c[0].Value,!1,g,-1,0,c)};this.deselectValue=function(){OAT_JS.grid.gridData[q.UcId].selection.SelectedNode=[];OAT.ClearSelectedNodes(jQuery(q.html))};this.refreshPivot=function(c,g){if(""!=c&&""!=g){var h=
(new DOMParser).parseFromString(c,"text/xml"),k=h.getElementsByTagName("OLAPDimension");q.serverPaging||OAT.RestoreGridRow({grid:q});for(var j="",l="",m=[],n=0;n<k.length;n++){for(var o=k[n].getElementsByTagName("name")[0].childNodes[0].nodeValue,r=-1,t=-1,u=0;u<q.columns.length;u++)if(q.columns[u].attributes.getNamedItem("name").nodeValue===o)for(var v=q.columns[u].attributes.getNamedItem("displayName").nodeValue,w=0;w<q.header.cells.length;w++)q.header.cells[w].options.value===v&&(r=q.header.cells.length-
1-w,t=w);if(-1!=r){u="none"===k[n].getElementsByTagName("condition")[0].childNodes[0].nodeValue?"none":"";q.header.cells[t].html.style.display=u;for(o=0;o<q.rows.length;o++)q.rows[o].cells[r].html.style.display=u;q.serverPaging&&OAT_JS.grid.setColumnVisibleValue(q.UcId,t,""==u);try{if(q.serverPaging){var x=OAT_JS.grid.gridData[q.UcId].columnDataField[t];m[parseInt(k[n].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=x}}catch(z){}q.serverPaging&&(x=OAT_JS.grid.gridData[q.UcId].columnDataField[t],
OAT_JS.grid.updateFilterInfo(q.UcId,x,{op:"all",values:[]}));o=k[n].getElementsByTagName("order")[0].childNodes[0].nodeValue;"ascending"==o&&3==q.conditions[r].sort?(q.sort(r,OAT.GridData.SORT_ASC,t),l="Ascending",j=k[n].getElementsByTagName("dataField")[0].childNodes[0].nodeValue):"descending"==o&&3!=q.conditions[r].sort&&(q.sort(r,OAT.GridData.SORT_DESC,t),l="Descending",j=k[n].getElementsByTagName("dataField")[0].childNodes[0].nodeValue);u=k[n].getElementsByTagName("hide")[0].childNodes;for(v=
0;v<u.length;v++)if("value"===u[v].tagName)if(q.serverPaging){x=OAT_JS.grid.gridData[q.UcId].columnDataField[t];w=OAT_JS.grid.gridData[q.UcId].differentValues[x];for(o=0;o<w.length;o++)w[o].trimpivot()==u[v].textContent&&OAT_JS.grid.updateFilterInfo(q.UcId,x,{op:"push",values:w[o]})}else if(-1===q.conditions[r].blackList.findIndex(u[v].textContent))for(o=0;o<q.rows.length;o++)if(q.rows[o].cells[r].options.value.toString().trimpivot()==u[v].textContent){q.conditions[n].blackList.push(q.rows[o].cells[r].options.value);
break}}}q.serverPaging?(m.length!=OAT_JS.grid.gridData[q.UcId].columnDataField.length&&(m=[]),h.getElementsByTagName("OLAPDimension"),OAT_JS.grid.refreshPivotWhenServerPagination(q.UcId,j,l,m)):(OAT.filterRows(q),OAT.saveState({grid:q},!0,-1))}};this.getDataXML=function(){if(q.serverPaging)spl=q.IdForQueryViewerCollection,c=q.QueryViewerCollection[spl].getPivottableDataSync().split("<Recordset")[1],c="<Recordset"+c;else{for(var c='<OLAPData format="adonet">\n <Table>\n',g=0;g<q.rows.length;g++){for(var c=
c+"  <Record>\n",h=0;h<q.columns.length;h++)c=c+"   <"+q.columns[h].getAttribute("dataField")+">",c+=q.rows[g].cells[h].options.value,c=c+"</"+q.columns[h].getAttribute("dataField")+">\n";c+="  </Record>\n"}c+=" </Table>\n</OLAPData>"}return c};this.getFilteredDataXML=function(){if(q.serverPaging)return OAT_JS.grid.getTableWhenServerPagination(q.UcId);for(var c="<Table>\n",g=0;g<q.rows.length;g++)if("none"!=q.rows[g].html.style.display||void 0==q.rows[g].html.getAttribute("visibq")||"tt"==q.rows[g].html.getAttribute("visibq")){for(var c=
c+"  <Record>\n",h=0;h<q.columns.length;h++)c=c+"   <"+q.columns[h].getAttribute("dataField")+">",c+=q.rows[g].cells[h].options.value,c=c+"</"+q.columns[h].getAttribute("dataField")+">\n";c+="  </Record>\n"}return c+"</Table>\n"};this.getMetadataXML=function(){for(var c='<OLAPCube format="compact" thousandsSeparator="," decimalSeparator="." dateFormat="MDY">',g=0;g<q.columns.length;g++){for(var h=void 0!=q.columns[g].getAttribute("isMeasure"),c=h?c+"<OLAPMeasure> ":c+"<OLAPDimension> ",c=c+OAT.createXMLDimensionInfo(q,
g),k=0,j=0;j<q.header.cells.length;j++)q.header.cells[j].dataField==q.columns[g].getAttribute("dataField")&&(k=j,"none"==q.header.cells[j].html.style.display&&(c+="<hidden>true</hidden>"));for(var c=""===q.columns[g].getAttribute("picture")?c+"<picture/> ":c+"<picture>"+q.columns[g].getAttribute("picture")+"</picture> ",c=""===q.columns[g].getAttribute("format")?c+"<format/> ":c+"<format>"+q.columns[g].getAttribute("format")+"</format> ",j=0,l=!1,m=-1,n=0;n<OAT_JS.grid.gridData[q.UcId].columnDataField.length&&
!l;n++){for(var o=OAT_JS.grid.gridData[q.UcId].columnDataField[n],r=!1,t=0;t<q.columns.length;t++)o==q.columns[t].getAttribute("dataField")&&(r="never"==q.columns[t].getAttribute("visible").toLowerCase());r||(j+=1);o==q.columns[g].getAttribute("dataField")&&(l=!0,r||(m=j))}c=0<m?c+"<position>"+m+"</position> ":c+"<position/>";c=OAT_JS.grid.gridData[q.UcId].dataFieldOrder==q.columns[g].getAttribute("dataField")?"Descending"==OAT_JS.grid.gridData[q.UcId].orderType?c+"<order>descending</order> ":c+"<order>ascending</order> ":
c+"<order>none</order> ";c+="<customOrder/> ";c+="<include> ";j=[];for(l=0;l<q.rows.length;l++)void 0!=q.rows[l].cells[k]&&(-1===j.findIndex(q.rows[l].cells[k].options.value)&&-1===q.conditions[g].blackList.findIndex(q.rows[l].cells[k].options.value))&&(c=c+"<value>"+q.rows[l].cells[k].options.value+"</value> ",j.push(q.rows[l].cells[k].options.value));c+="<value>TOTAL</value> </include> <collapse/> ";c=h?c+"</OLAPMeasure>":c+" </OLAPDimension>"}return c+"</OLAPCube>"};q.init();setInterval(function(){if(0<
jQuery("#"+q.controlName).length&&"oatgrid"===jQuery("#"+q.controlName)[0].getAttribute("class")){var c=0;if(0<jQuery("#"+q.controlName+"tablePagination_rowsPerPage").length){if(OAT_JS.grid.gridData[q.UcId].autoResize)g=jQuery("#"+q.controlName)[0].clientWidth;else{var g=jQuery("#"+q.ContainerName)[0].clientWidth;jQuery("#"+q.controlName).css({width:g+"px"})}c=parseInt(jQuery("#"+q.controlName+"tablePagination_rowsPerPage")[0].value);if(!isNaN(c))if(q.rowsPerPage!=c){var h=""!=q.rowsPerPage;q.rowsPerPage=
c;c={grid:q};h&&OAT.saveState(c,!1)}else q.rowsPerPage=c;h=g;jQuery("#"+q.controlName+"_tablePagination").css({width:h+"px"});jQuery("#"+q.controlName+"_grid_top_div").css({width:h+"px"});h=jQuery("#"+q.controlName)[0].clientWidth;if(h>g+10||0<jQuery("#"+q.controlName).closest(".gxwebcomponent").length)jQuery("#"+q.controlName+"_tablePagination").css({width:h+1+"px"}),jQuery("#"+q.controlName+"_grid_top_div").css({width:h+1+"px"})}else OAT_JS.grid.gridData[q.UcId].autoResize?g=jQuery("#"+q.controlName)[0].clientWidth:
(g=jQuery("#"+q.ContainerName)[0].clientWidth,jQuery("#"+q.controlName).css({width:g+"px"})),h=g,jQuery("#"+q.controlName+"_grid_top_div").css({width:h+"px"}),jQuery(".oatgrid").css({marginBottom:"0px"}),h=jQuery("#"+q.controlName)[0].clientWidth,(h>g+10||0<jQuery("#"+q.controlName).closest(".gxwebcomponent").length)&&jQuery("#"+q.controlName+"_grid_top_div").css({width:h+1+"px"});jQuery(".divIeContainer").css({opacity:"1"});if(500>jQuery("#"+q.controlName+" tr").length)for(h=g=1;h<jQuery("#"+q.controlName+
" tr").length;h++)"none"!=jQuery("#"+q.controlName+" tr")[h].style.display&&(1===g%2?jQuery("#"+q.controlName+" tr")[h].className="odd":jQuery("#"+q.controlName+" tr")[h].className="even",g++);0<jQuery("#"+q.controlName+"tablePagination_rowsPerPage").length&&0===q.QueryViewerCollection.length&&jQuery(".pivot_pag_div").css({marginBottom:"0px"})}},150)};OAT.GridHeader=function(c,g){var h=this;this.cells=[];this.grid=c;this.html=g?g:OAT.Dom.create("thead");this.container=OAT.Dom.create("tr");this.html.appendChild(h.container);
this.clear=function(){OAT.Dom.clear(h.container);h.cells=[]};this.addCell=function(c,g,l,n){c=new OAT.GridHeaderCell(h.grid,c,l,n);g=h.container.childNodes;g.length&&l<g.length?h.container.insertBefore(c.html,g[l]):h.container.appendChild(c.html);h.cells.splice(l,0,c);return c};h.removeColumn=function(c){OAT.Dom.unlink(h.cells[c].html);h.cells.splice(c,1);for(c=0;c<h.cells.length;c++)h.cells[c].number=c}};OAT.GridHeaderCell=function(c,g,h,j){var k=this;this.options={value:"",sortable:1,align:OAT.GridData.ALIGN_LEFT,
sort:OAT.GridData.SORT_NONE,type:OAT.GridData.TYPE_AUTO};var g="object"==typeof g?g:{value:g},l;for(l in g)k.options[l]=g[l];this.changeSort=function(c){k.options.sort=c;k.updateSortImage()};this.updateSortImage=function(){if(k.sorter){var c="none";switch(k.options.sort){case OAT.GridData.SORT_NONE:c="none";break;case OAT.GridData.SORT_ASC:c="asc";break;case OAT.GridData.SORT_DESC:c="desc"}k.sorter.className="table-sort-image table-sort-"+c;jQuery(k.sorter).find("i")[0].textContent="none"==c?"":"asc"==
c?"arrow_drop_up":"arrow_drop_down"}};this.signal=0;this.number=h;this.grid=c;this.dataField=j;this.html=OAT.Dom.create("td");this.container=OAT.Dom.create("div",{position:"relative"});this.value=OAT.Dom.create("div",{overflow:"hidden"});OAT.Dom.addClass(k.value,"header_value");OAT.Dom.append([k.html,k.container],[k.container,k.value]);OAT.addTextNode(this.value,g.value.replace(/ /g," "));this.value.setAttribute("title_v",g.value);this.value.setAttribute("dataField",j);this.html.setAttribute("title_v",
g.value);this.html.setAttribute("dataField",j);if(k.options.sortable){k.html.style.cursor="pointer";k.sorter=OAT.Dom.create("div",{});OAT.addImageNode(k.sorter,"arrow_drop_up","");k.container.appendChild(k.sorter);k.updateSortImage();var n;n=gx.util.browser.isIE()?c.isSD?OAT.Dom.create("div","","oatfilterwindowGrid oatfilterwindow_small"):OAT.Dom.create("div","","oatfilterwindowGrid"):c.isSD?OAT.Dom.create("div","","oatfilterwindow oatfilterwindow_small"):OAT.Dom.create("div","","oatfilterwindow");
OAT.Anchor.assign(k.container,{title:" ",content:n,result_control:!1,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(k.grid.QueryViewerCollection[IdForQueryViewerCollection])+" FilterPopup "});OAT.Event.attach(k.container,"click",function(c){var g=OAT.GridData.SORT_NONE;switch(k.options.sort){case OAT.GridData.SORT_NONE:g=OAT.GridData.SORT_ASC;break;case OAT.GridData.SORT_ASC:g=OAT.GridData.SORT_DESC;break;case OAT.GridData.SORT_DESC:g=OAT.GridData.SORT_ASC}if(k.grid.serverPaging)if(0==
OAT_JS.grid.gridData[k.grid.UcId].differentValuesPaginationInfo[j].previousPage){OAT_JS.grid.initValueRead(k.grid.UcId,0,j);jQuery(".oat_winrect_container").css({left:"-10000000px",top:"-10000000px"});var h=jQuery.extend(!0,{},c),l=function(){0==OAT_JS.grid.gridData[k.grid.UcId].differentValuesPaginationInfo[j].previousPage?setTimeout(l,100):OAT.showPopup(h,k,g,n)};l()}else OAT.showPopup(c,k,g,n);else OAT.showPopup(c,k,g,n)})}switch(k.options.align){case OAT.GridData.ALIGN_LEFT:k.html.style.textAlign=
"left";break;case OAT.GridData.ALIGN_CENTER:k.html.style.textAlign="center";break;case OAT.GridData.ALIGN_RIGHT:k.html.style.textAlign="right"}OAT.Event.attach(k.html,"mouseover",function(){OAT.Dom.addClass(k.html,"hover")});OAT.Event.attach(k.html,"mouseout",function(){OAT.Dom.removeClass(k.html,"hover")})};OAT.GridRow=function(c,g){var h=this;this.clear=function(){OAT.Dom.clear(h.html);h.cells=[]};this.removeColumn=function(c){OAT.Dom.unlink(h.cells[c].html);h.cells.splice(c,1)};this.isDecimal=
function(c){return c.match(/^[0-9]+(\.[0-9]+)+$/)?!0:!1};this.addCell=function(c,g,l,n,o,m,r,t,u,v){u=!u?h.cells.length:u;void 0==c&&(c="");g=new OAT.GridRowCell(c,u,g,l,n,o,m,r,t,v);l=h.html.childNodes;l.length&&u!=l.length?(h.html.insertBefore(g.html,l[u]),v||(l[u].style.display="none")):(h.html.appendChild(g.html),v||(g.html.style.display="none"));OAT.setClickEventHandlers(h,l[l.length-1],c,"DIMENSION",t,h.grid.rows.length);h.cells.splice(u,0,g);return g.value};this.select=function(){h.selected=
1};this.deselect=function(){h.selected=0;OAT.Dom.removeClass(h.html,"selected")};this.grid=c;this.cells=[];this.html=OAT.Dom.create("tr");this.selected=0;OAT.Dom.addClass(h.html,g%2?"even":"odd");OAT.Event.attach(h.html,"mouseover",function(){OAT.Dom.addClass(h.html,"hover")});OAT.Event.attach(h.html,"mouseout",function(){OAT.Dom.removeClass(h.html,"hover")});OAT.Event.attach(h.html,"click",function(c){if(!c.shiftKey&&!c.ctrlKey)for(var g=0;g<h.grid.rows.length;g++){var l=h.grid.rows[g];l!=h&&l.deselect()}if(c.shiftKey){for(var n=
c=-1,o=0,g=0;g<h.grid.rows.length;g++)l=h.grid.rows[g],l!=h?(!o&&l.selected&&(c=g),!o&&-1!=c&&l.select(),o&&l.selected&&(n=g)):o=1;if(-1==c&&-1!=n)for(g=o=0;g<h.grid.rows.length;g++)l=h.grid.rows[g],l==h&&(o=1),o&&(l!=h&&g<n)&&l.select()}h.selected?h.deselect():h.select()})};OAT.GridRowCell=function(c,g,h,j,k,l,n,o,m){this.options={value:"",align:OAT.GridData.ALIGN_LEFT};g="object"==typeof c?c:{value:c};for(p in g)this.options[p]=g[p];this.html=OAT.Dom.create("td");this.container=OAT.Dom.create("div");
this.value=OAT.Dom.create("div",{overflow:"hidden"});OAT.Dom.addClass(this.value,"row_value");OAT.addTextNode(this.value,OAT.ApplyPictureValue(this.options.value,h,j,k).trim().replace(/ /g," "));g=this.options.value;"date"==h&&(g=OAT.ApplyPictureValue(this.options.value,h,j,k));this.html=OAT.applyFormatValues(this.html,g,h,m,n,l,o,j);this.html.setAttribute("title",OAT.ApplyPictureValue(this.options.value,h,j,k));OAT.Dom.append([this.html,this.container],[this.container,this.value]);this.html.setAttribute("sin_pictureValue",
c);if("character"!=h&&"guid"!=h&&(isNaN(this.options.value)||(this.options.align=3),this.options.value))this.options.align=3;"date"===h&&(this.options.align=OAT.GridData.ALIGN_RIGHT);switch(this.options.align){case OAT.GridData.ALIGN_LEFT:this.html.style.textAlign="left";break;case OAT.GridData.ALIGN_CENTER:this.html.style.textAlign="center";break;case OAT.GridData.ALIGN_RIGHT:this.html.style.textAlign="right"}};OAT.underRecursionStyle=[];OAT.applyFormatValues=function(c,g,h,j,k,l,n){n=n[j];null!=
n&&""!=n&&(c=OAT.setStyleValues(c,n));if(0<OAT.underRecursionStyle.length)for(var o=0;o<OAT.underRecursionStyle.length;o++)c=OAT.setStyleValues(c,OAT.underRecursionStyle[o].format);for(o=0;o<k.length;o++)k[o].columnNumber==j&&k[o].value===g.trimpivot()&&(c=OAT.setStyleValues(c,k[o].format),void 0!=self.formatValues[o].recursive&&"yes"==self.formatValues[o].recursive&&OAT.underRecursionStyle.push(k[o]));for(var k=[],n=[],m=[],r=[],t=[],u=[],r=[],v=[],o=0;o<l.length;o++)if(l[o].columnNumber==j&&("equal"==
l[o].operation1&&(k[0]="real"===h||"integer"===h?parseFloat(l[o].value1):l[o].value1,k[1]=l[o].format),"notequal"==l[o].operation1&&(n[0]="real"===h||"integer"===h?parseFloat(l[o].value1):l[o].value1,n[1]=l[o].format),"less"==l[o].operation1&&(t[0]="real"===h||"integer"===h?parseFloat(l[o].value1):l[o].value1,t[1]=l[o].format),"lessequal"==l[o].operation1&&(u[0]="real"===h||"integer"===h?parseFloat(l[o].value1):l[o].value1,t[1]=l[o].format),"greater"==l[o].operation1&&(m[0]="real"===h||"integer"===
h?parseFloat(l[o].value1):l[o].value1,m[1]=l[o].format),"greaterequal"==l[o].operation1&&void 0==l[o].operation2&&(r[0]="real"===h||"integer"===h?parseFloat(l[o].value1):l[o].value1,m[1]=l[o].format),l[o].operation2&&"greaterequal"==l[o].operation1))v[0]="real"===h||"integer"===h?parseFloat(l[o].value1):l[o].value1,l[o].operation2&&"lessequal"==l[o].operation2&&(v[1]="real"===h||"integer"===h?parseFloat(l[o].value2):l[o].value2,v[2]=l[o].format);j=Array(3);"real"===h&&(g=parseFloat(g),void 0!=m[0]&&
""!=m[0]&&(j[0]=parseFloat(m[0])),void 0!=t[0]&&""!=t[0]&&(j[1]=parseFloat(t[0])),void 0!=v[0]&&""!=v[0]&&(j[2]=parseFloat(v[0])));"integer"===h&&(g=parseInt(g),void 0!=m[0]&&""!=m[0]&&(j[0]=parseInt(m[0])),void 0!=t[0]&&""!=t[0]&&(j[1]=parseInt(t[0])),void 0!=v[0]&&""!=v[0]&&(j[2]=parseInt(v[0])));if("date"===h){j=g.split("-");l=Array(3);l[0]=parseInt(j[0]);l[1]=parseInt(j[1]);l[2]=parseInt(j[2]);try{if(void 0!=k[0]||void 0!=r[0]||void 0!=u[0]){var x;void 0!=k[0]?x=k[0].split("-"):void 0!=r[0]?x=
r[0].split("-"):void 0!=r[0]&&(x=u[0].split("-"));var B=Array(3);B[1]=parseInt(x[1]);B[2]=parseInt(x[2]);B[0]=parseInt(x[0]);if(B[0]==l[0]||B[0]==l[0]&&B[1]==l[1])void 0!=k[1]?c=OAT.setStyleValues(c,k[1]):void 0!=m[1]?c=OAT.setStyleValues(c,m[1]):void 0!=t[1]&&(c=OAT.setStyleValues(c,t[1]))}if(void 0!=n[0]&&(x=n[0].split("-"),B=Array(3),B[1]=parseInt(x[1]),B[2]=parseInt(x[2]),B[0]=parseInt(x[0]),B[0]!=l[0]||B[0]!=l[0]&&B[1]!=l[1]))c=OAT.setStyleValues(c,n[1]);if(void 0!=m[0]||void 0!=r[0])if(x=void 0!=
m[0].split("-")?m[0].split("-"):r[0].split("-"),B[1]=parseInt(x[1]),B[2]=parseInt(x[2]),B[0]=parseInt(x[0]),B[0]<l[0]||B[0]<=l[0]&&B[1]<l[1]||B[0]<=l[0]&&B[1]<=l[1]&&B[2]<l[2])c=OAT.setStyleValues(c,m[1]);if(void 0!=t[0]||void 0!=u[0])if(x=void 0!=t[0].split("-")?t[0].split("-"):u[0].split("-"),B=Array(3),B[1]=parseInt(x[1]),B[2]=parseInt(x[2]),B[0]=parseInt(x[0]),B[0]>l[0]||B[0]>=l[0]&&B[1]>l[1]||B[0]>=l[0]&&B[1]>=l[1]&&B[2]>l[2])c=OAT.setStyleValues(c,t[1]);if(void 0!=v[0]&&void 0!=v[1]){x=v[0].split("-");
var H=v[1].split("-"),B=Array(3);cmparElements2=Array(3);B[1]=parseInt(x[1]);B[2]=parseInt(x[2]);B[0]=parseInt(x[0]);cmparElements2[1]=parseInt(H[1]);cmparElements2[2]=parseInt(H[2]);cmparElements2[0]=parseInt(H[0]);if((B[0]<=l[0]||B[0]<=l[0]&&B[1]<l[1]||B[0]<=l[0]&&B[1]<=l[1]&&B[2]<l[2])&&(cmparElements2[0]>l[0]||cmparElements2[0]>=l[0]&&cmparElements2[1]>l[1]||cmparElements2[0]>=l[0]&&cmparElements2[1]>=l[1]&&cmparElements2[2]>l[2]))c=OAT.setStyleValues(c,v[2])}}catch(w){}}if("date"!=h){void 0!=
k[0]&&g==k[0]&&(c=OAT.setStyleValues(c,k[1]));void 0!=n[0]&&g!=n[0]&&(c=OAT.setStyleValues(c,n[1]));if(void 0!=m[0]&&g>m[0]||void 0!=r[0]&&g>=r[0])c=OAT.setStyleValues(c,m[1]);if(void 0!=t[0]&&g<t[0]||void 0!=u[0]&&g<=u[0])c=OAT.setStyleValues(c,t[1]);void 0!=v[0]&&void 0!=v[1]&&(g>=v[0]&&g<=v[1])&&(c=OAT.setStyleValues(c,v[2]))}return c};OAT.setStyleValues=function(c,g){function h(c){c=c.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(c,g,h,k){return g+g+h+h+k+k});return(c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c))?
{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null}if(void 0==g)return c;for(var j=g.split(";"),k=0;k<j.length;k++){var l=j[k].split(":");switch(l[0]){case "color":c.style.color=void 0!=l[1][0]&&"#"===l[1][0]?"rgb("+h(l[1]).r+","+h(l[1]).g+","+h(l[1]).b+")":l[1];break;case "fontStyle":c.style.fontStyle=l[1];break;case "backgroundColor":c.style.backgroundColor=l[1];break;case "textDecoration":c.style.textDecoration=l[1];break;case "fontWeight":c.style.fontWeight=l[1];break;case "fontFamily":c.style.fontFamily=
l[1];break;case "fontVariant":c.style.fontVariant=l[1];break;case "fontSize":c.style.fontSize=l[1].replace("px","")+"px";break;case "textAlign":c.style.textAlign=l[1];break;case "lineHeight":c.style.lineHeight=l[1];break;case "textIndent":c.style.textIndent=l[1];break;case "verticalAlign":c.style.verticalAlign=l[1];break;case "wordSpacing":c.style.wordSpacing=l[1];break;case "display":c.style.display=l[1];break;case "borderThickness":c.style.borderThickness=l[1];c.style.borderWidth=l[1]+"px";break;
case "borderColor":c.style.borderColor=l[1];break;case "borderWith":c.style.borderWith=l[1];break;case "borderStyle":c.style.borderStyle=l[1];break;case "padding":c.style.padding=l[1];break;case "paddingBottom":c.style.paddingBottom=l[1];break;case "paddingLeft":c.style.paddingLeft=l[1];break;case "paddingRight":c.style.paddingRight=l[1];break;case "paddingTop":c.style.paddingTop=l[1]}}return c};OAT.GenerateFormatDateForGrid=function(c,g){g.split(" ");var h=c[0].split("-"),j="";switch(g){case "99/99/9999":j=
h[1]+"/"+h[2]+"/"+h[0];break;case "99/99/99":4==h[0].length&&(h[0]=h[0].substr(h[0].length-2,2));j=h[1]+"/"+h[2]+"/"+h[0];break;default:j=h[2]+"/"+h[1]+"/"+h[0]}return j};OAT.HideGridRow=function(c,g,h){for(var j=0;j<c.grid.rows.length;j++)c.grid.rows[j].cells[g].options.value.toString().trimpivot()===h.toString().trimpivot()&&(c.grid.rows[j].html.style.display="none",c.grid.rows[j].html.setAttribute("visibQ","tf"))};OAT.ShowGridRow=function(c,g,h){for(var j=0;j<c.grid.rows.length;j++)c.grid.rows[j].cells[g].options.value.toString().trimpivot()===
h.toString().trimpivot()&&(c.grid.rows[j].html.style.display="",c.grid.rows[j].html.setAttribute("visibQ","tt"))};OAT.RestoreGridRow=function(c){for(var g=0;g<c.grid.rows.length;g++)c.grid.rows[g].html.style.display="",c.grid.rows[g].html.setAttribute("visibQ","tt");for(g=0;g<c.grid.columnsDataType.length;g++)c.grid.conditions[g].blackList=[]};OAT.RestoreGridOrder=function(c){c.grid.sort(0,2,c.grid.columnsDataType.length-1-0);c.grid.sort(0,1,c.grid.columnsDataType.length-1-0)};OAT.RestoreGridColumns=
function(c){for(var g=0;g<c.grid.columnsDataType.length;g++){c.grid.header.cells[g].html.style.display="";for(var h=0,j=c.grid.columnsDataType.length-1-g,h=0;h<c.grid.rows.length;h++)c.grid.rows[h].cells[j].html.style.display=""}};OAT.CreateGridRow=function(c,g,h){for(var j=[],k=[],l=[],n=[],o=[],m=0;m<g.columnDataField.length;m++){var r=g.originalColumnDataField.indexOf(g.columnDataField[m]);j[m]=c[r];k[m]=g.rowsMetadata.columnsDataType[r];l[m]=g.rowsMetadata.forPivotCustomPicture[r];n[m]=g.rowsMetadata.forPivotCustomFormat[r];
o[m]=g.columnVisible[r]}c=g.grid.createRow(j,k,g.rowsMetadata.defaultPicture,l,g.rowsMetadata.conditionalFormatsColumns,g.rowsMetadata.formatValues,n,g.rowsMetadata.columns,null,o);h&&(c.style.visibility="collapse")};OAT.filterRows=function(c){for(var g={grid:c},h=0;h<c.columnsDataType.length;h++)for(var j=0;j<c.conditions[h].blackList.length;j++)OAT.HideGridRow(g,h,c.conditions[h].blackList[j]),OAT.actualizeBlackList("push",c,h,c.conditions[h].blackList[j],!1)};OAT.actualizeBlackList=function(c,
g,h,j,k){if(!k)for(k=0;k<g.rows.length;k++)if(g.rows[k].cells[h].options.value===j)for(var l=0;l<g.rows[0].cells.length;l++)if(l!=h){for(var n=g.rows[k].cells[l].options.value,o=0,m=0;m<g.rows.length;m++)if(g.rows[m].cells[l].options.value===n&&("none"!=g.rows[m].html.style.display||"tf"!=g.rows[m].html.getAttribute("visibQ")))o+=1;m=g.conditions[l].blackList.findIndex(n);0===o?"push"===c&&-1===m&&g.conditions[l].blackList.push(n):"pop"===c&&-1!=m&&g.conditions[l].blackList.splice(m,1)}"push"===c?
-1===g.conditions[h].blackList.indexOf(j)&&g.conditions[h].blackList.push(j):(m=g.conditions[h].blackList.indexOf(j),-1!=m&&g.conditions[h].blackList.splice(m,1))};OAT.showPopup=function(c,g,h,j){var h=[],k=function(){jQuery(".oat_winrect_container").css({display:"none"})},l=g.number;if(OAT_JS.grid.gridData[g.grid.UcId].redrawHeader)for(var n=0,o=0;o<g.grid.columns.length;o++)OAT_JS.grid.gridData[g.grid.UcId].columnVisible[o]&&(n+=1),g.grid.columns[o].getAttribute("dataField")==g.dataField&&(l=n-
1);g.grid.isSD?jQuery(".oat_winrect_container").css({left:"-1500px",top:jQuery(c.currentTarget).offset().top+"px"}):jQuery(".oat_winrect_container").css({left:jQuery(c.currentTarget).offset().left+"px",top:jQuery(c.currentTarget).offset().top+"px"});OAT.Dom.clear(j);h.push(j);jQuery(".oat_winrect_title").find(".winrect_title_label").remove();c=OAT.Dom.create("label");g.grid.isSD?(jQuery(".oat_winrect_container").addClass("oat_winrect_container_small"),c.setAttribute("class","winrect_title_label winrect_title_label_small")):
c.setAttribute("class","winrect_title_label");j=g.grid.columns[l].getAttribute("displayName");for(n=0;n<g.grid.columns.length;n++)g.dataField==g.grid.columns[n].getAttribute("dataField")&&(j=g.grid.columns[n].getAttribute("displayName"));OAT.addTextNode(c,j);jQuery(".oat_winrect_title").append(c);c=Math.floor(1E4*Math.random());if(!g.grid.disableColumnSort){j=document.createElement("div");j.setAttribute("class","first_popup_subdiv");n=OAT.Dom.radio("order");o="pivot_order_asc_"+g.grid.ContainerName+
"_"+g.grid.TableDataFilds[g.number]+c;n.id=o;n.checked=2===g.grid.conditions[l].sort;OAT.Dom.attach(n,"change",function(){});OAT.Dom.attach(n,"click",function(){var c=g.grid.conditions[l].sort;g.grid.sort(l,OAT.GridData.SORT_ASC,g.number);var h=g.grid.conditions[l].sort;OAT.saveState(g,true);if(qv.util.isGeneXusPreview()&&h!=c&&c!=OAT.GridData.SORT_NONE)try{var k='<DATA event="OrderChanged" name="'+g.grid.columns[g.number].getAttribute("name")+'" displayName="'+g.grid.columns[g.number].getAttribute("displayName")+
'"  order="ascending">';window.external.SendText(qv.collection[OAT_JS.grid.gridData[UcId].IdForQueryViewerCollection].ControlName,k+"</DATA>")}catch(j){}if(g.grid.serverPaging){c=g.container.parentNode.cellIndex;self.getDataForTable(g.grid.UcId,1,g.grid.rowsPerPage,false,c<0?g.dataField:OAT_JS.grid.gridData[g.grid.UcId].columnDataField[c],"Ascending","","")}c="i_"+this.getAttribute("id");document.getElementById(c).textContent="radio_button_checked";document.getElementById(c.replace("asc","desc")).textContent=
"radio_button_unchecked"});j.appendChild(n);var m=OAT.Dom.create("label");m.htmlFor=o;n=gx.util.browser.isIE()?"top:-10px;":"";OAT.addImageNode(m,2===g.grid.conditions[l].sort?"radio_button_checked":"radio_button_unchecked",n,"i_"+o);OAT.addTextNode(m,gx.getMessage("GXPL_QViewerJSAscending"));j.appendChild(m);j.appendChild(OAT.Dom.create("br"));o=OAT.Dom.radio("order");m="pivot_order_desc_"+g.grid.ContainerName+"_"+g.grid.TableDataFilds[g.number]+c;o.id=m;o.checked=3===g.grid.conditions[l].sort;OAT.Dom.attach(o,
"change",function(){});OAT.Dom.attach(o,"click",function(){var c=g.grid.conditions[l].sort;g.grid.sort(l,OAT.GridData.SORT_DESC,g.number);var h=g.grid.conditions[l].sort;OAT.saveState(g,true);if(qv.util.isGeneXusPreview()&&h!=c)try{var k='<DATA event="OrderChanged" name="'+g.grid.columns[g.number].getAttribute("name")+'" displayName="'+g.grid.columns[g.number].getAttribute("displayName")+'"  order="descending">';window.external.SendText(qv.collection[OAT_JS.grid.gridData[UcId].IdForQueryViewerCollection].ControlName,
k+"</DATA>")}catch(j){}if(g.grid.serverPaging){c=g.container.parentNode.cellIndex;self.getDataForTable(g.grid.UcId,1,g.grid.rowsPerPage,false,c<0?g.dataField:OAT_JS.grid.gridData[g.grid.UcId].columnDataField[c],"Descending","","")}c="i_"+this.getAttribute("id");document.getElementById(c).textContent="radio_button_checked";document.getElementById(c.replace("desc","asc")).textContent="radio_button_unchecked"});var r=OAT.Dom.create("label");r.htmlFor=m;OAT.addImageNode(r,3===g.grid.conditions[l].sort?
"radio_button_checked":"radio_button_unchecked",n,"i_"+m);OAT.addTextNode(r,gx.getMessage("GXPL_QViewerJSDescending"));j.appendChild(o);j.appendChild(r);h.push(j);1<self.header.length&&(j=OAT.Dom.create("hr",{}),h.push(j))}j=OAT.Dom.create("hr",{});n=OAT.Dom.create("div");g.grid.disableColumnSort&&n.setAttribute("class","first_popup_subdiv");0<g.container.parentNode.cellIndex&&(o=document.createElement("div"),o.setAttribute("class","move_item_img"),OAT.Dom.attach(o,"click",function(){for(var c=g.container.parentNode.cellIndex,
h=c-1;h>=0&&g.container.parentNode.parentNode.children[h].clientWidth==0;)h=h-1;if(h!=-1){for(var j=0,l=0,m=g.container.parentNode.parentNode.children[h].getAttribute("title_v"),n=0;n<g.grid.header.cells.length;n++){g.container.children[0].getAttribute("title_v")===g.grid.header.cells[n].value.textContent.replace(/\u00A0/g," ")&&(j=n);m===g.grid.header.cells[n].value.textContent.replace(/\u00A0/g," ")&&(l=n)}g.grid.header.cells[j].html.parentNode.insertBefore(g.grid.header.cells[j].html,g.grid.header.cells[l].html);
if(g.grid.serverPaging){OAT_JS.grid.gridData[g.grid.UcId].redrawHeader=true;for(n=0;n<g.grid.rows.length;n++)g.grid.rows[n].cells[j].html.parentNode.insertBefore(g.grid.rows[n].cells[j].html,g.grid.rows[n].cells[l].html)}else{m=jQuery("#"+g.grid.controlName+" tr")[1];for(n=0;n<g.grid.rows[0].cells.length;n++){if(m.children[c].getAttribute("title")===g.grid.rows[0].cells[n].value.textContent.replace(/\u00A0/g," ")||!isNaN(parseInt(m.children[c].getAttribute("title")))&&parseInt(m.children[c].getAttribute("title"))===
parseInt(g.grid.rows[0].cells[n].value.textContent.replace(/\u00A0/g," ")))j=n;if(m.children[h].getAttribute("title")===g.grid.rows[0].cells[n].value.textContent.replace(/\u00A0/g," ")||!isNaN(parseInt(m.children[h].getAttribute("title")))&&parseInt(m.children[h].getAttribute("title"))===parseInt(g.grid.rows[0].cells[n].value.textContent.replace(/\u00A0/g," ")))l=n}c=g.grid.columnsDataType.length-1-(j<l?l-1:l);for(n=0;n<g.grid.rows.length;n++){g.grid.rows[n].cells[j].html.parentNode.insertBefore(g.grid.rows[n].cells[j].html,
g.grid.rows[n].cells[l].html);h=g.grid.rows[n].cells[j];g.grid.rows[n].cells.splice(j,1);g.grid.rows[n].cells.splice(c,0,h)}}j=[];for(l=0;l<jQuery("#"+g.grid.controlName).find("thead td").length;l++)j.push(jQuery("#"+g.grid.controlName).find("thead td")[l].getAttribute("dataField"));OAT_JS.grid.setDataFieldPosition(g.grid.UcId,j);k()}}),m=OAT.Dom.create("label"),OAT.addTextNode(m,gx.getMessage("GXPL_QViewerJSMoveColumnToLeft")),m.htmlFor="move_column_to_left"+c,o.appendChild(m),OAT.Dom.append([n,
o]),g.container.parentNode.cellIndex>=g.grid.header.cells.length-2&&h.push(n));g.container.parentNode.cellIndex<g.grid.header.cells.length-1&&(o=document.createElement("div"),o.setAttribute("class","move_item_img"),OAT.Dom.attach(o,"click",function(){var c=g.container.parentNode.cellIndex;if(c==-1)for(var h=0;h<g.grid.html.tHead.rows[0].cells.length;h++)g.container.children[0].getAttribute("title_v")==g.grid.html.tHead.rows[0].cells[h].getAttribute("title_v")&&(c=h);var j=c+1,h=g.container.parentNode.parentNode;
for(g.container.parentNode.parentNode==void 0&&(h=g.grid.div.children[1].children[0].children[0]);j<h.children.length-1&&h.children[j].clientWidth==0;)j=j+1;if(!(j>=h.children.length)){var l=h=0,m;m=g.container.parentNode.parentNode!=void 0?g.container.parentNode.parentNode.children[j].getAttribute("title_v"):g.grid.html.tHead.rows[0].cells[j].getAttribute("title_v");for(var n=0;n<g.grid.header.cells.length;n++){g.container.children[0].getAttribute("title_v")===g.grid.header.cells[n].value.textContent.replace(/\u00A0/g,
" ")&&(h=n);m===g.grid.header.cells[n].value.textContent.replace(/\u00A0/g," ")&&(l=n)}g.grid.header.cells[h].html.parentNode.insertBefore(g.grid.header.cells[l].html,g.grid.header.cells[h].html);if(g.grid.serverPaging){OAT_JS.grid.gridData[g.grid.UcId].redrawHeader=true;for(n=0;n<g.grid.rows.length;n++)g.grid.rows[n].cells[h].html.parentNode.insertBefore(g.grid.rows[n].cells[l].html,g.grid.rows[n].cells[h].html)}else{m=jQuery("#"+g.grid.controlName+" tr")[1];for(n=0;n<g.grid.rows[0].cells.length;n++){if(m.children[c].getAttribute("title")===
g.grid.rows[0].cells[n].value.textContent.replace(/\u00A0/g," ")||!isNaN(parseInt(m.children[c].getAttribute("title")))&&parseInt(m.children[c].getAttribute("title"))===parseInt(g.grid.rows[0].cells[n].value.textContent.replace(/\u00A0/g," ")))h=n;if(m.children[j].getAttribute("title")===g.grid.rows[0].cells[n].value.textContent.replace(/\u00A0/g," ")||!isNaN(parseInt(m.children[j].getAttribute("title")))&&parseInt(m.children[j].getAttribute("title"))===parseInt(g.grid.rows[0].cells[n].value.textContent.replace(/\u00A0/g,
" ")))l=n}c=g.grid.columnsDataType.length-1-(h<l?l-1:l);for(n=0;n<g.grid.rows.length;n++){g.grid.rows[n].cells[h].html.parentNode.insertBefore(g.grid.rows[n].cells[l].html,g.grid.rows[n].cells[h].html);j=g.grid.rows[n].cells[h];g.grid.rows[n].cells.splice(h,1);g.grid.rows[n].cells.splice(c,0,j)}}c=[];for(h=0;h<jQuery("#"+g.grid.controlName).find("thead td").length;h++)c.push(jQuery("#"+g.grid.controlName).find("thead td")[h].getAttribute("dataField"));OAT_JS.grid.setDataFieldPosition(g.grid.UcId,
c);k()}}),m=OAT.Dom.create("label"),OAT.addTextNode(m,gx.getMessage("GXPL_QViewerJSMoveColumnToRight")),m.htmlFor="move_column_to_right"+c,o.appendChild(m),OAT.Dom.append([n,o]),h.push(n));OAT.gridStateChanged(g)&&(c=OAT.Dom.create("div"),n=document.createElement("div"),OAT.Dom.attach(n,"click",function(){if(g.grid.serverPaging)self.getDataForTable(g.grid.UcId,1,g.grid.rowsPerPage,true,"","","","",true);else{OAT.RestoreGridRow(g);OAT.RestoreGridOrder(g);OAT.RestoreGridColumns(g);OAT.saveState(g,"1")}k()}),
o=OAT.Dom.create("label"),OAT.addTextNode(o,gx.getMessage("GXPL_QViewerJSRestoreDefaultView")),o.htmlFor="pivot_checkbox_restoreview",n.appendChild(o),OAT.Dom.append([c,n]),h.push(c));c=OAT.Dom.create("div");c.setAttribute("class","last_div_popup");OAT.distinctDivs(g,c);h.push(j);h.push(c);OAT.Dom.append(h);g.grid.isSD&&setTimeout(function(){var c=window.innerWidth,g=jQuery(".oat_winrect_container")[0].clientWidth;if(g==0){g=jQuery(".oat_winrect_container").length;g=jQuery(".oat_winrect_container")[g-
1].clientWidth}g<220&&(g=220);c=(c-g)/2+jQuery(window).scrollLeft();jQuery(".oat_winrect_container").css({left:c+"px",width:g+"px"})},50)};OAT.distinctDivs=function(c,g){var h=c.grid.columns.length-1-c.number,j=c.container.parentNode.cellIndex;c.grid.serverPaging&&(h=-1<j?j:c.number);if(!c.grid.serverPaging)try{for(var k=jQuery("#"+c.grid.controlName+" tr")[1],l=0;l<c.grid.columns.length;l++){var n=k.children[j].getAttribute("title"),o=c.grid.rows[0].cells[l].value.textContent.replace(/\u00A0/g," ");
n.trim()===o.trim()&&(h=l)}}catch(m){}var j=function(c,g,h){var k=OAT.Dom.create("div"),j=OAT.Dom.create("input"),l=OAT.Dom.create("label");OAT.addTextNode(l,c);l.htmlFor=g;OAT.addImageNode(k,h?"check_box":"check_box_outline_blank","");k.appendChild(l);return[k,j]},r=function(g,k){var j="pop";g?(c.grid.serverPaging||OAT.ShowGridRow(c,h,k),OAT.actualizeBlackList("pop",c.grid,h,k,c.grid.serverPaging)):(c.grid.serverPaging||OAT.HideGridRow(c,h,k),j="push",OAT.actualizeBlackList("push",c.grid,h,k,c.grid.serverPaging));
c.grid.serverPaging&&self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,"","",OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h],{op:j,values:k});OAT.onFilteredChangedEventHandle(c,h);OAT.saveState(c,!0,h)},l=function(){self.getValuesForColumn(c.grid.UcId,h,this.value)};OAT.Dom.clear(g);k=OAT.Dom.create("div");k.setAttribute("class","div_buttons_popup");n=document.createElement("button");n.textContent=gx.getMessage("GXPL_QViewerJSAll");n.setAttribute("class","btn");jQuery(n).click(function(){c.grid.serverPaging?
self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,"","",OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h],{op:"all",values:[]}):(c.grid.conditions[h].blackList=[],OAT.RestoreGridRow(c),OAT.saveState(c,!0,h));OAT.onFilteredChangedEventHandle(c,h);OAT.distinctDivs(c,g)});o=document.createElement("button");o.textContent=gx.getMessage("GXPL_QViewerJSNone");o.setAttribute("class","btn");jQuery(o).click(function(){if(c.grid.serverPaging)self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,
"","",OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h],{op:"none",values:[]});else{c.grid.conditions[h].blackList=[];for(var k=0;k<c.grid.rows.length;k++){for(var j=0;j<c.grid.columns.length;j++)-1===c.grid.conditions[j].blackList.findIndex(c.grid.rows[k].cells[j].options.value)&&c.grid.conditions[j].blackList.push(c.grid.rows[k].cells[j].options.value);OAT.HideGridRow(c,h,c.grid.rows[k].cells[h].options.value)}}OAT.saveState(c,!0,h);OAT.onFilteredChangedEventHandle(c,h);OAT.distinctDivs(c,g)});
var t=document.createElement("button");t.textContent=gx.getMessage("GXPL_QViewerJSReverse");t.setAttribute("class","btn");jQuery(t).click(function(){if(c.grid.serverPaging)self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,"","",OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h],{op:"reverse",values:[]});else{for(var k=[],j=0;j<c.grid.rows.length;j++){var l=c.grid.rows[j].cells[h].options.value;-1==c.grid.conditions[h].blackList.findIndex(l)&&k.push(l)}for(j=0;j<c.grid.columns.length;j++)c.grid.conditions[j].blackList=
[];c.grid.conditions[h].blackList=k;for(j=0;j<c.grid.rows.length;j++)c.grid.rows[j].html.style.display="",c.grid.rows[j].html.setAttribute("visibQ","tt");OAT.filterRows(c.grid)}OAT.saveState(c,!0,h);OAT.distinctDivs(c,g);OAT.onFilteredChangedEventHandle(c,h)});OAT.Dom.append([k,n,o,t],[g,k]);k=OAT.Dom.create("div");k.setAttribute("class","div_filter_input");c.grid.serverPaging&&(n=document.createElement("input"),n.textContent="none",n.setAttribute("class","search_input"),n.setAttribute("type","text"),
n.setAttribute("label",gx.getMessage("GXPL_QViewerSearch")),n.setAttribute("title",gx.getMessage("GXPL_QViewerSearch")),n.setAttribute("placeholder",gx.getMessage("GXPL_QViewerSearch")),n.setAttribute("id",c.grid.UcId+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h]),jQuery(n).keyup(l),OAT.Dom.append([k,n],[g,k]));k=OAT.Dom.create("div");if(c.grid.serverPaging){n=OAT_JS.grid.getCantDifferentValues(c.grid.UcId,h);for(l=0;l<n;l++){var u=OAT_JS.grid.getDifferentValues(c.grid.UcId,h,l);if(u){o=u.value;
t=u.pict_value;if("#NuN#"==u.value||""==t.trimpivot())t+=" ";t=t.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");33<t.length&&(v=0<t.substring(32,t.length).trimpivot().length?"...":"",t=t.substring(0,32)+v);t=t.replace(/ /g," ")+"     ";v=u.checked;t=j(t,"pivot_distinct_"+l,v);t[0].setAttribute("value",o);k.appendChild(t[0]);o=v?"check_item_img":"uncheck_item_img";c.grid.isSD&&(o=v?"check_item_img_small":"uncheck_item_img_small");t[0].setAttribute("class",o);OAT.Dom.attach(t[0],"click",function(){var g=
"check_item_img",h="uncheck_item_img";if(c.grid.isSD){g="check_item_img_small";h="uncheck_item_img_small"}var k=this.getAttribute("class")!==g;this.setAttribute("class",this.getAttribute("class")===g?h:g);jQuery(this).find("i")[0].textContent=k?"check_box":"check_box_outline_blank";r(k,this.getAttribute("value"))})}}9>=OAT_JS.grid.getCantDifferentValues(c.grid.UcId,h)?k.setAttribute("class","pivot_popup_auto"):k.setAttribute("class","pivot_popup_fix");k.setAttribute("ucid",c.grid.UcId);k.setAttribute("columnnumber",
h);k.setAttribute("id","values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h])}else{n=[];for(l=0;l<c.grid.rows.length;l++)if(-1===n.findIndex(c.grid.rows[l].cells[h].options.value)){o=c.grid.rows[l].cells[h].options.value;t=c.grid.rows[l].cells[h].value.textContent;t=t.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");if(33<t.length)var v=0<t.substring(32,t.length).trimpivot().length?"...":"",t=t.substring(0,32)+v;t=t.replace(/ /g," ")+"     ";v=-1==c.grid.conditions[h].blackList.findIndex(o);
t=j(t,"pivot_distinct_"+l,v);t[0].setAttribute("value",o);k.appendChild(t[0]);o=v?"check_item_img":"uncheck_item_img";c.isSD&&(o=v?"check_item_img_small":"uncheck_item_img_small");t[0].setAttribute("class",o);OAT.Dom.attach(t[0],"click",function(){var c=this.getAttribute("class")!=="check_item_img";this.setAttribute("class",this.getAttribute("class")==="check_item_img"?"uncheck_item_img":"check_item_img");jQuery(this).find("i")[0].textContent=c?"check_box":"check_box_outline_blank";r(c,this.getAttribute("value"))});
n.push(c.grid.rows[l].cells[h].options.value)}9>=n.length?k.setAttribute("class","pivot_popup_auto"):k.setAttribute("class","pivot_popup_fix")}g.appendChild(k)};OAT.appendNewPairToPopUp=function(c,g,h,j,k,l){"#NuN#"==g&&(k=" ");k=k.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");if(33<k.length)var n=0<k.substring(32,k.length).trimpivot().length?"...":"",k=k.substring(0,32)+n;k=k.replace(/ /g," ")+"     ";k=function(c,g,h){var k=OAT.Dom.create("div"),j=OAT.Dom.create("input"),l=OAT.Dom.create("label");
OAT.addTextNode(l,c);l.htmlFor=g;OAT.addImageNode(k,h?"check_box":"check_box_outline_blank","");k.appendChild(l);return[k,j]}(k,"pivot_distinct_"+i,j);k[0].setAttribute("value",g);jQuery("#values_"+c.grid.UcId+"_"+l)[0].appendChild(k[0]);g=j?"check_item_img":"uncheck_item_img";c.grid.isSD&&(g=j?"check_item_img_small":"uncheck_item_img_small");k[0].setAttribute("class",g);OAT.Dom.attach(k[0],"click",function(){var g="check_item_img",k="uncheck_item_img";c.grid.isSD&&(g="check_item_img_small",k="uncheck_item_img_small");
var j=this.getAttribute("class")!==g,g=this.getAttribute("class")===g?k:g;jQuery(this).find("i")[0].textContent=j?"check_box":"check_box_outline_blank";this.setAttribute("class",g);g=this.getAttribute("value");k="pop";j||(k="push");self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,"","",l,{op:k,values:g});OAT.onFilteredChangedEventHandle(c,h);OAT.saveState(c,!0,h)})};OAT.removeAllPairsFromPopUp=function(c,g,h){var j="check_item_img",k="uncheck_item_img";c.grid.isSD&&(j="check_item_img_small",
k="uncheck_item_img_small");jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).find("."+j).remove();jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).find("."+k).remove();jQuery(".last_div_popup ."+j).remove();jQuery(".last_div_popup ."+k).remove();h?(jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).removeClass("pivot_popup_auto"),jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).addClass("pivot_popup_fix")):
(jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).removeClass("pivot_popup_fix"),jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).addClass("pivot_popup_auto"))};OAT.onFilteredChangedEventHandle=function(c,g){if(c.grid.serverPaging){for(var h=c.dataField,j=g,k=0;k<c.grid.columns.length;k++)h==c.grid.columns[k].getAttribute("dataField")&&(j=k);return OAT_JS.grid.setFilterChangedWhenServerPagination(c.grid.UcId,c.grid.columns[j])}k=
'<DATA event="FilterChanged" name="'+c.grid.columns[g].getAttribute("name")+'" displayName="'+c.grid.columns[g].getAttribute("displayName")+'">';j=[];for(h=0;h<c.grid.rows.length;h++)-1===j.findIndex(c.grid.rows[h].cells[g].options.value)&&-1===c.grid.conditions[g].blackList.findIndex(c.grid.rows[h].cells[g].options.value)&&(k=k+"<VALUE>"+c.grid.rows[h].cells[g].options.value+"</VALUE>",j.push(c.grid.rows[h].cells[g].options.value));k+="</DATA>";j=c.grid.IdForQueryViewerCollection;qv.util.isGeneXusPreview()&&
window.external.SendText(c.QueryViewerCollection[c.IdForQueryViewerCollection].ControlName,k);if(c.grid.QueryViewerCollection[j].FilterChanged){h=qv.util.dom.xmlDocument(k);k=qv.util.dom.selectXPathNode(h,"/DATA");c.grid.QueryViewerCollection[j].FilterChangedData={};c.grid.QueryViewerCollection[j].FilterChangedData.Name=k.getAttribute("name");c.grid.QueryViewerCollection[j].FilterChangedData.SelectedValues=[];for(var l=-1,h=0;h<k.childNodes.length;h++)"VALUE"==k.childNodes[h].nodeName&&(l++,c.grid.QueryViewerCollection[j].FilterChangedData.SelectedValues[l]=
k.childNodes[h].firstChild.nodeValue);c.grid.QueryViewerCollection[j].FilterChanged()}};OAT.setClickEventHandlers=function(c,g,h,j,k,l){var n=jQuery(g).find("#span_txt_pivot")[0];if(n){jQuery(g).data("itemValue",h);jQuery(g).data("numberMorD",k);jQuery(g).data("itemInfo",l);jQuery(n).data("itemValue",h);jQuery(n).data("typeMorD",j);jQuery(n).data("numberMorD",k);jQuery(n).data("itemInfo",l);h=c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection];j=!0;for(l=0;l<h.Metadata.Axes.length;l++)c.grid.TableDataFilds[k]==
h.Metadata.Axes[l].DataField&&(j=h.Metadata.Axes[l].RaiseItemClick);for(l=0;l<h.Metadata.Data.length;l++)c.grid.TableDataFilds[k]==h.Metadata.Data[l].DataField&&(j=h.Metadata.Data[l].RaiseItemClick);h.ItemClick&&j?(n.onclick=function(){OAT.onClickEventHandle(c,this);if(OAT_JS.grid.gridData[c.grid.UcId].selection.Allow)OAT.onClickSelectNode(g,c)},n.classList.add("gx-qv-clickable-element")):OAT_JS.grid.gridData[c.grid.UcId].selection.Allow&&(n.onclick=function(){OAT.onClickSelectNode(g,c)})}};var alreadyclicked=
!1,alreadyclickedTimeout;OAT.onClickEventHandle=function(c,g){if(alreadyclicked){alreadyclicked=!1;clearTimeout(alreadyclickedTimeout);var h=OAT.ClickHandle(c,g);qv.pivot.onItemClickEvent(c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection],h,!0)}else h=300,void 0==c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection].ItemDoubleClick&&(h=0),alreadyclicked=!0,alreadyclickedTimeout=setTimeout(function(){alreadyclicked=!1;var h=OAT.ClickHandle(c,g);qv.pivot.onItemClickEvent(c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection],
h,!1)},h)};OAT.onDblClickEventHandle=function(c,g){var h=OAT.ClickHandle(c,g);qv.pivot.onItemClickEvent(c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection],h,!0)};OAT.ClickHandle=function(c,g){if(c.grid.HideDataFilds.length){var h=c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection].getPivottableDataSync();c.grid.allRowsPivot=[];c.grid.allFullRowsPivot=[];for(var j=h.split("<Record>"),h=1;h<j.length;h++){for(var k=[],l=[],n=0;n<c.grid.TableDataFilds.length;n++){k[n]="#NuN#";
var o=j[h].split("<"+c.grid.TableDataFilds[n]+">");1<o.length?(o=o[1].split("</"+c.grid.TableDataFilds[n]+">"),k[n]=o[0],l[n]=k[n]):0<=j[h].indexOf("<"+c.grid.TableDataFilds[n]+"/>")?(k[n]="",l[n]=""):(k[n]="#NuN#",l[n]="#NuN#")}c.grid.allRowsPivot.push(k);for(n=0;n<c.grid.HideDataFilds.length;n++)o=j[h].split("<"+c.grid.HideDataFilds[n]+">"),1<o.length?(o=o[1].split("</"+c.grid.HideDataFilds[n]+">"),l[l.length+n]=o[0]):l[l.length+n]=0<=j[h].indexOf("<"+c.grid.HideDataFilds[n]+"/>")?"":"#NuN#";c.grid.allFullRowsPivot.push(l)}}j=
[];h=jQuery(g).data("itemValue");l=jQuery(g).data("typeMorD");n=jQuery(g).data("numberMorD");k=jQuery(g).data("itemInfo");o=OAT.IsNodeSelected(c.cells[n].html);l='<DATA><ITEM type="'+l+'" name="'+c.grid.columns[n].getAttribute("name")+'" ';l=l+'displayName="'+c.grid.columns[n].getAttribute("displayName")+'" ';l=l+'selected="'+o.toString()+'" ';l=l+'location="rows">'+h+"</ITEM><CONTEXT><RELATED>";for(h=0;h<c.grid.rows[k].cells.length;h++){var l=l+'<ITEM name="'+c.grid.columns[h].getAttribute("name")+
'">',l=l+"<VALUES",o=!1,m="";"#NuN#"!=c.grid.rows[k].cells[h].options.value?m=m+"<VALUE>"+c.grid.rows[k].cells[h].options.value+"</VALUE>":o=!0;j.push(c.grid.rows[k].cells[h].options.value);o&&(l+=' Null="true"');l=l+">"+m;l+="</VALUES>";l+="</ITEM>"}if(c.grid.HideDataFilds.length)for(n=0;n<c.grid.allFullRowsPivot.length;n++){a:{for(o=0;o<j.length;o++)if(void 0!=j[o]&&j[o]!=c.grid.allFullRowsPivot[n][o]){o=!1;break a}o=!0}if(o)for(var r=0;r<c.grid.HideDataFilds.length;r++)l=l+'<ITEM name="'+c.grid.OrderFildsHidden[r]+
'">',l+="<VALUES",o=!1,m="","#NuN#"!=c.grid.rows[k].cells[h].options.value?m=m+"<VALUE>"+c.grid.allFullRowsPivot[n][r+c.grid.rows[k].cells.length]+"</VALUE>":o=!0,o&&(l+=' Null="true"'),l=l+">"+m,l+="</VALUES>",l+="</ITEM>"}return l+"</RELATED><FILTERS></FILTERS></CONTEXT></DATA>"};OAT.onClickSelectNode=function(c,g){var h=jQuery(c).data("itemValue"),j=jQuery(c).data("numberMorD"),k=jQuery(c).data("itemInfo"),j=OAT_JS.grid.gridData[g.grid.UcId].columnDataField.indexOf(g.grid.TableDataFilds[j]);OAT_JS.grid.gridData[g.grid.UcId].selection.Allow&&
OAT.SelectNodes(g,h,!1,j,k)};OAT.SelectNodes=function(c,g,h,j,k,l,n){if(0<=k){var o=jQuery("#"+c.grid.controlName+" tbody").find("tr")[k];if(OAT.IsNodeSelected(jQuery(o).find("td")[j]))OAT.ClearSelectedNodes(jQuery(c.grid.html)),OAT_JS.grid.gridData[c.grid.UcId].selection.SelectedNode=[];else if(h?OAT.SetNodeBackgroundColor(jQuery(o).find("td")[j],c.grid.selection.Color):(OAT.SetSelectedNodeBackgroundColor(jQuery(o).find("td")[j],c.grid.selection.Color,jQuery(c.grid.html)),OAT_JS.grid.gridData[c.grid.UcId].selection.SelectedNode=
[],OAT_JS.grid.gridData[c.grid.UcId].selection.SelectedNode[0]={value:g,dataField:OAT_JS.grid.gridData[c.grid.UcId].columnDataField[j],rowData:[OAT_JS.grid.gridData[c.grid.UcId].rowsData[k]],clicked:!0}),OAT_JS.grid.gridData[c.grid.UcId].selection.EntireLine)for(h=0;h<c.grid.rows[k].cells.length;h++)h!=j&&OAT.SetNodeBackgroundColor(jQuery(o).find("td")[h],OAT_JS.grid.gridData[c.grid.UcId].selection.Color)}else{h||(OAT_JS.grid.gridData[c.grid.UcId].selection.SelectedNode[l]={value:g,dataField:OAT_JS.grid.gridData[c.grid.UcId].columnDataField[j],
rowData:[],clicked:!1,conditions:n});for(k=0;k<jQuery("#"+c.grid.controlName+" tbody").find("tr").length;k++){var o=c.grid.columnsDataType[c.grid.TableDataFilds.indexOf(OAT_JS.grid.gridData[c.grid.UcId].columnDataField[j])],h=OAT_JS.grid.gridData[c.grid.UcId].rowsData[k][c.grid.TableDataFilds.indexOf(OAT_JS.grid.gridData[c.grid.UcId].columnDataField[j])],m=!1;if((m="real"==o||"integer"==o?parseFloat(g)==h:h.trim()==g.trim())&&OAT.checkConditions(c,OAT_JS.grid.gridData[c.grid.UcId].rowsData[k],n))if(o=
jQuery("#"+c.grid.controlName+" tbody").find("tr")[k],OAT.SetNodeBackgroundColor(jQuery(o).find("td")[j],c.grid.selection.Color,jQuery(c.grid.html)),OAT_JS.grid.gridData[c.grid.UcId].selection.SelectedNode[l].rowData.push(OAT_JS.grid.gridData[c.grid.UcId].rowsData[k]),OAT_JS.grid.gridData[c.grid.UcId].selection.EntireLine)for(h=0;h<c.grid.rows[k].cells.length;h++)h!=j&&OAT.SetNodeBackgroundColor(jQuery(o).find("td")[h],OAT_JS.grid.gridData[c.grid.UcId].selection.Color)}}};OAT.checkConditions=function(c,
g,h){for(var j=0;j<h.length;j++){var k=OAT_JS.grid.gridData[c.grid.UcId].columnDataField.indexOf(h[j].DataField),l=c.grid.columnsDataType[c.grid.TableDataFilds.indexOf(OAT_JS.grid.gridData[c.grid.UcId].columnDataField[k])],n=!0,n="real"==l||"integer"==l?parseFloat(h[j].Value)==parseFloat(g[k]):h[j].Value.trim()==g[k].trim();if(!n)return!1}return!0};OAT.RedrawSelectedNode=function(c){if(OAT_JS.grid.gridData[c.UcId].selection.SelectedNode){OAT.ClearSelectedNodes(jQuery(c.html));for(var g=0;g<OAT_JS.grid.gridData[c.UcId].selection.SelectedNode.length;g++)if(OAT_JS.grid.gridData[c.UcId].selection.SelectedNode[g].clicked)for(var h=
0;h<OAT_JS.grid.gridData[c.UcId].selection.SelectedNode[g].rowData.length;h++)for(var j=OAT_JS.grid.gridData[c.UcId].selection.SelectedNode[g].rowData[h],k=0;k<OAT_JS.grid.gridData[c.UcId].rowsData.length;k++){for(var l=!0,n=0;n<OAT_JS.grid.gridData[c.UcId].rowsData[k].length;n++)OAT_JS.grid.gridData[c.UcId].rowsData[k][n]!=j[n]&&(l=!1);l&&OAT.SelectNodes({grid:c},OAT_JS.grid.gridData[c.UcId].selection.SelectedNode[g].value,!0,OAT_JS.grid.gridData[self.UcId].columnDataField.indexOf(OAT_JS.grid.gridData[c.UcId].selection.SelectedNode[g].dataField),
k)}else OAT.SelectNodes({grid:c},OAT_JS.grid.gridData[c.UcId].selection.SelectedNode[g].value,!0,OAT_JS.grid.gridData[self.UcId].columnDataField.indexOf(OAT_JS.grid.gridData[c.UcId].selection.SelectedNode[g].dataField),-1,g,OAT_JS.grid.gridData[c.UcId].selection.SelectedNode[g].conditions)}};OAT.gridStateChanged=function(c){if(c.grid.serverPaging)return OAT_JS.grid.getStateChange(c.grid.UcId);for(var g=!1,h=0;h<c.grid.columnsDataType.length;h++)void 0!=c.grid.header.cells[h]&&""!=c.grid.header.cells[h].html.style.display&&
(g=!0);for(h=0;h<c.grid.conditions.length;h++)1!=c.grid.conditions[h].sort&&(g=!0),0<c.grid.conditions[h].blackList.length&&(g=!0);return void 0!=c.grid.InitPageSize&&c.grid.rowsPerPage!=c.grid.InitPageSize?!0:g};OAT.createXMLDimensionInfo=function(c,g){return"<name>"+c.columns[g].getAttribute("name")+"</name> <displayName>"+c.columns[g].getAttribute("displayName")+"</displayName> <description>"+c.columns[g].getAttribute("description")+"</description> <dataField>"+c.columns[g].getAttribute("dataField")+
"</dataField> <dataType>"+c.columns[g].getAttribute("dataType")+"</dataType> <summarize>"+c.columns[g].getAttribute("summarize")+"</summarize> <align>"+c.columns[g].getAttribute("align")+"</align> <axis>"+c.columns[g].getAttribute("axis")+"</axis> "};OAT.createXMLMetadata=function(c,g,h){for(var g='<OLAPCube format="compact" thousandsSeparator="," decimalSeparator="." dateFormat="MDY">',j=0;j<=c.grid.columns.length-1;j++){for(var k=j,g=g+"<OLAPDimension> ",g=g+OAT.createXMLDimensionInfo(c.grid,k),
l=0,n=0;n<c.grid.header.cells.length;n++)c.grid.header.cells[n].dataField==c.grid.columns[k].getAttribute("dataField")&&(l=n);"none"==c.grid.header.cells[l].html.style.display&&(g+="<hidden>true</hidden>");g=""===c.grid.columns[k].getAttribute("picture")?g+"<picture/> ":g+"<picture>"+c.grid.columns[k].getAttribute("picture")+"</picture> ";g=""===c.grid.columns[k].getAttribute("picture")?g+"<format/> ":g+"<format>"+c.grid.columns[k].getAttribute("format")+"</format> ";g=OAT_JS.grid.gridData[c.grid.UcId].dataFieldOrder==
c.grid.columns[k].getAttribute("dataField")?"Descending"==OAT_JS.grid.gridData[c.grid.UcId].orderType?g+"<order>descending</order> ":g+"<order>ascending</order> ":g+"<order>none</order> ";g+="<customOrder/> ";g+="<include> ";if(h)if(n=c.grid.columns[k].getAttribute("dataField"),"none"!=c.blackLists[n].state&&"all"!=c.blackLists[n].state)for(l=0;l<c.blackLists[n].visibles.length;l++)g=g+"<value>"+c.blackLists[n].visibles[l].trimpivot()+"</value> ";else{if("none"!=c.blackLists[n].state)for(l=0;l<c.differentValues[n].length;l++)g=
g+"<value>"+c.differentValues[n][l].trimpivot()+"</value> "}else{n=[];for(l=0;l<c.grid.rows.length;l++)void 0!=c.grid.rows[l].cells[k]&&(-1===n.findIndex(c.grid.rows[l].cells[k].options.value)&&-1===c.grid.conditions[k].blackList.findIndex(c.grid.rows[l].cells[k].options.value))&&(g=g+"<value>"+c.grid.rows[l].cells[k].options.value.toString().trimpivot()+"</value> ",n.push(c.grid.rows[l].cells[k].options.value))}g+="<value>TOTAL</value> </include> <collapse/> ";g+="<hide> ";if(h)if(n=c.grid.columns[k].getAttribute("dataField"),
"none"!=c.blackLists[n].state&&"all"!=c.blackLists[n].state)for(l=0;l<c.blackLists[n].hiddens.length;l++)g=g+"<value>"+c.blackLists[n].hiddens[l].trimpivot()+"</value> ";else{if("all"!=c.blackLists[n].state)for(l=0;l<c.differentValues[n].length;l++)g=g+"<value>"+c.differentValues[n][l].trimpivot()+"</value> "}else for(l=0;l<c.grid.conditions[k].blackList.length;l++){for(var n=0===k,o=0;o<c.grid.rows.length;o++)if(c.grid.rows[o].cells[k].options.value===c.grid.conditions[k].blackList[l])for(var m=
0;m<k;m++)-1===c.grid.conditions[m].blackList.findIndex(c.grid.rows[o].cells[m].options.value)&&(n=!0);!0===n&&(g=g+"<value>"+c.grid.conditions[k].blackList[l].toString().trimpivot()+"</value> ")}g+="</hide> ";l=c.grid.columnsDataType.length-1-k;try{void 0!=c.grid.header.cells[l]&&(""===c.grid.header.cells[l].html.style.display?(g+="<condition>table</condition> ",g+="<filterbar>no</filterbar> "):(g+="<condition>none</condition> ",g+="<filterbar>yes</filterbar> "))}catch(r){}l=0;n=!1;o=-1;for(m=0;c.columnDataField&&
m<c.columnDataField.length&&!n;m++){for(var t=c.columnDataField[m],u=!1,v=0;v<c.grid.columns.length;v++)t==c.grid.columns[v].getAttribute("dataField")&&(u="never"==c.grid.columns[v].getAttribute("visible").toLowerCase());u||(l+=1);t==c.grid.columns[k].getAttribute("dataField")&&(n=!0,u||(o=l))}g=0<o?g+"<position>"+o+"</position> ":g+"<position/>";g+="<restoreview>no</restoreview> ";g+=" </OLAPDimension>"}return g+"</OLAPCube>"};OAT.ExportToPdf=function(c,g){for(var h=[],j=0;1>j;j++)for(var k=jQuery("#"+
c.grid.controlName+" tr")[j],l=0;l<k.children.length;l++)"none"==k.children[l].style.display&&h.push(l);var n=30*jQuery("#"+c.grid.controlName+" tr").length+25;841>n&&(n=841);var o=0,k=jQuery("#"+c.grid.controlName+" tr")[0].children.length-h.length,o=95*k+25;595>o&&(o=595);for(var m=[],j=0;j<jQuery("#"+c.grid.controlName+" tr").length;j++)for(var k=jQuery("#"+c.grid.controlName+" tr")[j],r=0,l=0;l<k.children.length;l++){var t=k.children[l].textContent,u=k.children[l].getAttribute("hidden");if("none"!=
k.children[l].style.display&&null===u){void 0==m[r]&&(m[r]=30);for(var v=0,x=0;x<t.length;x++)1E3<t.charCodeAt(x)&&v++;0===v?14<t.length&&1.68*t.length>m[r]&&(m[r]=1.68*t.length):(t=2.8*v+1.68*(t.length-v),t>m[r]&&(m[r]=t));r+=1}}for(j=k=0;j<m.length;j++)k=k+2.5*m[j]+65;k=20+k+5;k>o&&(o=k);v=function(c,g){for(var h=0,k=0;k<c;k++)h+=g[k];return h};n=o<=n?new jsPDF("portrait","mm","a4",!1,o,792):new jsPDF("landscape","mm","a4",!1,o,792);n.setFontSize(8);n.line(18,13,20+v(jQuery("#"+c.grid.controlName+
" tr")[0].children.length-h.length,m),13);for(var o=-1,B=1,H=Math.min(jQuery("#"+c.grid.controlName+" tr").length-26*(B-1),26),j=0;j<jQuery("#"+c.grid.controlName+" tr").length;j++){o++;k=jQuery("#"+c.grid.controlName+" tr")[j];for(l=r=0;l<k.children.length;l++)if("none"!=k.children[l].style.display){n.line(18+v(r,m),13,18+v(r,m),23+10*(H-1));var t=OAT.removeIconFont(k.children[l].textContent),u=k.children[l].getAttribute("hidden"),w=[];if(1E3<t.charCodeAt(0))for(x=0;x<t.length;x++)w[x]=OAT.getCharacterImg(t.charCodeAt(x));
else{for(var z=-1,x=1;x<t.length;x++)if(1E3<t.charCodeAt(x)){z=x;break}if(0<z){for(var q=t.substring(0,z),C=0,x=z;x<t.length;x++)w[C]=OAT.getCharacterImg(t.charCodeAt(x)),C++;t=q}}q=!1;n.setTextColor(0,0,0);n.setFontStyle("normal");x=!isNaN(parseFloat(t));z=n.getStringUnitWidth(t);if(void 0!=k.children[l].getAttribute("style")&&null!=k.children[l].getAttribute("style"))for(var C=k.children[l].getAttribute("style").split(";"),y=0;y<C.length;y++){var G=C[y].split(":");"color"===G[0].replace(/^\s+|\s+$/g,
"")?(G=G[1].replace(/^\s+|\s+$/g,""),G=G.substring(4,G.length),G=G.substring(0,G.length-1),n.setTextColor(parseInt(G.split(",")[0]),parseInt(G.split(",")[1]),parseInt(G.split(",")[2]))):"text-align"===G[0].replace(/^\s+|\s+$/g,"")?x="right"==G[1].replace(/^\s+|\s+$/g,""):"font-style"===G[0].replace(/^\s+|\s+$/g,"")?n.setFontStyle("italic"):"font-weight"===G[0].replace(/^\s+|\s+$/g,"")?"bold"===G[1].replace(/^\s+|\s+$/g,"")&&n.setFontStyle("bold"):"background-color"===G[0].replace(/^\s+|\s+$/g,"")?
(G=G[1].replace(/^\s+|\s+$/g,""),G=G.substring(4,G.length),G=G.substring(0,G.length-1),n.setFillColor(parseInt(G.split(",")[0]),parseInt(G.split(",")[1]),parseInt(G.split(",")[2])),q=!0):"border-color"===G[0].replace(/^\s+|\s+$/g,"")&&(G=G[1].replace(/^\s+|\s+$/g,""),G=G.substring(4,G.length),G=G.substring(0,G.length-1),n.setDrawColor(parseInt(G.split(",")[0]),parseInt(G.split(",")[1]),parseInt(G.split(",")[2])))}q&&l==k.children.length-1?n.rect(18+v(r,m),23+10*(o-1),32,10,"FD"):q&&n.rect(18+v(r,
m),23+10*(o-1),30,10,"FD");n.setDrawColor(0,0,0);n.setFontSize(8);if(null===u&&(u=0,1E3>t.charCodeAt(0)&&(u=t.length+2,x?n.text(20+v(r+1,m)-3*z-4,20+10*o,t):n.text(20+v(r,m),20+10*o,t)),0<w.length))for(x=0;x<w.length;x++)n.addImage(w[x],"JPEG",20+v(r,m)+u+2.5*x,20+10*o-2.5,2.5,2.5);r+=1}n.line(20+v(k.children.length-h.length,m),13,20+v(k.children.length-h.length,m),23+10*(H-1));n.line(18,23+10*o,20+v(k.children.length-h.length,m),23+10*o);25<=o&&(n.setDrawColor(0,0,0),B++,H=Math.min(jQuery("#"+c.grid.controlName+
" tr").length-1-26*(B-1)+1,26),o=-1,n.addPage(),n.line(18,13,20+v(jQuery("#"+c.grid.controlName+" tr")[0].children.length-h.length,m),13))}isSD=!1;h=-1<navigator.userAgent.toLowerCase().indexOf("android");if(gx.util.browser.isIPad()||gx.util.browser.isIPhone()||h)isSD=!0;if(gx.util.browser.webkit&&!gx.util.browser.chrome||isSD)n.output("dataurlnewwindow");else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())n.save(g+".pdf");else return n.output()};OAT.ExportToExcel=function(c,g){for(var h=
"<table><tbody>",j=0;j<jQuery("#"+c.grid.controlName+" tr").length;j++){for(var h=h+"<tr>",k=jQuery("#"+c.grid.controlName+" tr")[j],l=0;l<k.children.length;l++){var n;0===j?(n=k.children[l].getAttribute("title_v"),void 0===n&&(n=OAT.removeIconFont(k.children[l].textContent).trim())):(n=k.children[l].getAttribute("title"),void 0===n&&(n=k.children[l].textContent));n=n.replace(/\u00A0/g," ");var o=k.children[l].getAttribute("hidden");if("none"!=k.children[l].style.display&&null===o){var o=k.children[l].getAttribute("rowspan"),
m=k.children[l].getAttribute("colspan"),r="";void 0!=k.children[l].getAttribute("style")&&null!=k.children[l].getAttribute("style")&&(r=' style="'+k.children[l].getAttribute("style")+'" ');h=null===o&&null===m?h+"<td "+r+">"+n+"</td>":null===m?h+"<td "+r+' rowspan="'+o+'">'+n+"</td>":null===o?h+"<td "+r+' colspan="'+m+'">'+n+"</td>":h+"<td "+r+' colspan="'+m+'" rowspan="'+o+'">'+n+"</td>"}}h+="</tr>"}h='<head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"></head><body>'+(h+"</tbody></table>")+
"</body>";isSD=!1;j=-1<navigator.userAgent.toLowerCase().indexOf("android");if(gx.util.browser.isIPad()||gx.util.browser.isIPhone()||j)isSD=!0;if(gx.util.browser.webkit&&!gx.util.browser.chrome||isSD)window.open("data:application/vnd.ms-excel,"+encodeURIComponent(h));else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())h=new Blob([h],{type:"application/vnd.ms-excel"}),saveAs(h,g+".xls");else return h};OAT.ExportToExcel2010=function(c,g,h,j,k){function l(c){c=c.toString(16);return 1==c.length?
"0"+c:c}function n(c,g,h){return l(c)+l(g)+l(h)}dataTable=[];var o=jQuery("#"+c.grid.controlName+" tr").length;void 0!=h&&h&&(o=1);for(var m=[],r=0;r<o;r++){dataRow=[];for(var t=jQuery("#"+c.grid.controlName+" tr")[r],u=0;u<t.children.length;u++){var v=t.children[u].textContent,x=t.children[u].getAttribute("hidden");if("none"!=t.children[u].style.display){if(null===x){var B=t.children[u].getAttribute("rowspan"),H=t.children[u].getAttribute("colspan"),x={value:v};if(void 0!=t.children[u].getAttribute("style")&&
null!=t.children[u].getAttribute("style"))for(var v=t.children[u].getAttribute("style").split(";"),w=0;w<v.length;w++){var z=v[w].split(":");"color"===z[0].replace(/^\s+|\s+$/g,"")?(z=z[1].replace(/^\s+|\s+$/g,""),z=z.substring(4,z.length),z=z.substring(0,z.length-1),z=n(parseInt(z.split(",")[0]),parseInt(z.split(",")[1]),parseInt(z.split(",")[2])),x.fontColor=z):"text-align"===z[0].replace(/^\s+|\s+$/g,"")?(z=z[1].replace(/^\s+|\s+$/g,""),x.hAlign=z):"font-style"===z[0].replace(/^\s+|\s+$/g,"")?
"italic"===z[1].replace(/^\s+|\s+$/g,"")&&(x.italic=1):"font-weight"===z[0].replace(/^\s+|\s+$/g,"")?"bold"===z[1].replace(/^\s+|\s+$/g,"")&&(x.bold=1):"background-color"===z[0].replace(/^\s+|\s+$/g,"")&&(z=z[1].replace(/^\s+|\s+$/g,""),z=z.substring(4,z.length),z=z.substring(0,z.length-1),z=n(parseInt(z.split(",")[0]),parseInt(z.split(",")[1]),parseInt(z.split(",")[2])),x.fill=z)}null===B&&null===H||(null===H?x.rowSpan=parseInt(B):null===B?x.colSpan=parseInt(H):(x.colSpan=parseInt(H),x.rowSpan=parseInt(B)));
dataRow.push(x)}}else m.push(u)}dataTable.push(dataRow)}if(void 0!=h&&h)for(r=0;r<j.length;r++){dataRow=[];for(u=0;u<j[r].length;u++)if(-1==m.indexOf(u)){v=OAT.ApplyPictureValue(j[r][u],"",OAT_JS.grid.gridData[k].rowsMetadata.defaultPicture,OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomPicture[u]);h=OAT.Dom.create("td");h.setAttribute("title",v);x=j[r][u];"date"==c.grid.columnsDataType[u]&&(x=OAT.ApplyPictureValue(j[r][u],c.grid.columnsDataType[u],OAT_JS.grid.gridData[k].rowsMetadata.defaultPicture,
OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomPicture[u]));h=OAT.applyFormatValues(h,x,c.grid.columnsDataType,u,OAT_JS.grid.gridData[k].rowsMetadata.formatValues,OAT_JS.grid.gridData[k].rowsMetadata.conditionalFormatsColumns,OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomFormat);if("character"!=c.grid.columnsDataType[u]||"date"===c.grid.columnsDataType[u])h.style.textAlign="right";x={value:v};!isNaN(parseFloat(v))&&("character"!=c.grid.columnsDataType[u]&&"date"!=c.grid.columnsDataType[u]&&
"datetime"!=c.grid.columnsDataType[u])&&(x={value:parseFloat(v)+""});if(void 0!=h.getAttribute("style")&&null!=h.getAttribute("style")){v=h.getAttribute("style").split(";");for(w=0;w<v.length;w++)z=v[w].split(":"),"color"===z[0].replace(/^\s+|\s+$/g,"")?(z=z[1].replace(/^\s+|\s+$/g,""),z=z.substring(4,z.length),z=z.substring(0,z.length-1),z=n(parseInt(z.split(",")[0]),parseInt(z.split(",")[1]),parseInt(z.split(",")[2])),x.fontColor=z):"text-align"===z[0].replace(/^\s+|\s+$/g,"")?(z=z[1].replace(/^\s+|\s+$/g,
""),x.hAlign=z):"font-style"===z[0].replace(/^\s+|\s+$/g,"")?"italic"===z[1].replace(/^\s+|\s+$/g,"")&&(x.italic=1):"font-weight"===z[0].replace(/^\s+|\s+$/g,"")?"bold"===z[1].replace(/^\s+|\s+$/g,"")&&(x.bold=1):"background-color"===z[0].replace(/^\s+|\s+$/g,"")&&(z=z[1].replace(/^\s+|\s+$/g,""),z=z.substring(4,z.length),z=z.substring(0,z.length-1),z=n(parseInt(z.split(",")[0]),parseInt(z.split(",")[1]),parseInt(z.split(",")[2])),x.fill=z)}if("real"==c.grid.columnsDataType[u]||"integer"==c.grid.columnsDataType[u])x.formatCode=
OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomPicture[u].replace(/Z/g,"#").replace(/9/g,"0");if("date"==c.grid.columnsDataType[u]&&void 0!=OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomPicture[u]){h=OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomPicture[u].trim();o=OAT_JS.grid.gridData[k].rowsMetadata.defaultPicture.getAttribute("dateFormat");if("99/99/99"==h&&(x.formatCode="mm/dd/yy","DMY"==o&&(x.formatCode="dd/mm/yy"),"YMD"==o))x.formatCode="yy/mm/dd";if("99/99/9999"==h&&(x.formatCode=
"mm/dd/yyyy","DMY"==o&&(x.formatCode="dd/mm/yyyy"),"YMD"==o))x.formatCode="yyyy/mm/dd";if("9999/99/99"==h&&(x.formatCode="yyyy/mm/dd","YDM"==o&&(x.formatCode="yyyy/dd/mm"),"YMD"==o))x.formatCode="yyyy/mm/dd"}if("datetime"==c.grid.columnsDataType[u]&&void 0!=OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomPicture[u]){h=OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomPicture[u].trim().split(" ");o=OAT_JS.grid.gridData[k].rowsMetadata.defaultPicture.getAttribute("dateFormat");if("99/99/99"==h[0]&&
("DMY"==o&&(x.formatCode="dd/mm/yy"),"YMD"==o))x.formatCode="yy/mm/dd";if("99/99/9999"==h[0]&&("DMY"==o&&(x.formatCode="dd/mm/yyyy"),"YMD"==o))x.formatCode="yyyy/mm/dd";if("9999/99/99"==h[0]&&("YDM"==o&&(x.formatCode="yyyy/dd/mm"),"YMD"==o))x.formatCode="yyyy/mm/dd"}x.genexusType=c.grid.columnsDataType[u];x.genexusPicture=OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomPicture[u];dataRow.push(x)}dataTable.push(dataRow)}c=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:!1,worksheets:[{data:dataTable,
name:"Sheet 1"}]});isSD=!1;j=-1<navigator.userAgent.toLowerCase().indexOf("android");if(gx.util.browser.isIPad()||gx.util.browser.isIPhone()||j)isSD=!0;if(gx.util.browser.webkit&&!gx.util.browser.chrome||isSD)window.location=c.href();else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())c=atob(c.base64),c=Array.prototype.map.call(c,function(c){return c.charCodeAt(0)}),c=new Uint8Array(c),c=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),saveAs(c,g+
".xlsx");else return c.base64};OAT.ExportToXML=function(c,g){for(var h=[],j=0;1>j;j++)for(var k=jQuery("#"+c.grid.controlName+" tr")[j],l=0;l<k.children.length;l++)"none"==k.children[l].style.display&&h.push(l);var n;n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><EXPORT format="XML" type="flat"><METADATA>';for(k=0;k<c.grid.columns.length;k++)if(-1==h.indexOf(k)){n+="<OLAPDimension ";n=n+'name="'+c.grid.columns[k].getAttribute("dataField")+'" ';n=n+'label="'+c.grid.columns[k].getAttribute("displayName")+
'" ';n=n+'picture="'+c.grid.columns[k].getAttribute("picture")+'" ';n=n+'datatype="'+c.grid.columns[k].getAttribute("dataType")+'" ';n+='showAll="false" ';n+='position="row">';l=[];for(j=0;j<c.grid.rows.length;j++)if(-1===l.findIndex(c.grid.rows[j].cells[k].options.value)){n+="<VALUE CHECKED=";-1===c.grid.conditions[k].blackList.findIndex(c.grid.rows[j].cells[k].options.value)?(l.push(c.grid.rows[j].cells[k].options.value),n+='"true"'):n+='"false"';n+=' COLLAPSED="false">';var o=c.grid.rows[j].cells[k].options.value;
if(!isNaN(parseFloat(c.grid.rows[j].cells[k].options.value))&&(parseFloat(c.grid.rows[j].cells[k].options.value),void 0!=data))for(var m=0;m<data.length;m++)if(void 0!=data[m])for(var r=0;r<data[m].length;r++)void 0!=parseFloat(data[m][r])&&!isNaN(data[m][r])&&parseFloat(data[m][r])===parseFloat(c.grid.rows[j].cells[k].options.value)&&(o=data[m][r]);n=n+o+"</VALUE>"}n+="</OLAPDimension>"}for(k=0;k<measures.length;k++)n+="<OLAPMeasure ",n=n+'name="'+measures[k].getAttribute("dataField")+'" ',n=n+'label="'+
measures[k].getAttribute("displayName")+'" ',n=n+'picture="'+measures[k].getAttribute("picture")+'" ',n=n+'datatype="'+measures[k].getAttribute("dataType")+'" ',n+='showAll="true" ',n+='aggregator="sum"/>';n+="</METADATA><FLATDATA>";if(void 0!=data)for(j=0;j<data.length;j++){n+="<ROW ";for(k=0;k<data[0].length;k++)-1==h.indexOf(k)&&(o=data[j][k],n=n+c.grid.columns[k].getAttribute("dataField")+'="'+o+'" ');n+="/>"}else for(j=0;j<c.grid.rows.length;j++){n+="<ROW ";for(k=0;k<c.grid.rows[0].cells.length;k++){o=
c.grid.rows[j].cells[k].options.value;if(!isNaN(parseFloat(c.grid.rows[j].cells[k].options.value))&&(parseFloat(c.grid.rows[j].cells[k].options.value),void 0!=data))for(m=0;m<data.length;m++)if(void 0!=data[m])for(r=0;r<data[m].length;r++)void 0!=parseFloat(data[m][r])&&!isNaN(data[m][r])&&parseFloat(data[m][r])===parseFloat(c.grid.rows[j].cells[k].options.value)&&(o=data[m][r]);n=n+c.grid.columns[k].getAttribute("dataField")+'="'+o+'" '}n+="/>"}n+='</FLATDATA><HTML><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><STYLE>.odd {background-color: #FEFEFE; font-family: Verdana; font-size: 10pt;}\n.event {background-color: #EBEBEB; font-family: Verdana; font-size: 10pt;}\n.even {background-color: #FEFEFE;\tfont-weight: normal; font-family: Verdana; font-size: 10pt;\tpadding: 5px; }\ntr {border-left: 1px solid #BBBBBB; border-right: 1px solid #BBBBBB; line-height: 22px;}\ntable {border-collapse: collapse;}\n</STYLE></HEAD><BODY>';
for(j=0;j<jQuery("#"+c.grid.controlName+" tr").length;j++){n+="<TR>";k=jQuery("#"+c.grid.controlName+" tr")[j];for(l=0;l<k.children.length;l++)if(h=OAT.removeIconFont(k.children[l].textContent).trim(),o=k.children[l].getAttribute("hidden"),"none"!=k.children[l].style.display&&null===o){o=k.children[l].getAttribute("rowspan");m=k.children[l].getAttribute("colspan");r="";void 0!=k.children[l].getAttribute("style")&&null!=k.children[l].getAttribute("style")&&(r=' style="'+k.children[l].getAttribute("style")+
'" ');var t="";void 0!=k.getAttribute("class")&&null!=k.getAttribute("class")&&(t=' class="'+k.getAttribute("class")+'" ');n=null===o&&null===m?n+"<TD "+t+" "+r+" >"+h+"</TD>":null===m?n+"<TD "+t+" "+r+' rowspan="'+o+'">'+h+"</TD>":null===o?n+"<TD "+t+" "+r+' colspan="'+m+'">'+h+"</TD>":n+"<TD "+t+" "+r+' colspan="'+m+'" rowspan="'+o+'">'+h+"</TD>"}n+="</TR>"}n+="</BODY></HTML></EXPORT>";j=!1;k=-1<navigator.userAgent.toLowerCase().indexOf("android");if(gx.util.browser.isIPad()||gx.util.browser.isIPhone()||
k)j=!0;if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())n=n.replace(/\&/g,"&amp;"),gx.util.browser.webkit&&!gx.util.browser.chrome||j?window.open("data:text/xml,"+encodeURIComponent(n)):(n=new Blob([n],{type:"text/xml"}),saveAs(n,g+".xml"));else return n.replace(/\&/g,"&amp;")};OAT.SaveStateWhenServerPaging=function(c){localStorage.setItem(OAT.getURL()+c.grid.controlName+c.grid.query,JSON.stringify({pageSize:c.rowsPerPage,dataFieldOrder:c.dataFieldOrder,orderType:c.orderType,filters:c.filterInfo,
blackLists:c.blackLists,columnVisible:c.columnVisible,columnDataField:c.columnDataField}))};OAT.getStateWhenServingPaging=function(c,g){return JSON.parse(localStorage.getItem(OAT.getURL()+c+g))};OAT.saveState=function(c,g,h){if(!c.grid.serverPaging){"function"!==typeof JSON.decycle&&(JSON.decycle=function(c){var g=[],h=[];return function r(c,k){var j,l,B;switch(typeof c){case "object":if(!c)return null;for(j=0;j<g.length;j+=1)if(g[j]===c)return{$ref:h[j]};g.push(c);h.push(k);if("[object Array]"===
Object.prototype.toString.apply(c)){B=[];for(j=0;j<c.length;j+=1)B[j]=r(c[j],k+"["+j+"]")}else for(l in B={},c)Object.prototype.hasOwnProperty.call(c,l)&&(B[l]=r(c[l],k+"["+JSON.stringify(l)+"]"));return B;case "number":case "string":case "boolean":return c}}(c,"$")});for(var j=Array(c.grid.columnsDataType),k=0;k<c.grid.columnsDataType.length;k++)void 0!=c.grid.header.cells[k]&&(j[k]=c.grid.header.cells[k].html.style.display);"1"===g&&(c.grid.rowsPerPage=c.grid.InitPageSize);j={conditions:c.grid.conditions,
columnDisplay:j,rowsPerPage:c.grid.rowsPerPage};localStorage.setItem(OAT.getURL()+c.grid.controlName+c.grid.query,JSON.stringify(JSON.decycle(j)));j=!isNaN(c.grid.rowsPerPage)&&""!=c.grid.rowsPerPage?c.grid.rowsPerPage:c.grid.InitPageSize;"1"===g&&(j=c.grid.InitPageSize);j={currPage:1,ignoreRows:jQuery("tbody tr[visibQ=tf]",jQuery("#"+c.grid.controlName)),optionsForRows:[10,15,20],rowsPerPage:"undefined"!=j?j:50,jstype:"table",topNav:!1,controlName:c.grid.controlName};c.grid.InitPageSize&&g&&(OAT.tablePagination(jQuery("#"+
c.grid.controlName),j),setTimeout(function(){var g=jQuery("#"+c.grid.controlName)[0].offsetWidth-1;jQuery("#"+c.grid.controlName+"_tablePagination").css({width:g+"px"});jQuery("#"+c.grid.controlName).css("margin-bottom","0px")},500));void 0!=h&&-1<h&&(g=OAT.createXMLMetadata(c,h),h=c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection],""!=h&&(null!=h&&void 0!=h)&&qv.util.autorefresh.UpdateLayoutSameGroup(h,qv.pivot.GetRuntimeMetadata(g,h.RealType),!0))}};OAT.getState=function(c,g){"function"!==
typeof JSON.retrocycle&&(JSON.retrocycle=function(c){var g=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function r(c){var h,k,j;if(c&&"object"===typeof c)if("[object Array]"===Object.prototype.toString.apply(c))for(h=0;h<c.length;h+=1){if((k=c[h])&&"object"===typeof k)j=k.$ref,"string"===typeof j&&g.test(j)?c[h]=eval(j):r(k)}else for(h in c)if("object"===typeof c[h]&&(k=c[h]))j=k.$ref,"string"===typeof j&&g.test(j)?c[h]=eval(j):r(k)})(c);return c});var h=
localStorage.getItem(OAT.getURL()+c.controlName+c.query),h=JSON.retrocycle(JSON.parse(h));if(null!=h&&h.rowsPerPage+" "==g+" "){for(var j=0;j<c.columnsDataType.length;j++){c.header.cells[j].html.style.display=h.columnDisplay[j];for(var k=c.columnsDataType.length-1-j,l=0,l=0;l<c.rows.length;l++)c.rows[l].cells[k].html.style.display=h.columnDisplay[j]}c.conditions=h.conditions;c.rowsPerPage=h.rowsPerPage;return!0}return!1};OAT.SaveMetadata=function(c,g){try{window.localStorage&&(localStorage.removeItem(OAT.getURL()+
g),localStorage.setItem(OAT.getURL()+g,c))}catch(h){}};OAT.GetSavedMetadata=function(c){try{if(null!=localStorage.getItem(OAT.getURL()+c)){var g=localStorage.getItem(OAT.getURL()+c);if(void 0!=g&&null!=g)return g}}catch(h){}return""};try{OAT.Loader.featureLoaded("grid")}catch(ERROR$$7){}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){this.contains=function(c,g){for(var h=0;h<c.length;h++)if(c[h]===g)return h;return-1};renderJSPivot=function(c,g,h){"Table"!=c.RealType&&(c.ServerPaging=!1);"Table"==c.RealType&&(c.ServerPagingPivot=!1,""==qv.collection[c.UcId].AutoRefreshGroup&&jQuery(".oat_winrect_container").remove());if(c.RememberLayout&&c.ServerPaging&&"PivotTable"!=c.RealType){var j=OAT.getStateWhenServingPaging(c.UcId+"_"+c.ObjectName,c.ObjectName);if(j){var k=1;""==
j.pageSize&&(j.pageSize=void 0,k=0);g[c.UcId].getPageDataForTable(function(k){c.data=k;c.previousDataFieldOrder=j.dataFieldOrder;c.orderType=j.orderType;renderJSPivotInter(c,g,j,h)}.closure(this),[k,j.pageSize,!0,j.dataFieldOrder,j.orderType,j.filters,!1])}else renderJSPivotInter(c,g,null,h)}else if("Table"!=c.RealType)renderJSPivotInter(c,g,null,h);else{c.customFilterInfo="";for(var k=jQuery.parseXML(c.metadata).getElementsByTagName("OLAPDimension"),l=!1,n="",o="",m=0;m<k.length;m++){k[m].getAttribute("dataField");
for(var r=[],t=!1,u=0;u<k[m].childNodes.length;u++)if(void 0!=k[m].childNodes[u]&&void 0!=k[m].childNodes[u].localName&&"include"===k[m].childNodes[u].localName)for(var t=!0,v=0;v<k[m].childNodes[u].childNodes.length;v++)null!=k[m].childNodes[u].childNodes[v].localName&&"value"===k[m].childNodes[u].childNodes[v].localName.toLowerCase()&&r.push(k[m].childNodes[u].childNodes[v].textContent);!l&&(void 0!=k[m].getAttribute("order")&&""!=k[m].getAttribute("order"))&&(n=k[m].getAttribute("dataField"),o=
"descending"==k[m].getAttribute("order")?"Descending":"Ascending",l=!0);if(t){for(var u=g[c.UcId].getAttributeValuesSync([k[m].getAttribute("dataField"),1,0,""]),u=JSON.parse(u),t=u.NotNullValues,v=[],x=0;x<r.length;x++)for(u=0;u<t.length;u++)if(t[u].trimpivot()==r[x].trimpivot()){v.push(t[u]);break}""==c.customFilterInfo&&(c.customFilterInfo=[]);r={DataField:k[m].getAttribute("dataField"),NotNullValues:{DefaultAction:"Exclude",Excluded:"",Included:v},NullIncluded:!0};c.customFilterInfo.push(r)}}c.ServerPaging&&
(""!=c.customFilterInfo||""!=n)?g[c.UcId].getPageDataForTable(function(k){c.data=k;renderJSPivotInter(c,g,null,h)}.closure(this),[1,c.PageSize,!0,n,o,c.customFilterInfo,!1]):renderJSPivotInter(c,g,null,h)}};renderJSPivotInter=function(c,g,h,j){var k=c.RealType,l=c.container,n=c.page,o=c.content,m=c.metadata;this.dataString=c.data;var r=c.ObjectName,t=c.ControlName,u=parseInt(c.PageSize),v=c.AutoResize,x=c.DisableColumnSort,B=c.UcId,H=c.RememberLayout;this.pivotParams=c;this.serverPaging=c.ServerPaging;
this.previousDataFieldOrder=c.previousDataFieldOrder;this.previousOrderType=c.orderType;this.previousFilters=h?h.filters:void 0;this.previousColumnVisible=h?h.columnVisible:void 0;this.initialColumnVisible=[];this.previousState=h;this.customFilterInfo=c.customFilterInfo;this.gridCacheSize=c.ServerPagingCacheSize;this.hasShowValuesAs=0<c.metadata.indexOf("showValuesAs");"Table"==c.RealType&&(m=m.replace(/\<OLAPMeasure/g,'<OLAPMeasure axis="" isMeasure="true" '),m=m.replace(/OLAPMeasure/g,"OLAPDimension"));
if("Table"!=c.RealType){for(var h=m.split("<OLAPMeasure"),w=h[0],z=1;z<h.length;z++)m="",m=-1<h[z].indexOf('isComponent="true"')?"<OLAPDimension"+h[z].replace(/OLAPMeasure/g,"OLAPDimension"):"<OLAPMeasure"+h[z],w+=m;m=w}h="Rows"==c.ShowDataLabelsIn;if(void 0==H||"false"==H)H=!1;try{if(H){var q=OAT.GetSavedMetadata(l.id+r+B+t+k+"metadata");if(""===q)OAT.SaveMetadata(m,l.id+r+B+t+k+"metadata");else{var C=q.split("OLAPDimension").length===m.split("OLAPDimension").length,y=q.split("OLAPMeasure").length===
m.split("OLAPMeasure").length,G=q.split("name").length===m.split("name").length,z=!0;if(C&&y&&G)for(w=1;w<q.split("name").length;w++){var I=q.split("name")[w].substring(2,q.split("name")[w].length).split('"')[0],D=m.split("name")[w].substring(2,m.split("name")[w].length).split('"')[0];I!=D&&(z=!1)}if(!C||!y||!G||!z)if(gx.util.browser.isIE())try{window.localStorage&&(localStorage.removeItem(OAT.getURL()+l.id+r+B+t+k+"metadata"),localStorage.removeItem(OAT.getURL()+r+B))}catch(F){}else H=!1}}}catch(J){}C=
jQuery.parseXML(m);this.InitMetadata={};this.InitMetadata.Metadata=m;this.InitMetadata.DataString=dataString;this.InitMetadata.Dimensions=[];this.InitMetadata.Conditions=[];this.InitMetadata.DataFields=[];this.InitMetadata.RowsPerPage=u;y=C.getElementsByTagName("OLAPDimension");for(w=0;w<y.length;w++)z={},z.name=y[w].getAttribute("name"),z.displayName=y[w].getAttribute("displayName"),z.description=y[w].getAttribute("description"),z.dataField=y[w].getAttribute("dataField"),q="",G=y[w].getAttribute("visible"),
"Never"==G?(z.defaultPosition="hidden",z.Visible=!1):(z.Visible="No"==G?!1:!0,z.defaultPosition=y[w].getAttribute("axis"),q=0,q="true"==y[w].getAttribute("canDragToPages")?"filters;":"",q+="rows;columns;hidden"),z.validPosition=q,this.InitMetadata.Dimensions.push(z),this.InitMetadata.Conditions.push(""),this.InitMetadata.DataFields.push(z.dataField);this.InitMetadata.Measures=[];q=C.getElementsByTagName("OLAPMeasure");for(w=0;w<q.length;w++)C={},C.name=q[w].attributes.getNamedItem("name").nodeValue,
C.displayName=q[w].attributes.getNamedItem("displayName").nodeValue,C.dataField=q[w].attributes.getNamedItem("dataField").nodeValue,C.dataType=q[w].attributes.getNamedItem("dataType").nodeValue,C.Visible="yes"==q[w].attributes.getNamedItem("visible").nodeValue.toLowerCase(),"never"!=q[w].attributes.getNamedItem("visible").nodeValue.toLowerCase()?(C.defaultPosition=q[w].attributes.getNamedItem("axis")?q[w].attributes.getNamedItem("axis"):"data",C.validPosition="data;hidden"):(C.defaultPosition="hidden",
C.validPosition="hidden"),this.InitMetadata.Measures.push(C);this.InitMetadata.DimensionPosition=[];this.HideDataFilds=[];q=OATgetState(r,B.replace(/,/g,"").replace(/\./g,""));if(H&&void 0!=q){C=[];for(w=0;w<q.Dimensions.length;w++)q.Dimensions[w].Visible||C.push(q.Dimensions[w].dataField);y=[];for(w=0;w<q.Measures.length;w++)q.Measures[w].Visible||y.push(q.Measures[w].dataField);this.InitMetadata.Measures=q.Measures;this.InitMetadata.Dimensions=q.Dimensions;this.InitMetadata.DataFields=q.DataFields;
this.InitMetadata.DimensionPosition=q.DimensionPosition;c.ServerPagingPivot&&(this.InitMetadata.Conditions=q.Conditions);w=OATParseMetadata(m,C,y,c.ServerPagingPivot)}else{C=[];for(w=0;w<this.InitMetadata.Dimensions.length;w++)this.InitMetadata.Dimensions[w].Visible||C.push(this.InitMetadata.Dimensions[w].dataField);y=[];for(w=0;w<this.InitMetadata.Measures.length;w++)this.InitMetadata.Measures[w].Visible||y.push(this.InitMetadata.Measures[w].dataField);w="Table"==c.RealType?OATParseMetadata(m,[],
y,c.ServerPagingPivot):OATParseMetadata(m,C,y,c.ServerPagingPivot)}this.InitMetadata.GrandTotalVisibility={TotalForRows:c.TotalForRows,TotalForColumns:c.TotalForColumns};m=w[0];G=w[1];I=w[3];this.HideDataFilds=w[2];w=jQuery.parseXML(m);m=w.childNodes[0];this.IdForQueryViewerCollection=B;this.UcId=B=B.replace(/,/g,"").replace(/\./g,"");this.pivotDiv=l.id;this.query=r;this.control=t;this.pageSize=u;this.autoResize=v;this.disableColumnSort=x;this.header=[];this.data=[];this.columnNumbers=[];this.rowNumbers=
[];this.filterNumbers=[];this.cols=0;this.conditionalFormats=[];this.conditionalFormatsColumns=[];this.formatValues=[];this.formatValuesMeasures=[];this.forPivotFormatValues=[];this.forPivotFormats=[];this.forPivotCustomPicture=[];this.forPivotCustomFormat=[];l=w.getElementsByTagName("OLAPDimension");x=[];B=[];C=[];this.measures=w.getElementsByTagName("OLAPMeasure");var t=[],Q=[],D=q=0,y=[],v={measureFormula:[],itemPosition:[]},U=[],V=[],L=[],S=[],W=[];if("Table"==c.RealType)for(w=0;w<l.length;w++)this.initialColumnVisible[w]=
!0,"Yes"!=l[w].attributes.getNamedItem("visible").nodeValue&&(this.initialColumnVisible[w]=!1);for(w=0;w<l.length;w++){if("Rows"==l[w].attributes.getNamedItem("axis").nodeValue||"Table"==c.RealType||""==this.InitMetadata.Dimensions[w].validPosition)x[q]=l[w].attributes.getNamedItem("displayName").nodeValue,y[w]=x[q],q++;"Columns"==l[w].attributes.getNamedItem("axis").nodeValue&&(B[D]=l[w].attributes.getNamedItem("displayName").nodeValue,y[w]=B[D],D++);"Pages"==l[w].attributes.getNamedItem("axis").nodeValue&&
(C[D]=l[w].attributes.getNamedItem("displayName").nodeValue,y[w]=C[D],D++);if(c.ServerPagingPivot&&""==l[w].attributes.getNamedItem("axis").nodeValue)for(z=0;z<this.InitMetadata.Dimensions.length;z++)this.InitMetadata.Dimensions[z].dataField==l[w].attributes.getNamedItem("dataField").nodeValue&&this.InitMetadata.Dimensions[z].Visible&&(x[q]=l[w].attributes.getNamedItem("displayName").nodeValue,q++,y[w]=l[w].attributes.getNamedItem("displayName").nodeValue);t[w]=l[w].attributes.getNamedItem("dataType").nodeValue;
if(0<l[w].childNodes.length&&null!=l[w].childNodes)for(var E=0;E<l[w].childNodes.length;E++)if("formatValues"==l[w].childNodes[E].localName)for(z=0;z<l[w].childNodes[E].childNodes.length;z++)if("value"==l[w].childNodes[E].childNodes[z].localName){var N={};N.format=l[w].childNodes[E].childNodes[z].attributes.getNamedItem("format").nodeValue;N.recursive=l[w].childNodes[E].childNodes[z].attributes.getNamedItem("recursive").nodeValue;var M=l[w].childNodes[E].childNodes[z].textContent;N.value=M.replace(/^\s+|\s+$/g,
"");N.columnNumber=w;this.formatValues.push(N)}if(0<l[w].childNodes.length&&null!=l[w].childNodes)for(E=0;E<l[w].childNodes.length;E++)if("conditionalFormats"==l[w].childNodes[E].localName)for(z=0;z<l[w].childNodes[E].childNodes.length;z++)"rule"==l[w].childNodes[E].childNodes[z].localName&&(N={},N.format=l[w].childNodes[E].childNodes[z].attributes.getNamedItem("format").nodeValue,N.operation1=l[w].childNodes[E].childNodes[z].attributes.getNamedItem("op1").nodeValue,N.value1=l[w].childNodes[E].childNodes[z].attributes.getNamedItem("value1").nodeValue,
null!=l[w].childNodes[E].childNodes[z].attributes.getNamedItem("op2")&&(N.operation2=l[w].childNodes[E].childNodes[z].attributes.getNamedItem("op2").nodeValue,N.value2=l[w].childNodes[E].childNodes[z].attributes.getNamedItem("value2").nodeValue),N.columnNumber=w,this.conditionalFormatsColumns.push(N));if(""!=l[w].attributes.getNamedItem("picture").nodeValue&&("date"==l[w].attributes.getNamedItem("dataType").nodeValue&&(V.push(l[w].attributes.getNamedItem("picture").nodeValue),S.push(l[w].attributes.getNamedItem("dataField").nodeValue)),
"integer"==l[w].attributes.getNamedItem("dataType").nodeValue))L.push(l[w].attributes.getNamedItem("picture").nodeValue),W.push(l[w].attributes.getNamedItem("dataField").nodeValue);this.forPivotCustomPicture.push(l[w].attributes.getNamedItem("picture").nodeValue);this.forPivotCustomFormat.push(l[w].attributes.getNamedItem("format").nodeValue);U.push(l[w].attributes.getNamedItem("dataField").nodeValue)}for(w=0;w<this.measures.length;w++){Q[w]=this.measures[w].attributes.getNamedItem("displayName").nodeValue;
if(0<measures[w].childNodes.length&&null!=measures[w].childNodes)for(E=0;E<measures[w].childNodes.length;E++)if("formatValues"==measures[w].childNodes[E].localName)for(z=0;z<measures[w].childNodes[E].childNodes.length;z++)"value"==measures[w].childNodes[E].childNodes[z].localName&&(N={},N.format=measures[w].childNodes[E].childNodes[z].attributes.getNamedItem("format").nodeValue,N.recursive=measures[w].childNodes[E].childNodes[z].attributes.getNamedItem("recursive").nodeValue,M=measures[w].childNodes[E].childNodes[z].textContent,
N.value=M.replace(/^\s+|\s+$/g,""),N.columnNumber=w,this.formatValuesMeasures.push(N));if(0<measures[w].childNodes.length&&null!=measures[w].childNodes)for(E=0;E<measures[w].childNodes.length;E++)if("conditionalFormats"==measures[w].childNodes[E].localName)for(z=0;z<measures[w].childNodes[E].childNodes.length;z++)"rule"==measures[w].childNodes[E].childNodes[z].localName&&(N={},N.format=measures[w].childNodes[E].childNodes[z].attributes.getNamedItem("format").nodeValue,N.operation1=measures[w].childNodes[E].childNodes[z].attributes.getNamedItem("op1").nodeValue,
N.value1=measures[w].childNodes[E].childNodes[z].attributes.getNamedItem("value1").nodeValue,null!=measures[w].childNodes[E].childNodes[z].attributes.getNamedItem("op2")&&(N.operation2=measures[w].childNodes[E].childNodes[z].attributes.getNamedItem("op2").nodeValue,N.value2=measures[w].childNodes[E].childNodes[z].attributes.getNamedItem("value2").nodeValue),N.columnNumber=w,this.conditionalFormats.push(N));if(""!=measures[w].attributes.getNamedItem("picture").nodeValue&&("date"==measures[w].attributes.getNamedItem("dataType").nodeValue&&
(V.push(measures[w].attributes.getNamedItem("picture").nodeValue),S.push(measures[w].attributes.getNamedItem("dataField").nodeValue)),"integer"==measures[w].attributes.getNamedItem("dataType").nodeValue||"real"==measures[w].attributes.getNamedItem("dataType").nodeValue))L.push(measures[w].attributes.getNamedItem("picture").nodeValue),W.push(measures[w].attributes.getNamedItem("dataField").nodeValue);void 0!=measures[w].attributes.getNamedItem("formula")&&""!=measures[w].attributes.getNamedItem("formula").nodeValue?
v.measureFormula.push({hasFormula:!0,textFormula:measures[w].attributes.getNamedItem("formula").nodeValue}):v.measureFormula.push({hasFormula:!1});this.forPivotCustomPicture.push(measures[w].attributes.getNamedItem("picture").nodeValue);U.push(measures[w].attributes.getNamedItem("dataField").nodeValue)}this.header=y.concat(Q);this.getDataFromXML=function(f,c){var g=f.split("<Record>");if(this.serverPaging){this.ServerRecordCount=parseToIntRegisterValue(g[0],"RecordCount");this.ServerPageCount=parseToIntRegisterValue(g[0],
"PageCount");this.ServerPageNumber=parseToIntRegisterValue(g[0],"PageNumber")}filds=c;for(var h=1;h<g.length;h++){for(var k=[],j=[],l=0;l<filds.length;l++){k[l]="#NuN#";var m=g[h].split("<"+filds[l]+">");if(m.length>1){m=m[1].split("</"+filds[l]+">");k[l]=m[0];j[l]=k[l]}else if(g[h].indexOf("<"+filds[l]+"/>")>=0){k[l]="";j[l]=""}}this.data.push(k);k=filds.length;for(l=0;l<this.HideDataFilds.length;l++){j[k+l]=void 0;m=g[h].split("<"+this.HideDataFilds[l]+">");if(m.length>1){m=m[1].split("</"+this.HideDataFilds[l]+
">");j[k+l]=m[0]}}this.fullRecord.push(j);if(j.length>this.maxLengthRecord)this.maxLengthRecord=j.length}};this.maxLengthRecord=0;this.data=[];this.fullRecord=[];this.orderFildsHidden=G;this.TableOrderFilds=U;c.ServerPagingPivot?(h=h&&1<measures.length,this.pagingData={},this.pagingData.dataFields=U):this.getDataFromXML(c.data,this.TableOrderFilds);w={};for(q=0;q<G.length;q++)w[G[q]]=U.length+q;this.orderFildsHidden=I;v.itemPosition=w;v.recordDataLength=this.maxLengthRecord;for(z=v.cantFormulaMeasures=
0;z<v.measureFormula.length;z++)if(v.measureFormula[z].hasFormula){v.cantFormulaMeasures++;I=v.measureFormula[z].textFormula;G="*-+/()".split("");for(q=0;q<G.length;q++)if(D=I.split(G[q]),1<D.length){I="";for(w=0;w<D.length-1;w++)I=I+D[w]+" "+G[q]+" ";I+=D[D.length-1]}w=InfixToPostfix(I);v.measureFormula[z].polishNotationText=w;for(q=w.split(" ");-1!=q.indexOf("");)q.splice(q.indexOf(""),1);I=[];for(D=0;D<q.length;D++)-1==G.indexOf(q[D])&&isNaN(parseInt(q[D]))&&(U=v.itemPosition[q[D]],-1==I.indexOf(U)&&
I.push(U));v.measureFormula[z].relatedMeasures=I;for(w=w.split(" ");-1!=w.indexOf("");)w.splice(w.indexOf(""),1);v.measureFormula[z].PolishNotation=w}for(w=z=E=q=0;w<y.length;w++)if(-1!=this.contains(x,y[w])&&(this.columnNumbers[q]=w,q++),-1!=this.contains(B,y[w])&&(this.rowNumbers[E]=w,E++),-1!=this.contains(C,y[w]))this.filterNumbers[z]=w,z++;q=[];for(z=0;z<l.length;z++)q[z]=l[z];x="";for(w=0;w<jQuery("script").length;w++)if(B=jQuery("script")[w].src,0<B.indexOf("gxpivotjs")){x=B;break}this.relativePath=
x.substring(0,x.indexOf("QueryViewer/oatPivot"));var Z;this.query=r=r.replace(/\./g,"");OAT.Style.include("winrect.css",this.relativePath);OAT.Style.include("common.css",this.relativePath);if("PivotTable"==k){if(OAT.Style.include("pivot.css",this.relativePath),Z=OAT_JS.pivot.cb(this,this.pivotDiv,n,o,m,g,q,this.formatValues,this.conditionalFormatsColumns,this.formatValuesMeasures,this.autoResize,this.disableColumnSort,this.UcId,this.IdForQueryViewerCollection,H,h,v,this.fullRecord,c.ServerPagingPivot,
this.pagingData,this.HideDataFilds,this.orderFildsHidden,this.InitMetadata,this.relativePath,this.pivotParams),"error"==Z)return}else"Table"==k&&(OAT.Style.include("grid.css",this.relativePath),Z=OAT_JS.grid.cb(this.pivotDiv,this.UcId+"_"+r,t,m,this.forPivotCustomPicture,this.conditionalFormatsColumns,this.formatValues,this.forPivotCustomFormat,q,l,g,this.pageSize,this.disableColumnSort,this.UcId,this.IdForQueryViewerCollection,H,this));if("Table"==k){var R=this.pageSize=this.previousState?this.previousState.pageSize:
u;void 0!=Z.rowsPerPage&&""!=Z.rowsPerPage&&(R=Z.rowsPerPage);g[this.UcId]._ControlRenderedTo&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").remove();this.pageSize&&(self.serverPaging?(g={currPage:this.ServerPageNumber,ignoreRows:jQuery("tbody tr[visibQ=tf]",jQuery("#"+this.UcId+"_"+this.query)),optionsForRows:OAT.AddItemToList([10,15,20],this.InitMetadata.RowsPerPage),rowsPerPage:"undefined"!=R?R:10,jstype:"table",topNav:!1,controlName:this.UcId+"_"+this.query,cantPages:this.ServerPageCount,
controlUcId:this.UcId,control:this},OAT.partialTablePagination(jQuery("#"+this.UcId+"_"+this.query),g),g=jQuery("#"+this.UcId+"_"+this.query)[0].clientWidth-1,jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({width:g+"px"}),"none"===jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css("display")?jQuery("#"+this.UcId+"_"+this.query).css({marginBottom:"0px"}):jQuery("#"+this.UcId+"_"+this.query).css("margin-bottom","0px"),0<jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater").length&&
jQuery("#"+this.UcId+"_"+this.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({marginBottom:"0px"}),g=jQuery("#"+this.UcId+"_"+this.query)[0].offsetWidth-4,jQuery("#"+this.UcId+"_"+this.query+"_grid_top_div").css({width:g+"px"}),this.serverPaging&&(10==this.pageSize||10>this.ServerRecordCount)&&1>=this.ServerPageCount&&jQuery("#"+
this.UcId+"_"+this.query+"_tablePagination").css({display:"none"})):setTimeout(function(){var f={currPage:this.ServerPageNumber,ignoreRows:jQuery("tbody tr[visibQ=tf]",jQuery("#"+this.UcId+"_"+this.query)),optionsForRows:[10,15,20],rowsPerPage:R!="undefined"?R:10,jstype:"table",topNav:false,controlName:this.UcId+"_"+this.query,cantPages:this.ServerPageCount,controlUcId:this.UcId,control:this};OAT.tablePagination(jQuery("#"+this.UcId+"_"+this.query),f);f=jQuery("#"+this.UcId+"_"+this.query)[0].clientWidth-
1;jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({width:f+"px"});jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css("display")==="none"?jQuery("#"+this.UcId+"_"+this.query).css({marginBottom:"0px"}):jQuery("#"+this.UcId+"_"+this.query).css("margin-bottom","0px");jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&
jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({marginBottom:"0px"});f=jQuery("#"+this.UcId+"_"+this.query)[0].offsetWidth-4;jQuery("#"+this.UcId+"_"+this.query+"_grid_top_div").css({width:f+"px"});this.serverPaging&&this.pageSize==10&&this.ServerPageCount<=1&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({display:"none"})},50));g=jQuery("#"+this.UcId+"_"+this.query)[0].offsetWidth-4;try{-1<jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")&&(g+=4)}catch(aa){}jQuery("#"+
this.UcId+"_"+this.query+"_grid_top_div").css({width:g+"px"});self.serverPaging&&setInterval(function(){for(var f=0;f<jQuery(".oat_winrect_container .pivot_popup_fix").length;f++)if((!jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[f].style.display||jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[f].style.display!="none")&&jQuery(".oat_winrect_container .pivot_popup_fix").length>0){var c=jQuery(".oat_winrect_container .pivot_popup_fix")[f];
if(c.scrollHeight-c.clientHeight-c.scrollTop<25){var g=c.getAttribute("ucid"),c=parseInt(c.getAttribute("columnNumber"));OAT_JS.grid.readScrollValue(g,c)}}},250)}c.ServerPagingPivot||this.autoResize&&jQuery("#"+this.UcId+"_"+this.query).css({minWidth:"10px"});this.getDataForTable=function(f,c,g,h,k,j,l,m,A,T){var K=false;if(h||k!=""||l!=""){OAT_JS.grid.cleanCache(this,f);K=true}if(k!="")OAT_JS.grid.gridData[f].dataFieldOrder=k;if(j!="")OAT_JS.grid.gridData[f].orderType=j;l!=""&&OAT_JS.grid.updateFilterInfo(f,
l,m);if(A){OAT_JS.grid.restoreDefaultView(f);g=OAT_JS.grid.gridData[f].rowsPerPage}OAT_JS.grid.gridData[f].rowsPerPage=g;(h||k!=""||l!="")&&OAT.SaveStateWhenServerPaging(OAT_JS.grid.gridData[f],f,OAT_JS.grid.gridData[f].blackLists,OAT_JS.grid.gridData[f].columnVisible,OAT_JS.grid.gridData[f].columnDataField);if(g==""){g=void 0;c=0}OAT_JS.grid.pageInCache(f,c)?OAT_JS.grid.redraw(this,f,OAT_JS.grid.pageInCache(f,c),false,false,c,true):qv.collection[OAT_JS.grid.gridData[f].IdForQueryViewerCollection].getPageDataForTable(function(g){if(c==
0){c=1;h=false}OAT_JS.grid.redraw(this,f,g,h,k!="",c,T)}.closure(this),[c,g,h,OAT_JS.grid.gridData[f].dataFieldOrder,OAT_JS.grid.gridData[f].orderType,OAT_JS.grid.gridData[f].filterInfo,K])};this.getActualCantPages=function(f){return OAT_JS.grid.gridData[f].actualCantPages};this.getValuesForColumn=function(f,c,g){var h=OAT_JS.grid.gridData[f].columnDataField[c];g!=""?qv.collection[OAT_JS.grid.gridData[f].IdForQueryViewerCollection].getAttributeValues(function(k){k=JSON.parse(k);OAT_JS.grid.changeValues(f,
h,c,k,g)}.closure(this),[h,1,10,g]):OAT_JS.grid.resetScrollValue(f,h,c)};j.oat_element=Z};var OAT_JS={grid:{panel:1,tab:4,div:"",needs:["grid"],gridData:[],cb:function(c,g,h,j,k,l,n,o,m,r,t,u,v,x,B,H,w){this.gridData[x]={};this.gridData[x].div=c;this.gridData[x].controlName=g;this.gridData[x].actualPageNumber=1;this.gridData[x].rowsPerPage=w.previousState?w.previousState.pageSize:u;this.gridData[x].actualCantPages=w.ServerPageCount;this.gridData[x].autoResize=w.autoResize;this.gridData[x].selection=
{Allow:w.pivotParams.AllowSelection,EntireLine:w.pivotParams.SelectLine,SelectedNode:[]};this.gridData[x].grid=new OAT.Grid(c,g,query,h,m,t,this.gridData[x].rowsPerPage,v,x,B,H,w.serverPaging,w.HideDataFilds,w.orderFildsHidden,w.TableOrderFilds,w.relativePath,this.gridData[x].selection,w.pivotParams.Title);this.gridData[x].grid.oat_component=this;this.gridData[x].columnDataField=[];if(w.previousState&&w.previousState.columnDataField){this.gridData[x].columnDataField=w.previousState.columnDataField;
g=[];for(o=0;o<this.gridData[x].columnDataField.length;o++){c=this.gridData[x].columnDataField[o];for(m=0;m<r.length;m++)c==r[m].getAttribute("dataField")&&g.push(r[m].getAttribute("displayName"))}this.gridData[x].grid.createHeader(g,this.gridData[x].columnDataField)}else{for(g=0;g<r.length;g++)this.gridData[x].columnDataField[g]=r[g].getAttribute("dataField");this.gridData[x].grid.createHeader(w.header,this.gridData[x].columnDataField)}this.gridData[x].redrawHeader=!1;this.gridData[x].defaultValues=
{};this.gridData[x].defaultValues.rowsPerPage=u;this.gridData[x].defaultValues.dataFieldOrder="";this.gridData[x].defaultValues.orderType="";this.gridData[x].defaultValues.filterInfo=[];this.gridData[x].IdForQueryViewerCollection=B;this.gridData[x].TableOrderFields=w.TableOrderFilds;this.gridData[x].cacheSize=0==w.gridCacheSize?w.ServerPageCount*(0<this.gridData[x].rowsPerPage?this.gridData[x].rowsPerPage:1):w.gridCacheSize;this.gridData[x].gridCache=[];this.gridData[x].gridCache[0]={page:1,pageData:w.dataString};
this.gridData[x].nextCachePos=1;this.gridData[x].originalColumnDataField=[];for(g=0;g<r.length;g++)this.gridData[x].originalColumnDataField[g]=r[g].getAttribute("dataField");this.gridData[x].columnVisible=[];for(g=0;g<r.length;g++)this.gridData[x].columnVisible[g]=!0,w.previousColumnVisible?(this.gridData[x].columnVisible[g]=w.previousColumnVisible[g],this.gridData[x].columnVisible[g]||(c=this.gridData[x].originalColumnDataField[g],this.gridData[x].grid.hideColumnHeader(this.gridData[x].columnDataField.indexOf(c)))):
w.initialColumnVisible&&(this.gridData[x].columnVisible[g]=w.initialColumnVisible[g],this.gridData[x].columnVisible[g]||this.gridData[x].grid.hideColumnHeader(g));this.gridData[x].filterInfo=[];this.gridData[x].differentValues=[];this.gridData[x].blackLists=[];this.gridData[x].differentValuesPaginationInfo=[];this.gridData[x].filteredValuesPaginationInfo=[];for(g=0;g<r.length;g++)this.gridData[x].differentValues[r[g].getAttribute("dataField")]=[],this.gridData[x].blackLists[r[g].getAttribute("dataField")]=
{state:"all",visibles:[],hiddens:[],defaultAction:"Include",hasNull:!0},this.gridData[x].differentValuesPaginationInfo[r[g].getAttribute("dataField")]={blocked:!1,previousPage:0,totalPages:!0,filtered:!1},this.gridData[x].filteredValuesPaginationInfo[r[g].getAttribute("dataField")]={previousPage:0,totalPages:0,filteredText:"",values:[]};this.gridData[x].defaultNullText=j.getAttribute("textForNullValues");if(void 0!=w.previousFilters){this.gridData[x].filterInfo=w.previousFilters;for(B=0;B<this.gridData[x].filterInfo.length;B++){for(u=
0;u<this.gridData[x].filterInfo[B].NotNullValues.Included.length;u++)c=this.gridData[x].filterInfo[B].NotNullValues.Included[u],-1==this.gridData[x].blackLists[this.gridData[x].filterInfo[B].DataField].visibles.indexOf(c)&&this.gridData[x].blackLists[this.gridData[x].filterInfo[B].DataField].visibles.push(c);for(u=0;u<this.gridData[x].filterInfo[B].NotNullValues.Excluded.length;u++)c=this.gridData[x].filterInfo[B].NotNullValues.Excluded[u],-1==this.gridData[x].blackLists[this.gridData[x].filterInfo[B].DataField].hiddens.indexOf(c)&&
this.gridData[x].blackLists[this.gridData[x].filterInfo[B].DataField].hiddens.push(c);this.gridData[x].blackLists[this.gridData[x].filterInfo[B].DataField].state=0<this.gridData[x].filterInfo[B].NotNullValues.Included.length?"":"none";this.gridData[x].blackLists[this.gridData[x].filterInfo[B].DataField].defaultAction=this.gridData[x].filterInfo[B].NotNullValues.DefaultAction}}else void 0!=w.customFilterInfo&""!=w.customFilterInfo&&(this.gridData[x].filterInfo=w.customFilterInfo);this.gridData[x].dataFieldOrder=
void 0!=w.previousDataFieldOrder?w.previousDataFieldOrder:"";this.gridData[x].orderType=void 0!=w.previousOrderType?w.previousOrderType:"";this.gridData[x].customOrderValues=[];for(u=0;u<r.length;u++)void 0!=r[u].getAttribute("order")&&"custom"===r[u].getAttribute("order")?(result=this.gridData[x].grid.applyCustomSort(u,r[u],data),data=result[0],this.gridData[x].customOrderValues[u]=result[1]):this.gridData[x].customOrderValues[u]=!1;this.gridData[x].rowsMetadata={columnsDataType:h,defaultPicture:j,
forPivotCustomPicture:k,conditionalFormatsColumns:l,formatValues:n,forPivotCustomFormat:forPivotCustomFormat,columns:r};this.gridData[x].rowsData=data;for(o=0;o<data.length;o++)OAT.CreateGridRow(w.data[o],this.gridData[x]);if(w.serverPaging){h=!1;for(u=0;u<r.length;u++)if(void 0!=r[u].getAttribute("order")&&""!=r[u].getAttribute("order")){this.gridData[x].dataFieldOrder=r[u].getAttribute("dataField");this.gridData[x].orderType="descending"==r[u].getAttribute("order")?"Descending":"Ascending";h="custom"==
r[u].getAttribute("order");break}if(""!=this.gridData[x].dataFieldOrder&&!h){for(u=h=0;u<this.gridData[x].grid.columns.length;u++)if(this.gridData[x].dataFieldOrder==this.gridData[x].columnDataField[u]){h=u;break}this.gridData[x].grid.applySortOrderType(h,"ascending"==this.gridData[x].orderType.toLowerCase()?2:3)}}else for(u=0;u<r.length&&!(void 0!=r[u].getAttribute("order")&&"ascending"===r[u].getAttribute("order")&&this.gridData[x].grid.applySortOrderType(u,2),void 0!=r[u].getAttribute("order")&&
"descending"===r[u].getAttribute("order")&&this.gridData[x].grid.applySortOrderType(u,3),void 0!=r[u].getAttribute("order"));u++);for(u=0;u<r.length;u++)this.gridData[x].grid.applyCustomFilter(u,r[u]);w.serverPaging&&(this.gridData[x].endValueRead=!1,qv.collection[this.gridData[x].IdForQueryViewerCollection].CurrentPage=1,"function"==typeof qv.collection[this.gridData[x].IdForQueryViewerCollection].OnFirstPage&&qv.collection[this.gridData[x].IdForQueryViewerCollection].OnFirstPage());w.serverPaging||
this.gridData[x].grid.applySaveState(this.gridData[x].rowsPerPage);return this.gridData[x].grid},redraw:function(c,g,h,j,k,l,n){if(this.pageInCache(g,l)){for(var k=-1,o=0;o<this.gridData[g].gridCache.length;o++)this.gridData[g].gridCache[o].page==l&&(k=o);this.gridData[g].gridCache.splice(k,1);this.gridData[g].gridCache.push({page:l,pageData:h})}else this.gridData[g].gridCache.push({page:l,pageData:h}),this.gridData[g].gridCache.length>this.gridData[g].cacheSize&&this.gridData[g].gridCache.splice(0,
1);c.data=[];c.getDataFromXML(h,this.gridData[g].TableOrderFields);0<=c.ServerPageCount&&(this.gridData[g].actualCantPages=c.ServerPageCount);if(this.gridData[g].redrawHeader){h=[];for(k=0;k<this.gridData[g].columnDataField.length;k++)for(var o=this.gridData[g].columnDataField[k],m=0;m<this.gridData[g].rowsMetadata.columns.length;m++)o==this.gridData[g].rowsMetadata.columns[m].getAttribute("dataField")&&h.push(this.gridData[g].rowsMetadata.columns[m].getAttribute("displayName"));this.gridData[g].grid.createHeader(h,
this.gridData[g].columnDataField);if(""!=this.gridData[g].dataFieldOrder){for(k=h=0;k<this.gridData[g].grid.columns.length;k++)if(this.gridData[g].dataFieldOrder==this.gridData[g].columnDataField[k]){h=k;break}this.gridData[g].grid.applySortOrderType(h,"ascending"==this.gridData[g].orderType.toLowerCase()?2:3)}for(k=0;k<this.gridData[g].columnVisible.length;k++)this.gridData[g].columnVisible[k]||(o=this.gridData[g].originalColumnDataField[k],this.gridData[g].grid.hideColumnHeader(this.gridData[g].columnDataField.indexOf(o)))}this.gridData[g].grid.removeAllRows();
j&&0<jQuery("#"+this.gridData[g].controlName+"_tablePagination #tablePagination_totalPages").length&&(OAT.replaceTextNode(jQuery("#"+this.gridData[g].controlName+"_tablePagination #tablePagination_totalPages")[0]," "+c.ServerPageCount),1>=c.ServerPageCount?jQuery("#"+this.gridData[g].controlName+"_tablePagination ").css({display:"none"}):(jQuery("#"+this.gridData[g].controlName+"_tablePagination ").css({display:""}),1==c.ServerPageCount?jQuery("#"+this.gridData[g].controlName+"_tablePagination_paginater").css("display",
"none"):jQuery("#"+this.gridData[g].controlName+"_tablePagination_paginater").css("display","")));OAT_JS.grid.gridData[g].actualPageNumber!=l&&(qv.collection[this.gridData[g].IdForQueryViewerCollection].CurrentPage=l,1==l?"function"==typeof qv.collection[this.gridData[g].IdForQueryViewerCollection].OnFirstPage&&qv.collection[this.gridData[g].IdForQueryViewerCollection].OnFirstPage():l==this.gridData[g].actualCantPages?"function"==typeof qv.collection[this.gridData[g].IdForQueryViewerCollection].OnLastPage&&
qv.collection[this.gridData[g].IdForQueryViewerCollection].OnLastPage():l<OAT_JS.grid.gridData[g].actualPageNumber?"function"==typeof qv.collection[this.gridData[g].IdForQueryViewerCollection].OnPreviousPage&&qv.collection[this.gridData[g].IdForQueryViewerCollection].OnPreviousPage():"function"==typeof qv.collection[this.gridData[g].IdForQueryViewerCollection].OnNextPage&&qv.collection[this.gridData[g].IdForQueryViewerCollection].OnNextPage());if(!n&&""!=qv.collection[OAT_JS.grid.gridData[g].IdForQueryViewerCollection].AutoRefreshGroup){OAT_JS.grid.initValueRead(g,
0);var r=function(){if(OAT_JS.grid.gridData[g].endValueRead){var c=OAT.createXMLMetadata(OAT_JS.grid.gridData[g],null,true),h=qv.collection[OAT_JS.grid.gridData[g].IdForQueryViewerCollection];h!=""&&(h!=null&&h!=void 0)&&qv.util.autorefresh.UpdateLayoutSameGroup(h,qv.pivot.GetRuntimeMetadata(c,h.RealType),true)}else setTimeout(r,100)};r()}OAT_JS.grid.gridData[g].actualPageNumber=l;currPageNumber[this.gridData[g].controlName]=l;jQuery("#"+this.gridData[g].controlName+"_tablePagination #tablePagination_currPage").val(l);
this.gridData[g].rowsData=c.data;for(k=0;k<c.data.length;k++)OAT.CreateGridRow(c.data[k],this.gridData[g]);OAT.RedrawSelectedNode(this.gridData[g].grid)},getDifferentValues:function(c,g,h){var j=this.gridData[c].columnDataField[g],h=this.gridData[c].differentValues[j][h],g=this.gridData[c].originalColumnDataField.indexOf(this.gridData[c].columnDataField[g]),g=OAT.ApplyPictureValue(h.trimpivot(),this.gridData[c].rowsMetadata.columnsDataType[g],this.gridData[c].rowsMetadata.defaultPicture,this.gridData[c].rowsMetadata.forPivotCustomPicture[g]).replace(/ /g,
" ");if(this.gridData[c].blackLists[j].hasNull&&h.trimpivot()==this.gridData[c].defaultNullText)return!1;var k=!0;"all"!=this.gridData[c].blackLists[j].state&&0>this.gridData[c].blackLists[j].visibles.indexOf(h)&&(k=!1);return{value:h,checked:k,pict_value:g}},getCantDifferentValues:function(c,g){return this.gridData[c].differentValues[this.gridData[c].columnDataField[g]].length},cleanCache:function(c,g){for(var h=0;h<this.gridData[g].gridCache.length;h++)this.gridData[g].gridCache[h]={page:-1,pageData:""};
this.gridData[g].nextCachePos=0},pageInCache:function(c,g){for(var h=0;h<this.gridData[c].gridCache.length;h++)if(this.gridData[c].gridCache[h].page==g)return this.gridData[c].gridCache[h].pageData;return!1},updateFilterInfo:function(c,g,h){if("all"==h.op){for(var j=-1,h=0;h<this.gridData[c].filterInfo.length;h++)if(g==this.gridData[c].filterInfo[h].DataField){j=h;break}-1<j&&this.gridData[c].filterInfo.splice(j,1);this.gridData[c].blackLists[g].state="all";this.gridData[c].blackLists[g].visibles=
[];this.gridData[c].blackLists[g].hiddens=[];this.gridData[c].blackLists[g].defaultAction="Include"}else{if("none"==this.gridData[c].blackLists[g].state){this.gridData[c].blackLists[g].visibles=[];for(var k=0;k<this.gridData[c].differentValues[g].length;k++)-1==this.gridData[c].blackLists[g].hiddens.indexOf(this.gridData[c].differentValues[g][k])&&this.gridData[c].blackLists[g].hiddens.push(this.gridData[c].differentValues[g][k])}else if("all"==this.gridData[c].blackLists[g].state){this.gridData[c].blackLists[g].hiddens=
[];for(k=0;k<this.gridData[c].differentValues[g].length;k++)-1==this.gridData[c].blackLists[g].visibles.indexOf(this.gridData[c].differentValues[g][k])&&this.gridData[c].blackLists[g].visibles.push(this.gridData[c].differentValues[g][k])}if("none"==h.op)this.gridData[c].blackLists[g].state="none",this.gridData[c].blackLists[g].visibles=[],this.gridData[c].blackLists[g].hiddens=[],this.gridData[c].blackLists[g].defaultAction="Exclude";else if("push"==h.op)this.gridData[c].blackLists[g].state="",j=
this.gridData[c].blackLists[g].visibles.indexOf(h.values),-1<j&&this.gridData[c].blackLists[g].visibles.splice(j,1),-1==this.gridData[c].blackLists[g].hiddens.indexOf(h.values)&&this.gridData[c].blackLists[g].hiddens.push(h.values);else if("pop"==h.op)this.gridData[c].blackLists[g].state="",-1==this.gridData[c].blackLists[g].visibles.indexOf(h.values)&&this.gridData[c].blackLists[g].visibles.push(h.values),j=this.gridData[c].blackLists[g].hiddens.indexOf(h.values),-1<j&&this.gridData[c].blackLists[g].hiddens.splice(j,
1);else if("reverse"==h.op){this.gridData[c].blackLists[g].defaultAction="Include"==this.gridData[c].blackLists[g].defaultAction?"Exclude":"Include";if("none"==this.gridData[c].blackLists[g].state){j=-1;for(h=0;h<this.gridData[c].filterInfo.length;h++)if(g==this.gridData[c].filterInfo[h].DataField){j=h;break}-1<j&&this.gridData[c].filterInfo.splice(j,1);this.gridData[c].blackLists[g].state="all";this.gridData[c].blackLists[g].visibles=[];this.gridData[c].blackLists[g].hiddens=[];return}if("all"==
this.gridData[c].blackLists[g].state)this.gridData[c].blackLists[g].state="none",this.gridData[c].blackLists[g].visibles=[],this.gridData[c].blackLists[g].hiddens=[];else{for(var l=[],n=0;n<this.gridData[c].blackLists[g].visibles.length;n++)l.push(this.gridData[c].blackLists[g].visibles[n]);for(var o=[],n=0;n<this.gridData[c].blackLists[g].hiddens.length;n++)o.push(this.gridData[c].blackLists[g].hiddens[n]);this.gridData[c].blackLists[g].visibles=[];this.gridData[c].blackLists[g].hiddens=[];for(k=
0;k<this.gridData[c].differentValues[g].length;k++)j=this.gridData[c].differentValues[g][k],-1==l.indexOf(j)?this.gridData[c].blackLists[g].visibles.push(j):this.gridData[c].blackLists[g].hiddens.push(j);for(k=0;k<o.length;k++)-1==this.gridData[c].blackLists[g].visibles.indexOf(o[k])&&this.gridData[c].blackLists[g].visibles.push(o[k]);for(k=0;k<l.length;k++)-1==this.gridData[c].blackLists[g].hiddens.indexOf(l[k])&&this.gridData[c].blackLists[g].hiddens.push(l[k])}}l=!1;o=!0;n=[];for(k=0;k<this.gridData[c].blackLists[g].visibles.length;k++)"#NuN#"!=
this.gridData[c].blackLists[g].visibles[k]&&n.push(this.gridData[c].blackLists[g].visibles[k]);var m=[];if("none"!=this.gridData[c].blackLists[g].state){for(k=0;k<this.gridData[c].differentValues[g].length;k++)j=this.gridData[c].differentValues[g][k],"#NuN#"!=j&&-1==n.indexOf(j)&&m.push(j);for(k=0;k<this.gridData[c].blackLists[g].hiddens.length;k++)"#NuN#"!=this.gridData[c].blackLists[g].hiddens[k]&&-1==m.indexOf(this.gridData[c].blackLists[g].hiddens[k])&&m.push(this.gridData[c].blackLists[g].hiddens[k]);
0==n.length&&"Exclude"==this.gridData[c].blackLists[g].defaultAction&&(m=[])}"none"==h.op?(o=!1,n=[],m=[]):-1<this.gridData[c].differentValues[g].indexOf("#NuN#")||-1!=m.indexOf(this.gridData[c].blackLists[g].hiddens[k])?-1==this.gridData[c].blackLists[g].visibles.indexOf("#NuN#")&&(o=!1):"Exclude"==this.gridData[c].blackLists[g].defaultAction&&(o=!1);if(this.gridData[c].blackLists[g].hasNull&&"none"!=h.op){for(var j=this.gridData[c].defaultNullText,r=!1,t=0,k=0;k<this.gridData[c].differentValues[g].length;k++)t=
this.gridData[c].differentValues[g][k].length;for(k=0;k<this.gridData[c].differentValues[g].length;k++)if(this.gridData[c].differentValues[g][k].trimpivot()==this.gridData[c].defaultNullText){j=this.gridData[c].differentValues[g][k];r=!0;break}if(!r)for(k=0;k<t-this.gridData[c].defaultNullText.length;k++)j+=" ";if(o){if(-1==n.indexOf(j)&&(-1!=m.indexOf(j)?(m.splice(m.indexOf(j),1),n.push(j)):"Exclude"==this.gridData[c].blackLists[g].defaultAction&&n.push(j),-1!=this.gridData[c].blackLists[g].hiddens.indexOf(j)))this.gridData[c].blackLists[g].hiddens.splice(this.gridData[c].blackLists[g].hiddens.indexOf(j),
1),-1==this.gridData[c].blackLists[g].visibles.indexOf(j)&&this.gridData[c].blackLists[g].visibles.push(j)}else-1==m.indexOf(j)&&(m.push(j),-1==this.gridData[c].blackLists[g].hiddens.indexOf(j)&&this.gridData[c].blackLists[g].hiddens.push(j)),-1!=n.indexOf(j)&&n.splice(n.indexOf(j),1),-1!=this.gridData[c].blackLists[g].visibles.indexOf(j)&&this.gridData[c].blackLists[g].visibles.splice(this.gridData[c].blackLists[g].visibles.indexOf(j),1)}k=!1;null!=this.gridData[c].differentValuesPaginationInfo[g]&&
(k=this.gridData[c].differentValuesPaginationInfo[g].previousPage==this.gridData[c].differentValuesPaginationInfo[g].totalPages);h=(o||!this.gridData[c].blackLists[g].hasNull)&&0==m.length&&"none"!=h.op&&"push"!=h.op&&("Include"==this.gridData[c].blackLists[g].defaultAction||k)&&"reverse"!=h.op;for(k=j=0;k<this.gridData[c].filterInfo.length;k++)this.gridData[c].filterInfo[k].DataField==g&&(l=!0,this.gridData[c].filterInfo[k].NullIncluded=o,this.gridData[c].filterInfo[k].NotNullValues.Included=n,this.gridData[c].filterInfo[k].NotNullValues.Excluded=
m,this.gridData[c].filterInfo[k].NotNullValues.DefaultAction=this.gridData[c].blackLists[g].defaultAction,j=k);h&&this.gridData[c].filterInfo.splice(j,1);!l&&!h&&(filter={DataField:g,NullIncluded:o,NotNullValues:{Included:n,Excluded:m,DefaultAction:this.gridData[c].blackLists[g].defaultAction}},this.gridData[c].filterInfo.push(filter))}},readScrollValue:function(c,g){var h=this.gridData[c].columnDataField[g],j=this.gridData[c].originalColumnDataField.indexOf(this.gridData[c].columnDataField[g]);if(!this.gridData[c].differentValuesPaginationInfo[h].blocked)if(this.gridData[c].differentValuesPaginationInfo[h].blocked=
!0,this.gridData[c].differentValuesPaginationInfo[h].filtered){l=this.gridData[c].filteredValuesPaginationInfo[h];n=l.previousPage+1;this.gridData[c].lastRequestValue=h;var k=l.filteredText;qv.collection[this.gridData[c].IdForQueryViewerCollection].getAttributeValues(function(g){g=JSON.parse(g);OAT_JS.grid.appendNewFilteredValueData(c,g,j,k)}.closure(this),[h,n,10,l.filteredText])}else{var l=this.gridData[c].differentValuesPaginationInfo[h],n=l.previousPage+1;this.gridData[c].lastRequestValue=h;qv.collection[this.gridData[c].IdForQueryViewerCollection].getAttributeValues(function(g){g=
JSON.parse(g);OAT_JS.grid.appendNewValueData(c,g)}.closure(this),[h,n,10,""])}},appendNewValueData:function(c,g,h){var j=this.gridData[c].lastRequestValue;if(g.PageNumber>this.gridData[c].differentValuesPaginationInfo[j].previousPage||h){this.gridData[c].differentValuesPaginationInfo[j].previousPage=g.PageNumber;this.gridData[c].differentValuesPaginationInfo[j].totalPages=g.PagesCount;h=[];g.Null&&-1==this.gridData[c].differentValues[j].indexOf("#NuN#")&&this.gridData[c].differentValues[j].push("#NuN#");
for(var k=0;k<g.NotNullValues.length;k++){var l=g.NotNullValues[k];-1==this.gridData[c].differentValues[j].indexOf(l)&&(this.gridData[c].differentValues[j].push(l),h.push(l));"Include"==this.gridData[c].blackLists[j].defaultAction?-1==this.gridData[c].blackLists[j].visibles.indexOf(l)&&-1==this.gridData[c].blackLists[j].hiddens.indexOf(l)&&this.gridData[c].blackLists[j].visibles.push(l):-1==this.gridData[c].blackLists[j].visibles.indexOf(l)&&-1==this.gridData[c].blackLists[j].hiddens.indexOf(l)&&
this.gridData[c].blackLists[j].hiddens.push(l)}k=this.gridData[c].columnDataField.indexOf(j);l=this.gridData[c].originalColumnDataField.indexOf(j);this.gridData[c].grid.loadDifferentValues(k,this.gridData[c].differentValues[j]);for(var n=0;n<h.length;n++){var o=!0;"all"!=this.gridData[c].blackLists[j].state&&0>this.gridData[c].blackLists[j].visibles.indexOf(h[n])&&(o=!1);if(!(this.gridData[c].blackLists[j].hasNull&&h[n].trimpivot()==this.gridData[c].defaultNullText)){var m=OAT.ApplyPictureValue(h[n].trimpivot(),
this.gridData[c].rowsMetadata.columnsDataType[l],this.gridData[c].rowsMetadata.defaultPicture,this.gridData[c].rowsMetadata.forPivotCustomPicture[l]).replace(/ /g," ");OAT.appendNewPairToPopUp(this.gridData[c],h[n],k,o,m,j)}}}this.gridData[c].differentValuesPaginationInfo[j].previousPage<g.PagesCount&&(this.gridData[c].differentValuesPaginationInfo[j].blocked=!1)},resetScrollValue:function(c,g,h){this.gridData[c].differentValuesPaginationInfo[g].filtered=!1;this.gridData[c].differentValuesPaginationInfo[g].blocked=
!0;var h=this.gridData[c].columnDataField.indexOf(g),j=this.gridData[c].originalColumnDataField.indexOf(g);OAT.removeAllPairsFromPopUp(this.gridData[c],h,1<OAT_JS.grid.cantPages(c,g));for(var k=0;k<this.gridData[c].differentValues[g].length;k++){var l=!0,n=this.gridData[c].differentValues[g][k];"all"!=this.gridData[c].blackLists[g].state&&0>this.gridData[c].blackLists[g].visibles.indexOf(n)&&(l=!1);var o=OAT.ApplyPictureValue(n.trimpivot(),this.gridData[c].rowsMetadata.columnsDataType[j],this.gridData[c].rowsMetadata.defaultPicture,
this.gridData[c].rowsMetadata.forPivotCustomPicture[j]).replace(/ /g," ");this.gridData[c].blackLists[g].hasNull&&n.trimpivot()==this.gridData[c].defaultNullText||OAT.appendNewPairToPopUp(this.gridData[c],n,h,l,o,g)}this.gridData[c].differentValuesPaginationInfo[g].previousPage<OAT_JS.grid.cantPages(c,g)&&(this.gridData[c].differentValuesPaginationInfo[g].blocked=!1)},resetAllScrollValue:function(c){for(var g=0;g<this.gridData[c].grid.columns.length;g++){var h=this.gridData[c].grid.columns[g].getAttribute("dataField");
this.gridData[c].differentValuesPaginationInfo[h].filtered=!1;this.gridData[c].differentValuesPaginationInfo[h].blocked=!0;this.gridData[c].differentValuesPaginationInfo[h].previousPage<this.gridData[c].differentValuesPaginationInfo[h].totalPages&&(this.gridData[c].differentValuesPaginationInfo[h].blocked=!1)}},appendNewFilteredValueData:function(c,g,h,j){var k=this.gridData[c].lastRequestValue,h=this.gridData[c].columnDataField.indexOf(k),l=this.gridData[c].originalColumnDataField.indexOf(k),n=this.gridData[c].filteredValuesPaginationInfo[k];
if(!((j||""==j)&&n.filteredText!=j)&&g.PageNumber>n.previousPage){this.gridData[c].filteredValuesPaginationInfo[k].previousPage=g.PageNumber;this.gridData[c].filteredValuesPaginationInfo[k].totalPages=g.PagesCount;g.Null&&-1==this.gridData[c].differentValues[k].indexOf("#NuN#")&&this.gridData[c].differentValues[k].push("#NuN#");for(j=0;j<g.NotNullValues.length;j++){n=-1!=this.gridData[c].differentValues[k].indexOf(g.NotNullValues[j]);-1==this.gridData[c].differentValues[k].indexOf(g.NotNullValues[j])&&
this.gridData[c].differentValues[k].push(g.NotNullValues[j]);"Include"==this.gridData[c].blackLists[k].defaultAction&&!n?-1==this.gridData[c].blackLists[k].visibles.indexOf(g.NotNullValues[j])&&-1==this.gridData[c].blackLists[k].hiddens.indexOf(g.NotNullValues[j])&&this.gridData[c].blackLists[k].visibles.push(g.NotNullValues[j]):-1==this.gridData[c].blackLists[k].visibles.indexOf(g.NotNullValues[j])&&-1==this.gridData[c].blackLists[k].hiddens.indexOf(g.NotNullValues[j])&&this.gridData[c].blackLists[k].hiddens.push(g.NotNullValues[j]);
n=!0;"all"!=this.gridData[c].blackLists[k].state&&0>this.gridData[c].blackLists[k].visibles.indexOf(g.NotNullValues[j])&&(n=!1);var o=OAT.ApplyPictureValue(g.NotNullValues[j].trimpivot(),this.gridData[c].rowsMetadata.columnsDataType[l],this.gridData[c].rowsMetadata.defaultPicture,this.gridData[c].rowsMetadata.forPivotCustomPicture[l]).replace(/ /g," ");this.gridData[c].blackLists[k].hasNull&&g.NotNullValues[j].trimpivot()==this.gridData[c].defaultNullText||OAT.appendNewPairToPopUp(this.gridData[c],
g.NotNullValues[j],h,n,o,k)}this.gridData[c].filteredValuesPaginationInfo[k].previousPage<g.PagesCount&&(this.gridData[c].differentValuesPaginationInfo[k].blocked=!1)}},initValueRead:function(c,g,h){g>=this.gridData[c].grid.columns.length?this.gridData[c].endValueRead=!0:"Never"!=this.gridData[c].grid.columns[g].getAttribute("visible")?(this.gridData[c].grid.lastRequestValue=void 0==h?this.gridData[c].grid.columns[g].getAttribute("dataField"):h,0<this.gridData[c].differentValuesPaginationInfo[this.gridData[c].grid.lastRequestValue].previousPage&&
void 0==h&&(g++,OAT_JS.grid.initValueRead(c,g)),g=10,""!=qv.collection[this.gridData[c].IdForQueryViewerCollection].AutoRefreshGroup&&(g=0),qv.collection[this.gridData[c].IdForQueryViewerCollection].getAttributeValues(function(g){g=JSON.parse(g);dataField=this.gridData[c].grid.lastRequestValue;this.gridData[c].differentValuesPaginationInfo[dataField].previousPage=g.PageNumber;this.gridData[c].differentValuesPaginationInfo[dataField].totalPages=g.PagesCount;for(var k=0,l=0;l<this.gridData[c].grid.columns.length;l++)if(this.gridData[c].grid.lastRequestValue==
this.gridData[c].grid.columns[l].getAttribute("dataField")){k=l;break}if(g.Null){this.gridData[c].blackLists[dataField].hasNull=true;this.gridData[c].differentValues[dataField].indexOf("#NuN#")==-1&&this.gridData[c].differentValues[dataField].push("#NuN#");for(var n=true,l=0;l<this.gridData[c].filterInfo.length;l++)this.gridData[c].filterInfo[l].DataField==dataField&&(this.gridData[c].filterInfo[l].NullIncluded||(n=false));n&&this.gridData[c].blackLists[dataField].visibles.indexOf("#NuN#")==-1&&this.gridData[c].blackLists[dataField].visibles.push("#NuN#")}else this.gridData[c].blackLists[dataField].hasNull=
false;for(l=0;l<g.NotNullValues.length;l++){this.gridData[c].differentValues[dataField].indexOf(g.NotNullValues[l])==-1&&this.gridData[c].differentValues[dataField].push(g.NotNullValues[l]);this.gridData[c].blackLists[dataField].state=="all"&&this.gridData[c].blackLists[dataField].visibles.indexOf(g.NotNullValues[l])==-1&&this.gridData[c].blackLists[dataField].visibles.push(g.NotNullValues[l]);this.gridData[c].blackLists[dataField].state=="none"&&this.gridData[c].blackLists[dataField].hiddens.indexOf(g.NotNullValues[l])==
-1&&this.gridData[c].blackLists[dataField].hiddens.push(g.NotNullValues[l]);if(this.gridData[c].blackLists[dataField].defaultAction=="Exclude"&&this.gridData[c].blackLists[dataField].state==""&&g.NotNullValues[l].trimpivot()!=""&&this.gridData[c].blackLists[dataField].visibles.length>0)for(n=0;n<this.gridData[c].blackLists[dataField].visibles.length;n++)this.gridData[c].blackLists[dataField].visibles[n]==g.NotNullValues[l].trimpivot()&&(this.gridData[c].blackLists[dataField].visibles[n]=g.NotNullValues[l])}this.gridData[c].grid.loadDifferentValues(k,
this.gridData[c].differentValues[dataField]);if(h==void 0){k++;OAT_JS.grid.initValueRead(c,k)}}.closure(this),[this.gridData[c].grid.lastRequestValue,1,g,""])):(g++,OAT_JS.grid.initValueRead(c,g,h))},changeValues:function(c,g,h,j,k){h=jQuery("#"+c+g)[0];if(!((h.value||""==h.value)&&h.value!=k)){var h=this.gridData[c].columnDataField.indexOf(g),l=this.gridData[c].originalColumnDataField.indexOf(g);this.gridData[c].differentValuesPaginationInfo[g].filtered=!0;this.gridData[c].differentValuesPaginationInfo[g].blocked=
!0;OAT.removeAllPairsFromPopUp(this.gridData[c],h,1<j.PagesCount);this.gridData[c].filteredValuesPaginationInfo[g].previousPage=1;this.gridData[c].filteredValuesPaginationInfo[g].totalPages=j.PagesCount;this.gridData[c].filteredValuesPaginationInfo[g].filteredText=k;for(k=0;k<j.NotNullValues.length;k++){var n=-1!=this.gridData[c].differentValues[g].indexOf(j.NotNullValues[k]);-1==this.gridData[c].differentValues[g].indexOf(j.NotNullValues[k])&&this.gridData[c].differentValues[g].push(j.NotNullValues[k]);
("all"==this.gridData[c].blackLists[g].state||"Include"==this.gridData[c].blackLists[g].defaultAction&&!n)&&-1==this.gridData[c].blackLists[g].visibles.indexOf(j.NotNullValues[k])&&-1==this.gridData[c].blackLists[g].hiddens.indexOf(j.NotNullValues[k])&&this.gridData[c].blackLists[g].visibles.push(j.NotNullValues[k]);n=!0;"all"!=this.gridData[c].blackLists[g].state&&0>this.gridData[c].blackLists[g].visibles.indexOf(j.NotNullValues[k])&&(n=!1);this.gridData[c].filteredValuesPaginationInfo[g].values.push(j.NotNullValues[k]);
var o=OAT.ApplyPictureValue(j.NotNullValues[k].trimpivot(),this.gridData[c].rowsMetadata.columnsDataType[l],this.gridData[c].rowsMetadata.defaultPicture,this.gridData[c].rowsMetadata.forPivotCustomPicture[l]).replace(/ /g," ");this.gridData[c].blackLists[g].hasNull&&j.NotNullValues[k].trimpivot()==this.gridData[c].defaultNullText||OAT.appendNewPairToPopUp(this.gridData[c],j.NotNullValues[k],h,n,o,g)}0<j.PagesCount&&(this.gridData[c].differentValuesPaginationInfo[g].blocked=!1)}},setColumnVisibleValue:function(c,
g,h){g=this.gridData[c].originalColumnDataField.indexOf(this.gridData[c].columnDataField[g]);this.gridData[c].columnVisible[g]=h;OAT.SaveStateWhenServerPaging(OAT_JS.grid.gridData[c],c,OAT_JS.grid.gridData[c].blackLists,OAT_JS.grid.gridData[c].columnVisible,OAT_JS.grid.gridData[c].columnDataField);if(""!=qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].AutoRefreshGroup){OAT_JS.grid.initValueRead(c,0);var j=function(){if(OAT_JS.grid.gridData[c].endValueRead){var g=OAT.createXMLMetadata(OAT_JS.grid.gridData[c],
null,!0),h=qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection];""!=h&&(null!=h&&void 0!=h)&&qv.util.autorefresh.UpdateLayoutSameGroup(h,qv.pivot.GetRuntimeMetadata(g,h.RealType),!0)}else setTimeout(j,100)};j()}},getTableWhenServerPagination:function(c){return("<Recordset"+qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].getPageDataForTableSync([1,0,!0,"","",OAT_JS.grid.gridData[c].filterInfo,!1]).split("<Recordset")[1]).split("</Page>")[0]+"</Page>\n</Recordset>"},setFilterChangedWhenServerPagination:function(c,
g){if(qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChanged||qv.util.isGeneXusPreview()){var h=g.getAttribute("dataField"),j=OAT_JS.grid.gridData[c].differentValues[h];if(OAT_JS.grid.gridData[c].differentValuesPaginationInfo[h].previousPage==OAT_JS.grid.gridData[c].differentValuesPaginationInfo[h].totalPages){for(var k='<DATA event="FilterChanged" name="'+g.getAttribute("name")+'" displayName="'+g.getAttribute("displayName")+'">',l=0;l<j.length;l++){var n=!0;"all"!=OAT_JS.grid.gridData[c].blackLists[h].state&&
0>OAT_JS.grid.gridData[c].blackLists[h].visibles.indexOf(j[l])&&(n=!1);n&&(k=k+"<VALUE>"+j[l]+"</VALUE>")}k+="</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].ControlName,k);h=qv.util.dom.xmlDocument(k);h=qv.util.dom.selectXPathNode(h,"/DATA");qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChangedData={};qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChangedData.Name=h.getAttribute("name");
qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChangedData.SelectedValues=[];j=-1;for(k=0;k<h.childNodes.length;k++)"VALUE"==h.childNodes[k].nodeName&&(j++,qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChangedData.SelectedValues[j]=h.childNodes[k].firstChild.nodeValue);qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChanged&&qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChanged()}else OAT_JS.grid.gridData[c].differentValuesPaginationInfo[h].blocked=
!0,j=OAT_JS.grid.gridData[c].differentValuesPaginationInfo[h].previousPage+1,OAT_JS.grid.gridData[c].lastRequestValue=h,qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].getAttributeValues(function(h){h=JSON.parse(h);OAT_JS.grid.appendNewValueData(c,h,!0);OAT_JS.grid.setFilterChangedWhenServerPagination(c,g)}.closure(this),[h,j,0,""])}},getAllDataRowsForExport:function(c,g,h,j){qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].getPageDataForTable(function(k){for(var k=
k.split("<Record>"),l=[],n=1;n<k.length;n++){for(var o=[],m=0;m<OAT_JS.grid.gridData[c].grid.columns.length;m++){o[m]="#NuN#";var r=k[n].split("<"+OAT_JS.grid.gridData[c].grid.columns[m].getAttribute("dataField")+">");1<r.length&&(r=r[1].split("</"+OAT_JS.grid.gridData[c].grid.columns[m].getAttribute("dataField")+">"),o[m]=r[0])}l.push(o);"xlsx"!=j&&n>OAT_JS.grid.gridData[c].rowsPerPage&&""!=OAT_JS.grid.gridData[c].rowsPerPage&&OAT.CreateGridRow(o,OAT_JS.grid.gridData[c],!0)}switch(j){case "pdf":OAT.ExportToPdf(g,
h);break;case "xml":OAT.ExportToXML(g,h);break;case "html":OAT_JS.grid.gridData[c].grid.ExportToHtml(g,h);break;case "xls":OAT.ExportToExcel(g,h);break;case "xlsx":OAT.ExportToExcel2010(g,h,!0,l,c)}OAT_JS.grid.gridData[c].grid.removeAllCollapseRows()}.closure(this),[1,0,!1,OAT_JS.grid.gridData[c].dataFieldOrder,OAT_JS.grid.gridData[c].orderType,OAT_JS.grid.gridData[c].filterInfo],!1)},restoreDefaultView:function(c){this.gridData[c].redrawHeader=!0;this.gridData[c].columnDataField=this.gridData[c].originalColumnDataField;
OAT_JS.grid.gridData[c].dataFieldOrder="";OAT_JS.grid.gridData[c].orderType="";this.gridData[c].filterInfo=[];for(var g=[],h=0;h<OAT_JS.grid.gridData[c].grid.columns.length;h++)g[OAT_JS.grid.gridData[c].grid.columns[h].getAttribute("dataField")]=this.gridData[c].blackLists[OAT_JS.grid.gridData[c].grid.columns[h].getAttribute("dataField")].hasNull;for(h=0;h<OAT_JS.grid.gridData[c].grid.columns.length;h++)this.gridData[c].blackLists[OAT_JS.grid.gridData[c].grid.columns[h].getAttribute("dataField")]=
{state:"all",visibles:[],defaultAction:"Include",hiddens:[],hasNull:g[OAT_JS.grid.gridData[c].grid.columns[h].getAttribute("dataField")]};for(h=g=0;h<this.gridData[c].columnVisible.length;h++)this.gridData[c].grid.applySortOrderType(h,1),this.gridData[c].columnVisible[h]="yes"==OAT_JS.grid.gridData[c].grid.columns[h].getAttribute("visible").toLowerCase(),this.gridData[c].columnVisible[h]?this.gridData[c].grid.showColumnHeader(g):this.gridData[c].grid.hideColumnHeader(g),g+=1;this.gridData[c].rowsPerPage=
this.gridData[c].defaultValues.rowsPerPage;0<jQuery("#"+this.gridData[c].grid.controlName+"tablePagination_rowsPerPage").length&&(jQuery("#"+this.gridData[c].grid.controlName+"tablePagination_rowsPerPage")[0].value=this.gridData[c].defaultValues.rowsPerPage)},getStateChange:function(c){if(this.gridData[c].rowsPerPage!=this.gridData[c].defaultValues.rowsPerPage||(this.gridData[c].defaultValues.dataFieldOrder!=OAT_JS.grid.gridData[c].dataFieldOrder||this.gridData[c].defaultValues.orderType!=OAT_JS.grid.gridData[c].orderType)||
void 0!=this.gridData[c].filterInfo&&0<this.gridData[c].filterInfo.length)return!0;for(var g=0;g<this.gridData[c].columnVisible.length;g++){var h="yes"==OAT_JS.grid.gridData[c].grid.columns[g].getAttribute("visible").toLowerCase();if(this.gridData[c].columnVisible[g]!=h)return!0}for(g=0;g<this.gridData[c].columnDataField.length;g++)if(this.gridData[c].columnDataField[g]!=this.gridData[c].originalColumnDataField[g])return!0;return!1},refreshPivotWhenServerPagination:function(c,g,h){self.getDataForTable(c,
1,this.gridData[c].rowsPerPage,!0,g,h,"","","",!0)},moveToFirstPage:function(c){1<this.gridData[c].actualPageNumber&&self.getDataForTable(c,1,this.gridData[c].rowsPerPage,!1,"","","","",!1)},moveToNextPage:function(c){this.gridData[c].actualPageNumber<this.gridData[c].actualCantPages&&self.getDataForTable(c,this.gridData[c].actualPageNumber+1,this.gridData[c].rowsPerPage,!1,"","","","",!1)},moveToLastPage:function(c){this.gridData[c].actualPageNumber<this.gridData[c].actualCantPages&&self.getDataForTable(c,
this.gridData[c].actualCantPages,this.gridData[c].rowsPerPage,!1,"","","","",!1)},moveToPreviousPage:function(c){1<this.gridData[c].actualPageNumber&&self.getDataForTable(c,this.gridData[c].actualPageNumber-1,this.gridData[c].rowsPerPage,!1,"","","","",!1)},cantPages:function(c,g){return this.gridData[c].differentValuesPaginationInfo[g].totalPages},setDataFieldPosition:function(c,g){this.gridData[c].columnDataField=[];this.gridData[c].columnDataField=g;OAT.SaveStateWhenServerPaging(this.gridData[c],
c,this.gridData[c].blackLists,this.gridData[c].columnVisible,this.gridData[c].columnDataField);if(""!=qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].AutoRefreshGroup){OAT_JS.grid.initValueRead(c,0);var h=function(){if(OAT_JS.grid.gridData[c].endValueRead){var g=OAT.createXMLMetadata(OAT_JS.grid.gridData[c],null,!0),k=qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection];""!=k&&(null!=k&&void 0!=k)&&qv.util.autorefresh.UpdateLayoutSameGroup(k,qv.pivot.GetRuntimeMetadata(g,
k.RealType),!0)}else setTimeout(h,100)};h()}},addValueToDifferentValues:function(c,g,h){var j=this.gridData[c].originalColumnDataField.indexOf(g),k=this.gridData[c].grid.columnsDataType[j],j=!1;if("integer"==k||"real"==k)j=!0;var k=[],l=!1;"#NuN#"==h&&(k.push(h),l=!0);for(var n=0;n<this.gridData[c].differentValues[g].length;n++)j?parseFloat(h)<parseFloat(this.gridData[c].differentValues[g][n])&&!l&&(k.push(h),l=!0):h<this.gridData[c].differentValues[g][n]&&!l&&(k.push(h),l=!0),k.push(this.gridData[c].differentValues[g][n]);
l||k.push(h);this.gridData[c].differentValues[g]=k}},pivot:{panel:1,tab:5,div:"",needs:["pivot","statistics"],cb:function(c,g,h,j,k,l,n,o,m,r,t,u,v,x,B,H,w,z,q,C,y,G,I,D,F){this.div=g;var J=columnNumbers.length+rowNumbers.length+filterNumbers.length;if(1<measures.length)for(var Q=J,J=J+measures.length-1;Q<J;Q++)columnNumbers.push(Q);else for(Q=0;Q<data.length;Q++)data[Q].push("0");var U;try{U=new OAT.Pivot(c,j,h,header,data,columnNumbers,rowNumbers,filterNumbers,J,query,conditionalFormats,v,pageSize,
k,l,n,g,o,m,r,measures,t,u,v,x,B,H,w,z,q,C,y,G,I,D,{Allow:F.AllowSelection,EntireLine:F.SelectLine},{TotalForRows:F.TotalForRows,TotalForColumns:F.TotalForColumns},F.Title)}catch(V){}return U}}},parseToIntRegisterValue=function(c,g){if(0<c.indexOf(g)){var h=c.split(g+'="');return 1==h.length?(h=c.split(g+"='"),h[1]?parseInt(h[1].split("'")[0]):-1):h[1]?parseInt(h[1].split('"')[0]):-1}return-1},parseToStringRegisterValue=function(c,g){if(0<c.indexOf(g)){var h=c.split(g+'="');return 1==h.length?(h=
c.split(g+"='"),h[1]?h[1].split("'")[0]:-1):h[1]?h[1].split('"')[0]:-1}return-1},EvaluateExpressionPivotJs=function(c,g,h){for(var j=[],k=0;k<c.length;k++)j[k]=c[k];for(c=[];0!=j.length;)if(k=j.shift(),isOperator(k)){var l=c.pop(),n=c.pop(),k=PerformOperation(parseFloat(l),parseFloat(n),k);c.push(k)}else if(isNaN(parseInt(k))){if("#NuN#"==g[h.itemPosition[k]])return"#NuN#";c.push(g[h.itemPosition[k]])}else c.push(k);return c.pop()},PerformOperation=function(c,g,h){switch(h){case "+":return c+g;case "-":return g-
c;case "*":return c*g;case "/":return g/c}},InfixToPostfix=function(c){for(var c=c.split(" "),g=[],h=[];0!=c.length;){var j=c.shift();if(isOperator(j)){for(;"left"==getAssociativity(j)&&getPrecedence(j)<=getPrecedence(h[h.length-1])||"right"==getAssociativity(j)&&getPrecedence(j)<getPrecedence(h[h.length-1]);)g.push(h.pop());h.push(j)}else if("("==j)h.push(j);else if(")"==j){for(;"("!=h[h.length-1];){if(0==h.length)throw"";g.push(h.pop())}h.pop()}else g.push(j)}for(;0!=h.length;){if(h[h.length-1].match(/([()])/))throw"Parenthesis balancing error! Shame on you!";
g.push(h.pop())}return g.join(" ")},isOperator=function(c){return c.match(/([*+-\/])/)?!0:!1},isNumber=function(c){return c.match(/([0-9]+)/)?!0:!1},getPrecedence=function(c){switch(c){case "^":return 9;case "*":case "/":case "%":return 8;case "+":case "-":return 6;default:return-1}},getAssociativity=function(c){switch(c){case "+":case "-":case "*":case "/":return"left";case "^":return"right"}},OATSetCookie=function(c,g,h,j,k,l){document.cookie=c+"="+escape(g)+(null==h?"":"; expires="+h.toGMTString())+
(null==j?"":"; path="+j)+(null==k?"":"; domain="+k)+(null==l?"":"; secure")},OATGetCookie=function(c){var c=c+"=",g=document.cookie;return 0<g.length&&(begin=g.indexOf(c),-1!=begin)?(begin+=c.length,end=g.indexOf(";",begin),-1==end&&(end=g.length),unescape(g.substring(begin,end))):null},OATIsNotEmptyValue=function(c){return"#NaV#"!=c&&"#NuN#"!=c},OATGetRowsFromXML=function(c,g,h){var j=[],c=c.split("<Rows>");if(c.length)for(var c=c[1].split("</Rows>"),c=c[0].split("<Row>"),k=1;k<c.length;k++){var l=
{headers:[],cells:[],subTotal:!1,dataField:-1,rowSpan:0};"true"==parseToStringRegisterValue(c[k],"Subtotal")&&(l.subTotal=!0);var n;n=0<c[k].indexOf("</Header>")?c[k].split("</Header>")[0].replace("<Header>",""):c[k].split("/>")[0].replace("<Header","");l.dataField=parseToStringRegisterValue(n,"DataField");n=n.replace(/<\//g,"-*-5").replace(/\/>/g,"-*-5").split("-*-5");for(var o=1;o<n.length;o++){var m,r=n[o].split(">")[0];if(""==r)r=n[o-1].split("<")[1].split(" ")[0],m="#NuN#";else try{m=n[o-1].split(r+
">")[1].split("<")[0]}catch(t){m="#NuN#"}var r={dataField:r,value:m,rowSpan:1},u=n.length-1;h&&(u=n.length,l.subTotal&&u--);u=0<=o-u;if(0<j.length&&!u&&(0==o-1||0==l.headers[o-2].rowSpan)&&m==j[k-2].headers[o-1].value){r.rowSpan=0;for(u=k-2;0<=u;){if(0<j[u].headers[o-1].rowSpan){j[u].headers[o-1].rowSpan++;break}u--}}l.headers.push(r)}if(h&&l.subTotal)if(1==k||!j[k-2].subTotal||l.headers.length!=j[k-2].headers.length)l.rowSpan=1;else for(u=k-2;0<=u;){if(0<j[u].rowSpan){j[u].rowSpan++;break}u--}n=
c[k].split("<Cells>")[1].split("</Cell>");for(o=0;o<n.length-1;o++){for(var v=-1!=l.dataField?l.dataField:g.columnsHeaders[o].dataField,r=1;r<n[o].split("<Cell />").length;r++)u={value:"#NuN#",dataField:v},l.cells.push(u);m=n[o].split("<Cell>")[1];u={value:m,dataField:v};l.cells.push(u)}for(r=1;r<n[o].split("<Cell />").length;r++)u={value:"#NuN#",dataField:v},l.cells.push(u);j.push(l)}return j},OATGetColumnsHeadersFromXML=function(c){var g=c.split("<Columns>"),c=[];if(1<g.length)for(var g=g[1].split("</Columns>")[0],
g=g.split("<Header"),h=1;h<g.length;h++){var j=parseToStringRegisterValue(g[h],"DataField"),k=parseToStringRegisterValue(g[h],"Subtotal"),l=[],n=g[h].replace('DataField="'+j+'">',"").replace("DataField='"+j+"'>","").replace("</Header>","").replace(/IsNull="true" \/>/g,">#NuN#<F>").replace(/IsNull='true' \/>/g,">#NuN#<F>").replace(/IsNull="true"\/>/g,">#NuN#<F>").split("<");if(1<n.length)for(var o=1;o<n.length-1;o++)if(1==o%2){var m=n[o].split(">")[0],r=n[o].split(m+">")[1];l.push({dataField:m,value:r,
colSpan:1})}c.push({dataField:j,subTotal:"true"==k,subHeaders:l})}return c},OATGetDataFromXMLForPivot=function(c,g){dataString.split("<Record>");var h={};h.ServerRecordCount=parseToIntRegisterValue(c,"RecordCount");h.ServerPageCount=parseToIntRegisterValue(c,"PageCount");h.ServerPageNumber=parseToIntRegisterValue(c,"PageNumber");h.columnsHeaders=OATGetColumnsHeadersFromXML(c);h.rows=OATGetRowsFromXML(c,h,g);return h},OATGetNewDataFromXMLForPivot=function(c,g,h,j){c=c.replace(/<Cell\/>/g,"<Cell />");
if(void 0==j||""==j)if(-1!=parseToIntRegisterValue(c,"RecordCount")&&(g.ServerRecordCount=parseToIntRegisterValue(c,"RecordCount")),-1!=parseToIntRegisterValue(c,"PageCount"))g.ServerPageCount=parseToIntRegisterValue(c,"PageCount");g.ServerPageNumber=parseToIntRegisterValue(c,"PageNumber");1<c.split("<Columns>").length&&(g.columnsHeaders=OATGetColumnsHeadersFromXML(c));g.rows=OATGetRowsFromXML(c,g,h);return g},OATgetDataFromXMLOldFormat=function(c,g,h){for(var c=c.split("<Record>"),j=[],k=[],l=1;l<
c.length;l++){for(var n=[],o=[],m=0;m<g.length;m++){n[m]="#NuN#";var r=c[l].split("<"+g[m]+">");1<r.length&&(r=r[1].split("</"+g[m]+">"),n[m]=r[0],o[m]=n[m])}j.push(n);if(void 0!=h){n=g.length;for(m=0;m<h.length;m++)o[n+m]=void 0,r=c[l].split("<"+h[m]+">"),1<r.length&&(r=r[1].split("</"+h[m]+">"),o[n+m]=r[0]);k.push(o)}}return void 0!=h?[j,k]:j},OATgetAllDataFromXMLOldFormat=function(c,g,h){for(var c=c.split("<Record>"),j=[],k=[],l=1;l<c.length;l++){for(var n=[],o=[],m=0;m<g.length;m++){n[m]="#NuN#";
var r=c[l].split("<"+g[m]+">");1<r.length&&(r=r[1].split("</"+g[m]+">"),n[m]=r[0],o[m]=n[m])}j.push(n);n=g.length;for(m=0;m<h.length;m++)o[n+m]=void 0,r=c[l].split("<"+h[m]+">"),1<r.length&&(r=r[1].split("</"+h[m]+">"),o[n+m]=r[0]);k.push(o)}return[j,k]};OATParseMetadata=function(c,g,h,j){var k=[],l=[],n=[],o;o=-1!=c.indexOf("<OLAPDimension")?c.substring(0,c.indexOf("<OLAPDimension")):c.substring(0,c.indexOf("<OLAPMeasure"));for(var m=c.substring(c.indexOf("<OLAPDimension"),c.length),r=m.split("<OLAPDimension"),
t=1;t<r.length;t++)if(0<r[t].length)if(r[t]=-1!=r[t].indexOf("</OLAPDimension>")?r[t].substring(0,r[t].indexOf("</OLAPDimension>")):r[t].substring(0,r[t].indexOf("/>"))+">",c=!1,void 0!=g&&0<g.length&&(c=r[t].split('dataField="')[1].split('"')[0],c=-1!=g.indexOf(c)),(-1!=r[t].indexOf('visible="No"')||-1!=r[t].indexOf('visible="Never"'))&&void 0==g||c&&void 0!=g){try{if(-1!=r[t].indexOf("displayName=")){var u=r[t].substring(r[t].indexOf("displayName=")+13);k.push(u.split('"')[0]);l.push(r[t].substring(r[t].indexOf("dataField=")+
11).split('"')[0]);try{n.push(r[t].substring(r[t].indexOf("name=")+6).split('"')[0])}catch(v){}}}catch(x){}r[t]=""}else r[t]="<OLAPDimension "+r[t]+"</OLAPDimension>";else r[t]="";g=m.split("<OLAPMeasure");u=!0;for(t=1;t<g.length;t++)(c=!1,void 0!=h&&0<h.length&&(c=g[t].split('dataField="')[1].split('"')[0],c=-1!=h.indexOf(c)),c)?g[t]="":(g[t]=-1!=g[t].indexOf("</OLAPMeasure")?"<OLAPMeasure "+g[t].substring(0,g[t].indexOf("</OLAPMeasure>"))+"</OLAPMeasure>":-1!=g[t].indexOf("/>")?"<OLAPMeasure "+
g[t].substring(0,g[t].indexOf("/>"))+"/>":"",u=!1);j&&u&&g.push('<OLAPMeasure name="Quantity" displayName="'+gx.getMessage("GXPL_QViewerQuantity")+'" description="'+gx.getMessage("GXPL_QViewerQuantity")+'" dataField="F0" aggregation="count" summarize="yes" align="right" picture="" targetValue="0" defaultPosition="data" validPositions="data" dataType="integer" format="borderThickness:1"> </OLAPMeasure>');c=o;for(t=1;t<r.length;t++)0<r[t].length&&(c+=r[t]);for(t=1;t<g.length;t++)0<g[t].length&&(c+=
g[t]);return[c+"</OLAPCube>",k,l,n]};OATGetColumnsAndMeasureMeatadata=function(c,g,h,j){for(var k=[],l=[],n=[],o=[],m=[],r=[],t=[],u=[],v=[],x=0,B=0,H=[],w=[],z=[],q=0;q<c.length;q++){if("rows"==c[q].attributes.getNamedItem("axis").nodeValue.toLowerCase()||""==c[q].attributes.getNamedItem("axis").nodeValue)l[x]=c[q].attributes.getNamedItem("displayName").nodeValue,k[q]=l[x],x++;"columns"==c[q].attributes.getNamedItem("axis").nodeValue.toLowerCase()&&(n[B]=c[q].attributes.getNamedItem("displayName").nodeValue,
k[q]=n[B],B++);"pages"==c[q].attributes.getNamedItem("axis").nodeValue.toLowerCase()&&(o[B]=c[q].attributes.getNamedItem("displayName").nodeValue,k[q]=o[B],B++);c[q].attributes.getNamedItem("dataType");if(0<c[q].childNodes.length&&null!=c[q].childNodes)for(var C=0;C<c[q].childNodes.length;C++)if("formatValues"==c[q].childNodes[C].localName)for(var y=0;y<c[q].childNodes[C].childNodes.length;y++)if("value"==c[q].childNodes[C].childNodes[y].localName){var G={};G.format=c[q].childNodes[C].childNodes[y].attributes.getNamedItem("format").nodeValue;
G.recursive=c[q].childNodes[C].childNodes[y].attributes.getNamedItem("recursive").nodeValue;var I=c[q].childNodes[C].childNodes[y].textContent;G.value=I.replace(/^\s+|\s+$/g,"");G.columnNumber=q;m.push(G)}if(0<c[q].childNodes.length&&null!=c[q].childNodes)for(C=0;C<c[q].childNodes.length;C++)if("conditionalFormats"==c[q].childNodes[C].localName)for(y=0;y<c[q].childNodes[C].childNodes.length;y++)"rule"==c[q].childNodes[C].childNodes[y].localName&&(G={},G.format=c[q].childNodes[C].childNodes[y].attributes.getNamedItem("format").nodeValue,
G.operation1=c[q].childNodes[C].childNodes[y].attributes.getNamedItem("op1").nodeValue,G.value1=c[q].childNodes[C].childNodes[y].attributes.getNamedItem("value1").nodeValue,null!=c[q].childNodes[C].childNodes[y].attributes.getNamedItem("op2")&&(G.operation2=c[q].childNodes[C].childNodes[y].attributes.getNamedItem("op2").nodeValue,G.value2=c[q].childNodes[C].childNodes[y].attributes.getNamedItem("value2").nodeValue),G.columnNumber=q,r.push(G));w.push(c[q].attributes.getNamedItem("picture").nodeValue);
z.push(c[q].attributes.getNamedItem("format").nodeValue);v.push(c[q].attributes.getNamedItem("dataField").nodeValue)}c=[];for(q=0;q<g.length;q++){H[q]=g[q].attributes.getNamedItem("displayName").nodeValue;if(0<g[q].childNodes.length&&null!=g[q].childNodes)for(C=0;C<g[q].childNodes.length;C++)if("formatValues"==g[q].childNodes[C].localName)for(y=0;y<g[q].childNodes[C].childNodes.length;y++)"value"==g[q].childNodes[C].childNodes[y].localName&&(G={},G.format=g[q].childNodes[C].childNodes[y].attributes.getNamedItem("format").nodeValue,
G.recursive=g[q].childNodes[C].childNodes[y].attributes.getNamedItem("recursive").nodeValue,I=g[q].childNodes[C].childNodes[y].textContent,G.value=I.replace(/^\s+|\s+$/g,""),G.columnNumber=q,t.push(G));if(0<g[q].childNodes.length&&null!=g[q].childNodes)for(C=0;C<g[q].childNodes.length;C++)if("conditionalFormats"==g[q].childNodes[C].localName)for(y=0;y<g[q].childNodes[C].childNodes.length;y++)"rule"==g[q].childNodes[C].childNodes[y].localName&&(G={},G.format=g[q].childNodes[C].childNodes[y].attributes.getNamedItem("format").nodeValue,
G.operation1=g[q].childNodes[C].childNodes[y].attributes.getNamedItem("op1").nodeValue,G.value1=g[q].childNodes[C].childNodes[y].attributes.getNamedItem("value1").nodeValue,null!=g[q].childNodes[C].childNodes[y].attributes.getNamedItem("op2")&&(G.operation2=g[q].childNodes[C].childNodes[y].attributes.getNamedItem("op2").nodeValue,G.value2=g[q].childNodes[C].childNodes[y].attributes.getNamedItem("value2").nodeValue),G.columnNumber=q,u.push(G));void 0!=g[q].attributes.getNamedItem("formula")&&""!=g[q].attributes.getNamedItem("formula").nodeValue?
c.push({hasFormula:!0,textFormula:g[q].attributes.getNamedItem("formula").nodeValue}):c.push({hasFormula:!1});w.push(g[q].attributes.getNamedItem("picture").nodeValue);v.push(g[q].attributes.getNamedItem("dataField").nodeValue)}y={};for(x=0;x<j.length;x++)y[j[x]]=v.length+x;h.itemPosition=y;h.measureFormula=c;for(y=h.cantFormulaMeasures=0;y<h.measureFormula.length;y++)if(h.measureFormula[y].hasFormula){h.cantFormulaMeasures++;B=h.measureFormula[y].textFormula;j="*-+/()".split("");for(x=0;x<j.length;x++)if(g=
B.split(j[x]),1<g.length){B="";for(q=0;q<g.length-1;q++)B=B+g[q]+" "+j[x]+" ";B+=g[g.length-1]}x=InfixToPostfix(B);h.measureFormula[y].polishNotationText=x;for(q=x.split(" ");-1!=q.indexOf("");)q.splice(q.indexOf(""),1);g=[];for(B=0;B<q.length;B++)-1==j.indexOf(q[B])&&isNaN(parseInt(q[B]))&&(t=h.itemPosition[q[B]],-1==g.indexOf(t)&&g.push(t));h.measureFormula[y].relatedMeasures=g;for(B=x.split(" ");-1!=B.indexOf("");)B.splice(B.indexOf(""),1);h.measureFormula[y].PolishNotation=B}return[k.concat(H),
v,c,u,r,w,z]};OATgetState=function(c,g){"function"!==typeof JSON.retrocycle&&(JSON.retrocycle=function(c){var g=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function t(c){var h,k,j;if(c&&"object"===typeof c)if("[object Array]"===Object.prototype.toString.apply(c))for(h=0;h<c.length;h+=1){if((k=c[h])&&"object"===typeof k)j=k.$ref,"string"===typeof j&&g.test(j)?c[h]=eval(j):t(k)}else for(h in c)if("object"===typeof c[h]&&(k=c[h]))j=k.$ref,"string"===typeof j&&
g.test(j)?c[h]=eval(j):t(k)})(c);return c});try{var h;if(null!=localStorage.getItem(OAT.getURL()+c+g+"HiddenState")){var j=localStorage.getItem(OAT.getURL()+c+g+"HiddenState");h=JSON.retrocycle(JSON.parse(j))}if(null==h){var k=OATGetCookie('"'+OAT.getURL()+c+g+'HiddenStatecookie"');null!=k&&(h=JSON.parse(k))}return h}catch(l){try{return k=OATGetCookie('"'+OAT.getURL()+c+g+'HiddenStatecookie"'),h=JSON.parse(k)}catch(n){return null}}};var init=function(){}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){OAT.Layers=function(c){var g=this;this.baseOffset=c;this.layers=[];this.currentIndex=0;this.raise=function(c){if(-1!=g.layers.indexOf(c)){for(var j=c.style.zIndex,k=0;k<g.layers.length;k++){var l=g.layers[k];l.style.zIndex>j&&l.style.zIndex--}c.style.zIndex=g.currentIndex}};this.addLayer=function(c,j){var k=OAT.$(c);k&&(g.currentIndex++,k.style.zIndex=g.currentIndex,g.layers.push(k),OAT.Dom.attach(k,j?j:"mousedown",function(){g.raise(k)}))};
this.removeLayer=function(c){c=OAT.$(c);c=g.layers.indexOf(c);-1!=c&&g.layers.splice(c,1)};g.currentIndex=g.baseOffset};(function(){function c(c){function h(h,k){var n,C,y=h==window,G=k&&void 0!==k.message?k.message:void 0,k=c.extend({},c.blockUI.defaults,k||{});if(!k.ignoreIfBlocked||!c(h).data("blockUI.isBlocked")){k.overlayCSS=c.extend({},c.blockUI.defaults.overlayCSS,k.overlayCSS||{});n=c.extend({},c.blockUI.defaults.css,k.css||{});k.onOverlayClick&&(k.overlayCSS.cursor="pointer");C=c.extend({},
c.blockUI.defaults.themedCSS,k.themedCSS||{});G=void 0===G?k.message:G;y&&B&&j(window,{fadeOut:0});if(G&&"string"!=typeof G&&(G.parentNode||G.jquery)){var I=G.jquery?G[0]:G,D={};c(h).data("blockUI.history",D);D.el=I;D.parent=I.parentNode;D.display=I.style.display;D.position=I.style.position;D.parent&&D.parent.removeChild(I)}c(h).data("blockUI.onUnblock",k.onUnblock);var D=k.baseZ,F;F=u||k.forceIframe?c('<iframe class="blockUI" style="z-index:'+D++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+
k.iframeSrc+'"></iframe>'):c('<div class="blockUI" style="display:none"></div>');I=k.theme?c('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+D++ +';display:none"></div>'):c('<div class="blockUI blockOverlay" style="z-index:'+D++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');k.theme&&y?(D='<div class="blockUI '+k.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(D+10)+';display:none;position:fixed">',
k.title&&(D+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(k.title||"&nbsp;")+"</div>"),D+='<div class="ui-widget-content ui-dialog-content"></div></div>'):k.theme?(D='<div class="blockUI '+k.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(D+10)+';display:none;position:absolute">',k.title&&(D+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(k.title||"&nbsp;")+"</div>"),D+='<div class="ui-widget-content ui-dialog-content"></div></div>'):
D=y?'<div class="blockUI '+k.blockMsgClass+' blockPage" style="z-index:'+(D+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+k.blockMsgClass+' blockElement" style="z-index:'+(D+10)+';display:none;position:absolute"></div>';D=c(D);G&&(k.theme?(D.css(C),D.addClass("ui-widget-content")):D.css(n));k.theme||I.css(k.overlayCSS);I.css("position",y?"fixed":"absolute");(u||k.forceIframe)&&F.css("opacity",0);n=[F,I,D];var J=y?c("body"):c(h);c.each(n,function(){this.appendTo(J)});k.theme&&(k.draggable&&
c.fn.draggable)&&D.draggable({handle:".ui-dialog-titlebar",cancel:"li"});C=x&&(!c.support.boxModel||0<c("object,embed",y?null:h).length);if(v||C){y&&(k.allowBodyStretch&&c.support.boxModel)&&c("html,body").css("height","100%");if((v||!c.support.boxModel)&&!y){C=r(h,"borderTopWidth");var Q=r(h,"borderLeftWidth"),U=C?"(0 - "+C+")":0,V=Q?"(0 - "+Q+")":0}c.each(n,function(c,g){var h=g[0].style;h.position="absolute";if(c<2){y?h.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+
k.quirksmodeOffsetHack+') + "px"'):h.setExpression("height",'this.parentNode.offsetHeight + "px"');y?h.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):h.setExpression("width",'this.parentNode.offsetWidth + "px"');V&&h.setExpression("left",V);U&&h.setExpression("top",U)}else if(k.centerY){y&&h.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');
h.marginTop=0}else if(!k.centerY&&y){var j="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+(k.css&&k.css.top?parseInt(k.css.top,10):0)+') + "px"';h.setExpression("top",j)}})}G&&(k.theme?D.find(".ui-widget-content").append(G):D.append(G),(G.jquery||G.nodeType)&&c(G).show());(u||k.forceIframe)&&k.showOverlay&&F.show();k.fadeIn?(n=k.onBlock?k.onBlock:t,F=k.showOverlay&&!G?n:t,n=G?n:t,k.showOverlay&&I._fadeIn(k.fadeIn,F),G&&D._fadeIn(k.fadeIn,
n)):(k.showOverlay&&I.show(),G&&D.show(),k.onBlock&&k.onBlock.bind(D)());l(1,h,k);y?(B=D[0],H=c(k.focusableElements,B),k.focusInput&&setTimeout(o,20)):m(D[0],k.centerX,k.centerY);k.timeout&&(G=setTimeout(function(){y?c.unblockUI(k):c(h).unblock(k)},k.timeout),c(h).data("blockUI.timeout",G))}}function j(h,j){var m,n=h==window,o=c(h),r=o.data("blockUI.history"),t=o.data("blockUI.timeout");t&&(clearTimeout(t),o.removeData("blockUI.timeout"));j=c.extend({},c.blockUI.defaults,j||{});l(0,h,j);null===j.onUnblock&&
(j.onUnblock=o.data("blockUI.onUnblock"),o.removeData("blockUI.onUnblock"));var u;u=n?c("body").children().filter(".blockUI").add("body > .blockUI"):o.find(">.blockUI");if(j.cursorReset&&(1<u.length&&(u[1].style.cursor=j.cursorReset),2<u.length))u[2].style.cursor=j.cursorReset;n&&(B=H=null);j.fadeOut?(m=u.length,u.stop().fadeOut(j.fadeOut,function(){--m===0&&k(u,r,j,h)})):k(u,r,j,h)}function k(h,k,j,l){var m=c(l);if(!m.data("blockUI.isBlocked")){h.each(function(){this.parentNode&&this.parentNode.removeChild(this)});
k&&k.el&&(k.el.style.display=k.display,k.el.style.position=k.position,k.el.style.cursor="default",k.parent&&k.parent.appendChild(k.el),m.removeData("blockUI.history"));m.data("blockUI.static")&&m.css("position","static");if("function"==typeof j.onUnblock)j.onUnblock(l,j);h=c(document.body);k=h.width();j=h[0].style.width;h.width(k-1).width(k);h[0].style.width=j}}function l(h,k,j){var l=k==window,k=c(k);if(h||!(l&&!B||!l&&!k.data("blockUI.isBlocked")))k.data("blockUI.isBlocked",h),l&&(j.bindEvents&&
(!h||j.showOverlay))&&(h?c(document).bind("mousedown mouseup keydown keypress keyup touchstart touchend touchmove",j,n):c(document).unbind("mousedown mouseup keydown keypress keyup touchstart touchend touchmove",n))}function n(h){if("keydown"===h.type&&h.keyCode&&9==h.keyCode&&B&&h.data.constrainTabKey){var k=H,j=h.shiftKey&&h.target===k[0];if(!h.shiftKey&&h.target===k[k.length-1]||j)return setTimeout(function(){o(j)},10),!1}var k=h.data,l=c(h.target);if(l.hasClass("blockOverlay")&&k.onOverlayClick)k.onOverlayClick(h);
return 0<l.parents("div."+k.blockMsgClass).length?!0:0===l.parents().children().filter("div.blockUI").length}function o(c){H&&(c=H[!0===c?H.length-1:0])&&c.focus()}function m(c,g,h){var k=c.parentNode,j=c.style,l=(k.offsetWidth-c.offsetWidth)/2-r(k,"borderLeftWidth"),c=(k.offsetHeight-c.offsetHeight)/2-r(k,"borderTopWidth");g&&(j.left=0<l?l+"px":"0");h&&(j.top=0<c?c+"px":"0")}function r(h,k){return parseInt(c.css(h,k),10)||0}c.fn._fadeIn=c.fn.fadeIn;var t=c.noop||function(){},u=/MSIE/.test(navigator.userAgent),
v=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent),x=c.isFunction(document.createElement("div").style.setExpression);c.blockUI=function(c){h(window,c)};c.unblockUI=function(c){j(window,c)};c.growlUI=function(h,k,j,l){var m=c('<div class="growlUI"></div>');h&&m.append("<h1>"+h+"</h1>");k&&m.append("<h2>"+k+"</h2>");void 0===j&&(j=3E3);var n=function(h){h=h||{};c.blockUI({message:m,fadeIn:"undefined"!==typeof h.fadeIn?h.fadeIn:700,fadeOut:"undefined"!==typeof h.fadeOut?h.fadeOut:
1E3,timeout:"undefined"!==typeof h.timeout?h.timeout:j,centerY:!1,showOverlay:!1,onUnblock:l,css:c.blockUI.defaults.growlCSS})};n();m.css("opacity");m.mouseover(function(){n({fadeIn:0,timeout:3E4});var h=c(".blockMsg");h.stop();h.fadeTo(300,1)}).mouseout(function(){c(".blockMsg").fadeOut(1E3)})};c.fn.block=function(k){if(this[0]===window)return c.blockUI(k),this;var j=c.extend({},c.blockUI.defaults,k||{});this.each(function(){var h=c(this);(!j.ignoreIfBlocked||!h.data("blockUI.isBlocked"))&&h.unblock({fadeOut:0})});
return this.each(function(){"static"==c.css(this,"position")&&(this.style.position="relative",c(this).data("blockUI.static",!0));this.style.zoom=1;h(this,k)})};c.fn.unblock=function(h){return this[0]===window?(c.unblockUI(h),this):this.each(function(){j(this,h)})};c.blockUI.version=2.7;c.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",
cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:0.1,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:0.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1E3,centerX:!0,centerY:!0,
allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var B=null,H=[]}"function"===typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],c):c(jQuery)})();try{OAT.Loader.featureLoaded("layers")}catch(ERROR$$13){}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){if(void 0==GlobalPivotInterval)var GlobalPivotInterval=[];OAT.Pivot=function(c,g,h,j,k,l,n,o,m,r,t,u,v,x,B,H,w,z,q,C,y,G,I,D,F,J,Q,U,V,L,S,W,E,N,M,Z,R,aa){var f=this;this.autoPaging=!1;this.prevRowWhenAutopaging=this.nextRowWhenAutopaging=0;this.paginationInfo=!1;this.TempDataStructForAggStepOptimization=[];this.actualPaginationPage=1;this.allDataWithoutSort=jQuery.extend(!0,[],k);this.IdForQueryViewerCollection=F;this.UcId=D;this.ShowMeasuresAsRows=
Q;this.rememberLayoutStateVersion=L?"4.3.8SP":"4.3.8";2>y.length&&(this.ShowMeasuresAsRows=!1);this.swfPath=gx.util.resourceUrl(M+"QueryViewer/oatPivot/downloadify/media/downloadify.swf");this.downloadImagePath=gx.util.resourceUrl(M+"QueryViewer/oatPivot/images/download_file.png");this.allRowsPivot="vacio";this.HideDataFilds=W;this.OrderFildsHidden=E;this.initMetadata=N;this.relativePath=M;this.selection=Z;this.GrandTotalVisibility=R;this.isSD=this.Debugg=!1;Q=-1<navigator.userAgent.toLowerCase().indexOf("android");
if(gx.util.browser.isIPad()||(gx.util.browser.isIPhone()||Q)||this.Debugg)this.isSD=!0;fromUndefinedToBlanck(k);if(void 0!=k[0]){if(0<U.cantFormulaMeasures)for(var O=0;O<k.length;O++)k[O][j.length]=O;for(var Q=[],Y=j.length-1;-1<Y;Y--){W=!0;for(E=0;E<k.length;E++)if(W&&k[E][Y]!=parseInt(k[E][Y])){W=!1;break}Q[Y]=W}Y=0;k=Q[Y]?k.sort(function(f){return function(c,g){return parseInt(c[f])===parseInt(g[f])?0:parseInt(c[f])<parseInt(g[f])?-1:1}}(Y)):k.sort(function(f){return function(c,g){return c[f]===
g[f]?0:c[f]<g[f]?-1:1}}(Y));W=k[0][Y];for(O=E=0;O<k.length;O++)W!=k[O][Y]?(W=k[O][Y],k=OAT.PartialSort(k,E,O-1,Y+1,j.length,Q),E=O):O==k.length-1&&(k=OAT.PartialSort(k,E,O,Y+1,j.length,Q))}Q=k;k=[];0<Q.length&&(k[0]=Q[0]);W=0;for(O=1;O<Q.length;O++){E=!0;for(R=0;R<H.length;R++)if(Q[O][R]!=Q[O-1][R]){E=!1;break}if(E){for(R=H.length;R<H.length+y.length;R++)M=parseFloat(k[W][R])+parseFloat(Q[O][R]),"#NuN#"==k[W][R]&&"#NuN#"==Q[O][R]?M="#NuN#":"#NuN#"==k[W][R]?M=Q[O][R]+"":"#NuN#"==Q[O][R]&&(M=k[W][R]+
""),k[W][R]=M+"";if(0<U.cantFormulaMeasures){Z=k[W][j.length];E=Q[O][j.length];for(R=0;R<U.measureFormula.length;R++)if(U.measureFormula[R].hasFormula)for(var ba=0;ba<U.measureFormula[R].relatedMeasures.length;ba++){var ia=U.measureFormula[R].relatedMeasures[ba],M=parseFloat(V[Z][ia])+parseFloat(V[E][ia]);V[Z][ia]=M+""}for(R=H.length;R<H.length+y.length;R++)M=parseFloat(V[Z][R])+parseFloat(V[E][R]),V[Z][R]=M+"";for(M=0;M<j.length;M++)V[E][M]=""}}else W++,k[W]=Q[O]}if(0<U.cantFormulaMeasures&&void 0!=
k[0])for(Q=0;Q<k.length;Q++)k[Q].splice(j.length,1);this.serverPagination=L;this.pageData=S;this.serverPagination&&(this.pageData.PreviousPageNumber=-1,this.pageData.AxisInfo=[],this.pageData.FilterInfo=[]);if(!this.serverPagination&&void 0!=v&&(1<H.length||0<y.length))if(void 0!=k[0]&&(4>k[0].length-o.length&&4004<k.length)&&(this.autoPaging=!0),void 0!=k[0]&&(4==k[0].length-o.length&&2701<k.length)&&(this.autoPaging=!0),void 0!=k[0]&&(5==k[0].length-o.length&&2501<k.length)&&(this.autoPaging=!0),
void 0!=k[0]&&(6==k[0].length-o.length&&1301<k.length)&&(this.autoPaging=!0),void 0!=k[0]&&(7==k[0].length-o.length&&601<k.length)&&(this.autoPaging=!0),void 0!=k[0]&&8<=k[0].length-o.length&&301<=k.length)this.autoPaging=!0;1<o.length&&(2>=H.length-o.length&&0==n.length)&&(this.autoPaging=!0);if(this.ShowMeasuresAsRows||this.serverPagination)this.autoPaging=!1;this.recordForFormula=V;this.formulaInfo=U;this.filterIndexes=o;this.initFilterIndexes=[];for(O=0;O<this.filterIndexes.length;O++)this.initFilterIndexes[O]=
this.filterIndexes[O];this.getFormulaRowByDataRow=function(c,g){for(var h=false,k=f.recordForFormula,j=[],n=0;n<f.formulaInfo.recordDataLength;n++)j[n]=0;for(n=0;n<k.length;n++){for(var o=false,q=0;q<c.length;q++)if(f.filterIndexes.indexOf(q)!=-1){o=f.filterIndexes.indexOf(q);if(f.filterDiv!=void 0){o=OAT.$v(f.filterDiv.selects[o]);if(o=="[all]")o=true;else{o=o==k[n][q];if(!o)break}}else o=true}else if(f.filterIndexes.length>0&&q>=c.length-y.length)o=true;else if(k[n][q]==c[q]||c[q]=="#FoE#"&&k[n][q]==
0)o=true;else if(l!=void 0&&l.indexOf(q)!=-1&&l.indexOf(q)>l.length-y.length)o=true;else if(m>0&&m==q)o=true;else if(c[q]==void 0&&f.filterIndexes.length>0)o=true;else{o=false;break}if(o){for(h=0;h<f.formulaInfo.measureFormula[g].relatedMeasures.length;h++){o=f.formulaInfo.measureFormula[g].relatedMeasures[h];j[o]=j[o]+parseFloat(k[n][o])}h=true}}return h?j:"#NuN#"};for(o=0;o<y.length;o++)if(U.measureFormula[o].hasFormula)for(V=0;V<k.length;V++)if(0==k[V][k[V].length-y.length+o]&&(L=this.getFormulaRowByDataRow(k[V],
o,""),L=EvaluateExpressionPivotJs(U.measureFormula[o].PolishNotation,L,U),Infinity==L||isNaN(L)))k[V][k[V].length-y.length+o]="#FoE#";this.GeneralDataRows=k;this.autoPagingRowsPerPage=void 0!=v?parseInt(v):10;this.TotalPagesPaging=parseInt(k.length/this.autoPagingRowsPerPage);0!=k.length%this.autoPagingRowsPerPage&&this.TotalPagesPaging++;this.GeneralDistinctValues=[];this.GrandTotalsPaging=[];this.columns=H;0<k.length&&fillGeneralDistinctValues(j.length-y.length,f,k);if(this.autoPaging){Q=k;k=[];
for(O=0;O<Math.min(Q.length,this.autoPagingRowsPerPage);O++)k.push([Q[O]])}this.RowsWhenMoveToFilter=[];this.FilterByTopFilter=!1;this.options={headingBefore:1,headingAfter:0,agg:1,aggTotals:1,customType:function(f){return f},showEmpty:0,subtotals:1,totals:1};this.firstTime=!0;this.deleteState=this.readState=!1;this.defaultPicture=x;this.gd=new OAT.GhostDrag;this.div=OAT.$(g);this.filterDiv=OAT.$(h);this.hasShowValuesAs=c.hasShowValuesAs;this.TitleDivId=h.replace("pivot_page","title_div");aa?(this.PivotTitle=
aa,this.TitleDiv=OAT.$(this.TitleDivId),this.TitleDiv||(jQuery("#"+this.TitleDivId).remove(),this.TitleDiv=OAT.Dom.create("div",{}),this.TitleDiv.id=this.TitleDivId,jQuery("#"+w).prepend(this.TitleDiv))):jQuery("#"+this.TitleDivId).remove();this.defCArray="rgb(153,153,255) rgb(153,51,205) rgb(255,255,204) rgb(204,255,255) rgb(102,0,102) rgb(255,128,128) rgb(0,102,204) rgb(204,204,255) rgb(0,0,128) rgb(255,0,255) rgb(0,255,255) rgb(255,255,0)".split(" ");this.QueryViewerCollection=B;this.containerName=
w;this.formatValues=z;this.formatValuesMeasures=C;this.tempBlackLists=[];this.tempCollapsedValues=[];this.oldSortValues=[];this.stateChanged=!1;this.rowsPerPage=v;this.headerRow=j;this.allData=k;this.filteredData=[];this.tabularData=[];this.dataColumnIndex=m;this.rowConditions=l;this.colConditions=n;this.initRowConditions=[];for(O=0;O<this.rowConditions.length;O++)this.initRowConditions[O]=this.rowConditions[O];this.initColConditions=[];for(O=0;O<this.colConditions.length;O++)this.initColConditions[O]=
this.colConditions[O];1==H.length&&0==y.length&&(this.rowConditions=[0]);this.conditions=[];this.filterDiv.selects=[];this.rowStructure={};this.colStructure={};this.colPointers=[];this.rowPointers=[];this.rowTotals=[[],[]];this.colTotals=[[],[]];this.gTotal=[];this.query=r;this.controlName=u;this.conditionalFormats=t;this.conditionalFormatsColumns=q;this.GreyList=[];this.EmptyValue="#NaV#";this.NullValue="#NuN#";this.initState={};"function"!==typeof JSON.decycle&&(JSON.decycle=function(f){var c=[],
g=[];return function P(f,h){var A,k,j;switch(typeof f){case "object":if(!f)return null;for(A=0;A<c.length;A=A+1)if(c[A]===f)return{$ref:g[A]};c.push(f);g.push(h);if(Object.prototype.toString.apply(f)==="[object Array]"){j=[];for(A=0;A<f.length;A=A+1)j[A]=P(f[A],h+"["+A+"]")}else{j={};for(k in f)Object.prototype.hasOwnProperty.call(f,k)&&(j[k]=P(f[k],h+"["+JSON.stringify(k)+"]"))}return j;case "number":case "string":case "boolean":return f}}(f,"$")});this.saveState=function(c){try{if(window.localStorage){localStorage.removeItem(OAT.getURL()+
f.query+f.controlName);localStorage.setItem(OAT.getURL()+f.query+f.controlName,JSON.stringify(JSON.decycle(c)))}else OATSetCookie('"'+OAT.getURL()+f.query+f.controlName+'cookie"',JSON.stringify(c),null,"/")}catch(g){try{OATSetCookie('"'+OAT.getURL()+f.query+f.controlName+'cookie"',JSON.stringify(c),null,"/")}catch(h){}}};this.saveHiddenState=function(c){try{if(window.localStorage){localStorage.removeItem(OAT.getURL()+f.query+f.controlName+"HiddenState");localStorage.setItem(OAT.getURL()+f.query+f.controlName+
"HiddenState",JSON.stringify(JSON.decycle(c)))}else OATSetCookie('"'+OAT.getURL()+f.query+f.controlName+'HiddenStatecookie"',JSON.stringify(c),null,"/")}catch(g){try{OATSetCookie('"'+OAT.getURL()+f.query+f.controlName+'HiddenStatecookie"',JSON.stringify(c),null,"/")}catch(h){}}};this.getState=function(){if(typeof JSON.retrocycle!=="function")JSON.retrocycle=function(f){var c=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function qa(f){var g,h,A;if(f&&typeof f===
"object")if(Object.prototype.toString.apply(f)==="[object Array]")for(g=0;g<f.length;g=g+1){if((h=f[g])&&typeof h==="object"){A=h.$ref;typeof A==="string"&&c.test(A)?f[g]=eval(A):qa(h)}}else for(g in f)if(typeof f[g]==="object")if(h=f[g]){A=h.$ref;typeof A==="string"&&c.test(A)?f[g]=eval(A):qa(h)}})(f);return f};try{var c;if(localStorage.getItem(OAT.getURL()+f.query+f.controlName)!=null){var g=localStorage.getItem(OAT.getURL()+f.query+f.controlName);c=JSON.retrocycle(JSON.parse(g))}if(c==null){var h=
OATGetCookie('"'+OAT.getURL()+f.query+f.controlName+'cookie"');h!=null&&(c=JSON.parse(h))}return c}catch(k){try{h=OATGetCookie('"'+OAT.getURL()+f.query+f.controlName+'cookie"');return c=JSON.parse(h)}catch(j){return null}}};this.cleanState=function(){for(var c=0;c<f.filterDiv.selects.length;c++)f.filterDiv.selects[c].value="[all]";for(c=0;c<=f.conditions.length-1;c++){f.conditions[c].blackList=[];f.conditions[c].whiteList=[];f.conditions[c].greyList=[]}localStorage.removeItem(OAT.getURL()+f.query+
f.controlName);f.deleteState=false;for(var c=[],g=0;g<f.initState.colConditions.length;g++)c[g]=f.initState.colConditions[g];for(var h=[],g=0;g<f.initState.rowConditions.length;g++)h[g]=f.initState.rowConditions[g];for(var k=[],g=0;g<f.initState.filterIndexes.length;g++)k[g]=f.initState.filterIndexes[g];this.conditions=jQuery.extend(true,[],f.initState.conditions);this.rowConditions=h;this.colConditions=c;this.filterIndexes=k;this.stateChanged=f.initState.stateChanged;this.rowsPerPage=f.initState.rowsPerPage;
f.saveState({query:f.query,conditions:f.conditions,colConditions:f.colConditions,rowConditions:f.rowConditions,filterIndexes:f.filterIndexes,filterDivSelects:[],rowsPerPage:f.rowsPerPage,version:f.rememberLayoutStateVersion})};this.cleanStateWhenServerPagination=function(){for(var c=0;c<f.filterDiv.selects.length;c++)f.filterDiv.selects[c].value="[all]";for(c=0;c<=f.conditions.length-1;c++)f.conditions[c].blackList=[];for(var c=[],g=0;g<f.initState.colConditions.length;g++)c[g]=f.initState.colConditions[g];
for(var h=[],g=0;g<f.initState.rowConditions.length;g++)h[g]=f.initState.rowConditions[g];for(var k=[],g=0;g<f.initState.filterIndexes.length;g++)k[g]=f.initState.filterIndexes[g];for(g=0;g<f.conditions.length;g++)if(f.conditions[g]&&f.conditions[g].distinctValues&&f.conditions[g].dataField){for(var j=-1,l=0;l<f.initState.conditions.length;l++)f.initState.conditions[l]&&f.initState.conditions[l].dataField==f.conditions[g].dataField&&(j=l);if(j>-1){f.initState.conditions[j].distinctValues=[];for(l=
0;l<f.conditions[g].distinctValues.length;l++)f.initState.conditions[j]&&f.initState.conditions[j].distinctValues.indexOf(f.conditions[g].distinctValues[l])==-1&&f.initState.conditions[j].distinctValues.push(f.conditions[g].distinctValues[l]);f.initState.conditions[j].previousPage=f.conditions[g].previousPage;f.initState.conditions[j].totalPages=f.conditions[g].totalPages}}f.conditions=jQuery.extend(true,[],f.initState.conditions);f.pageData.AxisInfo=jQuery.extend(true,[],f.initState.AxisInfo);f.pageData.DataInfo=
jQuery.extend(true,[],f.initState.DataInfo);f.pageData.FilterInfo=jQuery.extend(true,[],f.initState.FilterInfo);f.pageData.CollapseInfo=jQuery.extend(true,[],f.initState.CollapseInfo);f.rowConditions=h;f.colConditions=c;f.filterIndexes=k;f.stateChanged=f.initState.stateChanged;f.rowsPerPage=f.initState.rowsPerPage;f.DefaultAction=f.initState.DefaultAction;f.initMetadata=jQuery.extend(true,{},f.initState.InitMetadata);for(c=0;c<f.initMetadata.Conditions.length;c++)f.initMetadata.Conditions[c]="";for(c=
0;c<f.initState.conditions.length;c++)if(g=f.initState.conditions[c].dataField){g=f.initMetadata.DataFields.indexOf(g);f.initMetadata.Conditions[g]=f.conditions[c]}gx.util.browser.isIE()||f.goWhenHide(true)};this.getDataXML=function(){var c;if(f.serverPagination){c=f.QueryViewerCollection[f.IdForQueryViewerCollection].getPivottableDataSync().split("<Recordset")[1];c="<Recordset"+c}else{c='<OLAPData format="adonet">\n <Table>\n';for(var g=0;g<f.GeneralDataRows.length;g++){c=c+"  <Record>\n";for(var h=
0;h<this.columns.length;h++){c=c+"    <"+this.columns[h].getAttribute("dataField")+">";c=c+f.GeneralDataRows[g][h];c=c+"</"+this.columns[h].getAttribute("dataField")+">\n"}for(h=0;h<y.length;h++){c=c+"    <"+y[h].getAttribute("dataField")+">";c=c+f.GeneralDataRows[g][h+this.columns.length];c=c+"</"+y[h].getAttribute("dataField")+">\n"}c=c+"  </Record>\n"}c=c+"</Table>\n</OLAPData>"}return c};this.getFilteredDataXML=function(){if(f.serverPagination){for(var c=f.QueryViewerCollection[f.IdForQueryViewerCollection].getPivottableDataSync(),
c=c.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&apos;/g,"'").replace(/\&quot/g,'"'),g=c.split("<Record>"),c=[],h=1;h<g.length;h++){for(var k=[],j=[],l=0;l<f.pageData.dataFields.length;l++){k[l]="#NuN#";var m=g[h].split("<"+f.pageData.dataFields[l]+">");if(m.length>1){m=m[1].split("</"+f.pageData.dataFields[l]+">");k[l]=m[0];for(var n=0;n<f.initMetadata.Dimensions.length;n++)f.initMetadata.Dimensions[n].dataField==f.pageData.dataFields[l]&&f.headerRow.indexOf(f.initMetadata.Dimensions[n].displayName)!=
-1&&j.push(m[0]);l>=f.initMetadata.Dimensions.length&&j.push(m[0])}else g[h].indexOf("<"+f.pageData.dataFields[l]+"/>")>=0&&(k[l]="")}f.filterDataXMLOK(j)&&c.push(k)}g='<Recordset RecordCount="'+c.length+'" PageCount="1">\n';g=g+'<Page PageNumber="1">\n';for(h=0;h<c.length;h++){g=g+"  <Record>\n";for(k=0;k<f.initMetadata.DataFields.length;k++){j=f.initMetadata.DataFields[k];g=g+"    <"+j+">";g=g+(c[h][k]||"").replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,
"&#x27;");g=g+"</"+j+">\n"}for(k=0;k<y.length;k++){g=g+"    <"+y[k].getAttribute("dataField")+">";g=g+(c[h][k+f.initMetadata.DataFields.length]||"").replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;");g=g+"</"+y[k].getAttribute("dataField")+">\n"}g=g+"  </Record>\n"}g=g+"</Page>\n</Recordset>"}else{g="<Table>\n";for(h=0;h<f.filteredData.length;h++){g=g+"  <Record>\n";for(k=0;k<this.columns.length;k++){g=g+"    <"+this.columns[k].getAttribute("dataField")+
">";g=g+f.filteredData[h][k];g=g+"</"+this.columns[k].getAttribute("dataField")+">\n"}for(k=0;k<y.length;k++){g=g+"    <"+y[k].getAttribute("dataField")+">";g=g+f.filteredData[h][k+this.columns.length];g=g+"</"+y[k].getAttribute("dataField")+">\n"}g=g+"  </Record>\n"}g=g+"</Table>"}return g};this.getMetadataXML=function(){xml='<OLAPCube format="'+this.defaultPicture.getAttribute("format")+'" thousandsSeparator="'+this.defaultPicture.getAttribute("thousandsSeparator")+'" decimalSeparator="'+this.defaultPicture.getAttribute("decimalSeparator")+
'" dateFormat="'+this.defaultPicture.getAttribute("dateFormat")+'">';var c=this.columns;if(f.initMetadata.Metadata)var g=jQuery.parseXML(f.initMetadata.Metadata),c=g.getElementsByTagName("OLAPDimension");for(var h=0,k=0,j=0,l=0,m=0,n=0,g=0;g<c.length;g++){var o=g;if(f.initMetadata.Metadata)for(var o=-1,q=0;q<f.conditions.length;q++)f.conditions[q].dataField==f.initMetadata.Dimensions[g].dataField&&(o=q);xml=xml+"<OLAPDimension>";xml=xml+"<name>"+c[g].getAttribute("name")+"</name> ";xml=xml+"<displayName>"+
c[g].getAttribute("displayName")+"</displayName> ";xml=xml+"<description>"+c[g].getAttribute("description")+"</description> ";xml=xml+"<dataField>"+c[g].getAttribute("dataField")+"</dataField> ";xml=xml+"<dataType>"+c[g].getAttribute("dataType")+"</dataType> ";f.initMetadata.Dimensions&&!f.initMetadata.Dimensions[g].Visible&&(xml=xml+"<hidden>true</hidden>");xml=xml+"<axis>";var r=0;if(o==-1)if(c[g].getAttribute("visible").toLowerCase()!="never"){xml=xml+c[g].getAttribute("axis").toLowerCase();q=
f.initMetadata.Dimensions[g].defaultPosition;if(q=="Rows"){k=k+1;h=r=h+1}if(q=="Columns"){l=l+1;j=r=j+1}if(q=="Pages"){n=n+1;m=r=m+1}}else xml=xml+"";else if(f.rowConditions.indexOf(o)!=-1){xml=xml+"rows";h=r=f.rowConditions.indexOf(o)+1+k}else if(f.colConditions.indexOf(o)!=-1){xml=xml+"columns";j=r=f.colConditions.indexOf(o)+1+l}else{xml=xml+"pages";m=r=f.filterIndexes.indexOf(o)+1+n}xml=xml+"</axis> ";xml=c[g].getAttribute("visible").toLowerCase()!="never"?xml+"<position>"+r+"</position> ":xml+
"<position/>";r=c[g].getAttribute("summarize");o>=0&&(r=f.conditions[o].subtotals?"yes":"no");xml=xml+"<summarize>"+r+"</summarize> ";xml=xml+"<align>"+c[g].getAttribute("align")+"</align> ";xml=c[g].getAttribute("picture")===""?xml+"<picture/> ":xml+"<picture>"+c[g].getAttribute("picture")+"</picture> ";xml=c[g].getAttribute("picture")===""?xml+"<format/> ":xml+"<format>"+c[g].getAttribute("format")+"</format> ";r=-1;if(f.initMetadata.Metadata){r=-1;for(q=0;q<f.initMetadata.Conditions.length;q++)f.initMetadata.Conditions[q].dataField==
f.initMetadata.Dimensions[g].dataField&&(r=q)}if(c[g].getAttribute("visible").toLowerCase()!="never"){q=o>-1?f.conditions[o].sort:r>-1?f.initMetadata.Conditions[r].sort:"metadata";xml=q=="metadata"?xml+"<order>"+(c[g].getAttribute("order")!=""?c[g].getAttribute("order"):"Ascending")+"</order> ":q==1?xml+"<order>Ascending</order> ":q==-1?xml+"<order>Descending</order> ":xml+"<order>Custom</order> "}else xml=xml+"<order>"+c[g].getAttribute("order")+"</order> ";xml=xml+"<customOrder/> ";xml=xml+"<filterType>";
q=o>-1?f.conditions[o].blackList:r>-1?f.initMetadata.Conditions[r].blackList:[];xml=q.length==0?o>-1&&f.conditions[o].defaultAction=="Exclude"?f.conditions[o].visibles.length==0?xml+"HideAllValues":xml+"ShowAllValues":xml+"ShowAllValues":xml+"ShowSomeValues";xml=xml+"</filterType>";xml=xml+"<include> ";var t=o>-1?f.filterIndexes.indexOf(o):-1;if(t!=-1&&f.filterDiv.selects[t].value!="[all]")xml=xml+"<value>"+f.filterDiv.selects[t].value+"</value> ";else{t=o>-1?f.conditions[o].distinctValues:r>-1?f.initMetadata.Conditions[r].distinctValues:
[];if(!(o>-1&&f.conditions[o].defaultAction=="Exclude"&&q.length==0))for(var u=0;u<t.length;u++)q.indexOf(t[u])===-1&&(xml=xml+"<value>"+t[u]+"</value> ")}xml=xml+"<value>TOTAL</value> </include>";xml=xml+"<collapseType>";q=o>-1?f.conditions[o].collapsedValues:r>-1?f.initMetadata.Conditions[r].collapsedValues:[];if(q==void 0||q.length==0){xml=xml+"ExpandAllValues";xml=xml+"</collapseType>"}else{xml=xml+"ExpandSomeValues";xml=xml+"</collapseType>";t=f.serverPagination?o>-1?f.conditions[o].distinctValues:
r>-1?f.initMetadata.Conditions[r].distinctValues:[]:f.GeneralDistinctValues[g];xml=xml+"<includeExpand> ";for(u=0;u<t.length;u++)t[u]!=void 0&&q.indexOf(t[u])==-1&&(xml=xml+"<value>"+t[u]+"</value>");xml=xml+"</includeExpand> "}xml=xml+"</OLAPDimension>"}c=y;if(f.initMetadata.Metadata){g=jQuery.parseXML(f.initMetadata.Metadata);c=g.getElementsByTagName("OLAPMeasure")}for(g=0;g<c.length;g++){xml=xml+"<OLAPMeasure> ";xml=xml+"<name>"+c[g].getAttribute("name")+"</name> ";xml=xml+"<displayName>"+c[g].getAttribute("displayName")+
"</displayName> ";xml=xml+"<description>"+c[g].getAttribute("description")+"</description> ";xml=xml+"<dataField>"+c[g].getAttribute("dataField")+"</dataField> ";xml=xml+"<dataType>"+c[g].getAttribute("dataType")+"</dataType> ";xml=xml+"<defaultAggregator>"+c[g].getAttribute("defaultAggregator")+"</defaultAggregator> ";xml=xml+"<validAggregators>"+c[g].getAttribute("validAggregators")+"</validAggregators> ";xml=xml+"<summarize>"+c[g].getAttribute("summarize")+"</summarize> ";xml=c[g].getAttribute("format")===
""?xml+"<format/> ":xml+"<format>"+c[g].getAttribute("format")+"</format> ";xml=xml+"<align>"+c[g].getAttribute("align")+"</align> ";xml=c[g].getAttribute("picture")===""?xml+"<picture/> ":xml+"<picture>"+c[g].getAttribute("picture")+"</picture> ";f.initMetadata.Measures&&!f.initMetadata.Measures[g].Visible&&(xml=xml+"<hidden>true</hidden>");if(c[g].getAttribute("visible").toLowerCase()!="never"){h=h+1;xml=xml+"<position>"+h+"</position> "}else xml=xml+"<position/>";xml=xml+"</OLAPMeasure>"}xml=xml+
"</OLAPCube>";return xml=xml.replace(/\&/g,"&amp;")};this.createXMLMetadata=function(){for(var c='<OLAPCube format="'+this.defaultPicture.getAttribute("format")+'" thousandsSeparator="'+this.defaultPicture.getAttribute("thousandsSeparator")+'" decimalSeparator="'+this.defaultPicture.getAttribute("decimalSeparator")+'" dateFormat="'+this.defaultPicture.getAttribute("dateFormat")+'">',g=0;g<this.columns.length;g++)if(this.conditions[g]!=false&&this.conditions[g]!=void 0){var c=c+"<OLAPDimension> ",
c=c+"<name>"+this.columns[g].getAttribute("name")+"</name> ",c=c+"<displayName>"+this.columns[g].getAttribute("displayName")+"</displayName> ",c=c+"<description>"+this.columns[g].getAttribute("description")+"</description> ",c=c+"<dataField>"+this.columns[g].getAttribute("dataField")+"</dataField> ",c=c+"<dataType>"+this.columns[g].getAttribute("dataType")+"</dataType> ",c=c+"<summarize>"+this.columns[g].getAttribute("summarize")+"</summarize> ",c=c+"<align>"+this.columns[g].getAttribute("align")+
"</align> ",c=this.columns[g].getAttribute("picture")===""?c+"<picture/> ":c+"<picture>"+this.columns[g].getAttribute("picture")+"</picture> ",c=this.columns[g].getAttribute("picture")===""?c+"<format/> ":c+"<format>"+this.columns[g].getAttribute("format")+"</format> ",c=this.conditions[g].sort===1?c+"<order>ascending</order> ":c+"<order>descending</order> ",c=c+"<customOrder/> ",c=c+"<include> ",h=f.filterIndexes.indexOf(g);if(h!=-1&&f.filterDiv.selects[h].value!="[all]")this.conditions[g].blackList.indexOf(f.filterDiv.selects[h].value)===
-1&&(c=c+"<value>"+f.filterDiv.selects[h].value.toString().trimpivot()+"</value> ");else if(f.serverPagination){if(f.conditions[g].state!="none")for(k=0;k<this.conditions[g].distinctValues.length;k++)this.conditions[g].blackList.indexOf(this.conditions[g].distinctValues[k])===-1&&(c=c+"<value>"+this.conditions[g].distinctValues[k].toString().trimpivot()+"</value> ")}else for(var k=0;k<this.conditions[g].distinctValues.length;k++)this.conditions[g].blackList.indexOf(this.conditions[g].distinctValues[k])===
-1&&(c=c+"<value>"+this.conditions[g].distinctValues[k].toString().trimpivot()+"</value> ");c=c+"<value>TOTAL</value> </include> <collapse/> ";c=c+"<hide> ";if(f.serverPagination)if(f.conditions[g].state=="none")for(k=0;k<this.conditions[g].distinctValues.length;k++)c=c+"<value>"+this.conditions[g].distinctValues[k].toString().trimpivot()+"</value> ";else{if(f.conditions[g].state!="all")for(k=0;k<this.conditions[g].blackList.length;k++)c=c+"<value>"+this.conditions[g].blackList[k].toString().trimpivot()+
"</value> "}else for(k=0;k<this.conditions[g].blackList.length;k++)c=c+"<value>"+this.conditions[g].blackList[k].toString().trimpivot()+"</value> ";c=c+"</hide> ";if(f.rowConditions.indexOf(g)!=-1){c=c+"<condition>row</condition> ";c=c+"<filterbar>no</filterbar> ";c=c+"<position>"+f.rowConditions.indexOf(g)+"</position>"}else if(f.colConditions.indexOf(g)!=-1){c=c+"<condition>col</condition> ";c=c+"<filterbar>no</filterbar> ";c=c+"<position>"+f.colConditions.indexOf(g)+"</position>"}else{c=c+"<condition>none</condition> ";
c=c+"<filterbar>yes</filterbar> "}c=c+"<filterdivs> ";h!=-1&&(c=c+"<value>"+f.filterDiv.selects[h].value.toString().trimpivot()+"</value> ");c=c+"</filterdivs> ";c=c+"<restoreview>no</restoreview> ";c=c+" </OLAPDimension>"}for(g=0;g<y.length;g++){c=c+"<OLAPMeasure> ";c=c+"<name>"+y[g].getAttribute("name")+"</name> ";c=c+"<displayName>"+y[g].getAttribute("displayName")+"</displayName> ";c=c+"<description>"+y[g].getAttribute("description")+"</description> ";c=c+"<dataField>"+y[g].getAttribute("dataField")+
"</dataField> ";c=c+"<dataType>"+y[g].getAttribute("dataType")+"</dataType> ";c=c+"<defaultAggregator>"+y[g].getAttribute("defaultAggregator")+"</defaultAggregator> ";c=c+"<validAggregators>"+y[g].getAttribute("validAggregators")+"</validAggregators> ";c=c+"<summarize>"+y[g].getAttribute("summarize")+"</summarize> ";c=y[g].getAttribute("format")===""?c+"<format/> ":c+"<format>"+y[g].getAttribute("format")+"</format> ";c=c+"<align>"+y[g].getAttribute("align")+"</align> ";c=y[g].getAttribute("picture")===
""?c+"<picture/> ":c+"<picture>"+y[g].getAttribute("picture")+"</picture> ";c=c+" </OLAPMeasure>"}return c+"</OLAPCube>"};this.ExportToXML=function(){var c;c='<EXPORT format="XML" type="pivot"><METADATA>';for(var g=0;g<this.columns.length;g++){var h="row",h=f.rowConditions.indexOf(g)!=-1?"row":f.colConditions.indexOf(g)!=-1?"column":"filter";c=c+"<OLAPDimension ";c=c+'name="'+this.columns[g].getAttribute("dataField")+'" ';c=c+'label="'+this.columns[g].getAttribute("displayName")+'" ';c=c+'picture="'+
this.columns[g].getAttribute("picture")+'" ';c=c+'datatype="'+this.columns[g].getAttribute("dataType")+'" ';c=c+'showAll="true" ';c=c+'position="'+h+'">';if(this.conditions[g]!=void 0&&this.conditions[g].distinctValues!=void 0)for(h=0;h<this.conditions[g].distinctValues.length;h++){c=c+"<VALUE CHECKED=";c=this.conditions[g].blackList.indexOf(this.conditions[g].distinctValues[h])===-1?c+'"true"':c+'"false"';c=this.conditions[g].collapsedValues.indexOf(this.conditions[g].distinctValues[h])==-1?c+' COLLAPSED="false">':
c+' COLLAPSED="true">';c=c+this.conditions[g].distinctValues[h]+"</VALUE>"}c=c+"</OLAPDimension>"}for(g=0;g<y.length;g++){c=c+"<OLAPMeasure ";c=c+'name="'+y[g].getAttribute("dataField")+'" ';c=c+'label="'+y[g].getAttribute("displayName")+'" ';c=c+'picture="'+y[g].getAttribute("picture")+'" ';c=c+'datatype="'+y[g].getAttribute("dataType")+'" ';c=c+'showAll="true" ';c=c+'aggregator="sum"/>'}c=c+"</METADATA><FLATDATA>";for(h=0;h<this.allDataWithoutSort.length;h++){c=c+"<ROW ";for(g=0;g<this.columns.length;g++)c=
c+this.columns[g].getAttribute("dataField")+'="'+this.allDataWithoutSort[h][g]+'" ';for(g=0;g<y.length;g++)c=c+y[g].getAttribute("dataField")+'="'+this.allDataWithoutSort[h][g+this.columns.length]+'" ';c=c+"/>"}h=c=c+"</FLATDATA><COLITEMS>";try{var k=0,j=this.colConditions.length;if(k===j)for(g=0;g<y.length;g++){c=c+'<COLITEM measure="'+y[g].getAttribute("displayName")+'" type=""';c=c+"/>"}else{k++;for(g=0;g<this.colStructure.items.length;g++)c=c+this.createXMLCOLITEMS(this.colStructure.items[g],
k,j)}}catch(l){c=h}h=c=c+"</COLITEMS><ROWITEMS>";try{for(g=0;g<this.rowStructure.items.length;g++){k=0;j=this.columns.length-this.colConditions.length-this.filterIndexes.length-1;j>=k&&(c=c+this.createXMLROWITEMS(this.rowStructure.items[g],k,j))}}catch(m){c=h}c=c+'</ROWITEMS><HTML><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><STYLE>.h2title {background-color: #5C5D5F; border-color: #666666; font-family: Verdana; font-weight: normal; font-size: 10pt; height: 44px; color: #E0E0E0;}\n.h2titlewhite {background-color: #ffffff; font-family: Verdana; font-size: 10pt; font-weight: normal; height: 25px; color: black;}\n.even {background-color: #FEFEFE;\tfont-weight: normal; font-family: Verdana; font-size: 10pt;\tpadding: 5px; }\n.h2subtitle {background-color: #5C5D5F; border-color: #666666; font-family: Verdana; font-weight: normal; font-size: 10pt;\theight: 22px; color: #E0E0E0;}\n.gtotal {background-color: #EBEBEB; font-weight: normal; font-family: Verdana; font-size: 10pt;}\n.pivot_table td.total {background-color: #EBEBEB; font-weight: normal;\tfont-family: Verdana; font-size: 10pt;}\n.pivot_table td.subtotal {background-color: #EBEBEB; font-weight: normal;\tfont-family: Verdana; font-size: 10pt;}\n</STYLE></HEAD><BODY><TABLE border="2">';
for(h=0;h<jQuery("#"+f.controlName+"_"+f.query+" tr").length;h++){c=c+"<TR>";g=jQuery("#"+f.controlName+"_"+f.query+" tr")[h];for(j=0;j<g.children.length;j++){var k=OAT.removeIconFont(g.children[j].textContent).trim(),n=g.children[j].getAttribute("hidden"),o="";g.children[j].getAttribute("style")!=void 0&&g.children[j].getAttribute("style")!=null&&(o=' style="'+g.children[j].getAttribute("style")+'" ');var q="";g.children[j].getAttribute("class")!=void 0&&g.children[j].getAttribute("class")!=null&&
(q=' class="'+g.children[j].getAttribute("class")+'" ');if(n===null){var n=g.children[j].getAttribute("rowspan"),r=g.children[j].getAttribute("colspan");c=n===null&&r===null||j===g.children.length-1?c+"<TD "+q+" "+o+">"+k+"</TD>":r===null?c+"<TD "+q+' rowspan="'+n+'" '+o+" >"+k+"</TD>":n===null?c+"<TD "+q+' colspan="'+r+'" '+o+" >"+k+"</TD>":c+"<TD "+q+' colspan="'+r+'" rowspan="'+n+'" '+o+" >"+k+"</TD>"}}c=c+"</TR>"}return(c+"</TABLE></BODY></HTML></EXPORT>").replace(/\&/g,"&amp;")};this.createXMLROWITEMS=
function(f,c,g){var h=f.parent==void 0||f.parent.collapsed==void 0?false:f.parent.collapsed,h='<ROWITEM dimension="'+H[c].getAttribute("dataField")+'" collapsed="'+f.collapsed+'" parentCollapsed="'+h+'" value="'+f.value+'" level="'+c+'"';if(c===g)return h+"/>";c++;for(var h=h+">",k=0;k<f.items.length;k++)h=h+this.createXMLROWITEMS(f.items[k],c,g);return h+"</ROWITEM>"};this.createXMLCOLITEMS=function(c,g,h){var k="";if(g===h)for(h=0;h<y.length;h++){for(var k=k+'<COLITEM measure="'+y[h].getAttribute("displayName")+
'" type="">',j=f.rowConditions.length-y.length+1,k=k+'<VALITEM dimension="'+H[g-1+j].getAttribute("dataField")+'" value="'+c.value+'"/>',l=c;l.parent.depth!=-1;){l=l.parent;k=k+'<VALITEM dimension="'+H[g-1+j].getAttribute("dataField")+'" value="'+l.value+'"/>'}k=k+"</COLITEM>"}else{g++;for(j=0;j<c.items.length;j++)k=k+this.createXMLCOLITEMS(c.items[j],g,h)}return k};this.ExportToExcel=function(c){for(var g='<table border="2">',h=0;h<jQuery("#"+f.controlName+"_"+f.query+" tr").length;h++){for(var g=
g+"<tr>",k=jQuery("#"+f.controlName+"_"+f.query+" tr")[h],j=0;j<k.children.length;j++){var l=OAT.removeIconFont(k.children[j].textContent.replace(/^\s+|\s+$/g,"")).trim(),m=k.children[j].getAttribute("hidden"),n="";k.children[j].getAttribute("style")!=void 0&&k.children[j].getAttribute("style")!=null&&(n=' style="'+k.children[j].getAttribute("style")+'" ');for(var o="",q=false,r=0;r<l.length;r++)if(l.charCodeAt(r)<1E3){o=q?o+" "+l[r]:o+l[r];q=false}else{q=l.charCodeAt(r).toString(16);o=o+"&#x"+q;
q=true}if(m===null){l=k.children[j].getAttribute("rowspan");m=k.children[j].getAttribute("colspan");g=l===null&&m===null||j===k.children.length-1?g+"<td "+n+">"+o+"</td>":m===null?g+'<td rowspan="'+l+'" '+n+" >"+o+"</td>":l===null?g+'<td colspan="'+m+'" '+n+" >"+o+"</td>":g+'<td colspan="'+m+'" rowspan="'+l+'" '+n+" >"+o+"</td>"}}g=g+"</tr>"}g='<head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"></head><body>'+(g+"</table>")+"</body>";if(gx.util.browser.webkit&&!gx.util.browser.chrome||
f.isSD)window.open("data:application/vnd.ms-excel,"+encodeURIComponent(g));else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){g=new Blob([g],{type:"application/vnd.ms-excel"});saveAs(g,c+".xls")}else return g};this.lightOn=function(){for(var c=0;c<f.gd.targets.length;c++){var g=f.gd.targets[c][0];gx.util.browser.isIE()?g.className=g.className+" drag-drop":g.classList.add("drag-drop")}};this.lightOff=function(){for(var c=0;c<f.gd.targets.length;c++){var g=f.gd.targets[c][0];try{gx.util.browser.isIE()&&
11>gx.util.browser.ieVersion()?g.className.replace("drag-drop"):g.classList.remove("drag-drop")}catch(h){}}};f.gd.onFail=f.lightOff;this.process=function(c){f.lightOn();c.style.backgroundColor="#888";c.style.padding="2px";c.style.cursor="pointer"};this.filterOK=function(c){for(var g=0;g<f.filterIndexes.length;g++){var h=f.filterIndexes[g],k=f.filterDiv.selects[g];if(k.selectedIndex&&OAT.$v(k)!=c[h])return false}for(g=0;g<f.rowConditions.length;g++){h=c[f.rowConditions[g]];k=f.conditions[f.rowConditions[g]];
if(k.blackList.length>0&&k.blackList.indexOf(h)!=-1)return false}for(g=0;g<f.colConditions.length;g++){h=c[f.colConditions[g]];k=f.conditions[f.colConditions[g]];if(k.blackList.length>0&&k.blackList.indexOf(h)!=-1)return false}return true};this.filterDataXMLOK=function(c){for(var g=0;g<f.filterIndexes.length;g++){var h=f.filterIndexes[g],k=f.filterDiv.selects[g];if(k.selectedIndex&&OAT.$v(k)!=c[h])return false}for(g=0;g<f.rowConditions.length;g++){h=c[f.rowConditions[g]];k=f.conditions[f.rowConditions[g]];
if(k.state=="none")return false;if(k.defaultAction=="Exclude"){if(k.visibles.indexOf(h)==-1)return false}else if(k.blackList.indexOf(h)!=-1)return false}for(g=0;g<f.colConditions.length;g++){h=c[f.colConditions[g]];k=f.conditions[f.colConditions[g]];if(k.state=="none")return false;if(k.defaultAction=="Exclude"){if(k.visibles.indexOf(h)==-1)return false}else if(k.blackList.indexOf(h)!=-1)return false}return true};this.sort=function(c,g){var h,k=c.sort;c.sort==0&&(k=1);c.sort==2&&(k=-1);h=function(f,
c){return f==c?0:k*(parseInt(f)>parseInt(c)?1:-1)};var j=function(f,c){return f==c?0:k*(f>c?1:-1)};if(c.distinctValues!=void 0){for(var l=true,m=0;m<c.distinctValues.length;m++)l&&c.distinctValues[m]!=parseInt(c.distinctValues[m])&&(l=false);h=l?h:j;if(c.sort!=0&&c.sort!=2)c.distinctValues.sort(h);else if(g!=void 0&&f.columns[g]!=void 0){c.distinctValues.sort(h);h=[];for(j=0;j<c.distinctValues.length;j++)h[j]=c.distinctValues[j];c.distinctValues=[];if(c.sort==0)for(j=0;j<f.columns[g].childNodes.length;j++){if(f.columns[g].childNodes[j]!=
void 0&&f.columns[g].childNodes[j].localName!=void 0&&f.columns[g].childNodes[j].localName==="customOrder")for(l=0;l<f.columns[g].childNodes[j].childNodes.length;l++)if(f.columns[g].childNodes[j].childNodes[l].localName=="Value")for(var m=f.columns[g].childNodes[j].childNodes[l].textContent,n=0;n<h.length;n++)h[n].trimpivot()==m.trimpivot()&&c.distinctValues.push(h[n])}else for(j=0;j<f.columns[g].childNodes.length;j++)if(f.columns[g].childNodes[j]!=void 0&&f.columns[g].childNodes[j].localName!=void 0&&
f.columns[g].childNodes[j].localName==="customOrder")for(l=f.columns[g].childNodes[j].childNodes.length-1;l>=0;l--)if(f.columns[g].childNodes[j].childNodes[l].localName=="Value"){m=f.columns[g].childNodes[j].childNodes[l].textContent;for(n=0;n<h.length;n++)h[n].trimpivot()==m.trimpivot()&&c.distinctValues.push(h[n])}if(c.distinctValues.length<h.length)for(j=0;j<h.length;j++)c.distinctValues.indexOf(h[j])==-1&&c.distinctValues.push(h[j])}if(H.length==1||(y.length=0))c.sort==1?f.allData.sort(function(f){return function(c,
g){return c[f]===g[f]?0:c[f]<g[f]?-1:1}}(0)):c.sort==-1&&f.allData.sort(function(f){return function(c,g){return c[f]===g[f]?0:c[f]>g[f]?-1:1}}(0))}};this.initCondition=function(c){if(c==f.dataColumnIndex&&(H.length>1||y.length>0))f.conditions.push(false);else{var g=1,h=1,k=false,j="filters;rows;columns;hidden",l=false;if(f.columns[c]!=void 0){l=true;f.serverPagination&&f.columns[c].getAttribute("order")!=void 0&&f.columns[c].getAttribute("order")==="ascending"&&(g=1);f.columns[c].getAttribute("order")!=
void 0&&f.columns[c].getAttribute("order")==="descending"&&(g=-1);if(f.columns[c].getAttribute("order")!=void 0&&f.columns[c].getAttribute("order")==="custom"){g=0;f.serverPagination&&(g=1)}if(f.columns[c].getAttribute("summarize")!=void 0&&f.columns[c].getAttribute("summarize")==="yes"){h=1;for(j=0;j<f.columns[c].childNodes.length;j++)if(f.columns[c].childNodes[j]!=void 0&&f.columns[c].childNodes[j].localName!=void 0&&f.columns[c].childNodes[j].localName==="include")for(var h=false,m=0;m<f.columns[c].childNodes[j].childNodes.length;m++)f.columns[c].childNodes[j].childNodes[m].localName!=
null&&f.columns[c].childNodes[j].childNodes[m].localName.toLowerCase()==="value"&&f.columns[c].childNodes[j].childNodes[m].textContent=="TOTAL"&&(h=true);else f.columns[c].childNodes[j]!=void 0&&(f.columns[c].childNodes[j].localName!=void 0&&f.columns[c].childNodes[j].localName==="exclude")&&(h=false)}if(f.columns[c].getAttribute("summarize")!=void 0&&f.columns[c].getAttribute("summarize")==="no"){h=false;k=true}j="";if(f.columns[c].getAttribute("visible")!="Never"){j=f.columns[c].getAttribute("canDragToPages")==
"true"?"filters;":"";j=j+"rows;columns;hidden"}}h={distinctValues:[],blackList:[],whiteList:[],greyList:[],collapsedValues:[],sort:g,subtotals:h,hideSubtotalOption:k,validPosition:j,dataRowPosition:c,isDimension:l,topFilterValue:gx.getMessage("GXPL_QViewerJSAllOption")};if(f.serverPagination){h.topFilterValue="[all]";h.topFilterString=gx.getMessage("GXPL_QViewerJSAllOption")}f.conditions.push(h);if(!f.serverPagination){for(j=0;j<f.allData.length;j++){m=f.allData[j][c];if(m==void 0){m=" ";f.allData[j][c]=
" "}h.distinctValues.indexOf(m)==-1&&h.distinctValues.push(m)}if(g!=0&&g!=2)f.sort(h);else if(f.columns[c]!=void 0){j=h.sort;h.sort=h.sort!=2?1:-1;f.sort(h);h.sort=j;k=[];for(j=0;j<h.distinctValues.length;j++)k[j]=h.distinctValues[j];h.distinctValues=[];for(j=0;j<f.columns[c].childNodes.length;j++)if(f.columns[c].childNodes[j]!=void 0&&f.columns[c].childNodes[j].localName!=void 0&&f.columns[c].childNodes[j].localName==="customOrder"){if(g==0)for(m=0;m<f.columns[c].childNodes[j].childNodes.length;m++){if(f.columns[c].childNodes[j].childNodes[m].localName==
"Value")for(var l=f.columns[c].childNodes[j].childNodes[m].textContent,n=0;n<k.length;n++)k[n].trimpivot()==l.trimpivot()&&h.distinctValues.push(k[n])}else for(m=f.columns[c].childNodes[j].childNodes.length-1;m>=0;m--)if(f.columns[c].childNodes[j].childNodes[m].localName=="Value"){l=f.columns[c].childNodes[j].childNodes[m].textContent;for(n=0;n<k.length;n++)k[n].trimpivot()==l.trimpivot()&&h.distinctValues.push(k[n])}if(h.distinctValues.length<k.length)for(j=0;j<k.length;j++)h.distinctValues.indexOf(k[j])==
-1&&h.distinctValues.push(k[j])}}}if(f.columns[c]!=void 0)for(j=0;j<f.columns[c].childNodes.length;j++)if(f.columns[c].childNodes[j]!=void 0&&f.columns[c].childNodes[j].localName!=void 0&&f.columns[c].childNodes[j].localName==="include")for(m=0;m<f.columns[c].childNodes[j].childNodes.length;m++)if(f.columns[c].childNodes[j].childNodes[m].localName!=null&&f.columns[c].childNodes[j].childNodes[m].localName.toLowerCase()==="value"&&f.columns[c].childNodes[j].childNodes[m].textContent!="TOTAL")f.conditions[c].topFilterValue=
f.columns[c].childNodes[j].childNodes[m].textContent}};this.restoreSubtotalsAndSortLayout=function(c){try{if(J){mState=f.getState();if(mState!=void 0&&mState.version!=void 0&&mState.version===f.rememberLayoutStateVersion&&mState.query==f.query&&f.conditions.length==mState.conditions.length){f.conditions[c].subtotals=mState.conditions[c].subtotals;f.conditions[c].sort=mState.conditions[c].sort;f.conditions[c].collapsedValues=mState.conditions[c].collapsedValues}}}catch(g){}};this.applyCustomFilters=
function(c){try{if(c!=f.dataColumnIndex&&f.columns[c]!=void 0)for(var g=0;g<f.columns[c].childNodes.length;g++){if(f.columns[c].childNodes[g]!=void 0&&f.columns[c].childNodes[g].localName!=void 0&&f.columns[c].childNodes[g].localName==="include")if(f.serverPagination){f.createFilterInfo({op:"none",values:"",dim:c});for(k=0;k<f.columns[c].childNodes[g].childNodes.length;k++)if(f.columns[c].childNodes[g].childNodes[k].localName!=null&&f.columns[c].childNodes[g].childNodes[k].localName.toLowerCase()===
"value"&&f.columns[c].childNodes[g].childNodes[k].textContent!="TOTAL"){f.UserFilterValues[c]==void 0&&(f.UserFilterValues[c]=[]);f.UserFilterValues[c].push(f.columns[c].childNodes[g].childNodes[k].textContent.trimpivot())}}else{f.conditions[c].blackList=[];for(var h=0;h<f.GeneralDistinctValues[c].length;h++)f.conditions[c].blackList.push(f.GeneralDistinctValues[c][h]);for(var k=0;k<f.columns[c].childNodes[g].childNodes.length;k++)if(f.columns[c].childNodes[g].childNodes[k].localName!=null&&f.columns[c].childNodes[g].childNodes[k].localName.toLowerCase()===
"value"){var j=f.conditions[c].blackList.indexOf(f.columns[c].childNodes[g].childNodes[k].textContent);if(j!=-1){f.conditions[c].topFilterValue=f.columns[c].childNodes[g].childNodes[k].textContent;f.conditions[c].blackList.splice(j,1)}}if(f.filterIndexes.indexOf(c)!=-1)f.conditions[c].blackList=[]}var l=f.rowConditions.indexOf(c),m=f.colConditions.indexOf(c);if((m<f.colConditions.length-1&&m!=-1||l<f.rowConditions.length-y.length&&l!=-1)&&f.columns[c].childNodes[g]!=void 0&&f.columns[c].childNodes[g].localName!=
void 0&&f.columns[c].childNodes[g].localName==="expand")if(f.serverPagination){for(k=0;k<f.columns[c].childNodes[g].childNodes.length;k++)if(f.columns[c].childNodes[g].childNodes[k].localName!=null&&f.columns[c].childNodes[g].childNodes[k].localName.toLowerCase()==="value"){f.UserExpandValues[c]==void 0&&(f.UserExpandValues[c]=[]);f.UserExpandValues[c].push(f.columns[c].childNodes[g].childNodes[k].textContent.trimpivot())}f.UserExpandValues[c]==void 0&&(f.UserExpandValues[c]=["#ALLCOLLAPSE#"])}else{f.conditions[c].collapsedValues=
[];for(h=0;h<f.GeneralDistinctValues[c].length;h++)f.conditions[c].collapsedValues.push(f.GeneralDistinctValues[c][h]);for(k=0;k<f.columns[c].childNodes[g].childNodes.length;k++)if(f.columns[c].childNodes[g].childNodes[k].localName!=null&&f.columns[c].childNodes[g].childNodes[k].localName.toLowerCase()==="value"){j=f.conditions[c].collapsedValues.indexOf(f.columns[c].childNodes[g].childNodes[k].textContent);j!=-1&&f.conditions[c].collapsedValues.splice(j,1)}}}}catch(n){}};this.pseudoInitCondition=
function(c,g){if(c==f.dataColumnIndex)f.conditions.push(false);else{var h=1,k=1,j=false,l="filters;rows;columns;hidden",m=false;if(f.columns[c]!=void 0){m=true;f.columns[c].getAttribute("order")!=void 0&&f.columns[c].getAttribute("order")==="descending"&&(h=-1);f.columns[c].getAttribute("order")!=void 0&&f.columns[c].getAttribute("order")==="custom"&&(h=0);if(f.columns[c].getAttribute("summarize")!=void 0&&f.columns[c].getAttribute("summarize")==="yes"){k=1;f.columns[c].firstElementChild!=void 0&&
f.columns[c].firstElementChild.localName=="exclude"&&(k=false)}if(g[c].sort!=void 0)h=g[c].sort;if(g[c].subtotals!=void 0)k=g[c].subtotals;if(f.columns[c].getAttribute("summarize")!=void 0&&f.columns[c].getAttribute("summarize")==="no"){k=false;j=true}l="";if(f.columns[c].getAttribute("visible")!="Never"){l=f.columns[c].getAttribute("canDragToPages")=="true"?"filters;":"";l=l+"rows;columns;hidden"}}h={distinctValues:[],blackList:[],whiteList:[],greyList:[],collapsedValues:[],sort:h,subtotals:k,hideSubtotalOption:j,
validPosition:l,dataRowPosition:c,isDimension:m,topFilterValue:gx.getMessage("GXPL_QViewerJSAllOption")};f.conditions.push(h);for(k=0;k<f.allData.length;k++){j=f.allData[k][c];if(j==void 0){j=" ";f.allData[k][c]=" "}h.distinctValues.indexOf(j)==-1&&h.distinctValues.push(j)}h.blackList=g[c].blackList;h.collapsedValues=g[c].collapsedValues;f.allData.length>0&&f.sort(h,c)}};this.init=function(){f.propPage=OAT.Dom.create("div",{});if(k[0]!=void 0){for(var c=0;c<f.headerRow.length;c++){f.initCondition(c);
f.applyCustomFilters(c)}for(var g=jQuery.extend(true,[],f.conditions),h=[],c=0;c<f.initRowConditions.length;c++)h[c]=f.initRowConditions[c];for(var j=[],c=0;c<f.initColConditions.length;c++)j[c]=f.initColConditions[c];for(var l=[],c=0;c<f.initFilterIndexes.length;c++)l[c]=f.initFilterIndexes[c];f.initState={query:f.query,conditions:g,colConditions:j,rowConditions:h,filterDivSelects:[],filterIndexes:l,stateChanged:false,rowsPerPage:v};for(c=0;c<f.headerRow.length;c++)f.restoreSubtotalsAndSortLayout(c);
h=J?f.getState():null;g=[];if(h!=null&&h.version!=void 0&&h.version===f.rememberLayoutStateVersion&&h.query==f.query&&f.conditions.length==h.conditions.length){for(j=0;j<=h.conditions.length-1;j++)if(h.conditions[j]!=false&&f.conditions[j]!=false){for(l=0;l<h.conditions[j].blackList.length;l++)f.conditions[j].blackList.indexOf(h.conditions[j].blackList[l])==-1&&f.GeneralDistinctValues[j].indexOf(h.conditions[j].blackList[l])!=-1&&f.conditions[j].blackList.push(h.conditions[j].blackList[l]);for(l=
0;l<h.conditions[j].collapsedValues.length;l++)f.conditions[j].collapsedValues.indexOf(h.conditions[j].collapsedValues[l])==-1&&f.GeneralDistinctValues[j].indexOf(h.conditions[j].collapsedValues[l])!=-1&&f.conditions[j].collapsedValues.push(h.conditions[j].collapsedValues[l]);try{f.conditions[j].sort=h.conditions[j].sort;f.sort(f.conditions[j],j);f.oldSortValues[j]=h.conditions[j].sort;f.conditions[j].subtotals=h.conditions[j].subtotals}catch(m){}}f.rowConditions=h.rowConditions;f.colConditions=h.colConditions;
f.rowsPerPage=h.rowsPerPage;f.filterIndexes=h.filterIndexes;if(h.filterDivSelects!=void 0)for(j=0;j<h.filterDivSelects.length;j++)g[j]=h.filterDivSelects[j];f.stateChanged=true}try{if(h!=null&&h.version===f.rememberLayoutStateVersion&&h.filterIndexes.length>0){h=false;for(c=0;c<f.conditions.length;c++){j=[];if(f.conditions[c]&&f.conditions[c].blackList)for(var n=0;n<f.conditions[c].blackList.length;n++){j.push(f.conditions[c].blackList[n]);h=true}f.tempBlackLists.push([j]);j=[];if(f.conditions[c]&&
f.conditions[c].collapsedValues)for(n=0;n<f.conditions[c].collapsedValues.length;n++){j.push(f.conditions[c].collapsedValues[n]);h=true}f.tempCollapsedValues.push([j])}if(!h)f.tempBlackLists=false}else f.tempBlackLists=false}catch(o){f.tempBlackLists=false}f.gd.clearSources();f.gd.clearTargets();f.drawTitleDiv();(f.autoPaging||f.rowConditions.length<=16||f.GeneralDataRows.length<=1200)&&f.drawFilters();if(g.length>0){for(j=0;j<g.length;j++)f.filterDiv.selects[j].value=g[j];f.preGoWhenFilterByTopFilter(true)}try{if(f.filterIndexes.length==
0){f.applyFilters();f.createAggStructure();f.fillAggStructure();f.checkAggStructure();f.count()}}catch(q){}GlobalPivotInterval[D]!=void 0&&clearInterval(GlobalPivotInterval[D]);var r=0,t=0;GlobalPivotInterval[D]=setInterval(function(){if(f.autoPaging&&(jQuery("#"+f.containerName+" #tablePagination_currPage")[0]!=void 0||jQuery("#"+f.controlName+"_"+f.query+"_tablePagination #tablePagination_currPage")[0]!=void 0)){var c;c=jQuery("#"+f.containerName+" #tablePagination_currPage")[0]!=void 0?parseInt(jQuery("#"+
f.containerName+" #tablePagination_currPage")[0].value):parseInt(jQuery("#"+f.controlName+"_"+f.query+"_tablePagination #tablePagination_currPage")[0].value);if(f.actualPaginationPage!=c){var g=f.actualPaginationPage<c,h=c==parseInt(jQuery("#"+f.containerName+" #tablePagination_totalPages")[0].textContent);f.actualPaginationPage=c;f.changePaginationRows(c,g,h);c=jQuery("#"+f.containerName+" #tablePagination_totalPages")[0]!=void 0?parseInt(jQuery("#"+f.containerName+" #tablePagination_totalPages")[0].value):
parseInt(jQuery("#"+f.controlName+"_"+f.query+"_tablePagination  #tablePagination_totalPages")[0].value);if(!isNaN(c))f.TotalPagesPaging=c;f.go(false)}c=parseInt(jQuery("#"+f.controlName+"_"+f.query+"tablePagination_rowsPerPage")[0].value);if(f.autoPagingRowsPerPage!=c){f.autoPagingRowsPerPage=c;f.actualPaginationPage=1;setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter);f.changePaginationRows(1);f.go(false)},500)}}c=0;if(jQuery("#"+f.controlName+"_"+f.query+"tablePagination_rowsPerPage").length>
0){c=parseInt(jQuery("#"+f.controlName+"_"+f.query+"tablePagination_rowsPerPage")[0].value);if(!isNaN(c)){if(f.rowsPerPage!=c){f.rowsPerPage=c;f.stateChanged=true;c=[];for(g=0;g<f.filterDiv.selects.length;g++)c[g]=f.filterDiv.selects[g].value;f.saveState({query:f.query,conditions:f.conditions,colConditions:f.colConditions,rowConditions:f.rowConditions,filterIndexes:f.filterIndexes,filterDivSelects:c,rowsPerPage:f.rowsPerPage,version:f.rememberLayoutStateVersion})}else f.rowsPerPage=c;if(jQuery("#"+
f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"){if(!G){c=jQuery("#"+f.containerName)[0].clientWidth;jQuery("#"+f.controlName+"_"+f.query).css({width:c+"px"})}c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-4;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(c=c+4)}catch(k){}g=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-1;try{var j=jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css("border-right-width");j!=void 0&&j[0]!="0"&&(g=g-1)}catch(A){}j=
jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].clientWidth;if(j>c+1||j<c-1){jQuery("#"+D+"_"+f.query+"_title_div").css({width:c+"px"});jQuery("#"+D+"_"+f.query+"_pivot_page").css({width:c+"px"});jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css({width:g+"px"});t=r;r=c}jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.controlName+"_"+f.query+
"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")}jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")}}else if(jQuery("#"+f.controlName+"_"+f.query)[0]!=
void 0&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"){if(!G){c=jQuery("#"+f.containerName)[0].clientWidth;jQuery("#"+f.controlName+"_"+f.query).css({width:c+"px"})}c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth;if(t==0||t==r||r>c+6||r<c-6||t>r+6||t<r-6){jQuery("#"+D+"_"+f.query+"_title_div").css({width:c+"px"});jQuery("#"+D+"_"+f.query+"_pivot_page").css({width:c+"px"});t=r;r=c}}},250)}else{OAT.Dom.clear(f.div);f.div.setAttribute("class","conteiner_table_div");
f.drawTitleDiv();f.drawFilters();c=OAT.Dom.create("table",{},"pivot_table");c.id=this.controlName+"_"+this.query;g=OAT.Dom.create("tbody");OAT.Dom.append([c,g],[f.div,c]);if(f.colConditions.length>0){c=0;j=OAT.Dom.create("tr");f._drawRowConditionsHeadingsCustom(j);for(c=0;c<f.colConditions.length;c++)j=f._drawColConditionsHeadingsCustom(j,c,c===f.colConditions.length-1);f.appendRowToTable(g,j,true);firstRow=j;if(f.colConditions.length>0){j=OAT.Dom.create("tr");for(c=0;c<y.length;c++){h=OAT.Dom.create("th",
{},"h2titlewhite");h.colSpan=1;OAT.addTextNode(h,y[c].attributes.getNamedItem("displayName").nodeValue);f.setTitleTexrtAlign(h,h.textContent);j.appendChild(h)}f.appendRowToTable(g,j,true)}c=y.length-f.colConditions.length;if(c>0){h=OAT.Dom.create("th",{},"h2subtitle ");OAT.addTextNode(h,"");h.colSpan=c;h.style.borderLeftColor="transparent";firstRow.appendChild(h)}}else{j=OAT.Dom.create("tr");for(c=0;c<f.rowConditions.length-(y.length-1);c++){h=OAT.Dom.create("th",{cursor:"pointer"},"h2title");l=OAT.Dom.create("div");
OAT.addTextNode(l,f.headerRow[f.rowConditions[c]]+"   ");h.appendChild(l);j.appendChild(h)}if(f.colConditions.length>0)for(c=0;c<f.colConditions.length;c++){h=OAT.Dom.create("th",{cursor:"pointer"},"h2title");l=OAT.Dom.create("div");OAT.addTextNode(l,f.headerRow[f.colConditions[c]]+"   ");h.appendChild(l);j.appendChild(h)}for(n=0;n<f.rowConditions.length;n++)if(f.isMeasureByName(f.headerRow[f.rowConditions[n]])){h=OAT.Dom.create("th",{},"h2titlewhite");l=OAT.Dom.create("div");OAT.addTextNode(l,f.headerRow[f.rowConditions[n]]);
f.setTitleTexrtAlign(l,f.headerRow[f.rowConditions[n]]);f.setClickEventHandlers(h,f.headerRow[f.rowConditions[n]],"MEASURE",f.rowConditions[n]-H.length,"GrandTotal");OAT.Dom.append([h,l],[j,h])}if(f.colConditions.length)h.style.border="none";else{h=OAT.Dom.create("th");f._drawCorner(h,true);h.conditionIndex=-1;j.appendChild(h)}g.appendChild(j)}gx.util.browser.isIE()&&jQuery("#"+D+"_"+f.query+"_pivot_page").css({boxShadow:"0px 0px 0px"});GlobalPivotInterval[D]!=void 0&&clearInterval(GlobalPivotInterval[D]);
t=r=0;setTimeout(function(){if(jQuery("#"+f.controlName+"_"+f.query)[0]!=void 0&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"){if(!G){var c=jQuery("#"+this.containerName)[0].clientWidth;jQuery("#"+f.controlName+"_"+f.query).css({width:c-4+"px"})}c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-4;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(c=c+4)}catch(g){}jQuery("#"+D+"_"+f.query+"_title_div").css({width:c+"px"});jQuery("#"+D+"_"+f.query+
"_pivot_page").css({width:c+"px"})}},250)}};this.initWhenServerPagination=function(){f.propPage=OAT.Dom.create("div",{});f.QueryViewerCollection[f.IdForQueryViewerCollection].AutoRefreshGroup==""&&jQuery(".oat_winrect_container").remove();f.UserFilterValues=[];f.UserExpandValues=[];for(var c=0;c<f.headerRow.length;c++){f.initCondition(c);if(f.conditions[c]&&f.columns[c]){f.conditions[c].dataField=f.columns[c].getAttribute("dataField");f.conditions[c].state="all";f.conditions[c].defaultAction="Include";
f.conditions[c].visibles=[];f.conditions[c].searchInfo={previousPage:0,totalPages:0,filteredText:"",values:[]}}f.applyCustomFilters(c)}for(var g=jQuery.extend(true,[],f.conditions),h=[],c=0;c<f.initRowConditions.length;c++)h[c]=f.initRowConditions[c];for(var k=[],c=0;c<f.initColConditions.length;c++)k[c]=f.initColConditions[c];for(var j=[],c=0;c<f.initFilterIndexes.length;c++)j[c]=f.initFilterIndexes[c];c=jQuery.extend(true,{},f.initMetadata);f.initState={query:f.query,conditions:g,colConditions:k,
rowConditions:h,filterDivSelects:[],filterIndexes:j,stateChanged:false,rowsPerPage:v,AxisInfo:f.createAxisInfo(""),NewAxisInfo:f.createNewAxisInfo(""),DataInfo:f.createDataInfo(),NewDataInfo:f.createNewDataInfo(),CollapseInfo:[],FilterInfo:[],InitMetadata:c};for(c=0;c<f.headerRow.length;c++)f.restoreSubtotalsAndSortLayout(c);var g=J?f.getState():null,l=false;f.stateLoad=false;if(g!=null&&g.version!=void 0&&g.version===f.rememberLayoutStateVersion&&g.query==f.query&&f.conditions.length==g.conditions.length){l=
true;f.stateLoad=true;f.UserFilterValues=[];for(h=0;h<=g.conditions.length-1;h++)if(g.conditions[h]!=false&&f.conditions[h]!=false){for(k=0;k<g.conditions[h].distinctValues.length;k++)f.conditions[h].distinctValues.indexOf(g.conditions[h].distinctValues[k])==-1&&f.conditions[h].distinctValues.push(g.conditions[h].distinctValues[k]);for(k=0;k<g.conditions[h].blackList.length;k++)f.conditions[h].blackList.indexOf(g.conditions[h].blackList[k])==-1&&f.conditions[h].blackList.push(g.conditions[h].blackList[k]);
if(g.conditions[h].visibles)for(k=0;k<g.conditions[h].visibles.length;k++)f.conditions[h].visibles.indexOf(g.conditions[h].visibles[k])==-1&&f.conditions[h].visibles.push(g.conditions[h].visibles[k]);for(k=0;k<g.conditions[h].collapsedValues.length;k++)f.conditions[h].collapsedValues.indexOf(g.conditions[h].collapsedValues[k])==-1&&f.conditions[h].collapsedValues.push(g.conditions[h].collapsedValues[k]);try{f.conditions[h].sort=g.conditions[h].sort;f.oldSortValues[h]=g.conditions[h].sort;f.conditions[h].subtotals=
g.conditions[h].subtotals;f.conditions[h].defaultAction=g.conditions[h].defaultAction;f.conditions[h].state=g.conditions[h].state;f.conditions[h].topFilterValue=g.conditions[h].topFilterValue;f.conditions[h].totalPages=g.conditions[h].totalPages;f.conditions[h].previousPage=g.conditions[h].previousPage;f.conditions[h].blocked=g.conditions[h].blocked}catch(m){}}f.rowConditions=g.rowConditions;f.colConditions=g.colConditions;f.rowsPerPage=g.rowsPerPage;f.filterIndexes=g.filterIndexes;if(g.filterDivSelects!=
void 0)for(h=0;h<g.filterDivSelects.length;h++);f.stateChanged=true}try{if(g!=null&&g.version===f.rememberLayoutStateVersion&&g.filterIndexes.length>0){h=false;for(c=0;c<f.conditions.length;c++){k=[];if(f.conditions[c]&&f.conditions[c].blackList)for(var n=0;n<f.conditions[c].blackList.length;n++){k.push(f.conditions[c].blackList[n]);h=true}f.tempBlackLists.push([k]);k=[];if(f.conditions[c]&&f.conditions[c].collapsedValues)for(n=0;n<f.conditions[c].collapsedValues.length;n++){k.push(f.conditions[c].collapsedValues[n]);
h=true}f.tempCollapsedValues.push([k])}if(!h)f.tempBlackLists=false}else f.tempBlackLists=false}catch(o){f.tempBlackLists=false}f.gd.clearSources();f.gd.clearTargets();GlobalPivotInterval[D]!=void 0&&clearInterval(GlobalPivotInterval[D]);var q=0,r=0;GlobalPivotInterval[D]=setInterval(function(){for(var c=0,c=jQuery("#"+D+"_"+f.query+"_pivot_page").find(".inner_filter_div"),g=0,h=0;h<c.length;h++)if(g<c[h].offsetWidth)g=c[h].offsetWidth;g=g>0?g+8:g;if(jQuery("#"+f.controlName+"_"+f.query+"tablePagination_rowsPerPage").length>
0){c=parseInt(jQuery("#"+f.controlName+"_"+f.query+"tablePagination_rowsPerPage")[0].value);if(!isNaN(c)&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"){if(!G){c=jQuery("#"+f.containerName)[0].clientWidth;c<g?jQuery("#"+f.controlName+"_"+f.query).css({width:g+"px"}):jQuery("#"+f.controlName+"_"+f.query).css({width:c+"px"})}c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth;if(c>=g){h=jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].clientWidth;if(h>
g+1||h<g-1){jQuery("#"+D+"_"+f.query+"_title_div").css({width:c+"px"});jQuery("#"+D+"_"+f.query+"_pivot_page").css({width:c+"px"});jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css({width:c+"px"});r=q;q=c}}else{jQuery("#"+D+"_"+f.query+"_title_div").css({width:g+"px"});jQuery("#"+D+"_"+f.query+"_pivot_page").css({width:g+"px"});jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css({width:g+"px"});jQuery("#"+f.controlName+"_"+f.query).css({width:g+"px"});r=q;q=g}}}else if(jQuery("#"+
f.controlName+"_"+f.query)[0]!=void 0&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"){if(!G){c=jQuery("#"+f.containerName)[0].clientWidth;c<g?jQuery("#"+f.controlName+"_"+f.query).css({width:g+"px"}):jQuery("#"+f.controlName+"_"+f.query).css({width:c+"px"})}c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth;if(c<g){if(r==0||r==q||q>g+6||q<g-6||r>q+6||r<q-6){jQuery("#"+D+"_"+f.query+"_title_div").css({width:g+"px"});jQuery("#"+D+"_"+f.query+"_pivot_page").css({width:g+
"px"});r=q;q=g;jQuery("#"+f.controlName+"_"+f.query).css({width:g+"px"})}}else if(r==0||r==q||q>c+6||q<c-6||r>q+6||r<q-6){jQuery("#"+D+"_"+f.query+"_title_div").css({width:c+"px"});jQuery("#"+D+"_"+f.query+"_pivot_page").css({width:c+"px"});r=q;q=c}}},20);if(g!=null&&g.AxisInfo!=null){f.pageData.AxisInfo=g.AxisInfo;n=jQuery.extend(true,{},g.NewAxisInfo)}else{f.pageData.AxisInfo=f.createAxisInfo("");n=f.createNewAxisInfo("")}if(g!=null&&g.DataInfo!=null){f.pageData.DataInfo=g.DataInfo;c=jQuery.extend(true,
{},g.NewDataInfo)}else{f.pageData.DataInfo=f.createDataInfo();c=f.createNewDataInfo()}if(g!=null&&g.FilterInfo!=null)f.pageData.FilterInfo=g.FilterInfo;if(f.UserFilterValues.length==0&&f.UserExpandValues.length==0){f.pageData.CollapseInfo=f.CreateExpandCollapseInfo("");f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){if(!qv.util.anyError(c)||f.QueryViewerCollection[f.IdForQueryViewerCollection].debugServices){f.pageData=OATGetNewDataFromXMLForPivot(c,f.pageData,
f.ShowMeasuresAsRows);f.preGoWhenServerPagination(true);f.filterIndexes.length>0&&f.initValueRead(f,0,l);qv.util.hideActivityIndicator(f.QueryViewerCollection[f.IdForQueryViewerCollection])}else{c=qv.util.getErrorFromText(c);qv.util.renderError(f.QueryViewerCollection[f.IdForQueryViewerCollection],c)}}.closure(this),[1,f.rowsPerPage,true,n,c,f.pageData.FilterInfo,f.pageData.CollapseInfo,true])}else f.initValueRead(f,0,true);setInterval(function(){for(var c=0;c<jQuery(".oat_winrect_container .pivot_popup_fix").length;c++)if((!jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[c].style.display||
jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[c].style.display!="none")&&jQuery(".oat_winrect_container .pivot_popup_fix").length>0){var g=jQuery(".oat_winrect_container .pivot_popup_fix")[c];if(g.scrollHeight-g.clientHeight-g.scrollTop<25){var h=g.getAttribute("ucid"),g=parseInt(g.getAttribute("columnNumber"));h==f.UcId&&f.readScrollValue(g)}}},250)};this.initValueRead=function(f,c,g,h){if(c>=f.columns.length){try{for(var k=0;k<jQuery("#"+f.UcId+"_"+f.query+
"_pivot_page").find("select").length;k++){var j=jQuery("#"+f.UcId+"_"+f.query+"_pivot_page").find("select")[k],l=parseInt(j.getAttribute("id").replace("page_select_","")),m=f.filterIndexes[l];if(f.conditions[m].filteredShowValues==void 0)f.conditions[m].filteredShowValues=[];for(var n=f.conditions[m].distinctValues,o=0;o<n.length;o++){var q=n[o];if(f.conditions[m].filteredShowValues.indexOf(q)==-1){f.conditions[m].filteredShowValues.push(q);q!="#NuN#"?OAT.Dom.option(q,q,j):OAT.Dom.option(" ",q,j)}}if(f.conditions[m].topFilterValue!=
"[all]"){for(var q=f.conditions[m].topFilterValue,o=-1,r=0;r<f.conditions[m].filteredShowValues.length;r++)(""+f.conditions[m].filteredShowValues[r]).trim()==(""+q).trim()&&(o=r);if(o>-1)j.selectedIndex=o+1;else{f.conditions[m].filteredShowValues.push(q);q!="#NuN#"?OAT.Dom.option(q,q,j):OAT.Dom.option(" ",q,j);j.selectedIndex=1}}}}catch(t){}g&&f.callServiceWhenCustomeValues()}else{k=10;if(f.QueryViewerCollection[f.IdForQueryViewerCollection].AutoRefreshGroup!=""||g)k=0;f.lastRequestValue=c;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(k){k=
JSON.parse(k);f.conditions[c].previousPage=k.PageNumber;f.conditions[c].totalPages=k.PagesCount;f.conditions[c].blocked=false;if(g)f.conditions[c].distinctValues=[];if(k.Null){f.conditions[c].hasNull=true;f.conditions[c].distinctValues.indexOf("#NuN#")==-1&&f.conditions[c].distinctValues.push("#NuN#");var j=true;f.conditions[c].NullIncluded||(j=false);j&&f.conditions[c].visibles.indexOf("#NuN#")==-1&&f.conditions[c].visibles.push("#NuN#")}else f.conditions[c].hasNull=false;for(var j=[],l=0;l<k.NotNullValues.length;l++){var m=
k.NotNullValues[l],n=false;if(f.conditions[c].state=="none"&&f.UserFilterValues.length>0&&f.UserFilterValues[c]!=void 0&&f.UserFilterValues[c].length>0&&f.UserFilterValues[c].indexOf(m.trimpivot())!=-1){n=true;j.push(m)}f.conditions[c].distinctValues.indexOf(m)==-1&&f.conditions[c].distinctValues.push(m);f.conditions[c].state=="all"&&f.conditions[c].visibles.indexOf(m)==-1&&f.conditions[c].visibles.push(m);f.conditions[c].state=="none"&&(f.conditions[c].blackList.indexOf(m)==-1&&!n)&&f.conditions[c].blackList.push(m);
g&&f.UserExpandValues.length>0&&f.UserExpandValues[c]!=void 0&&(f.UserExpandValues[c][0]=="#ALLCOLLAPSE#"||f.UserExpandValues[c].indexOf(m.trimpivot())==-1)&&f.conditions[c].collapsedValues.push(m)}for(l=0;l<j.length;l++)f.createFilterInfo({op:"pop",values:j[l],dim:c},true);if(h==void 0){c++;f.initValueRead(f,c,g)}}.closure(this),[f.columns[c].getAttribute("dataField"),1,k,""])}};this.callServiceWhenCustomeValues=function(){f.pageData.CollapseInfo=f.CreateExpandCollapseInfo("");var c=f.createNewAxisInfo(),
g=f.createNewDataInfo();f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){if(!qv.util.anyError(c)||f.QueryViewerCollection[f.IdForQueryViewerCollection].debugServices){f.pageData=OATGetNewDataFromXMLForPivot(c,f.pageData,f.ShowMeasuresAsRows);f.preGoWhenServerPagination(true);qv.util.hideActivityIndicator(f.QueryViewerCollection[f.IdForQueryViewerCollection])}else{c=qv.util.getErrorFromText(c);qv.util.renderError(f.QueryViewerCollection[f.IdForQueryViewerCollection],
c)}}.closure(this),[1,f.rowsPerPage,true,c,g,f.pageData.FilterInfo,f.pageData.CollapseInfo,true])};this.getOrderReference=function(c,g,h,k){return function(j,l,m){if(!(f.conditions[c].validPosition!=void 0&&f.conditions[c].validPosition.indexOf("filters")==-1)){f.lightOff();var n=j.conditionIndex;c!=n&&f.conditions[0].previousPage==void 0&&f.initValueRead(f,0,f.stateLoad);if(j==f.filterDiv){f.stateChanged=true;n=false;for(j=0;j<f.filterIndexes.length&&!n;j++)if(f.filterIndexes[j]>c){f.filterIndexes.splice(j,
0,c);n=true}n||f.filterIndexes.push(c);f.conditions[c].blackList=[];for(l=0;l<f.rowConditions.length;l++)f.rowConditions[l]==c&&f.rowConditions.splice(l,1);for(l=0;l<f.colConditions.length;l++)f.colConditions[l]==c&&f.colConditions.splice(l,1);f.serverPagination||(f.autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(c));f.onDragundDropEventHandle(c,"pages",f.filterIndexes.indexOf(c));f.DiseablePivot();setTimeout(function(){f.serverPagination?f.getDataForPivot(f.UcId,1,f.rowsPerPage,
true,f.conditions[c].dataField,{op:"all",value:"",dim:c},"",""):f.go(false);f.EneablePivot()},200)}else{j=f.rowConditions.indexOf(c)>-1;if(c==n){if(gx.util.browser.webkit&&g!=void 0){g.displayRef2([l,m]);h([l,m,k])}}else{for(var m=false,o=-1,q=false,r=-1,l=0;l<f.rowConditions.length;l++){if(f.rowConditions[l]==c){m=f.rowConditions;o=l}if(f.rowConditions[l]==n){q=f.rowConditions;r=l}}for(l=0;l<f.colConditions.length;l++){if(f.colConditions[l]==c){m=f.colConditions;o=l}if(f.colConditions[l]==n){q=f.colConditions;
r=l}}if(n==-1){f.colConditions.push(c);f.rowConditions.splice(o,1);autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(c);f.go(f)}else if(n==-2){f.rowConditions.push(c);f.colConditions.splice(o,1);autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(c);f.go(f)}else{if(m==q){if(o+1==r){q.splice(r+1,0,c);q.splice(o,1)}else{q.splice(o,1);q.splice(r,0,c)}f.changesrowposition=true;f.onDragundDropEventHandle(c,j?"rows":"columns",j?f.rowConditions.indexOf(c):f.colConditions.indexOf(c))}else{m.splice(o,
1);q.splice(r,0,c);f.onDragundDropEventHandle(c,j?"columns":"rows",j?f.colConditions.indexOf(c):f.rowConditions.indexOf(c))}f.serverPagination?f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[c].dataField,"","",""):f.go(false)}}}}}};this.getOrderReferenceProg=function(c){if(!(f.conditions[c].validPosition!=void 0&&f.conditions[c].validPosition.indexOf("filters")==-1)){f.stateChanged=true;f.filterIndexes.indexOf(c)<0&&f.filterIndexes.push(c);f.conditions[c].blackList=[];for(var g=0;g<f.rowConditions.length;g++)f.rowConditions[g]==
c&&f.rowConditions.splice(g,1);for(g=0;g<f.colConditions.length;g++)f.colConditions[g]==c&&f.colConditions.splice(g,1);f.serverPagination||(f.autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(c));f.onDragundDropEventHandle(c,"pages",f.filterIndexes.indexOf(c));f.DiseablePivot();setTimeout(function(){f.serverPagination?f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[c].dataField,{op:"all",value:"",dim:c},"",""):f.go(false);f.EneablePivot()},200)}};this.getClickReference=
function(c,g,h){var k=OAT.Anchor.assign(h,{title:" ",content:f.propPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(f.QueryViewerCollection[f.IdForQueryViewerCollection])+" FilterPopup "});jQuery(h).data("anchorRef",k);return[function(h){if(f.serverPagination)if(f.conditions[g].previousPage==void 0){f.initValueRead(f,g,f.stateLoad,f.conditions[g].dataField);jQuery(".oat_winrect_container").css({left:"-10000000px",
top:"-10000000px"});var k=jQuery.extend(true,{},h),j=function(){f.conditions[g].previousPage==void 0?setTimeout(j,100):f.ShowPopUp(c,g,k)};j()}else f.ShowPopUp(c,g,h);else f.ShowPopUp(c,g,h)},k]};this.ShowPopUp=function(c,g,h){var k=function(){jQuery(".oat_winrect_container").css({display:"none"})},j,l;if(h.currentTarget!=void 0){j=h.currentTarget;l=OAT.Dom.eventPos(h)}else{j=h[2];l=[h[0],h[1]]}h=[];f.propPage.style.left=l[0]+"px";f.propPage.style.top=l[1]+"px";if(f.isSD){jQuery(".oat_winrect_container").css({left:"-1500px",
top:jQuery(j).offset().top+"px"});jQuery(".oat_winrect_container").addClass("oat_winrect_container_small")}else jQuery(".oat_winrect_container").css({left:jQuery(j).offset().left+"px",top:jQuery(j).offset().top+"px"});f.propPage.setAttribute("id","pop-up");f.propPage.setAttribute("class","oatpop-up");OAT.Dom.clear(f.propPage);h.push(f.propPage);jQuery(".oat_winrect_title").find(".winrect_title_label").remove();l=OAT.Dom.create("label");f.isSD?l.setAttribute("class","winrect_title_label winrect_title_label_small"):
l.setAttribute("class","winrect_title_label");OAT.addTextNode(l,f.columns[g].getAttribute("displayName"));jQuery(".oat_winrect_title").append(l);if(!I){l=document.createElement("div");l.setAttribute("class","first_popup_subdiv");var m=OAT.Dom.radio("order"),n="pivot_order_asc_"+f.containerName+"_"+f.columns[g].getAttribute("dataField");m.id=n;OAT.Dom.attach(m,"change",function(){try{var h='<DATA event="OrderChanged" name="'+f.columns[g].getAttribute("name")+'" displayName="'+f.columns[g].getAttribute("displayName")+
'"  order="ascending">',h=h+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,h)}catch(k){}if(f.serverPagination){c.sort=1;f.stateChanged=true;f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","","");h="i_"+this.getAttribute("id");document.getElementById(h).textContent="radio_button_checked";document.getElementById(h.replace("asc","desc")).textContent="radio_button_unchecked"}else{c.sort=c.sort==0||c.sort==2?
0:1;f.stateChanged=true;f.sort(c,g);f.DiseablePivot();setTimeout(function(){f.go(false);f.EneablePivot()},200)}});l.appendChild(m);var o=gx.util.browser.isIE()?"top:-10px;":"",q=OAT.Dom.create("label");q.htmlFor=n;l.appendChild(q);l.appendChild(OAT.Dom.create("br"));OAT.addImageNode(q,c.sort==1?"radio_button_checked":"radio_button_unchecked",o,"i_"+n);OAT.addTextNode(q,gx.getMessage("GXPL_QViewerJSAscending"));n=OAT.Dom.radio("order");q="pivot_order_desc_"+f.containerName+"_"+f.columns[g].getAttribute("dataField");
n.id=q;OAT.Dom.attach(n,"change",function(){try{var h='<DATA event="OrderChanged" name="'+f.columns[g].getAttribute("name")+'" displayName="'+f.columns[g].getAttribute("displayName")+'"  order="descending">',h=h+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,h)}catch(k){}if(f.serverPagination){c.sort=-1;f.stateChanged=true;f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","","");h="i_"+this.getAttribute("id");
document.getElementById(h).textContent="radio_button_checked";document.getElementById(h.replace("desc","asc")).textContent="radio_button_unchecked"}else{c.sort=c.sort==0||c.sort==2?2:-1;f.stateChanged=true;f.sort(c,g);f.serverPagination||f.updateSortImage(j.firstChild.children[1],2);f.DiseablePivot();setTimeout(function(){f.go(false);f.EneablePivot()},200)}});l.appendChild(n);var r=OAT.Dom.create("label");r.htmlFor=q;l.appendChild(r);OAT.addImageNode(r,c.sort==1?"radio_button_unchecked":"radio_button_checked",
o,"i_"+q);OAT.addTextNode(r,gx.getMessage("GXPL_QViewerJSDescending"));h.push(l);l=OAT.Dom.create("hr",{});h.push(l)}o=OAT.Dom.create("hr",{});l=OAT.Dom.create("hr",{});if((c.hideSubtotalOption===void 0||!c.hideSubtotalOption)&&(!f.autoPaging||f.colConditions.length==0)){q=OAT.Dom.create("div");I&&q.setAttribute("class","first_popup_subdiv");var r=document.createElement("div"),t=c.subtotals?"check_item_img":"uncheck_item_img";f.isSD&&(t=c.subtotals?"check_item_img_small":"uncheck_item_img_small");
r.setAttribute("class",t);OAT.Dom.attach(r,"click",function(){var h="check_item_img",k="uncheck_item_img";if(f.isSD){h="check_item_img_small";k="uncheck_item_img_small"}c.subtotals=this.getAttribute("class")!==h;this.setAttribute("class",this.getAttribute("class")===h?k:h);jQuery(this).find("i")[0].textContent=c.subtotals?"check_box":"check_box_outline_blank";f.stateChanged=true;try{var j='<DATA event="SubtotalsChanged" name="'+f.columns[g].getAttribute("name")+'" displayName="'+f.columns[g].getAttribute("displayName")+
'"  subtotals="'+c.subtotals+'">',j=j+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,j)}catch(l){}if(f.autoPaging){f.DiseablePivot();setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter);f.go(false);f.EneablePivot()},500)}else if(f.serverPagination)f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","","");else{f.DiseablePivot();setTimeout(function(){f.go(false);f.EneablePivot()},500)}});t=OAT.Dom.create("label");
OAT.addImageNode(t,c.subtotals?"check_box":"check_box_outline_blank","");OAT.addTextNode(t,gx.getMessage("GXPL_QViewerJSSubtotals"));t.htmlFor="pivot_checkbox_subtotals";r.appendChild(t);OAT.Dom.append([q,r]);h.push(q);h.push(o)}if(f.stateChanged||f.pivotStateChanged()){o=OAT.Dom.create("div");q=document.createElement("div");OAT.Dom.attach(q,"click",function(){if(!f.autoPaging&&!f.serverPagination){f.cleanState();for(var g=0;g<f.conditions.length;g++)f.sort(f.conditions[g],g);c.subtotals=true;f.DiseablePivot();
setTimeout(function(){f.EneablePivot();f.go(false);k();f.stateChanged=false;f.EneablePivot()},200)}else if(f.serverPagination){f.cleanStateWhenServerPagination();f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","","");k();f.stateChanged=false}else{f.cleanState();for(g=0;g<f.conditions.length;g++)f.sort(f.conditions[g],g);if(jQuery("#"+f.containerName+" #tablePagination_currPage")[0]!=void 0)jQuery("#"+f.containerName+" #tablePagination_currPage")[0].value=1;f.actualPaginationPage=1;f.DiseablePivot();
setTimeout(function(){f.preGo(false,null,null,-1);k();f.stateChanged=false;f.EneablePivot()},200)}});r=OAT.Dom.create("label");OAT.addTextNode(r,gx.getMessage("GXPL_QViewerJSRestoreDefaultView"));r.htmlFor="pivot_checkbox_restoreview";q.appendChild(r);OAT.Dom.append([o,q]);h.push(o)}o=false;if(y.length>0){o=OAT.Dom.create("div");q=document.createElement("div");OAT.Dom.attach(q,"click",function(){if(!f.autoPaging&&!f.serverPagination){f.stateChanged=true;f.changedFromColumnToRow(g);f.DiseablePivot();
setTimeout(function(){f.go(false);k();f.EneablePivot()},200)}else if(f.serverPagination){f.stateChanged=true;f.changedFromColumnToRow(g);f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","","");k()}else if(f.columns.length<4){f.stateChanged=true;f.changedFromColumnToRow(g);f.DiseablePivot();setTimeout(function(){f.preGo(false,null,null,-1);f.distinctDivs(f.conditions[g],u,g);k();f.EneablePivot()},200)}});r=OAT.Dom.create("label");f.rowConditions.indexOf(g)!=-1?OAT.addTextNode(r,gx.getMessage("GXPL_QViewerJSPivotDimensionToColumn")):
OAT.addTextNode(r,gx.getMessage("GXPL_QViewerJSPivotDimensionToRow"));r.htmlFor="pivot_checkbox_restoreview";q.appendChild(r);OAT.Dom.append([o,q]);h.push(o);o=true}if(y.length>0){q=navigator.userAgent.toLowerCase().indexOf("android")>-1;if((gx.util.browser.isIPad()||gx.util.browser.isIPhone()||q)&&f.filterIndexes.indexOf(g)===-1){o=OAT.Dom.create("div");q=document.createElement("div");OAT.Dom.attach(q,"click",function(){if(f.serverPagination)f.getOrderReferenceProg(g);else{f.filterIndexes.push(g);
f.conditions[g].blackList=[];for(var c=0;c<f.rowConditions.length;c++)f.rowConditions[c]==g&&f.rowConditions.splice(c,1);for(c=0;c<f.colConditions.length;c++)f.colConditions[c]==g&&f.colConditions.splice(c,1);f.autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(g);f.go(false)}k()});r=OAT.Dom.create("label");OAT.addTextNode(r,gx.getMessage("GXPL_QViewerJSMoveToFilterBar"));r.htmlFor="pivot_checkbox_movetocolumn";q.appendChild(r);OAT.Dom.append([o,q]);h.push(o);o=true}}o&&h.push(l);
var u=OAT.Dom.create("div");u.setAttribute("class","last_div_popup");if(gx.util.browser.isIE()){OAT.Dom.create("span");OAT.Dom.create("span");OAT.Dom.create("span")}else{OAT.Dom.create("br");OAT.Dom.create("br");OAT.Dom.create("br")}h.push(u);OAT.Dom.append(h);f.distinctDivs(c,u,g);if(!I){m.checked=c.sort==1||c.sort==0;m.__checked=m.checked;n.checked=c.sort==-1||c.sort==2;n.__checked=n.checked}f.isSD&&setTimeout(function(){var f=window.innerWidth,c=jQuery(".oat_winrect_container")[0].clientWidth;
if(c==0){c=jQuery(".oat_winrect_container").length;c=jQuery(".oat_winrect_container")[c-1].clientWidth}c<245&&(c=245);f=(f-c)/2+jQuery(window).scrollLeft();jQuery(".oat_winrect_container").css({left:f+"px",width:c+"px"})},50)};this.updateRowConditions=function(c,g){var h=false;f.initRowConditions.length+f.initColConditions.length<=f.rowConditions.length+f.colConditions.length&&(h=true);for(var k=[],j=0;j<f.initRowConditions.length-(g.length-1);j++){f.initRowConditions[j]==c&&k.push(c);f.rowConditions.indexOf(f.initRowConditions[j])>
-1&&k.push(f.initRowConditions[j])}for(j=0;j<f.initColConditions.length;j++){f.initColConditions[j]==c&&k.push(c);f.rowConditions.indexOf(f.initColConditions[j])>-1&&k.push(f.initColConditions[j])}for(j=0;j<f.initFilterIndexes.length;j++){f.initFilterIndexes[j]==c&&k.indexOf(c)==-1&&k.push(c);f.rowConditions.indexOf(f.initFilterIndexes[j])>-1&&k.indexOf(f.initFilterIndexes[j])==-1&&k.push(f.initFilterIndexes[j])}k.indexOf(c)<0&&k.push(c);if(h)for(h=0;h<f.rowConditions.length;h++)k.indexOf(f.rowConditions[h])<
0&&k.push(f.rowConditions[h]);k.sort(function(){return function(f,c){return f==c?0:f<c?-1:1}}(0));for(j=f.initRowConditions.length-(g.length-1);j<Math.min(f.initRowConditions.length,f.dataColumnIndex);j++)k.indexOf(f.initRowConditions[j])<0&&k.push(f.initRowConditions[j]);f.rowConditions=[];for(j=0;j<k.length;j++)f.rowConditions[j]=k[j]};this.changedFromColumnToRow=function(c){var g=f.rowConditions.indexOf(c),h="columns",k=0;if(g!=-1){f.rowConditions.splice(g,1);y.length>1?f.colConditions=[c].concat(f.colConditions):
f.colConditions.push(c);k=f.colConditions.indexOf(c)}else{if(f.serverPagination){h="rows";g=f.colConditions.indexOf(c);f.colConditions.splice(g,1);f.updateRowConditions(c,y,false)}else{h="rows";g=f.colConditions.indexOf(c);f.colConditions.splice(g,1);y.length>1?f.rowConditions=[c].concat(f.rowConditions):f.rowConditions.push(c)}k=f.rowConditions.indexOf(c)}f.onDragundDropEventHandle(c,h,k)};this.getDelFilterReference=function(c){return function(){var g=f.filterIndexes.indexOf(c);g!=-1&&f.filterIndexes.splice(g,
1);f.updateRowConditions(c,y,true);for(g=0;g<f.filterDiv.selects.length;g++)if(c==f.filterDiv.selects[g].filterIndex){f.filterDiv.selects.splice(g,1);break}f.stateChanged=true;f.serverPagination||(f.autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(-1));f.onDragundDropEventHandle(c,"rows",f.rowConditions.indexOf(c));f.DiseablePivot();setTimeout(function(){if(f.serverPagination){f.conditions[c].topFilterValue="[all]";f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[c].dataField,
{op:"all",values:"",dim:c},"","")}else f.go(false);f.EneablePivot()},200)}};this.valueIsShowed=function(c,g){if(f.serverPagination)return f.conditions[g].state=="all"?true:f.conditions[g].state=="none"?false:f.conditions[g].blackList.indexOf(c)!=-1?false:f.conditions[g].distinctValues.indexOf(c)!=-1?true:f.conditions[g].defaultAction=="Exclude"?false:true;for(var h=0;h<f.filteredData.length;h++)if(f.filteredData[h][g]===c)return true;return false};this.distinctDivs=function(c,g,h){var k=function(g,
k){var j=OAT.Dom.create("div"),l="check_item_img",m="uncheck_item_img";if(f.isSD){l="check_item_img_small";m="uncheck_item_img_small"}OAT.addImageNode(j,f.valueIsShowed(t,h)?"check_box":"check_box_outline_blank","");var n=c.blackList.indexOf(t)==-1&&f.valueIsShowed(t,h)?l:m;f.serverPagination&&(n=f.valueIsShowed(t,h)?l:m);j.setAttribute("class",n);l=OAT.Dom.create("input");l.type="checkbox";l.id=k;m=OAT.Dom.create("label");OAT.addTextNode(m,g);m.htmlFor=k;j.appendChild(m);return[j,l]},j=function(g,
k){setTimeout(function(){if(f.serverPagination){var j="pop";g||(j="push");f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[h].dataField,{op:j,values:k,dim:h},"","");f.stateChanged=true;f.onFilteredChangedEventHandleWhenServerPagination(h)}else{j=false;if(g){if(f.autoPaging){l=f.conditions[h].blackList.indexOf(k);l!=-1&&f.conditions[h].blackList.splice(l,1);for(l=f.conditions[h].blackList.indexOf(k);l!=-1;){f.conditions[h].blackList.splice(l,1);l=f.conditions[h].blackList.indexOf(k)}f.conditions[h].whiteList.indexOf(k);
if(l==-1){for(l=0;l<f.allData.length;l++)if(f.allData[l][h]===k)for(m=0;m<f.allData[l].length;m++)if(m!=h){n=f.rowConditions.indexOf(m);if(n!=-1)for(P=f.allData[l][m];f.conditions[n].blackList.indexOf(P)!=-1;)f.conditions[n].blackList.splice(f.conditions[n].blackList.indexOf(P),1)}f.conditions[h].whiteList.push(k)}}else{var l=c.blackList.indexOf(k);l!=-1&&c.blackList.splice(l,1);if(f.autoPaging)for(l=c.blackList.indexOf(k);l!=-1;){c.blackList.splice(l,1);l=c.blackList.indexOf(k)}c.whiteList.indexOf(k);
if(l==-1){for(l=0;l<f.allData.length;l++)if(f.allData[l][h]===k)for(var m=0;m<f.allData[l].length;m++)if(m!=h){var n=f.rowConditions.indexOf(m);if(n!=-1)for(var P=f.allData[l][m];f.conditions[n].blackList.indexOf(P)!=-1;)f.conditions[n].blackList.splice(f.conditions[n].blackList.indexOf(P),1)}c.whiteList.push(k)}}for(;f.GreyList.indexOf(k)!=-1;){index2=f.GreyList.indexOf(k);f.GreyList.splice(index2,1)}f.autoPaging&&(j=true)}else f.autoPaging?f.conditions[h].blackList.push(k):c.blackList.push(k);f.onFilteredChangedEventHandle(h);
f.stateChanged=true;if(f.autoPaging){if(jQuery("#"+f.containerName+" #tablePagination_currPage")[0]!=void 0){jQuery("#"+f.containerName+" #tablePagination_currPage")[0].value=1;f.actualPaginationPage=1}j?f.preGo(false,null,k,-1):f.preGo(false,null,k,h)}else f.go(false)}f.EneablePivot()},200)},l=function(){f.getValuesForColumn(f.UcId,h,this.value)};OAT.Dom.clear(g);var m=OAT.Dom.create("div");m.setAttribute("class","div_buttons_popup");var n=document.createElement("button");n.textContent=gx.getMessage("GXPL_QViewerJSAll");
n.setAttribute("class","btn");jQuery(n).click(function(){f.DiseablePivot();setTimeout(function(){if(f.serverPagination){f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[h].dataField,{op:"all",values:"",dim:h},"","");f.stateChanged=true;f.onFilteredChangedEventHandleWhenServerPagination(h)}else{f.autoPaging?f.conditions[h].blackList=[]:c.blackList=[];f.stateChanged=true;f.onFilteredChangedEventHandle(h);if(f.autoPaging){if(jQuery("#"+f.containerName+" #tablePagination_currPage")[0]!=void 0){jQuery("#"+
f.containerName+" #tablePagination_currPage")[0].value=1;f.actualPaginationPage=1}f.preGo(false,null,null,-1)}else f.go(false)}f.distinctDivs(c,g,h);f.EneablePivot()},200)});var o=document.createElement("button");o.textContent=gx.getMessage("GXPL_QViewerJSNone");o.setAttribute("class","btn");jQuery(o).click(function(){f.DiseablePivot();setTimeout(function(){if(f.serverPagination){f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[h].dataField,{op:"none",values:"",dim:h},"","");f.stateChanged=
true;f.onFilteredChangedEventHandleWhenServerPagination(h)}else{c.blackList=[];if(f.autoPaging)for(k=0;k<f.GeneralDistinctValues[h].length;k++)f.conditions[h].blackList.push(f.GeneralDistinctValues[h][k]);else for(var k=0;k<c.distinctValues.length;k++)c.blackList.push(c.distinctValues[k]);f.stateChanged=true;f.onFilteredChangedEventHandle(h);f.go(false)}f.distinctDivs(c,g,h);f.EneablePivot()},200)});var q=document.createElement("button");q.textContent=gx.getMessage("GXPL_QViewerJSReverse");q.setAttribute("class",
"btn");jQuery(q).click(function(){f.DiseablePivot();setTimeout(function(){if(f.serverPagination){f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[h].dataField,{op:"reverse",values:"",dim:h},"","");f.stateChanged=true;f.onFilteredChangedEventHandleWhenServerPagination(h)}else{var k=[];if(f.autoPaging)for(j=0;j<f.GeneralDistinctValues[h].length;j++){l=f.GeneralDistinctValues[h][j];f.conditions[h].blackList.indexOf(l)==-1&&k.push(l)}else for(var j=0;j<c.distinctValues.length;j++){var l=c.distinctValues[j];
c.blackList.indexOf(l)==-1&&k.push(l)}f.autoPaging?f.conditions[h].blackList=k:c.blackList=k;f.stateChanged=true;f.onFilteredChangedEventHandle(h);f.autoPaging?f.preGo(false,null,null,-1):f.go(false)}f.distinctDivs(c,g,h);f.EneablePivot()},200)});OAT.Dom.append([m,n,o,q],[g,m]);if(f.serverPagination){m=OAT.Dom.create("div");m.setAttribute("class","div_filter_input");if(f.serverPagination){n=document.createElement("input");n.textContent="none";n.setAttribute("class","search_input");n.setAttribute("type",
"text");n.setAttribute("label",gx.getMessage("GXPL_QViewerSearch"));n.setAttribute("title",gx.getMessage("GXPL_QViewerSearch"));n.setAttribute("placeholder",gx.getMessage("GXPL_QViewerSearch"));n.setAttribute("id",f.UcId+h);jQuery(n).keyup(l);OAT.Dom.append([m,n],[g,m])}}if(f.autoPaging){l=OAT.Dom.create("div");f.GeneralDistinctValues[h].length<=9?l.setAttribute("class","pivot_popup_auto"):l.setAttribute("class","pivot_popup_fix");for(m=0;m<f.GeneralDistinctValues[h].length;m++){t=f.GeneralDistinctValues[h][m];
n=f.dimensionPictureValue(t,h);try{t=="#NuN#"&&!f.formulaInfo.measureFormula[h].hasFormula&&(n="&nbsp;")}catch(r){}n=n.replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ");if(n.length>33){o=n.substring(32,n.length).trimpivot().length>0?"...":"";n=n.substring(0,32)+o}n=n.replace(/ /g,"&nbsp;")+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";q=k(n,"pivot_distinct_"+m);q[0].setAttribute("value",t);l.appendChild(q[0]);o=(n=f.conditions[h].blackList.indexOf(t)==-1&&f.valueIsShowed(t,h)||f.conditions[h].distinctValues.indexOf(t)==
-1&&f.conditions[h].blackList.indexOf(t)==-1)?"check_item_img":"uncheck_item_img";f.isSD&&(o=n?"check_item_img_small":"uncheck_item_img_small");q[0].setAttribute("class",o);OAT.Dom.attach(q[0],"click",function(){f.DiseablePivot();var c="check_item_img",g="uncheck_item_img";if(f.isSD){c="check_item_img_small";g="uncheck_item_img_small"}var h=this.getAttribute("class")!==c;this.setAttribute("class",this.getAttribute("class")===c?g:c);j(h,this.getAttribute("value"))})}}else{l=OAT.Dom.create("div");f.serverPagination&&
(c=f.conditions[h]);c.distinctValues.length<=9?l.setAttribute("class","pivot_popup_auto"):l.setAttribute("class","pivot_popup_fix");for(m=0;m<c.distinctValues.length;m++){var t=c.distinctValues[m];if(!f.serverPagination||!(f.conditions[h].hasNull&&t.trimpivot()==f.defaultPicture.getAttribute("textForNullValues"))){n=f.dimensionPictureValue(t,h);n=n.replace(/\&amp;/g,"&").replace(/\u00A0/g," ");if(n.length>33){o=n.substring(32,n.length).trimpivot().length>0?"...":"";n=n.substring(0,32)+o}n=n.replace(/ /g,
" ")+"     ";q=k(n,"pivot_distinct_"+m);q[0].setAttribute("value",t);l.appendChild(q[0]);OAT.Dom.attach(q[0],"click",function(){f.DiseablePivot();var c="check_item_img",g="uncheck_item_img";if(f.isSD){c="check_item_img_small";g="uncheck_item_img_small"}var h=this.getAttribute("class")!==c;this.setAttribute("class",this.getAttribute("class")===c?g:c);jQuery(this).find("i")[0].textContent=h?"check_box":"check_box_outline_blank";j(h,this.getAttribute("value"))})}}l.setAttribute("ucid",f.UcId);l.setAttribute("columnnumber",
h);l.setAttribute("id","values_"+f.UcId+"_"+h)}g.appendChild(l)};this.DiseablePivot=function(){try{var c=jQuery('<div class="disable_popup" ></div>');if(jQuery("#"+f.containerName).length>0){var g=Math.min(jQuery("#"+D+"_"+f.query+"_pivot_page")[0].clientHeight+jQuery("#"+D+"_"+f.query+"_pivot_content")[0].clientHeight,jQuery("#"+f.containerName)[0].clientHeight),h=Math.min(jQuery("#"+D+"_"+f.query)[0].clientWidth,jQuery("#"+f.containerName)[0].clientWidth);if(jQuery("#"+f.containerName).closest(".gxwebcomponent").length>
0){jQuery("#"+D+"_"+f.query+"_tablePagination").length>0&&(g=g+jQuery("#"+D+"_"+f.query+"_tablePagination")[0].clientHeight);jQuery(c).css({width:h,height:g,position:"absolute",top:jQuery("#"+f.containerName)[0].offsetTop,left:jQuery("#"+f.containerName)[0].offsetLeft,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":99})}else jQuery(c).css({width:h,height:g,position:"absolute",top:jQuery("#"+f.containerName)[0].offsetTop,left:jQuery("#"+D+"_"+f.query).offset().left,"background-color":"rgba(0,0,0,0.1)",
cursor:"wait","z-index":999});jQuery("#"+f.containerName).append(c)}else{g=Math.min(jQuery("#"+D+"_"+f.query).closest(".gx_usercontrol").find(".pivot_filter_div")[0].clientHeight+jQuery("#"+D+"_"+f.query).closest(".conteiner_table_div")[0].clientHeight,jQuery("#"+D+"_"+f.query).closest(".gx_usercontrol")[0].clientHeight);h=Math.min(jQuery("#"+D+"_"+f.query)[0].clientWidth,jQuery("#"+D+"_"+f.query).closest(".gx_usercontrol")[0].clientWidth);jQuery("#"+D+"_"+f.query).closest(".gx_usercontrol").find(".pivot_pag_div").length>
0&&(g=g+jQuery("#"+D+"_"+f.query).closest(".gx_usercontrol").find(".pivot_pag_div")[0].clientHeight);jQuery(c).css({width:h,height:g,position:"absolute",top:jQuery("#"+D+"_"+f.query).closest(".gx_usercontrol")[0].offsetTop,left:jQuery("#"+D+"_"+f.query).closest(".gx_usercontrol")[0].offsetLeft,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":99});jQuery("#"+D+"_"+f.query).closest(".gx_usercontrol").append(c)}jQuery(".oat_winrect_container").block({message:null})}catch(k){}};this.EneablePivot=
function(){for(jQuery(".disable_popup").remove();jQuery(".disable_popup").length>0;)jQuery(".disable_popup").remove();jQuery(".oat_winrect_container").unblock()};this.addExpandCollapseFunctionality=function(c,g,h,k,j){var l=OAT.Dom.create("div",{});if(k){l.className=l.className+" expanded";OAT.addImageNode(l,"indeterminate_check_box","")}else{l.className=l.className+" collapsed";OAT.addImageNode(l,"add_box","")}c.insertBefore(l,c.firstChild);c.style.paddingLeft="0px";k=jQuery(c).find("#span_txt_pivot")[0];
if(j){f.setExpandCollapseEventHandlers(l,g.value,"DIMENSION",f.rowConditions[h],g);if(f.QueryViewerCollection[f.IdForQueryViewerCollection].ItemDoubleClick==void 0&&f.QueryViewerCollection[f.IdForQueryViewerCollection].ItemClick==void 0&&!f.selection.Allow){f.setExpandCollapseEventHandlers(k,g.value,"DIMENSION",f.rowConditions[h],g);jQuery(k).css({cursor:"pointer"})}}else{f.setExpandCollapseEventHandlers(l,g.value,"DIMENSION",f.colConditions[h],g);if(f.QueryViewerCollection[f.IdForQueryViewerCollection].ItemDoubleClick==
void 0&&f.QueryViewerCollection[f.IdForQueryViewerCollection].ItemClick==void 0&&!f.selection.Allow){f.setExpandCollapseEventHandlers(k,g.value,"DIMENSION",f.colConditions[h],g);jQuery(k).css({cursor:"pointer"})}}return c};this.setClickEventHandlers=function(c,g,h,k,j){if(!f.ShowMeasuresAsRows||f.h<500){var l=jQuery(c).find("#span_txt_pivot")[0];if(l){jQuery(l).data("itemValue",g);jQuery(l).data("typeMorD",h);jQuery(l).data("numberMorD",k);jQuery(l).data("itemInfo",j);jQuery(c).data("itemValue",g);
jQuery(c).data("typeMorD",h);jQuery(c).data("numberMorD",k);jQuery(c).data("itemInfo",j);c=f.QueryViewerCollection[F];h=h=="DIMENSION"?c.Metadata.Axes[k].RaiseItemClick:c.Metadata.Data[k].RaiseItemClick;if(c.ItemClick&&h){l.onclick=function(){f.onClickEventHandle(this);if(f.selection.Allow)f.onClickSelectNode(this)};l.classList.add("gx-qv-clickable-element")}else if(f.selection.Allow)l.onclick=function(){f.onClickSelectNode(this)}}}};this.setExpandCollapseEventHandlers=function(c,g,h,k,j){if(!f.ShowMeasuresAsRows||
f.h<500){jQuery(c).data("itemValue",g);jQuery(c).data("numberMorD",k);jQuery(c).data("itemInfoEC",j);c.onclick=function(){f.onClickExpandCollapse(this)}}};this.getPerFilterValue=function(c,g){for(var h=false,k=0;k<c.length;k++)c[k]!=null&&(h=true);if(!h)return false;h=[];for(k=0;k<f.GeneralDataRows.length;k++){for(var j=true,l=0;l<c.length;l++)c[l]!=null&&f.GeneralDataRows[k][f.filterIndexes[l]]!=c[l]&&(j=false);j&&h.push(f.GeneralDataRows[k][f.filterIndexes[g]])}return h};this.drawTitleDiv=function(){if(f.PivotTitle){OAT.Dom.clear(f.TitleDiv);
var c=navigator.userAgent.toLowerCase().indexOf("android")>-1;gx.util.browser.isIE()||c?f.TitleDiv.className=f.TitleDiv.className+" pivot_title_div":f.TitleDiv.classList.add("pivot_title_div");OAT.addTextNode(f.TitleDiv,f.PivotTitle)}};this.drawFilters=function(){var c=[],g=f.filterDiv,h=navigator.userAgent.toLowerCase(),h=h.indexOf("android")>-1;gx.util.browser.isIE()||h?f.filterDiv.className=f.filterDiv.className+" pivot_filter_div":f.filterDiv.classList.add("pivot_filter_div");f.filterIndexes.length==
0&&OAT.addTextNode(f.filterDiv,"drop filters here");for(var k=0;k<g.selects.length;k++)c.push([g.selects[k].filterIndex,g.selects[k].selectedIndex,g.selects[k].value]);OAT.Dom.clear(g);f.gd.addTarget(g);g.selects=[];if(!f.filterIndexes.length){k=gx.getMessage("GXPL_QViewerJSDropFiltersHere");f.isSD&&(k="");h=navigator.userAgent.toLowerCase();(h=h.indexOf("android")>-1)&&(k="");if(k[k.length-1]==='"'||k[k.length-1]==="'"||k[k.length-1]==="]"||k[k.length-1]==="}"||k[k.length-1]==="`")k=k.substring(0,
k.length-1);h=document.createElement("span");h.textContent=k;g.appendChild(h)}for(var h=function(){for(var c=this,g=f.conditions[this.filterIndex].distinctValues,h=0;h<g.length;h++){var k=g[h];if(f.conditions[this.filterIndex].filteredShowValues.indexOf(k)==-1){f.conditions[this.filterIndex].filteredShowValues.push(k);if(k!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(k,this.filterIndex),k,c)}catch(j){OAT.Dom.option(k,k,c)}else OAT.Dom.option(" ",k,c)}}var l=f.lastRequestValue=this.filterIndex;
f.conditions[l].previousPage<f.conditions[l].totalPages&&f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(g){g=JSON.parse(g);f.conditions[l].previousPage=g.PageNumber;f.conditions[l].totalPages=g.PagesCount;f.conditions[l].blocked=true;if(g.Null&&!f.conditions[l].hasNull){f.conditions[l].hasNull=true;f.conditions[l].distinctValues.indexOf("#NuN#")==-1&&f.conditions[l].distinctValues.push("#NuN#");f.conditions[l].defaultAction=="Include"?f.conditions[l].visibles.indexOf("#NuN#")==
-1&&f.conditions[l].visibles.push("#NuN#"):f.conditions[l].blackList.indexOf("#NuN#")==-1&&f.conditions[l].blackList.push("#NuN#")}for(var h=0;h<g.NotNullValues.length;h++){var k=g.NotNullValues[h];if(f.conditions[l].distinctValues.indexOf(k)==-1){f.conditions[l].distinctValues.push(k);f.conditions[l].defaultAction=="Include"&&f.conditions[l].visibles.indexOf(k)==-1&&f.conditions[l].visibles.push(k);f.conditions[l].state=="Exclude"&&f.conditions[l].blackList.indexOf(k)==-1&&f.conditions[l].blackList.push(k)}}g=
f.conditions[l].distinctValues;for(h=0;h<g.length;h++){k=g[h];if(f.conditions[l].filteredShowValues.indexOf(k)==-1){f.conditions[l].filteredShowValues.push(k);if(k!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(k,l),k,c)}catch(j){OAT.Dom.option(k,k,c)}else OAT.Dom.option(" ",k,c)}}}.closure(this),[f.columns[this.filterIndex].getAttribute("dataField"),1,0,""])},j=function(){f.stateChanged=true;if(f.serverPagination){f.DiseablePivot();f.conditions[this.filterIndex].topFilterValue=this.value;f.getDataForPivot(f.UcId,
1,f.rowsPerPage,true,f.conditions[this.filterIndex].dataField,{op:"pagefilter",values:this.value,dim:this.filterIndex},"","");f.EneablePivot()}else{this.value=="[all]"?f.autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(this.filterIndex):f.preGoWhenFilterByTopFilter(false);f.actualPaginationPage=1;f.DiseablePivot();setTimeout(function(){f.go(false);f.EneablePivot()},200)}},l=[],m=[],k=0;k<f.filterIndexes.length;k++)if(m.indexOf(f.filterIndexes[k])<0){m.push(f.filterIndexes[k]);
var n=f.filterIndexes[k],o=OAT.Dom.create("select");o.setAttribute("id","page_select_"+k);OAT.Dom.option(gx.getMessage("GXPL_QViewerJSAllOption"),"[all]",o);var q;q=f.serverPagination?[]:f.getPerFilterValue(l,k);if(f.GeneralDistinctValues.length>0){for(var r=0;r<f.GeneralDistinctValues[n].length;r++){var t=f.GeneralDistinctValues[n][r];if(q){if(q.indexOf(t)!=-1)if(t!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(t,n),t,o)}catch(y){OAT.Dom.option(t,t,o)}else OAT.Dom.option(" ",t,o)}else if(t!=
"#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(t,n),t,o)}catch(u){OAT.Dom.option(t,t,o)}else OAT.Dom.option(" ",t,o)}try{for(var v=0,r=0;r<f.GeneralDistinctValues[n].length;r++){t=f.GeneralDistinctValues[n][r];if(f.conditions[n].topFilterValue===t)o.selectedIndex=v+1;q?q.indexOf(t)!=-1&&v++:v++}}catch(w){}}if(f.serverPagination){f.conditions[n].filteredShowValues=[];q=f.conditions[n].distinctValues;for(r=0;r<q.length;r++){t=q[r];if(f.conditions[n].filteredShowValues.indexOf(t)==-1){f.conditions[n].filteredShowValues.push(t);
if(t!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(t,n),t,o)}catch(x){OAT.Dom.option(t,t,o)}else OAT.Dom.option(" ",t,o)}}if(f.conditions[n].topFilterValue!="[all]"){t=f.conditions[n].topFilterValue;r=-1;for(q=0;q<f.conditions[n].filteredShowValues.length;q++)(""+f.conditions[n].filteredShowValues[q]).trim()==(""+t).trim()&&(r=q);if(r>-1)o.selectedIndex=r+1;else{f.conditions[n].filteredShowValues.push(t);if(t!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(t,n),t,o)}catch(z){OAT.Dom.option(t,
t,o)}else OAT.Dom.option(" ",t,o);o.selectedIndex=1}}}o.filterIndex=n;for(r=0;r<c.length;r++)if(c[r][0]==n)for(q=0;q<o.length;q++)if(o[q].value==c[r][2])o.selectedIndex=q;l[k]=o.selectedIndex>0?o.value:null;f.serverPagination&&OAT.Dom.attach(o,"click",h);OAT.Dom.attach(o,"change",j);g.selects.push(o);r=OAT.Dom.create("div");r.setAttribute("class","inner_filter_div");OAT.addTextNode(r,f.headerRow[n]+": ");q=document.createElement("div");q.setAttribute("class","close_span_filter");OAT.addImageNode(q,
"close","");q.style.cursor="pointer";n=f.getDelFilterReference(n);OAT.Dom.attach(q,"click",n);f.serverPagination?OAT.Dom.append([f.filterDiv,r],[r,o,q]):f.GeneralDataRows.length==0?OAT.Dom.append([f.filterDiv,r],[r,o]):OAT.Dom.append([f.filterDiv,r],[r,o,q])}c=OAT.Dom.create("div");c.href="#";f.isSD?c.setAttribute("class","exportOptionsAnchor exportOptionsAnchor_small"):c.setAttribute("class","exportOptionsAnchor");OAT.addImageNode(c,"menu","");f.exportPage=OAT.Dom.create("div",{});OAT.Dom.attach(document,
"mousedown",function(c){source=OAT.Event.source(c);for(var g=c=false,h=0;h<jQuery(".oat_winrect_container").length;h++){var k=jQuery(".oat_winrect_container")[h];if(source!=k&&!OAT.Dom.isChild(source,k))c=true;else{c=false;break}}for(h=0;h<jQuery(".oat_winrect_container").length;h++)jQuery(".oat_winrect_container")[h].style.display!="none"&&(g=true);f.serverPagination&&((source.getAttribute("class")=="oat_winrect_close_b"||!OAT.Dom.isChild(source,k))&&g)&&f.resetAllScrollValue(f.UcId);c&&jQuery(".oat_winrect_container").css({display:"none"})});
OAT.Anchor.assign(c,{title:" ",content:f.exportPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(f.QueryViewerCollection[f.IdForQueryViewerCollection])+" ExportPopup "});OAT.Event.attach(c,"click",function(c){var g=OAT.Event.position(c);f.exportPage.style.left=g[0]+"px";f.exportPage.style.top=g[1]+"px";f.exportPage.id="exportOptionsContainer";Math.max(jQuery(".ExportPopup")[0].clientWidth,300);jQuery(c.currentTarget).offset();
var h=c.currentTarget;jQuery(".oat_winrect_title").find(".winrect_title_label").remove();c=OAT.Dom.create("label");if(f.isSD){jQuery(".oat_winrect_container").addClass("oat_winrect_container_small");c.setAttribute("class","winrect_title_label winrect_title_label_small")}else c.setAttribute("class","winrect_title_label");OAT.addTextNode(c,gx.getMessage("GXPL_QViewerPopupTitle"));jQuery(".oat_winrect_title").append(c);jQuery(".ExportPopup").css({left:"-2500px",top:"0px"});OAT.Dom.clear(f.exportPage);
c=document.createElement("div");c.setAttribute("class","upper_container");jQuery("#divtoxml").remove();jQuery("#divtoxls").remove();jQuery("#divtoxlsx").remove();jQuery("#divtoexport").remove();jQuery("#divtohtml").remove();f.appendExportToXmlOption(c,false);f.appendExportToHtmlOption(c,false);f.appendExportToPdfOption(c,false);f.appendExportToExcelOption(c,false);f.appendExportToExcel2010Option(c,false);f.exportPage.appendChild(c);if(f.QueryViewerCollection[F].ExportToXML||f.QueryViewerCollection[F].ExportToHTML||
f.QueryViewerCollection[F].ExportToPDF||f.QueryViewerCollection[F].ExportToXLS||f.QueryViewerCollection[F].ExportToXLSX){c=OAT.Dom.create("hr",{});f.exportPage.appendChild(c)}c=document.createElement("div");c.setAttribute("class","down_container");f.exportPage.appendChild(c);g=document.createElement("span");g.textContent=gx.getMessage("GXPL_QViewerJSVisibleColumns");var k=document.createElement("div");k.setAttribute("class","div_label_win");k.appendChild(g);c.appendChild(k);for(var g=function(c,g){if(g&&
f.initMetadata.Dimensions[c].validPosition==""||!g&&f.initMetadata.Measures[c].validPosition=="hidden")return false;var h,k;if(g){h=f.initMetadata.Dimensions[c].dataField;k=f.initMetadata.Dimensions[c].displayName}else{h=f.initMetadata.Measures[c].dataField;k=f.initMetadata.Measures[c].displayName}var j=f.headerRow.indexOf(k)!=-1,l=OAT.Dom.create("div"),A=j?"check_item_img":"uncheck_item_img";f.isSD&&(A=j?"check_item_img_small":"uncheck_item_img_small");OAT.addImageNode(l,j?"check_box":"check_box_outline_blank",
"");l.setAttribute("class",A);l.setAttribute("dataField",k);l.setAttribute("isDimension",g);l.setAttribute("index",c);k=OAT.Dom.create("span");g?OAT.addTextNode(k," "+f.initMetadata.Dimensions[c].displayName):OAT.addTextNode(k," "+f.initMetadata.Measures[c].displayName);h=f.formulaInfo.itemPosition[h]==void 0||f.formulaInfo.cantFormulaMeasures==0;if(h=g?h&&f.initMetadata.Dimensions[c].validPosition!="hidden":h&&f.initMetadata.Measures[c].validPosition!="hidden"){l.appendChild(k);OAT.Event.attach(l,
"click",function(){var c=l.getAttribute("isDimension")=="true";l.getAttribute("dataField");var g=parseInt(l.getAttribute("index")),h="check_item_img",k="uncheck_item_img";if(f.isSD){h="check_item_img_small";k="uncheck_item_img_small"}this.setAttribute("class",this.getAttribute("class")===h?k:h);jQuery(this).find("i")[0].textContent=this.getAttribute("class")===h?"check_box":"check_box_outline_blank";if(c){f.initMetadata.Dimensions[g].Visible=!f.initMetadata.Dimensions[g].Visible;f.preGoWhenShowHideDimension(g)}else{f.initMetadata.Measures[g].Visible=
!f.initMetadata.Measures[g].Visible;f.preGoWhenShowHideMeasures(g)}})}return l},j=k=f.autoNumber?1:0;j<f.initMetadata.Dimensions.length;j++){var l=g(j,true);l&&c.appendChild(l)}for(j=k;j<f.initMetadata.Measures.length;j++)(l=g(j,false))&&c.appendChild(l);setTimeout(function(){var c=window.innerWidth,g=jQuery(".ExportPopup")[0].clientWidth;if(g==0){g=jQuery(".ExportPopup").length;g=jQuery(".ExportPopup")[g-1].clientWidth}if(f.isSD){g<240&&(g=240);c=(c-g)/2+jQuery(window).scrollLeft();jQuery(".ExportPopup").css({left:c+
"px",top:jQuery(h).offset().top+"px",width:g+"px"})}else{var k=jQuery(h).offset().left;k+g+15<c?jQuery(".ExportPopup").css({left:jQuery(h).offset().left+"px",top:jQuery(h).offset().top+"px"}):jQuery(".ExportPopup").css({left:k-g+16+"px",top:jQuery(h).offset().top+"px"})}},50)});f.filterDiv.appendChild(c)};this.appendExportToXmlOption=function(c,g){var h;if(f.QueryViewerCollection[F].ExportToXML){if(gx.util.browser.isIE()&&9>=gx.util.browser.ieVersion()){h=document.createElement("div");h.style.marginBottom=
"10px";exportXMLButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportXMLButtonSub.setAttribute("id","divtoxml");var k=f.query;if(k==""){k="Query";try{k=f.controlName.split("_")[0]}catch(j){}}setTimeout(function(){jQuery("#divtoxml").downloadify({filename:function(){return k+".xml"},data:function(){return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+f.ExportToXML()},onComplete:function(){},onCancel:function(){},onError:function(){},swf:f.swfPath,
downloadImage:f.downloadImagePath,width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportXMLButtonSub);var l=OAT.Dom.create("label");OAT.addTextNode(l,gx.getMessage("GXPL_QViewerContextMenuExportXml"));l.style.paddingLeft="9px";l.htmlFor="pivot_checkbox_restoreview";h.appendChild(l)}else{h=OAT.Dom.create("div");exportXMLButtonSub=f.createExportButton(h);l=OAT.Dom.create("label");OAT.addTextNode(l,gx.getMessage("GXPL_QViewerContextMenuExportXml"));l.htmlFor="pivot_checkbox_restoreview";
h.appendChild(l);l=document.createElement("span");h.appendChild(l);OAT.Dom.attach(exportXMLButtonSub,"click",function(){if(f.serverPagination)f.getDataForPivot(f.UcId,1,-1,true,"","","XML","","",true);else{str=f.ExportToXML();if(gx.util.browser.webkit&&!gx.util.browser.chrome||f.isSD)window.open("data:text/xml,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+str));else{var c=new Blob([str],{type:"text/xml"});if(f.query!="")saveAs(c,f.query+".xml");else{var g="Query";
try{g=f.controlName.substr(4).split("_")[0]}catch(h){}saveAs(c,g+".xml")}}}})}g&&(gx.util.browser.isIE()||c.appendChild(OAT.Dom.create("br")));c.appendChild(h);g=true}};this.ExportToXMLWhenServerPagination=function(){f.QueryViewerCollection[f.IdForQueryViewerCollection].calculatePivottableData(function(c){f.allDataWithoutSort=OATgetDataFromXMLOldFormat(c,f.pageData.dataFields);f.allData=f.allDataWithoutSort;for(var c=jQuery.extend(true,[],f.conditions),g=0;g<f.conditions.length;g++)if(f.conditions[g]){for(var h=
0;h<f.allData.length;h++){var k=f.allData[h][g];if(k==void 0){k=" ";f.allData[h][Y]=" "}f.conditions[g].distinctValues.indexOf(k)==-1&&f.conditions[g].distinctValues.push(k)}try{f.sort(f.conditions[g],g)}catch(j){}}f.applyFilters();f.createAggStructure();f.fillAggStructure();f.checkAggStructure();str=f.ExportToXML();f.allDataWithoutSort=[];f.allData=[];f.filteredData=[];f.conditions=c;if(gx.util.browser.webkit&&!gx.util.browser.chrome||f.isSD)window.open("data:text/xml,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+
str));else{c=new Blob([str],{type:"text/xml"});if(f.query!="")saveAs(c,f.query+".xml");else{g="Query";try{g=f.controlName.substr(4).split("_")[0]}catch(l){}saveAs(c,g+".xml")}}}.closure(this))};this.ExportToHTMLWhenServerPagination=function(){for(var c=gx.util.resourceUrl(f.relativePath+"QueryViewer/oatPivot/css/pivot.css"),c='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+c+
'" />',g=0;g<jQuery("link").length;g++)jQuery("link")[g].href.indexOf("QueryViewer.css")<0&&(c=c+'<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+jQuery("link")[g].href+'" />');c=c+'</HEAD><DIV style="margin-bottom: 5px;"><div class="gx_usercontrol qv-pivottable QueryViewer-pivottable"><table class="pivot_table" style="width: 100%;">'+OAT.removeIconFont(jQuery("#"+f.controlName+"_"+f.query)[0].innerHTML.replace(/display: none;/g,"").replace(/sort-asc/g,"").replace(/sort-desc/g,
""));c=c+"</table></div></DIV></BODY></HTML>";if(gx.util.browser.webkit&&!gx.util.browser.chrome||f.isSD)window.open("data:text/html,"+c);else{c=new Blob([c],{type:"text/html"});if(f.query!="")saveAs(c,f.query+".html");else{g="Query";try{g=f.controlName.substr(4).split("_")[0]}catch(h){}saveAs(c,g+".html")}}};this.appendExportToHtmlOption=function(c,g){var h;if(f.QueryViewerCollection[F].ExportToHTML){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");exportButtonSub=
f.createExportButton(h);var k=OAT.Dom.create("label");OAT.addTextNode(k,gx.getMessage("GXPL_QViewerContextMenuExportHtml"));k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k);OAT.Dom.attach(exportButtonSub,"click",function(){if(f.serverPagination)f.getDataForPivot(f.UcId,1,-1,true,"","","HTML","","",true);else{var c=gx.util.resourceUrl(f.relativePath+"QueryViewer/oatPivot/css/pivot.css"),c='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+
c+'" /></HEAD><DIV style="margin-bottom: 5px;">'+jQuery("#"+f.controlName+"_"+f.query)[0].outerHTML.replace(/display: none;/g,"").replace(/sort-asc/g,"").replace(/sort-desc/g,""),c=c+"</DIV></BODY></HTML>";if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.open("data:text/html,"+c);else{c=new Blob([c],{type:"text/html"});if(f.query!="")saveAs(c,f.query+".html");else{var g="Query";try{g=f.controlName.substr(4).split("_")[0]}catch(h){}saveAs(c,g+".html")}}}})}else{h=document.createElement("div");
h.style.marginBottom="10px";exportHTMLButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportHTMLButtonSub.setAttribute("id","divtohtml");var j=f.query;if(j==""){j="Query";try{j=f.controlName.split("_")[0]}catch(l){}}setTimeout(function(){jQuery("#divtohtml").downloadify({filename:function(){return j+".html"},data:function(){var c=gx.util.resourceUrl(f.relativePath+"QueryViewer/oatPivot/css/pivot.css"),c='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+
c+'" /></HEAD><DIV style="margin-bottom: 5px;">'+jQuery("#"+f.controlName+"_"+f.query)[0].outerHTML.replace(/display: none;/g,"").replace(/sort-asc/g,"").replace(/sort-desc/g,"");return c+"</DIV></BODY></HTML>"},onComplete:function(){},onCancel:function(){},onError:function(){},swf:f.swfPath,downloadImage:f.downloadImagePath,width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportHTMLButtonSub);k=OAT.Dom.create("label");OAT.addTextNode(k,gx.getMessage("GXPL_QViewerContextMenuExportHtml"));
k.style.paddingLeft="9px";k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k)}g&&(gx.util.browser.isIE()||c.appendChild(OAT.Dom.create("br")));c.appendChild(h);g=true}};this.appendExportToPdfOption=function(c){var g;if(f.QueryViewerCollection[F].ExportToPDF){if(gx.util.browser.isIE()&&9>=gx.util.browser.ieVersion()){g=document.createElement("div");g.style.marginBottom="10px";exportPdfButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportPdfButtonSub.setAttribute("id",
"divtoexport");var h=f.query;if(h==""){h="Query";try{h=f.controlName.split("_")[0]}catch(k){}}setTimeout(function(){jQuery("#divtoexport").downloadify({filename:function(){return h+".pdf"},data:function(){return btoa(OAT.GeneratePDFOutput(f))},onComplete:function(){},onCancel:function(){},onError:function(){},dataType:"base64",swf:f.swfPath,downloadImage:f.downloadImagePath,width:21,height:21,transparent:true,append:false})},100);g.appendChild(exportPdfButtonSub);var j=OAT.Dom.create("label");OAT.addTextNode(j,
gx.getMessage("GXPL_QViewerContextMenuExportPdf"));j.style.paddingLeft="9px";j.htmlFor="pivot_checkbox_restoreview";g.appendChild(j)}else{g=OAT.Dom.create("div");exportButtonSub=f.createExportButton(g);j=OAT.Dom.create("label");OAT.addTextNode(j,gx.getMessage("GXPL_QViewerContextMenuExportPdf"));j.htmlFor="pivot_checkbox_restoreview";g.appendChild(j);h=f.query;if(h==""){h="Query";try{h=f.controlName.split("_")[0]}catch(l){}}OAT.Dom.attach(exportButtonSub,"click",function(){f.serverPagination?f.getDataForPivot(f.UcId,
1,-1,true,"","","PDF","","",true):OAT.GeneratePDFOutput(f,h)})}c.appendChild(g)}};this.appendExportToExcelOption=function(c,g){var h;if(f.QueryViewerCollection[F].ExportToXLS){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");exportButtonSub=f.createExportButton(h);var k=OAT.Dom.create("label");OAT.addTextNode(k,gx.getMessage("GXPL_QViewerContextMenuExportXls2003"));gx.getMessage("GXPL_QViewerContextMenuExportPdf");k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k);
var j=f.query;if(j==""){j="Query";try{j=f.controlName.split("_")[0]}catch(l){}}OAT.Dom.attach(exportButtonSub,"click",function(){f.serverPagination?f.getDataForPivot(f.UcId,1,-1,true,"","","XLS","","",true):f.ExportToExcel(j)})}else{h=document.createElement("div");h.style.marginBottom="10px";exportXLSButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportXLSButtonSub.setAttribute("id","divtoxls");j=f.query;if(j==""){j="Query";try{j=f.controlName.split("_")[0]}catch(m){}}setTimeout(function(){jQuery("#divtoxls").downloadify({filename:function(){return j+
".xls"},data:function(){return f.ExportToExcel()},onComplete:function(){},onCancel:function(){},onError:function(){},swf:f.swfPath,downloadImage:f.downloadImagePath,width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportXLSButtonSub);k=OAT.Dom.create("label");OAT.addTextNode(k,gx.getMessage("GXPL_QViewerContextMenuExportXls2003"));k.style.paddingLeft="9px";k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k)}g&&(gx.util.browser.isIE()||c.appendChild(OAT.Dom.create("br")));
c.appendChild(h);g=true}};this.ExportToXLSXWhenServerPagination=function(){f.QueryViewerCollection[f.IdForQueryViewerCollection].calculatePivottableData(function(c){for(var g=[],h=0;h<f.initMetadata.Dimensions.length;h++)f.initMetadata.Dimensions[h].Visible&&g.push(f.initMetadata.Dimensions[h].dataField);for(h=0;h<f.pageData.AxisInfo.length;h++)if(f.pageData.AxisInfo[h].Axis!=void 0&&f.pageData.AxisInfo[h].Axis.Type=="Hidden"){var k=g.indexOf(f.pageData.AxisInfo[h].DataField);k>-1&&g.splice(k,1)}for(h=
0;h<f.initMetadata.Measures.length;h++)f.initMetadata.Measures[h].Visible&&g.indexOf(f.initMetadata.Measures[h].dataField)<0&&g.push(f.initMetadata.Measures[h].dataField);for(h=0;h<y.length;h++)if(y[h].getAttribute("aggregation")=="average"){f.formulaInfo.measureFormula[h].hasFormula=true;f.formulaInfo.measureFormula[h].textFormula=y[h].getAttribute("dataField")+"_N/"+y[h].getAttribute("dataField")+"_D";f.formulaInfo.cantFormulaMeasures++;for(var j=f.formulaInfo.measureFormula[h].textFormula,l=["*",
"-","+","/","(",")"],m=0;m<l.length;m++){var n=j.split(l[m]);if(n.length>1){for(var j="",o=0;o<n.length-1;o++)j=j+n[o]+" "+l[m]+" ";j=j+n[n.length-1]}}o=InfixToPostfix(j);U.measureFormula[h].polishNotationText=o;for(j=o.split(" ");j.indexOf("")!=-1;)j.splice(j.indexOf(""),1);m=[];for(n=0;n<j.length;n++)if(l.indexOf(j[n])==-1&&isNaN(parseInt(j[n]))){var q=U.itemPosition[j[n]];m.indexOf(q)==-1&&m.push(q)}f.formulaInfo.measureFormula[h].relatedMeasures=m;for(l=o.split(" ");l.indexOf("")!=-1;)l.splice(l.indexOf(""),
1);f.formulaInfo.measureFormula[h].PolishNotation=l}c=c.replace(/\&amp;/g,"&").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&apos;/g,"'").replace(/\&quot/g,'"');h=OATgetDataFromXMLOldFormat(c,g,f.OrderFildsHidden);f.GeneralDataRows=h[0];f.recordForFormula=h[1];f.allData=f.GeneralDataRows;c=jQuery.extend(true,[],f.conditions);f.GeneralDistinctValues=[];for(h=0;h<f.conditions.length;h++)if(f.conditions[h]){f.GeneralDistinctValues[h]=[];for(o=0;o<f.allData.length;o++){g=f.allData[o][h];if(g==
void 0){g=" ";f.allData[o][k]=" "}f.conditions[h].distinctValues.indexOf(g)==-1&&f.conditions[h].distinctValues.push(g);f.GeneralDistinctValues[h].indexOf(g)==-1&&f.GeneralDistinctValues[h].push(g)}try{f.sort(f.conditions[h],h)}catch(r){}}f.applyFilters();f.createAggStructure();f.fillAggStructure();f.checkAggStructure();k=f.query;if(k==""){k="Query";try{k=f.controlName.split("_")[0]}catch(t){}}OAT.GenerateExcelOutput(k,f,y);str=f.ExportToXML();f.GeneralDataRows=[];f.allData=[];f.filteredData=[];f.GeneralDistinctValues=
[];f.conditions=c;for(h=0;h<y.length;h++)if(y[h].getAttribute("aggregation")=="average"){f.formulaInfo.measureFormula[h]={hasFormula:false};f.formulaInfo.cantFormulaMeasures--}}.closure(this))};this.appendExportToExcel2010Option=function(c,g){var h;if(f.QueryViewerCollection[F].ExportToXLSX&&(f.allData.length>0||f.serverPagination)){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");exportButtonSub=f.createExportButton(h);var k=OAT.Dom.create("label");OAT.addTextNode(k,
gx.getMessage("GXPL_QViewerContextMenuExportXlsx"));k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k);var j=f.query;if(j==""){j="Query";try{j=f.controlName.split("_")[0]}catch(l){}}OAT.Dom.attach(h,"click",function(){f.serverPagination?f.getDataForPivot(f.UcId,1,-1,true,"","","XLSX","","",true):OAT.GenerateExcelOutput(j,f,y)})}else{h=document.createElement("div");h.style.marginBottom="10px";exportXLSButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportXLSButtonSub.setAttribute("id",
"divtoxlsx");j=f.query;if(j==""){j="Query";try{j=f.controlName.split("_")[0]}catch(m){}}setTimeout(function(){jQuery("#divtoxlsx").downloadify({filename:function(){return j+".xlsx"},data:function(){return OAT.GenerateExcelOutput("",f,y)},onComplete:function(){},onCancel:function(){},onError:function(){},dataType:"base64",swf:f.swfPath,downloadImage:f.downloadImagePath,width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportXLSButtonSub);k=OAT.Dom.create("label");OAT.addTextNode(k,
gx.getMessage("GXPL_QViewerContextMenuExportXlsx"));k.style.paddingLeft="9px";k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k)}g&&(gx.util.browser.isIE()||c.appendChild(OAT.Dom.create("br")));c.appendChild(h);g=true}};this.createExportButton=function(c){var g=OAT.Dom.create("div",{});g.setAttribute("id","divtoxml");c.appendChild(g);f.isSD?g.setAttribute("class","download_file_img_small"):g.setAttribute("class","download_file_img");OAT.addImageNode(g,"save_alt","");c.setAttribute("class","export_item_div");
f.isSD&&c.setAttribute("class","export_item_div export_item_div_small");return c};this.countTotals=function(){f.rowTotals=[[],[]];f.colTotals=[[],[]];f.gTotal=[];for(var c=0;c<f.w;c++){f.colTotals[0].push([]);f.colTotals[1].push([])}for(c=0;c<f.h;c++){f.rowTotals[0].push([]);f.rowTotals[1].push([])}for(var g=[],c=0;c<f.w;c++)for(var h=0;h<f.h;h++){var k=f.tabularData[c][h][0];if(k!=f.EmptyValue&&k!="#NuN#"){y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula?f.colTotals[0][c].push(f.tabularData[c][h][2][0]):
f.colTotals[0][c].push(k);f.colTotals[1][c].push(f.tabularData[c][h][1]);y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula?f.rowTotals[0][h].push(f.tabularData[c][h][2][0]):f.rowTotals[0][h].push(k);f.rowTotals[1][h].push(f.tabularData[c][h][1]);y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula?f.gTotal.push(f.tabularData[c][h][2][0]):f.gTotal.push(k)}else k=="#NuN#"&&(g[c]=true)}h=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func];for(c=0;c<f.rowTotals[0].length;c++)f.rowTotals[0][c]=
y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula?f.calculateFormulaTotal(f.rowTotals[0][c],y.length-1,"MesaureAsColumn"):h(f.rowTotals[0][c]);for(c=0;c<f.colTotals[0].length;c++)f.colTotals[0][c]=f.colTotals[0][c].length==0&&g[c]?"#NuN#":y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula?f.calculateFormulaTotal(f.colTotals[0][c],y.length-1,"MesaureAsColumn"):h(f.colTotals[0][c]);f.gTotal=y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula?f.calculateFormulaTotal(f.gTotal,
y.length-1,"MesaureAsColumn"):h(f.gTotal)};this.countSubTotals=function(){function c(f,g){for(var h=0;h<f.length-1;h++)for(var k=f[h],j=0;j<k.length;j++){k[j].totals=[];k[j].filtrows=[];for(var l=0;l<g;l++){k[j].totals.push([]);k[j].filtrows.push([])}}}function g(c,f,h,k,j){if(c.length)for(c=c[c.length-1][f].parent;c.parent;){c.totals[h].push(k);c.filtrows[h].push(j);c=c.parent}}function h(c,g){for(var k=0;k<c.length-1;k++)for(var j=c[k],l=0;l<j.length;l++)for(var A=j[l].totals,m=j[l].filtrows,n=
0;n<A.length;n++)if(y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula){var K=f.calculateFormulaTotal(A[n],y.length-1,"MesaureAsColumn");A[n]={array:A[n],value:K,rows:m[n]}}else A[n]={array:A[n],value:g(A[n]),rows:m[n]}}c(f.colPointers,f.h);c(f.rowPointers,f.w);for(var k=0;k<f.w;k++)for(var j=0;j<f.h;j++){var l=f.tabularData[k][j][0],m=f.tabularData[k][j][1];if(l!=f.EmptyValue)if(y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula){g(f.colPointers,k,j,f.tabularData[k][j][2][0],
m);g(f.rowPointers,j,k,f.tabularData[k][j][2][0],m)}else{g(f.colPointers,k,j,l,m);g(f.rowPointers,j,k,l,m)}}k=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func];h(f.colPointers,k);h(f.rowPointers,k)};this.countPointers=function(){function c(f){for(var g=[],h=0;h<f.length;h++)g.push(f[h]);return g}function g(h,k,j){if(f.ShowMeasuresAsRows){f[j]=[];l=[h];h=k.length-(y.length-1)+1;if(j=="colPointers")h=k.length;for(m=0;m<h;m++){n=[];for(o=0;o<l.length;o++){q=l[o];for(r=0;r<q.items.length;r++)n.push(q.items[r])}l=
n;f[j].push(c(l))}}else{f[j]=[];for(var l=[h],m=0;m<k.length;m++){for(var n=[],o=0;o<l.length;o++)for(var q=l[o],r=0;r<q.items.length;r++)n.push(q.items[r]);l=n;f[j].push(c(l))}}}g(f.rowStructure,f.rowConditions,"rowPointers");g(f.colStructure,f.colConditions,"colPointers")};this.countOffsets=function(){function c(f){for(var g=0;g<f.length;g++)for(var h=f[g],k=0,j=0;j<h.length;j++){var l=h[j];l.offset=k;k=k+l.spanData}}c(f.rowPointers);c(f.colPointers)};this.count=function(){function c(g,h,k,j,l){var m=
0,n=0,o=0;if(!g.items){g.span=1;g.spanData=1;g.spanDraw=1;return[g.span,g.spanData,g.spanDraw]}for(var K=0;K<g.items.length;K++){var q=c(g.items[K],h,k,j+1,l),m=m+q[0],n=n+q[1];if(!k||j<l)o=o+q[2]}g.span=m;g.spanData=n;g.spanDraw=o;if(g.items.length&&g.items[0].items&&!f.ShowMeasuresAsRows&&f.conditions[h[g.items[0].depth]].subtotals&&(!f.autoPaging||f.colConditions.length==0)){m=g.items;h=0;if(g.items.length>0)for(;m!=false;){h++;m=m[0].items}for(m=0;m<g.items.length;m++){n=y.length;if(g.items[m].items!=
null&&h-n>0){g.span=g.span+1;g.spanDraw=g.spanDraw+1}}}if(k&&!(j<l))g.spanDraw=1;if(g.collapsed!=void 0&&g.collapsed){g.span=1;g.spanDraw=1}return[g.span,g.spanData,g.spanDraw]}function g(c,h,k,j){var l=0,A=0;if(!c.items){c.span=1;c.spanData=1;return[c.span,c.spanData]}for(var m=0,n=0;n<c.items.length;n++){var o=g(c.items[n],h,k+1,j),l=l+o[0],A=A+o[1];o[0]==0&&(m=m+1)}c.span=l;c.spanData=A;if(k!=-1&&k<j&&f.conditions[h[k+1]].subtotals)c.span=c.span+y.length*(c.items.length-m);if(c.collapsed!=void 0&&
c.collapsed)c.span=1;return[c.span,c.spanData]}if(f.ShowMeasuresAsRows){h=f.rowConditions.length-(y.length-1)-2;g(f.rowStructure,f.rowConditions,-1,h);g(f.colStructure,f.colConditions,0,0)}else{var h=f.rowConditions.length-(y.length-1)-1;c(f.rowStructure,f.rowConditions,true,-1,h);c(f.colStructure,f.colConditions,false)}f.countPointers();f.countOffsets();f.tabularData=[];var h=[],k=[];f.w=1;f.h=1;if(f.colConditions.length)f.w=f.colPointers[f.colPointers.length-1].length;if(f.rowConditions.length)f.h=
f.rowPointers[f.rowPointers.length-1].length;if(!f.ShowMeasuresAsRows){for(var j=0;j<f.w;j++){for(var l=Array(f.h),m=Array(f.h),n=Array(f.h),o=0;o<f.h;o++){l[o]=[];m[o]=[];n[o]=[]}f.tabularData.push(l);h.push(m);k.push(n)}o=function(c,g,h){for(var k=0,j=0;j<g.length;j++){for(var l=h[g[j]],A=false,m=0;m<c.items.length;m++)if(c.items[m].value!=l)k=k+c.items[m].spanData;else{A=c.items[m];break}if(f.autoPaging)if(A)c=A;else return-1;else A&&(c=A)}return k};l=function(c,g,h){for(var k=0,j=[],l=0;l<f.rowConditions.length-
y.length+1;l++)j.push(g[l]);for(l=0;l<j.length;l++){for(var g=h[j[l]],A=false,m=0;m<c.items.length;m++)if(c.items[m].value!=g)k=k+c.items[m].spanData;else{A=c.items[m];break}if(f.autoPaging)if(A)c=A;else return-1;else A&&(c=A)}return k};for(j=0;j<f.filteredData.length;j++){var q=f.filteredData[j],m=o(f.colStructure,f.colConditions,q),n=l(f.rowStructure,f.rowConditions,q),r=q[f.dataColumnIndex],r=r.toString(),r=r.replace(/,/g,"."),r=r.replace(/%/g,""),r=r.replace(/ /g,"");if(r!="#NuN#"){r=parseFloat(r);
isNaN(r)&&(r=0)}if(f.autoPaging){if(m!=-1&&n!=-1){f.tabularData[m][n].push(r);h[m][n].push(j);if(y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula){q=f.getFormulaRowByDataRow(q,y.length-1,"grandTotal-Tab");k[m][n].push(q)}}}else{if(y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula){q=f.getFormulaRowByDataRow(q,y.length-1,"grandTotal-Tab");if(r==0){f.tabularData[m][n].push(r);f.tabularData[m][n]=f.calculateFormulaTotal([q],y.length-1,"MesaureAsColumn")}else f.tabularData[m][n].push(f.calculateFormulaTotal([q],
y.length-1,"MesaureAsColumn"));k[m][n].push(q)}else f.tabularData[m][n].push(r);h[m][n].push(j)}}l=OAT.Statistics[OAT.Statistics.list[f.options.agg].func];for(j=0;j<f.w;j++)for(o=0;o<f.h;o++){m=f.tabularData[j][o].length==0;n=f.tabularData[j][o].length==1&&f.tabularData[j][o][0]=="#NuN#";r=parseFloat(l(f.tabularData[j][o]));f.tabularData[j][o]=!m&&!n?[r,h[j][o]]:n?["#NuN#",h[j][o]]:[f.EmptyValue,h[j][o]];if(y.length>0&&f.formulaInfo.measureFormula[y.length-1].hasFormula){!m&&!n&&(f.tabularData[j][o]=
[r,h[j][o]]);f.tabularData[j][o].push(k[j][o])}}for(j=f.options.subtotals=0;j<f.conditions.length;j++)if(f.conditions[j].subtotals)f.options.subtotals=true;f.countSubTotals();f.options.totals&&f.countTotals()}};this._drawGTotal=function(c,g){var h=OAT.Dom.create("td",{},"gtotal grandtotalvalue");if(f.gTotal!=NaN)if(f.autoPaging&&f.FilterByTopFilter){var k=calculateGrandTotalForLastMeasure(f);OAT.addTextNode(h,f.defaultPictureValue(k.toString(),true,0));h=f.applyConditionalFormats(h,k.toString(),true,
0);f.setClickEventHandlers(h,k.toString(),"MEASURE",y.length-1,"GrandTotal")}else if(!f.autoPaging||f.FilterByTopFilter){if(isNaN(f.gTotal))f.gTotal=0;OAT.addTextNode(h,f.defaultPictureValue(f.gTotal.toString(),true,0));h=f.applyConditionalFormats(h,f.gTotal.toString(),true,0);f.setClickEventHandlers(h,f.gTotal.toString(),"MEASURE",y.length-1,"GrandTotal")}else{OAT.addTextNode(h,f.defaultPictureValue(g[g.length-1].toString(),true,0));h=f.applyConditionalFormats(h,g[g.length-1].toString(),true,0);
f.setClickEventHandlers(h,g[g.length-1].toString(),"MEASURE",y.length-1,"GrandTotal")}else OAT.addTextNode(h,"-");c.appendChild(h)};this._drawRowTotals=function(c,g,h,k){for(var j=[],l=[],m=0;m<y.length-1;m++){j[m]=[];l[m]=[]}var m=f.colConditions.length>1&&y.length>1,n=[],o=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func];if(f.colConditions.length)for(var q=0;q<f.w;q++){var r=-1;if(f.colConditions.length>0)for(var t=0;t<y.length-1;t++){for(var u=OAT.Dom.create("td",{},"gtotal grandtotalvalue"),
v=0;v<h.length;v++)if(h[v][2]===q)if(o(h[v][0][t])!=NaN){OAT.addTextNode(u,f.defaultPictureValue(o(h[v][0][t]).toString(),false,t));u=f.applyConditionalFormats(u,o(h[v][0][t]).toString(),false,t);f.setClickEventHandlers(u,o(h[v][0][t]).toString(),"MEASURE",t,["PartialGrandTotal",h[v][3]]);r=v;j[t].push(o(h[v][0][t]));l[t].push(o(h[v][0][t]))}else OAT.addTextNode(u,"-");else if(h[v][2]==void 0&&h[v][0][0][t]!=void 0&&h[v][0][2]===q){for(var w=[],x=0;x<h[v][0][0][t].length;x++)w.push(h[v][0][0][t][x][0]);
if(o(w)!=NaN){OAT.addTextNode(u,f.defaultPictureValue(o(w).toString(),false,t));u=f.applyConditionalFormats(u,o(w).toString(),false,t);f.setClickEventHandlers(u,o(w).toString(),"MEASURE",t,["PartialGrandTotal",h[v][0][3]]);r=v;j[t].push(o(w));l[t].push(o(w))}else OAT.addTextNode(u,"-")}k.indexOf(q)==-1&&c.appendChild(u)}u=OAT.Dom.create("td",{},"gtotal grandtotalvalue");if(!isNaN(f.colTotals[0][q])||f.colTotals[0][q]=="#NuN#"||f.colTotals[0][q]=="#FoE#"){OAT.addTextNode(u,f.defaultPictureValue(f.colTotals[0][q].toString(),
true,0));u=f.applyConditionalFormats(u,f.colTotals[0][q].toString(),true,0);r!=-1?f.setClickEventHandlers(u,f.colTotals[0][q].toString(),"MEASURE",y.length-1,["PartialGrandTotal",h[r][3]]):f.setClickEventHandlers(u,f.colTotals[0][q].toString(),"MEASURE",y.length-1,["PtrTotals",f.colTotals[1][q]]);n.push(f.colTotals[0][q])}else OAT.addTextNode(u,"");k.indexOf(q)==-1&&c.appendChild(u);if(f.colPointers.length)for(r=f.colPointers[f.colPointers.length-1][q].parent;r.parent;){if(f.conditions[f.colConditions[r.depth]].subtotals&&
r.offset+r.spanData-1==q){if(m){for(t=0;t<y.length-1;t++){u=OAT.Dom.create("td",{},"gtotal grandtotalvalue");OAT.addTextNode(u,f.defaultPictureValue(o(l[t]).toString(),false,t));u=f.applyConditionalFormats(u,o(l[t]).toString(),false,t);f.setClickEventHandlers(u,o(l[t]).toString(),"MEASURE",t,"GrandTotal");c.appendChild(u);l[t]=[]}u=OAT.Dom.create("td",{},"gtotal grandtotalvalue");OAT.addTextNode(u,f.defaultPictureValue(o(n).toString(),true,0));u=f.applyConditionalFormats(u,o(n).toString(),true,0);
f.setClickEventHandlers(u,o(n).toString(),"MEASURE",y.length-1,"GrandTotal");n=[]}else{u=OAT.Dom.create("td",{},"gtotal grandtotalvalue");t=[];for(v=0;v<r.totals.length;v++)t.push(r.totals[v].array);if(o(t)!=NaN){OAT.addTextNode(u,f.defaultPictureValue(o(t).toString(),true,0));u=f.applyConditionalFormats(u,o(t).toString(),true,0);f.setClickEventHandlers(u,o(t).toString(),"MEASURE",y.length-1,"GrandTotal")}else OAT.addTextNode(u,"-")}c.appendChild(u)}r=r.parent}}if(f.colConditions.length>0&&f.GrandTotalVisibility.TotalForColumns==
"Yes")for(t=0;t<y.length-1;t++){u=OAT.Dom.create("td",{},"gtotal grandtotalvalue");OAT.addTextNode(u,f.defaultPictureValue(o(j[t]).toString(),false,t));u=f.applyConditionalFormats(u,o(j[t]).toString(),false,t);f.setClickEventHandlers(u,o(j[t]).toString(),"MEASURE",t,"GrandTotal");c.appendChild(u)}(f.colConditions.length==0||f.GrandTotalVisibility.TotalForColumns=="Yes")&&f._drawGTotal(c,g)};this._drawRowSubtotals=function(c,g,h,k,j,l,m){for(var g=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func],
n=[],o=[],q=0;q<y.length;q++){o[q]=[];n[q]=[]}for(var r=0;r<f.w;r++){q=OAT.Dom.create("td",{},"gtotal firstlevelvalue");if(h.totals[r].array.length>0){if(f.colConditions.length>0)for(var t=0;t<y.length-1;t++){var u=OAT.Dom.create("td",{},"gtotal firstlevelvalue");if(k[0]!=void 0)for(var v=0;v<k.length;v++){var w=k[v][2];f.colConditions.length>1&&(w=k[v][0][2]);if(w==r){w=k[v][0][t];f.colConditions.length>1&&(w=k[v][0][t][0]);for(var x=[],z=0;z<w.length;z++)if(l<w[z][1]){x.push(w[z][0]);w[z][1]=l}if(g(x)!=
NaN){OAT.addTextNode(u,f.defaultPictureValue(g(x).toString(),false,t));u=f.applyConditionalFormats(u,g(x).toString(),false,t);f.setClickEventHandlers(u,g(x).toString(),"MEASURE",t,["PartialGrandTotal",k[0][3]]);n[t].push(g(x));o[t].push(g(x))}else OAT.addTextNode(u,"")}}c.appendChild(u)}OAT.addTextNode(q,f.defaultPictureValue(h.totals[r].value.toString(),true,0));o[y.length-1].push(h.totals[r].value);n[y.length-1].push(h.totals[r].value);j&&OAT.addTextNode(j,f.defaultPictureValue(h.totals[r].value.toString(),
true,0));q=f.applyConditionalFormats(q,h.totals[r].value.toString(),true,0);f.setClickEventHandlers(q,h.totals[r].value.toString(),"MEASURE",y.length-1,["PtrTotals",h.totals[r].rows])}else{if(f.colConditions.length>0)for(t=0;t<y.length-1;t++){u=OAT.Dom.create("td",{},"total");OAT.addTextNode(u,"");c.appendChild(u)}OAT.addTextNode(q,"")}c.appendChild(q);if(f.colPointers.length)for(u=f.colPointers[f.colPointers.length-1][r].parent;u.parent;){if(f.conditions[f.colConditions[u.depth]].subtotals&&u.offset+
u.spanData-1==r)if(y.length>1&&f.colConditions.length>1)for(t=0;t<y.length;t++){q=OAT.Dom.create("td",{},"gtotal firstlevelvalue");if(g(o[t])!=NaN){OAT.addTextNode(q,f.defaultPictureValue(g(o[t]).toString(),t==y.length-1,0));q=f.applyConditionalFormats(q,g(o[t]).toString(),t==y.length-1,0);f.setClickEventHandlers(q,g(o[t]).toString(),"MEASURE",y.length-1,"");o[t]=[]}else OAT.addTextNode(q,"");c.appendChild(q)}else{q=OAT.Dom.create("td",{},"gtotal firstlevelvalue");c.appendChild(q);t=[];for(v=0;v<
h.totals.length;v++)v>=u.offset&&v<u.spanData+u.offset&&t.push(h.totals[v].array);if(g(t)!=NaN){OAT.addTextNode(q,f.defaultPictureValue(g(t).toString(),true,0));q=f.applyConditionalFormats(q,g(t).toString(),true,0);f.setClickEventHandlers(q,g(t).toString(),"MEASURE",y.length-1,"")}else OAT.addTextNode(q,"-")}u=u.parent}}if(f.options.totals&&f.colConditions.length&&f.GrandTotalVisibility.TotalForColumns=="Yes"){if(f.colConditions.length>0){OAT.Dom.create("td",{},"gtotal firstlevelvalue");k=y.length>
1?y.length:y.length-1;for(j=0;j<k;j++){q=OAT.Dom.create("td",{},"gtotal firstlevelvalue");t=n[j];if(g(t)!=NaN){OAT.addTextNode(q,f.defaultPictureValue(g(t).toString(),j==y.length-1,j));q=f.applyConditionalFormats(q,g(t).toString(),false,j)}else OAT.addTextNode(q,"-");c.appendChild(q)}}if(f.colConditions.length==0||y.length<2){t=[];for(v=0;v<h.totals.length;v++)t.push(h.totals[v].array);q=OAT.Dom.create("td",{},"total");if(f.formulaInfo.measureFormula[y.length-1].hasFormula){h=f.calculateFormulaTotal(t,
y.length-1,"MeasureInRows");if(h!=NaN&&!isNaN(h)){OAT.addTextNode(q,f.defaultPictureValue(h.toString(),true,0));q=f.applyConditionalFormats(q,h.toString(),true,0);f.setClickEventHandlers(q,h.toString(),"MEASURE",y.length-1,"")}else OAT.addTextNode(q,"-")}else if(g(t)!=NaN){OAT.addTextNode(q,f.defaultPictureValue(g(t).toString(),true,0));m&&OAT.addTextNode(m,f.defaultPictureValue(g(t).toString(),true,0));q=f.applyConditionalFormats(q,g(t).toString(),true,0);f.setClickEventHandlers(q,g(t).toString(),
"MEASURE",y.length-1,"")}else OAT.addTextNode(q,"-");c.appendChild(q)}}};this._drawRowSubtotalsAutoPaging=function(c,g){for(var h=0;h<g.length;h++){var k=h==g.length-1?true:false,j=OAT.Dom.create("td",{},"total");if(g[h]!=NaN){OAT.addTextNode(j,f.defaultPictureValue(g[h].toString(),k,h));j=f.applyConditionalFormats(j,g[h].toString(),k,h);f.setClickEventHandlers(j,g[h].toString(),"MEASURE",h,"")}else OAT.addTextNode(j," ");c.appendChild(j)}};this._sumValuesInDept=function(c,g,h){if(g===0){var g=c.items,
k=0;if(g!=false)for(c=0;c<g.length;c++){k=k+parseFloat(g[c].value);g[c].value=="#NuN#"?h.push("#NuN#"):h.push(parseFloat(g[c].value))}else{h.push(parseFloat(c.value));return parseFloat(c.value)}return k}for(var k=c.items,j=0,c=0;c<k.length;c++)j=j+f._sumValuesInDept(k[c],g-1,h);return j};this._sumValuesInDeptFormula=function(c,g,h,k){if(g===0){g=c.items;if(g!=false)for(var j=0;j<g.length;j++){for(var c=g[j],l=0;l<k;l++)c=c.parent;c=f.getFormulaRowByCoord(c,[],k,"");h.push([c])}else{c=f.getFormulaRowByCoord(g[j],
[],k,"");h.push([c])}}else{c=c.items;for(j=0;j<c.length;j++)f._sumValuesInDeptFormula(c[j],g-1,h,k)}};this._drawRowSubtotalsForMeasures=function(c,g,h,k,j,l,m){var n=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func],g=OAT.Dom.create("td",{},"gtotal firstlevelvalue"),o=k,q=f.rowConditions.length-(y.length-1),k=q>=3&&j!=-1?q-j+k-1:q-1+k,j=[];f.formulaInfo.measureFormula[o].hasFormula?f._sumValuesInDeptFormula(h,k,j,o):f._sumValuesInDept(h,k,j);if(j.length>0)if(f.formulaInfo.measureFormula[o].hasFormula){k=
f.calculateFormulaTotal(j,o,"MeasureInRows");if(k!=NaN){OAT.addTextNode(g,f.defaultPictureValue(k.toString(),false,o));g=f.applyConditionalFormats(g,k.toString(),false,o);f.setClickEventHandlers(g,k.toString(),"MEASURE",o,["PtrTotals",h.filtrows]);l!=void 0&&f.setClickEventHandlers(l,l.textContent,"DIMENSION",o,["PtrTotals",h.filtrows])}else OAT.addTextNode(g,"")}else if(n(j)!=NaN){OAT.addTextNode(g,f.defaultPictureValue(n(j).toString(),false,o));g=f.applyConditionalFormats(g,n(j).toString(),false,
o);f.setClickEventHandlers(g,n(j).toString(),"MEASURE",o,["PtrTotals",h.filtrows]);l!=void 0&&f.setClickEventHandlers(l,l.textContent,"DIMENSION",o,["PtrTotals",h.filtrows])}else OAT.addTextNode(g,"");else OAT.addTextNode(g,"");if(m!=void 0&&m[o]){OAT.addTextNode(m[o],g.textContent);m[o]=false}c.appendChild(g)};this._drawCorner=function(c){if(y.length>0){OAT.addTextNode(c,f.headerRow[f.dataColumnIndex]);c.className="h2titlewhite";this.setTitleTexrtAlign(c,c.textContent)}};this._drawCornerCustom=function(c){OAT.addTextNode(c,
"");c.className="h2titlewhite";this.setTitleTexrtAlign(c,c.textContent)};this._drawRowConditionsHeadingsCustom=function(c){for(var g=0;g<f.rowConditions.length;g++){var h=f.conditions[f.rowConditions[g]];if(f.isMeasureByName(f.headerRow[f.rowConditions[g]])){if(!f.ShowMeasuresAsRows){var k=OAT.Dom.create("th",{},"h2titlewhite"),j=OAT.Dom.create("div");OAT.addTextNode(j,f.headerRow[f.rowConditions[g]]);this.setTitleTexrtAlign(j,f.headerRow[f.rowConditions[g]]);k.rowSpan=f.colConditions.length+2}}else{var k=
OAT.Dom.create("th",{},"h2title"),l=OAT.Dom.create("div",{position:"relative"}),j=OAT.Dom.create("div",{overflow:"hidden"});f.serverPagination?OAT.addTextNode(j,f.headerRow[f.rowConditions[g]].replace(/ /g," ")+"    "):OAT.addTextNode(j,f.headerRow[f.rowConditions[g]]+"   ");if(f.GeneralDataRows.length>0||f.serverPagination){var m=f.getClickReference(h,f.rowConditions[g],j),n=m[0],m=m[1];OAT.Dom.attach(k,"click",n);n=f.getOrderReference(f.rowConditions[g],m,n,j);f.gd.addSource(j,f.process,n);f.gd.addTarget(k)}k.conditionIndex=
f.rowConditions[g];k.rowSpan=f.ShowMeasuresAsRows?f.colConditions.length+1:f.colConditions.length+2;n=OAT.Dom.create("div",{position:"absolute",right:"-6px",bottom:"0px"});OAT.addImageNode(n,"arrow_drop_up","");try{this.updateSortImage(n,h.sort)}catch(o){}OAT.Dom.append([k,l],[l,j],[l,n],[c,k])}}if(f.ShowMeasuresAsRows){k=OAT.Dom.create("th",{},"h2title");l=OAT.Dom.create("div",{position:"relative",width:"80px"});j=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(j,gx.getMessage("GXPL_QViewerJSMeasures")+
"   ");OAT.Dom.append([k,l],[l,j],[c,k]);k.rowSpan=f.colConditions.length+1;OAT.Dom.append([k,j],[c,k])}};this.isMeasureByName=function(c){for(var f=false,g=0;g<y.length-1;g++)y[g].attributes.getNamedItem("displayName").nodeValue==c&&(f=true);return f};this.setTitleTexrtAlign=function(c,f){for(var g=0;g<y.length;g++)if(y[g].getAttribute("displayName")===f){if(y[g].getAttribute("dataType")==="integer"||y[g].getAttribute("dataType")==="real")c.style.textAlign="right";if(y[g].getAttribute("date")===
"integer")c.style.textAlign="left"}};this.updateSortImage=function(c,f){var g="none";switch(f){case 0:g="asc";break;case 1:g="asc";break;case -1:g="desc";break;case 2:g="desc"}var h=navigator.userAgent.toLowerCase().indexOf("android")>-1;if(gx.util.browser.isIE()||h){c.className.replace("sort-none");c.className.replace("sort-asc");c.className.replace("sort-desc")}else{c.classList.remove("sort-none");c.classList.remove("sort-asc");c.classList.remove("sort-desc")}gx.util.browser.isIE()||h?c.className=
c.className+(" sort-"+g):c.classList.add("sort-"+g);jQuery(c).find("i")[0].textContent=g=="asc"?"arrow_drop_up":"arrow_drop_down"};this._drawRowConditionsHeadings=function(c){for(var g=OAT.Dom.create("tr"),h=0;h<f.rowConditions.length;h++){var k=f.conditions[f.rowConditions[h]];if(f.isMeasureByName(f.headerRow[f.rowConditions[h]])){if(!f.ShowMeasuresAsRows){var j=OAT.Dom.create("th",{},"h2titlewhite"),l=OAT.Dom.create("div");OAT.addTextNode(l,f.headerRow[f.rowConditions[h]]);f.setTitleTexrtAlign(l,
f.headerRow[f.rowConditions[h]]);OAT.Dom.append([j,l],[g,j])}}else{var l=f.headerRow[f.rowConditions[h]].length>8?f.headerRow[f.rowConditions[h]].length*10:80,j=OAT.Dom.create("th",{},"h2title"),m=OAT.Dom.create("div",{position:"relative",width:l+"px"}),l=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(l,f.headerRow[f.rowConditions[h]]+"   ");var n=f.getClickReference(k,f.rowConditions[h],l),o=n[0],n=n[1];OAT.Dom.attach(j,"click",o);o=f.getOrderReference(f.rowConditions[h],n,o,l);f.gd.addSource(l,
f.process,o);f.gd.addTarget(j);j.conditionIndex=f.rowConditions[h];o=OAT.Dom.create("div",{position:"absolute",right:"-6px",bottom:"0px"});OAT.addImageNode(o,"arrow_drop_up","");k!=void 0?this.updateSortImage(o,k.sort):this.updateSortImage(o,0);OAT.Dom.append([j,m],[m,l],[m,o],[g,j])}}if(f.ShowMeasuresAsRows){l=80;j=OAT.Dom.create("th",{},"h2title");m=OAT.Dom.create("div",{position:"relative",width:l+"px"});l=OAT.Dom.create("div",{overflow:"hidden"});OAT.addTextNode(l,gx.getMessage("GXPL_QViewerJSMeasures")+
"   ");OAT.Dom.append([j,m],[m,l],[g,j]);j=OAT.Dom.create("th",{},"h2titlewhite");l=OAT.Dom.create("div");OAT.addTextNode(l,gx.getMessage("GXPL_QViewerJSValue"));j.style.textAlign="right";OAT.Dom.append([j,l],[g,j])}j=OAT.Dom.create("th");if(f.colConditions.length)j.style.border="none";else{f._drawCorner(j,true);j.conditionIndex=-1}j.colSpan=f.colStructure.span!=null?f.colStructure.span+(f.options.headingBefore?1:0)+(f.options.totals?1:0):(f.options.headingBefore?1:0)+(f.options.totals?1:0);y.length>
0&&!f.ShowMeasuresAsRows&&g.appendChild(j);if(f.colConditions.length){j=OAT.Dom.create("th",{border:"none",width:"0px;"});g.appendChild(j)}y.length>0&&g.cells[1]!=void 0&&g.cells[1].textContent==""?g.hidden=true:f.appendRowToTable(c,g,true);y.length>0&&(g.cells[1]!=void 0&&g.cells[1].textContent=="")&&document.getElementById(f.controlName+"_"+f.query+"_toolbar").rows[0].appendChild(g.cells[0])};this._drawColConditionsHeadingsCustom=function(c,g,h){var k=f.conditions[f.colConditions[g]],j=OAT.Dom.create("th",
{cursor:"pointer"},"h2title"),l=OAT.Dom.create("div",{position:"relative",width:(f.headerRow[f.colConditions[g]].length>8?(f.headerRow[f.colConditions[g]].length+3)*10:80)+"px"});if(h)j.style.borderRightColor="transparent";h=OAT.Dom.create("div",{overflow:"hidden"});f.serverPagination?OAT.addTextNode(h,f.headerRow[f.colConditions[g]].replace(/ /g," ")+"   "):OAT.addTextNode(h,f.headerRow[f.colConditions[g]]+"  ");if(f.GeneralDataRows.length>0||f.serverPagination){var m=f.getClickReference(k,f.colConditions[g],
h),n=m[0],m=m[1];OAT.Dom.attach(j,"click",n);n=f.getOrderReference(f.colConditions[g],m,n,h);f.gd.addSource(h,f.process,n);f.gd.addTarget(j)}n=OAT.Dom.create("div",{position:"absolute",right:"0px",bottom:"2px",width:"12px",height:"12px"});OAT.addImageNode(n,"arrow_drop_up","");try{this.updateSortImage(n,k.sort)}catch(o){}l.appendChild(h);l.appendChild(n);j.conditionIndex=f.colConditions[g];j.appendChild(l);c.appendChild(j);return c};this._drawColConditionsHeadings=function(c,g){var h=f.conditions[f.colConditions[g]],
k=OAT.Dom.create("th",{cursor:"pointer"},"even gx-pv-even-row"),j=OAT.Dom.create("div");OAT.addTextNode(j,f.headerRow[f.colConditions[g]]);var l=f.getClickReference(h,f.colConditions[g],j),h=l[0],l=l[1];OAT.Dom.attach(k,"click",h);h=f.getOrderReference(f.colConditions[g],l,h,j);f.gd.addSource(j,f.process,h);f.gd.addTarget(k);k.conditionIndex=f.colConditions[g];k.appendChild(j);k.hidden=true;if(k.textContent==f.headerRow[f.colConditions[g]]){j=document.getElementById(f.controlName+"_"+f.query+"_toolbar");
k.hidden=false;j.rows[0].appendChild(k)}};this.getClassName=function(){return"even gx-pv-even-row"};this.setStyleValues=function(c,f){function g(c){c=c.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(c,f,g,h){return f+f+g+g+h+h});return(c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c))?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null}for(var h=f.split(";"),k=0;k<h.length;k++){var j=h[k].split(":");switch(j[0]){case "color":c.style.color=j[1][0]!=void 0&&j[1][0]==="#"?"rgb("+
g(j[1]).r+","+g(j[1]).g+","+g(j[1]).b+")":j[1];break;case "fontStyle":c.style.fontStyle=j[1];break;case "backgroundColor":c.style.backgroundColor=j[1];break;case "textDecoration":c.style.textDecoration=j[1];break;case "fontWeight":c.style.fontWeight=j[1];break;case "fontFamily":c.style.fontFamily=j[1];break;case "fontVariant":c.style.fontVariant=j[1];break;case "fontSize":c.style.fontSize=j[1].replace("px","")+"px";break;case "textAlign":c.style.textAlign=j[1];break;case "lineHeight":c.style.lineHeight=
j[1];break;case "textIndent":c.style.textIndent=j[1];break;case "verticalAlign":c.style.verticalAlign=j[1];break;case "wordSpacing":c.style.wordSpacing=j[1];break;case "display":c.style.display=j[1];break;case "borderThickness":c.style.borderThickness=j[1];c.style.borderWidth=j[1]+"px";break;case "borderColor":c.style.borderColor=j[1];break;case "borderWith":c.style.borderWith=j[1];break;case "borderStyle":c.style.borderStyle=j[1];break;case "padding":c.style.padding=j[1];break;case "paddingBottom":c.style.paddingBottom=
j[1];break;case "paddingLeft":c.style.paddingLeft=j[1];break;case "paddingRight":c.style.paddingRight=j[1];break;case "paddingTop":c.style.paddingTop=j[1]}}return c};this.underRecursionStyle=[];this.applyFormatValues=function(c,g,h){f.columns[h].getAttribute("dataType")=="date"&&(g=f.dimensionPictureValue(g,h));var k=f.columns[h].getAttribute("format");k!=null&&k!=""&&(c=f.setStyleValues(c,k));f.underRecursionStyle=[];for(var j=0;j<f.formatValues.length;j++)if(f.formatValues[j].columnNumber==h&&f.formatValues[j].value===
g.trimpivot()){c=f.setStyleValues(c,f.formatValues[j].format);f.formatValues[j].recursive!=void 0&&f.formatValues[j].recursive=="yes"&&f.underRecursionStyle.push(f.formatValues[j])}for(var l=f.columns[h].getAttribute("dataType"),m=[],n=[],k=[],o=[],q=[],r=[],o=[],t=[],j=0;j<f.conditionalFormatsColumns.length;j++)if(f.conditionalFormatsColumns[j].columnNumber==h){if(f.conditionalFormatsColumns[j].operation1=="equal"){m[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[j].value1):
f.conditionalFormatsColumns[j].value1;m[1]=f.conditionalFormatsColumns[j].format}if(f.conditionalFormatsColumns[j].operation1=="notequal"){n[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[j].value1):f.conditionalFormatsColumns[j].value1;n[1]=f.conditionalFormatsColumns[j].format}if(f.conditionalFormatsColumns[j].operation1=="less"){q[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[j].value1):f.conditionalFormatsColumns[j].value1;q[1]=f.conditionalFormatsColumns[j].format}if(f.conditionalFormatsColumns[j].operation1==
"greater"){k[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[j].value1):f.conditionalFormatsColumns[j].value1;k[1]=f.conditionalFormatsColumns[j].format}if(f.conditionalFormatsColumns[j].operation1=="greaterequal"&&f.conditionalFormatsColumns[j].operation2==void 0){o[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[j].value1):f.conditionalFormatsColumns[j].value1;k[1]=f.conditionalFormatsColumns[j].format}if(f.conditionalFormatsColumns[j].operation1=="lessequal"){r[0]=
l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[j].value1):f.conditionalFormatsColumns[j].value1;q[1]=f.conditionalFormatsColumns[j].format}if(f.conditionalFormatsColumns[j].operation2&&f.conditionalFormatsColumns[j].operation1=="greaterequal"){t[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[j].value1):f.conditionalFormatsColumns[j].value1;if(f.conditionalFormatsColumns[j].operation2&&f.conditionalFormatsColumns[j].operation2=="lessequal"){t[1]=l==="real"||l===
"integer"?parseFloat(f.conditionalFormatsColumns[j].value2):f.conditionalFormatsColumns[j].value2;t[2]=f.conditionalFormatsColumns[j].format}}}c.style.textAlign="left";if(l==="real"){c.style.textAlign="left";g=parseFloat(g)}if(l==="integer"){c.style.textAlign="right";g=parseInt(g)}if(l==="real")c.style.textAlign="right";if(l!="date"){m[0]!=void 0&&g==m[0]&&(c=f.setStyleValues(c,m[1]));n[0]!=void 0&&g!=n[0]&&(c=f.setStyleValues(c,n[1]));if(k[0]!=void 0&&g>k[0]||o[0]!=void 0&&g>=o[0])c=f.setStyleValues(c,
k[1]);if(q[0]!=void 0&&g<q[0]||r[0]!=void 0&&g<=r[0])c=f.setStyleValues(c,q[1]);t[0]!=void 0&&t[1]!=void 0&&(g>=t[0]&&g<=t[1])&&(c=f.setStyleValues(c,t[2]));return c}if(l==="date"){c.style.textAlign="right";j=g.split("-");f.defaultPicture.getAttribute("dateFormat")!=void 0&&f.defaultPicture.getAttribute("dateFormat")!=null&&(picture=f.defaultPicture.getAttribute("dateFormat").split(""));h=Array(3);h[0]=parseInt(j[0]);h[1]=parseInt(j[1]);h[2]=parseInt(j[2]);if(k[0]!=void 0){j=k[0].split("-");l=Array(3);
l[1]=parseInt(j[1]);l[2]=parseInt(j[2]);l[0]=parseInt(j[0]);if(l[0]<h[0]||l[0]<=h[0]&&l[1]<h[1]||l[0]<=h[0]&&l[1]<=h[1]&&l[2]<h[2])c=f.setStyleValues(c,k[1])}if(q[0]!=void 0){j=q[0].split("-");l=Array(3);l[1]=parseInt(j[1]);l[2]=parseInt(j[2]);l[0]=parseInt(j[0]);if(l[0]>h[0]||l[0]>=h[0]&&l[1]>h[1]||l[0]>=h[0]&&l[1]>=h[1]&&l[2]>h[2])c=f.setStyleValues(c,q[1])}if(t[0]!=void 0&&t[1]!=void 0){j=t[0].split("-");m=t[1].split("-");l=Array(3);cmparElements2=Array(3);l[1]=parseInt(j[1]);l[2]=parseInt(j[2]);
l[0]=parseInt(j[0]);cmparElements2[1]=parseInt(m[1]);cmparElements2[2]=parseInt(m[2]);cmparElements2[0]=parseInt(m[0]);if((l[0]<=h[0]||l[0]<=h[0]&&l[1]<h[1]||l[0]<=h[0]&&l[1]<=h[1]&&l[2]<h[2])&&(cmparElements2[0]>h[0]||cmparElements2[0]>=h[0]&&cmparElements2[1]>h[1]||cmparElements2[0]>=h[0]&&cmparElements2[1]>=h[1]&&cmparElements2[2]>h[2]))c=f.setStyleValues(c,t[2])}}g>k[0]?c=f.setStyleValues(c,k[1]):g<q[0]?c=f.setStyleValues(c,q[1]):g>=t[0]&&g<=t[1]&&(c=f.setStyleValues(c,t[2]));return c};this.applyConditionalFormats=
function(c,g,h,k){if(y.length>0){var j;if(h){k=y.length-1;j=y[y.length-1].getAttribute("dataType");h=y[y.length-1].getAttribute("format")}else{j=y[k].getAttribute("dataType");h=y[k].getAttribute("format")}h!=null&&h!=""&&(c=f.setStyleValues(c,h));for(var l=0;l<f.formatValuesMeasures.length;l++)f.formatValuesMeasures[l].columnNumber==k&&f.formatValuesMeasures[l].value===g&&(c=f.setStyleValues(c,f.formatValuesMeasures[l].format));if(f.underRecursionStyle)for(l=0;l<f.underRecursionStyle.length;l++)c=
f.setStyleValues(c,f.underRecursionStyle[l].format);for(var h=[],m=[],n=[],o=[],q=[],r=[],o=[],t=[],l=0;l<f.conditionalFormats.length;l++)if(f.conditionalFormats[l].columnNumber==k){if(f.conditionalFormats[l].operation1=="equal"){h[0]=j==="real"||j==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;h[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="notequal"){m[0]=j==="real"||j==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;
m[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="less"){q[0]=j==="real"||j==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;q[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="lessequal"&&!f.conditionalFormats[l].operation2){r[0]=j==="real"||j==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;q[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="greater"){n[0]=
j==="real"||j==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;n[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="greaterequal"&&!f.conditionalFormats[l].operation2){o[0]=j==="real"||j==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;n[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation2&&f.conditionalFormats[l].operation1=="greaterequal"){t[0]=j==="real"||j==="integer"?parseFloat(f.conditionalFormats[l].value1):
f.conditionalFormats[l].value1;if(f.conditionalFormats[l].operation2&&f.conditionalFormats[l].operation2=="lessequal"){t[1]=j==="real"||j==="integer"?parseFloat(f.conditionalFormats[l].value2):f.conditionalFormats[l].value2;t[2]=f.conditionalFormats[l].format}}}if(j!="date"){h[0]!=void 0&&g==h[0]&&(c=f.setStyleValues(c,h[1]));m[0]!=void 0&&g!=m[0]&&(c=f.setStyleValues(c,m[1]));if(n[0]!=void 0&&g>n[0]||o[0]!=void 0&&g>=o[0])c=f.setStyleValues(c,n[1]);if(q[0]!=void 0&&g<q[0]||r[0]!=void 0&&g<=r[0])c=
f.setStyleValues(c,q[1]);t[0]!=void 0&&t[1]!=void 0&&(g>=t[0]&&g<=t[1])&&(c=f.setStyleValues(c,t[2]))}if(j==="date"){g=g.split("-");f.defaultPicture.getAttribute("dateFormat")!=void 0&&f.defaultPicture.getAttribute("dateFormat")!=null&&(picture=f.defaultPicture.getAttribute("dateFormat").split(""));k=Array(3);k[0]=parseInt(g[0]);k[1]=parseInt(g[1]);k[2]=parseInt(g[2]);try{if(h[0]!=void 0||o[0]!=void 0||r[0]!=void 0){var u;h[0]!=void 0?u=h[0].split("-"):o[0]!=void 0?u=o[0].split("-"):o[0]!=void 0&&
(u=r[0].split("-"));var v=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);if(v[0]==k[0]||v[0]==k[0]&&v[1]==k[1])h[1]!=void 0?c=f.setStyleValues(c,h[1]):n[1]!=void 0?c=f.setStyleValues(c,n[1]):q[1]!=void 0&&(c=f.setStyleValues(c,q[1]))}if(m[0]!=void 0){u=m[0].split("-");v=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);if(v[0]!=k[0]||v[0]!=k[0]&&v[1]!=k[1])c=f.setStyleValues(c,m[1])}if(n[0]!=void 0||o[0]!=void 0){u=n[0].split("-")!=void 0?n[0].split("-"):o[0].split("-");
v=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);if(v[0]<k[0]||v[0]<=k[0]&&v[1]<k[1]||v[0]<=k[0]&&v[1]<=k[1]&&v[2]<k[2])c=f.setStyleValues(c,n[1])}if(q[0]!=void 0||r[0]!=void 0){u=q[0].split("-")!=void 0?q[0].split("-"):r[0].split("-");v=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);if(v[0]>k[0]||v[0]>=k[0]&&v[1]>k[1]||v[0]>=k[0]&&v[1]>=k[1]&&v[2]>k[2])c=f.setStyleValues(c,q[1])}if(t[0]!=void 0&&t[1]!=void 0){u=t[0].split("-");var w=t[1].split("-"),v=Array(3);
cmparElements2=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);cmparElements2[1]=parseInt(w[1]);cmparElements2[2]=parseInt(w[2]);cmparElements2[0]=parseInt(w[0]);if((v[0]<=k[0]||v[0]<=k[0]&&v[1]<k[1]||v[0]<=k[0]&&v[1]<=k[1]&&v[2]<k[2])&&(cmparElements2[0]>k[0]||cmparElements2[0]>=k[0]&&cmparElements2[1]>k[1]||cmparElements2[0]>=k[0]&&cmparElements2[1]>=k[1]&&cmparElements2[2]>k[2]))c=f.setStyleValues(c,t[2])}}catch(x){}}}return c};this.dimensionPictureValue=function(c,g){if(c==
"#NuN#"){var h=f.defaultPicture.getAttribute("textForNullValues");return h!=void 0?h:""}var k,h=f.columns[g].getAttribute("dataType");k=f.columns[g].getAttribute("picture");return OAT.ApplyPictureValue(c,h,f.defaultPicture,k)};this.getMeasureNumber=function(c,f){for(var g=0;g<f.length;g++)if(f[g].getAttribute("dataField")==c)return g};this.getMeasureName=function(c,f){for(var g=0;g<f.length;g++)if(f[g].getAttribute("dataField")==c)return f[g].getAttribute("displayName")};this.defaultPictureValue=
function(c,g,h){if(c=="#NuN#"){c=f.defaultPicture.getAttribute("textForNullValues");return c!=void 0?c:""}if(c=="#NaV#"||isNaN(c))return"-";if(y.length>0){if(g){g=y[y.length-1].getAttribute("dataType");h=y[y.length-1].getAttribute("picture")}else{g=y[h].getAttribute("dataType");h=y[h].getAttribute("picture")}return OAT.ApplyPictureValue(c,g,f.defaultPicture,h)}return c};this.concatToGrandTotal=function(c,g){for(var h=0;h<g.length;h++){for(var k=false,j=0;j<c.length;j++)if(f.colConditions.length>0&&
g[h][2]==void 0){if(c[j][0][2]==g[h][0][2]){k=true;c[j][0][0][g[h][0][1]]==void 0&&(c[j][0][0][g[h][0][1]]=[]);c[j][0][0][g[h][0][1]].push(g[h][0][0][g[h][0][1]][0][0])}}else if(c[j][2]===g[h][2])for(var k=true,l=0;l<y.length-1;l++)for(var m=0;m<g[h][0][l].length;m++)g[h][0][l][m][1]==99&&c[j][0][l].push(g[h][0][l][m][0]);if(!k){k=jQuery.extend(true,[],g[h]);j=[];for(l=0;l<k[0].length;l++){for(var m=[],n=0;n<k[0][l].length;n++)m.push(k[0][l][n][0]);j.push(m)}f.colConditions.length>0&&(j[2]=g[h][0][2]);
k[0]=j;c.push(k)}}return c};this.countedRows=0;this.appendRowToTable=function(c,g,h){if(!f.autoPaging&&v&&!f.serverPagination){h||f.countedRows++;if(f.countedRows>v)g.style.display="none"}if(f.serverPagination&&f.ExportTo){h||f.countedRows++;if(f.countedRows>f.rowsPerPage)g.style.display="none"}h&&g.setAttribute("title_row",true);if(f.autoPaging){var k=!f.paginationInfo?0:f.paginationInfo.pages[f.actualPaginationPage-1].extraRows;if(!h){if(f.countedRows<k)g.style.display="none";f.countedRows++}if(f.countedRows>
f.autoPagingRowsPerPage+k)g.style.display="none"}c.appendChild(g)};this.drawTable=function(){OAT.Dom.clear(f.div);f.div.setAttribute("class","conteiner_table_div");var c=OAT.Dom.create("table",{},"");c.id=f.controlName+"_"+f.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");f.div.appendChild(c);var g=OAT.Dom.create("table",{},"pivot_table");g.id=this.controlName+"_"+this.query;c=OAT.Dom.create("tbody");if(f.autoPaging&&f.allData.length<f.filteredData.length&&f.colPointers.length>1)f.allData=
f.filteredData;else if(f.autoPaging&&f.filteredData.length>f.allData.length&&f.colPointers.length===0)f.filteredData=f.allData;f.drawTitleDiv();f.drawFilters();f.countedRows=0;if(gx.util.browser.isIE()){var h=document.createElement("div");h.setAttribute("class","divIeContainer");f.div.appendChild(h);OAT.Dom.append([g,c],[h,g]);g.style.marginBottom="0px"}else OAT.Dom.append([g,c],[f.div,g]);f.countedRows=0;var k,g=f.colConditions.length;if(f.colConditions.length>0){var j=0,l=OAT.Dom.create("tr");f._drawRowConditionsHeadingsCustom(l);
for(h=0;h<f.colConditions.length;h++)l=f._drawColConditionsHeadingsCustom(l,h,h===f.colConditions.length-1);f.appendRowToTable(c,l,true);k=l}try{for(var m=0-g,n=[false,0,0],g=[],h=[],o=false,q=false,r=[],t=y.length>1&&f.colConditions.length>1,j=0;j<y.length;j++)r[j]=false;for(j=0;j<f.colConditions.length;j++){for(var l=OAT.Dom.create("tr"),u=f.colPointers[j],v=0;v<u.length;v++){var w=u[v],x=OAT.Dom.create("th",{},"even gx-pv-even-row");if(w.span===0)w.span=1;x.colSpan=w.span*y.length;if(y.length==
0)x.colSpan=w.span;if(w.span===0)m++;else{m=m+w.span*y.length;y.length==0&&(m=m+w.span)}OAT.addTextNode(x,f.dimensionPictureValue(w.value,f.colConditions[j]));for(var x=f.applyFormatValues(x,w.value,f.colConditions[j]),z=w,B=false,C=false;z.parent;){if(z.parent.collapsed==void 0){n[0]=false;break}if(z.parent.collapsed){if(!n[0]||z.parent!=n[1]){C=true;j==f.colConditions.length-1&&h.push(v)}else n[2]++;j==f.colConditions.length-1&&!C&&g.push(v);n[0]=true;n[1]=z.parent;OAT.addTextNode(x,"");B=true;
x.colSpan=1;break}else z=z.parent}var F=f.conditions[f.colConditions[j]].collapsedValues.indexOf(w.value)!=-1;!B&&j<f.colConditions.length-1&&(x=f.addExpandCollapseFunctionality(x,w,j,!F,false));(!B||C)&&l.appendChild(x);var D=f.conditions[f.colConditions[w.depth]];if(D.subtotals&&j+1<f.colConditions.length&&y.length>0){x=OAT.Dom.create("th",{},"h2subtitle ");OAT.addTextNode(x,gx.getMessage("GXPL_QViewerJSTotalFor")+" "+f.dimensionPictureValue(w.value,f.colConditions[j]));x.rowSpan=f.colConditions.length-
j+1;if(t){x.rowSpan=x.rowSpan-1;x.colSpan=y.length}m=m+f.colConditions.length-j;n[0]&&n[1]!=w||l.appendChild(x)}}if(f.options.totals&&(f.GrandTotalVisibility.TotalForColumns=="Yes"&&j==0)&&y.length>0){x=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(x,gx.getMessage("GXPL_QViewerJSTotal"));x.rowSpan=f.colConditions.length;if(f.colConditions.length>0){x.colSpan=y.length;m=m+f.colConditions.length+(y.length-1)}else m=m+f.colConditions.length;totalSpan=f.colConditions.length;l.appendChild(x)}f.options.headingAfter&&
f._drawColConditionsHeadings(l,j);f.appendRowToTable(c,l,true)}if(f.colConditions.length>0){var l=OAT.Dom.create("tr"),G=u.length-n[2]-(f.GrandTotalVisibility.TotalForColumns=="Yes"?0:1);t&&(G=G+f.colPointers[0].length);for(v=0;v<=G;v++)for(u=0;u<y.length;u++){x=OAT.Dom.create("th",{},"h2titlewhite");x.colSpan=1;OAT.addTextNode(x,y[u].attributes.getNamedItem("displayName").nodeValue);f.setTitleTexrtAlign(x,x.textContent);l.appendChild(x)}f.appendRowToTable(c,l,true)}if(m>0){x=OAT.Dom.create("th",
{},"h2subtitle ");OAT.addTextNode(x,"");x.colSpan=m;x.style.borderLeftColor="transparent";k.appendChild(x)}if(f.rowConditions.length&&f.options.headingBefore&&f.colConditions.length===0)f._drawRowConditionsHeadings(c);else if(f.rowConditions.length==0&&f.options.headingBefore&&f.colConditions.length===0)try{f._drawRowConditionsHeadings(c)}catch(I){}var E=y.length>1,L;L=E?f.rowConditions.length-(y.length-1):f.rowConditions.length;G=[false,9999,true,0];k=[];for(var N=[],u=false,j=0;j<f.h;j++){l=OAT.Dom.create("tr");
if(f.rowConditions.length)for(var w=f.rowPointers[f.rowConditions.length-1][j],M=[],m=w;m.parent;){M.unshift(m);m=m.parent}for(v=0;v<f.rowConditions.length-(y.length-1);v++){w=M[v];if(w!=void 0&&w.offset==j){F=f.conditions[f.rowConditions[v]].collapsedValues.indexOf(w.value)!=-1;v>=f.rowConditions.length-(y.length-1)-1&&(F=false);x=OAT.Dom.create("th",{},"even gx-pv-even-row");if(!G[0]||G[1]>=v){x.rowSpan=M[v].spanDraw;OAT.addTextNode(x,f.dimensionPictureValue(w.value,f.rowConditions[v]));x=f.applyFormatValues(x,
w.value,f.rowConditions[v]);f.setClickEventHandlers(x,w.value,"DIMENSION",f.rowConditions[v],w);if(v<f.rowConditions.length-(y.length-1)-1&&(y.length>0||v<f.rowConditions.length-1))x=f.addExpandCollapseFunctionality(x,w,v,!F,true)}else{x.rowSpan=1;OAT.addTextNode(x,"")}if(G[1]>=v){G[0]=F;G[3]=w;G[1]=F?v:9999;G[2]=true}u=false;l.appendChild(x)}else y.length>0&&(u=true)}f.rowConditions.length-(y.length-1)==0&&(j>0&&y.length>0)&&(u=true);var m=[],O=y.length;O===0&&(O=1);for(n=0;n<O-1;n++){var w=M[f.rowConditions.length-
(O-1)+n],J=OAT.Dom.create("td",{},"even gx-pv-even-row");if(w.value!=f.EmptyValue){if(!G[0]||f.autoPaging){OAT.addTextNode(J,f.defaultPictureValue(w.value,false,n));J=f.applyConditionalFormats(J,w.value,false,n);f.setClickEventHandlers(J,w.value,"MEASURE",n,w)}}else OAT.addTextNode(J,"");G[0]&&!r[n]&&(r[n]=J);m[n]||(m[n]=[]);m[n].push([[w.value,[M[M.length-1].row!=void 0?M[M.length-1].row:w.row]]]);f.colConditions.length===0&&l.appendChild(J)}if(f.colConditions.length&&j==0&&f.options.headingBefore){x=
OAT.Dom.create("th");if(f.rowConditions.length)x.style.border="none";else{f._drawCorner(x,true);x.conditionIndex=-2}x.rowSpan=f.rowStructure.span;x.hidden=true}for(var n=false,B=[],C=[],Q=0;Q<O-1;Q++){B[Q]=[];C[Q]=[]}for(v=0;v<f.w;v++){var V=f.tabularData[v][j][0],Q=false;try{Q=V=="#NaV#"&&f.tabularData[v][j][1].length>0}catch(Y){}if(f.colConditions.length>0)for(var S=0;S<O-1;S++){J=OAT.Dom.create("td",{},f.getClassName(j,v));if(V!=f.EmptyValue||Q){var U=getValueMeasureFromMeasureList(m,f.tabularData[v][j][1][0],
S,f.filteredData,y.length);OAT.addTextNode(J,f.defaultPictureValue(U,false,S));J=f.applyConditionalFormats(J,U,false,S);f.setClickEventHandlers(J,U,"MEASURE",S,f.tabularData[v][j][1]);for(var Z=false,W=0;W<k.length;W++)if(k[W][2]===v){U=="#NuN#"?k[W][0][S].push(["#NuN#",99]):U=="#FoE#"?R[S].push([["#FoE#",99]]):k[W][0][S].push([parseFloat(U),99]);k[W][3].push(f.tabularData[v][j][1].slice());Z=true}if(!Z){for(var R=[],Z=0;Z<O-1;Z++)R[Z]=[];U=="#NuN#"?R[S].push([["#NuN#",99]]):U=="#FoE#"?R[S].push([["#FoE#",
99]]):R[S].push([[parseFloat(U),99]]);k.push([[R,S,v,f.tabularData[v][j][1].slice()]])}if(!isNaN(parseFloat(U))){B[S].push(parseFloat(U));C[S].push(parseFloat(U))}}else OAT.addTextNode(J,"");h.indexOf(v)!=-1&&OAT.addTextNode(J,"");g.indexOf(v)==-1&&l.appendChild(J)}J=OAT.Dom.create("td",{},f.getClassName(j,v));if(g.indexOf(v)==-1){if(V!=f.EmptyValue&&y.length>0){OAT.addTextNode(J,f.defaultPictureValue(V.toString(),true,0));J=f.applyConditionalFormats(J,V.toString(),true,0);f.setClickEventHandlers(J,
V,"MEASURE",O-1,f.tabularData[v][j][1])}else OAT.addTextNode(J,"");if((h.indexOf(v)!=-1||G[0])&&!f.autoPaging){o||(o=J);n||(n=J);OAT.addTextNode(J,"")}y.length>0&&l.appendChild(J)}if(y.length>0&&f.colPointers.length>0)for(w=f.colPointers[f.colPointers.length-1][v].parent;w.parent;){z=w.parent;for(Q=false;z!=void 0;){Q=w.parent.collapsed!=void 0&&w.parent.collapsed?true:false;z=z.parent}if(!Q){D=f.conditions[f.colConditions[w.depth]];if(w.offset+w.spanData-1==v){if(t)for(S=0;S<O-1;S++){for(var J=OAT.Dom.create("td",
{},"subtotal"),pa=0,aa=0;aa<C[S].length;aa++)if(!isNaN(C[S][aa])){pa=parseFloat(C[S][aa])+pa;C[S][aa]=0}OAT.addTextNode(J,f.defaultPictureValue(pa.toString(),false,S));J=f.applyConditionalFormats(J,pa.toString(),false,S);l.appendChild(J)}J=OAT.Dom.create("td",{},"subtotal");if(w.totals[j].value>0){OAT.addTextNode(J,f.defaultPictureValue(w.totals[j].value.toString(),true,0));J=f.applyConditionalFormats(J,w.totals[j].value.toString(),true,0);f.setClickEventHandlers(J,w.totals[j].value.toString(),"MEASURE",
O-1,w);if(n!=false){OAT.addTextNode(n,f.defaultPictureValue(w.totals[j].value.toString(),true,0));n=false}}else OAT.addTextNode(J,"");D.subtotals&&l.appendChild(J)}}w=w.parent}}if(f.options.totals&&f.colConditions.length&&f.GrandTotalVisibility.TotalForColumns=="Yes"){if(f.colConditions.length>0)for(S=0;S<O-1;S++){J=OAT.Dom.create("td",{},"total");for(aa=pa=0;aa<B[S].length;aa++)isNaN(B[S][aa])||(pa=parseFloat(B[S][aa])+pa);OAT.addTextNode(J,f.defaultPictureValue(pa.toString(),false,S));J=f.applyConditionalFormats(J,
pa.toString(),false,S);f.setClickEventHandlers(J,pa.toString(),"MEASURE",S,["PtrTotals",f.rowTotals[1][j]]);l.appendChild(J)}if(f.rowConditions.length){J=OAT.Dom.create("td",{},"total");if(isNaN(f.rowTotals[0][j]))OAT.addTextNode(J,"-");else{OAT.addTextNode(J,f.defaultPictureValue(f.rowTotals[0][j].toString(),true,0));J=f.applyConditionalFormats(J,f.rowTotals[0][j].toString(),true,0);f.setClickEventHandlers(J,f.rowTotals[0][j].toString(),"MEASURE",O-1,["PtrTotals",f.rowTotals[1][j]]);if((h.indexOf(v)!=
-1||G[0])&&!f.autoPaging)o&&(q||(q=J))}y.length>0&&l.appendChild(J)}else f._drawGTotal(l)}if(f.colConditions.length&&j==0&&f.options.headingAfter){x=OAT.Dom.create("th");if(f.rowConditions.length)x.style.border="none";else{f._drawCorner(x,true);x.conditionIndex=-2}x.rowSpan=f.rowStructure.span+(f.options.totals&&f.rowConditions.length?1:0);l.appendChild(x)}if((!G[0]||G[2])&&!u){f.appendRowToTable(c,l,false);G[2]=false}var ua=f.rowConditions.length-2;E&&(f.rowConditions.length-2>=0&&M[f.rowConditions.length-
2]!=void 0&&M[f.rowConditions.length-2].items!=void 0&&M[f.rowConditions.length-2].items.length<=1&&f.colConditions.length<=0)&&(ua=f.rowConditions.length-2-(O-1));f.rowConditions.length-(y.length-1)<=0&&(ua=-1);for(v=ua;v>=0;v--){var w=M[v],D=f.conditions[f.rowConditions[w.depth]],wa=w.conditionNumber,ba=f.rowConditions.indexOf(wa)+1,ca=f.rowConditions.length-y.length+1;if(w.offset+w.spanData-1==j&&(H.length<2||f.colConditions.length!=0||v<H.length-1)&&(f.colConditions.length==0||ba<ca)&&(!f.autoPaging||
f.colConditions.length==0)){var da;if(f.autoPaging){var ia=getDataRowFromItem(w);da=getTotalsForDataRow(f.GeneralDataRows,ia,O,f.conditions,f.filterIndexes,f.allData,f.filterDiv.selects,f)}l=OAT.Dom.create("tr");x=OAT.Dom.create("th",{},"h2subtitle subtitleFirstLevel");x.colSpan=L-v;w.value!="#NuN#"?OAT.addTextNode(x,gx.getMessage("GXPL_QViewerJSTotalFor")+" "+f.dimensionPictureValue(w.value,wa)):OAT.addTextNode(x,gx.getMessage("GXPL_QViewerJSTotalFor")+"  ");l.appendChild(x);if(!f.autoPaging&&E)for(m=
0;m<O-1;m++){if(f.colConditions.length===0){var fa=false;if(!G[0]||G[2]||!(G[3]!=w&&v>=G[1]))fa=r;m>0?f._drawRowSubtotalsForMeasures(l,j,w,m,v,void 0,fa):f._drawRowSubtotalsForMeasures(l,j,w,m,v,x,fa)}n=0}N=f.concatToGrandTotal(N,k);t&&(k=[]);if(y.length>0)if(f.autoPaging)da&&f._drawRowSubtotalsAutoPaging(l,da);else{fa=o;G[0]&&!G[2]&&G[3]!=w&&v>=G[1]?fa=false:o=false;if(fa){f._drawRowSubtotals(l,j,w,k,fa,ba,q);q=false}else t?f._drawRowSubtotals(l,j,w,N,fa,ba,false):f._drawRowSubtotals(l,j,w,k,fa,
ba,false)}(!f.autoPaging||da)&&(!G[0]||G[2]||!(G[3]!=w&&v>=G[1]))&&D.subtotals&&f.appendRowToTable(c,l,false)}}if(ua===-1){N=f.concatToGrandTotal(N,k);k=[]}else if(f.rowConditions.length-y.length==0){N=f.concatToGrandTotal(N,k);k=[]}}}catch(Qa){}if(y.length>0&&f.GrandTotalVisibility.TotalForRows=="Yes"&&(!f.autoPaging||f.colConditions.length==0)){if(f.options.totals&&f.rowConditions.length&&(!f.autoPaging||f.TotalPagesPaging==f.actualPaginationPage)){l=OAT.Dom.create("tr");if(L!=0){x=OAT.Dom.create("th",
{},"h2subtitle grandtotaltitle");OAT.addTextNode(x,gx.getMessage("GXPL_QViewerJSTotal"));x.colSpan=L;l.appendChild(x)}t=[];f.autoPaging&&(t=sumGrandPagingTotals(this.GeneralDataRows,f.conditions,y.length,f.formulaInfo,f));if(E)for(m=0;m<y.length-1;m++){numCol=f.rowConditions.length-(y.length-1)+m;J=OAT.Dom.create("td",{},"gtotal grandtotalvalue");E=this.rowPointers[numCol];n=0;v=[];for(j=0;j<E.length;j++){if(f.formulaInfo.measureFormula[m].hasFormula){w=E[j];for(x=0;x<m;x++)w=w.parent;v.push(f.getFormulaRowByCoord(w,
false,m,"MeasureInRows"))}OATIsNotEmptyValue(E[j].value)&&(n=n+parseFloat(E[j].value))}if(!f.autoPaging){f.formulaInfo.measureFormula[m].hasFormula&&(n=f.calculateFormulaTotal(v,m,"MeasureInRows"));t[m]=n}if(f.colConditions.length===0){if(f.autoPaging)if(isNaN(n))OAT.addTextNode(J,"");else{OAT.addTextNode(J,f.defaultPictureValue(t[m].toString(),false,m));J=f.applyConditionalFormats(J,t[m].toString(),false,m)}else if(isNaN(n))OAT.addTextNode(J,"");else{OAT.addTextNode(J,f.defaultPictureValue(n.toString(),
false,m));J=f.applyConditionalFormats(J,n.toString(),false,m);f.setClickEventHandlers(J,n.toString(),"MEASURE",m,"GrandTotal");m==0&&f.setClickEventHandlers(J,gx.getMessage("GXPL_QViewerJSTotal"),"DIMENSION",m,"GrandTotal")}l.appendChild(J)}}f._drawRowTotals(l,t,N,g);f.appendRowToTable(c,l,false)}f.rowConditions.length&&f.options.headingAfter&&f._drawRowConditionsHeadings(c)}};this.drawTableWhenServerPagination=function(){OAT.Dom.clear(f.div);f.div.setAttribute("class","conteiner_table_div");var c=
OAT.Dom.create("table",{},"");c.id=f.controlName+"_"+f.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");f.div.appendChild(c);var g=OAT.Dom.create("table",{},"pivot_table");g.id=this.controlName+"_"+this.query;c=OAT.Dom.create("tbody");f.drawTitleDiv();f.drawFilters();f.countedRows=0;if(gx.util.browser.isIE()){var h=document.createElement("div");h.setAttribute("class","divIeContainer");f.div.appendChild(h);OAT.Dom.append([g,c],[h,g]);g.style.marginBottom="0px"}else OAT.Dom.append([g,c],
[f.div,g]);f.countedRows=0;var k;if(f.colConditions.length>0){var j=0,l=OAT.Dom.create("tr");f._drawRowConditionsHeadingsCustom(l);for(k=0;k<f.colConditions.length;k++)l=f._drawColConditionsHeadingsCustom(l,k,k===f.colConditions.length-1);f.appendRowToTable(c,l,true);k=l}try{for(j=0;j<f.colConditions.length;j++){for(var l=OAT.Dom.create("tr"),m=0;m<f.pageData.columnsHeaders.length;){var n;if(f.pageData.columnsHeaders[m].subTotal){var o=m>=f.pageData.columnsHeaders.length-y.length+(f.GrandTotalVisibility.TotalForColumns==
"No"?y.length:0);f.ShowMeasuresAsRows&&(o=m>=f.pageData.columnsHeaders.length-1&&f.GrandTotalVisibility.TotalForColumns=="Yes");if(o){if(f.GrandTotalVisibility.TotalForColumns=="Yes"&&j==0){t=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(t,gx.getMessage("GXPL_QViewerJSTotal"));t.rowSpan=f.colConditions.length;if(!f.ShowMeasuresAsRows)t.colSpan=y.length;l.appendChild(t)}}else if(j<f.pageData.columnsHeaders[m].subHeaders.length){t=OAT.Dom.create("th",{},"h2subtitle ");r=f.pageData.columnsHeaders[m].subHeaders.length>
j?f.pageData.columnsHeaders[m].subHeaders[j].value:"";OAT.addTextNode(t,gx.getMessage("GXPL_QViewerJSTotalFor")+" "+f.dimensionPictureValue(r.trimpivot(),f.colConditions[j]));f.setClickEventHandlers(t,gx.getMessage("GXPL_QViewerJSTotalFor")+" "+f.dimensionPictureValue(r.trimpivot(),f.colConditions[j]),"DIMENSION",f.colConditions[j],["PtrTotals",r,"",n,"columns",j]);t.rowSpan=f.colConditions.length-j;if(!f.ShowMeasuresAsRows)t.colSpan=y.length;l.appendChild(t)}f.ShowMeasuresAsRows?m++:m=m+y.length}else{n=
m;for(var q=1,r=f.pageData.columnsHeaders[m].subHeaders.length>j?f.pageData.columnsHeaders[m].subHeaders[j].value:"";m+1<f.pageData.columnsHeaders.length&&(!f.pageData.columnsHeaders[m+1].subTotal||j<f.pageData.columnsHeaders[m+1].subHeaders.length-1)&&f.pageData.columnsHeaders[m+1].subHeaders.length>j&&f.pageData.columnsHeaders[m+1].subHeaders[j].value==r;){q++;m++}m++;var t=OAT.Dom.create("th",{},"even gx-pv-even-row");t.colSpan=q;OAT.addTextNode(t,f.dimensionPictureValue(r.trimpivot(),f.colConditions[j]));
f.setClickEventHandlers(t,r,"DIMENSION",f.colConditions[j],{axis:"columns",columnnumber:n,columndimension:f.pageData.columnsHeaders[n],rownumber:j});t=f.applyFormatValues(t,r.trimpivot(),f.colConditions[j]);l.appendChild(t)}}f.appendRowToTable(c,l,true)}if(f.colConditions.length>0){if(f.pageData.columnsHeaders.length-f.colConditions.length>0){t=OAT.Dom.create("th",{},"h2subtitle ");OAT.addTextNode(t,"");t.colSpan=f.pageData.columnsHeaders.length-f.colConditions.length;t.style.borderLeftColor="transparent";
k.appendChild(t)}if(!f.ShowMeasuresAsRows){for(var l=OAT.Dom.create("tr"),v=f.pageData.columnsHeaders.length/y.length,m=0;m<v;m++)for(o=0;o<y.length;o++){t=OAT.Dom.create("th",{},"h2titlewhite");t.colSpan=1;OAT.addTextNode(t,y[o].attributes.getNamedItem("displayName").nodeValue);f.setTitleTexrtAlign(t,t.textContent);l.appendChild(t)}f.appendRowToTable(c,l,true)}}if(f.rowConditions.length&&f.options.headingBefore&&f.colConditions.length===0)f._drawRowConditionsHeadings(c);else if(f.rowConditions.length==
0&&f.options.headingBefore&&f.colConditions.length===0)try{f._drawRowConditionsHeadings(c)}catch(u){}q=y.length>1?f.rowConditions.length-(y.length-1):f.rowConditions.length;if(f.colConditions.length>0)f.underRecursionStyle=[];v=false;for(j=0;j<f.pageData.rows.length;j++){for(var l=OAT.Dom.create("tr"),w=f.pageData.rows[j],m=0;m<w.headers.length;m++){var x=w.headers[m];if(x.rowSpan>0){t=OAT.Dom.create("th",{},"even gx-pv-even-row");t.rowSpan=x.rowSpan;OAT.addTextNode(t,f.dimensionPictureValue(x.value.trimpivot(),
f.rowConditions[m]));t=f.applyFormatValues(t,x.value,f.rowConditions[m]);f.setClickEventHandlers(t,x.value,"DIMENSION",f.rowConditions[m],{cell:m,row:w});if(m<f.rowConditions.length-(y.length-1)-1&&!f.ShowMeasuresAsRows)var z=f.conditions[f.rowConditions[m]].collapsedValues.indexOf(x.value)!=-1,t=f.addExpandCollapseFunctionality(t,x,m,!z,true);l.appendChild(t)}}if(w.headers.length<f.rowConditions.length-(y.length-1))for(var B=f.rowConditions.length-(y.length-1)-w.headers.length,o=0;o<B;o++){t=OAT.Dom.create("th",
{},"even gx-pv-even-row");OAT.addTextNode(t,"");l.appendChild(t)}if(f.ShowMeasuresAsRows){var C=OAT.Dom.create("td",{},"even gx-pv-even-row"),F=f.getMeasureName(w.dataField,y);OAT.addTextNode(C,F);C.style.textAlign="left";f.setClickEventHandlers(C,F,"MEASURE",getMeasureNumberByName(F,y),"GrandTotal");l.appendChild(C)}var G=y.length;G===0&&(G=1);if(w.subTotal){l=OAT.Dom.create("tr");if(w.headers.length==0)if(f.GrandTotalVisibility.TotalForRows!="Yes")v=true;else{t=OAT.Dom.create("th",{},"h2subtitle grandtotaltitle");
OAT.addTextNode(t,gx.getMessage("GXPL_QViewerJSTotal"));t.colSpan=q;if(f.ShowMeasuresAsRows){if(w.rowSpan>0){t.rowSpan=w.rowSpan;l.appendChild(t)}}else l.appendChild(t)}else{if(j==0)for(n=0;n<w.headers.length-1;n++){x=w.headers[n];t=OAT.Dom.create("th",{},"even gx-pv-even-row");t.rowSpan=x.rowSpan;OAT.addTextNode(t,f.dimensionPictureValue(x.value.trimpivot(),f.rowConditions[n]));t=f.applyFormatValues(t,x.value,f.rowConditions[n]);f.setClickEventHandlers(t,x.value,"DIMENSION",f.rowConditions[n],{cell:n,
row:w,isTotal:false});l.appendChild(t)}t=OAT.Dom.create("th",{},"h2subtitle "+(w.headers.length==1?"subtitleFirstLevel":""));t.colSpan=q-(w.headers.length-1);I=w.headers[w.headers.length-1].value.trimpivot();I=="#NuN#"?OAT.addTextNode(t,gx.getMessage("GXPL_QViewerJSTotalFor")+" "+f.defaultPicture.getAttribute("textForNullValues")):OAT.addTextNode(t,gx.getMessage("GXPL_QViewerJSTotalFor")+" "+f.dimensionPictureValue(OAT.Dom.fromSafeXML(I),f.rowConditions[w.headers.length-1]));f.setClickEventHandlers(t,
gx.getMessage("GXPL_QViewerJSTotalFor")+" "+x.value,"DIMENSION",getMeasureNumberByDataField(x.dataField,H),["PtrTotals",I,w,-1]);if(f.ShowMeasuresAsRows){if(w.rowSpan>0){t.rowSpan=w.rowSpan;l.appendChild(t)}}else l.appendChild(t)}if(f.ShowMeasuresAsRows){var D=w.headers.length==0?"grandtotalvalue":w.headers.length==1?"firstlevelvalue":"",C=OAT.Dom.create("td",{},"gtotal "+D),F=f.getMeasureName(w.dataField,y);OAT.addTextNode(C,F);C.style.textAlign="left";l.appendChild(C)}for(o=0;o<w.cells.length;o++){I=
w.cells[o].value;J=f.getMeasureNumber(w.cells[o].dataField,y);D=w.headers.length==0?"grandtotalvalue":w.headers.length==1?"firstlevelvalue":"";C=OAT.Dom.create("td",{},"gtotal "+D);OAT.addTextNode(C,f.defaultPictureValue(I,false,J));if(w.headers.length==0&&f.colConditions.length==0){f.underRecursionStyle=[];C=f.applyConditionalFormats(C,I,false,J);f.setClickEventHandlers(C,I,"MEASURE",J,"GrandTotal")}else{C=f.applyConditionalFormats(C,I,false,J);f.setClickEventHandlers(C,I,"MEASURE",J,["PtrTotals",
I,w,o])}l.appendChild(C)}}else for(o=0;o<w.cells.length;o++){var I=w.cells[o].value;if(f.colConditions.length>0&&f.pageData.columnsHeaders[o].subTotal){C=OAT.Dom.create("td",{},"subtotal");if(I!=f.EmptyValue){var J=f.getMeasureNumber(w.cells[o].dataField,y);OAT.addTextNode(C,f.defaultPictureValue(I,false,J));C=f.applyConditionalFormats(C,I,false,J);f.setClickEventHandlers(C,I,"MEASURE",J,["PtrTotals",I,w,o])}else OAT.addTextNode(C,"")}else{C=OAT.Dom.create("td",{},"even gx-pv-even-row");if(I!=f.EmptyValue){J=
f.getMeasureNumber(w.cells[o].dataField,y);OAT.addTextNode(C,f.defaultPictureValue(I,false,J));C=f.applyConditionalFormats(C,I,false,J);f.setClickEventHandlers(C,I,"MEASURE",J,{cell:o,row:w})}else OAT.addTextNode(C,"")}l.appendChild(C)}v||f.appendRowToTable(c,l,false);if(f.colConditions.length>0)f.underRecursionStyle=[]}}catch(E){}};this.drawTableWhenShowMeasuresAsRows=function(){OAT.Dom.clear(f.div);f.div.setAttribute("class","conteiner_table_div");var c=OAT.Dom.create("table",{},"");c.id=f.controlName+
"_"+f.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");f.div.appendChild(c);var g=OAT.Dom.create("table",{},"pivot_table");g.id=this.controlName+"_"+this.query;c=OAT.Dom.create("tbody");f.drawTitleDiv();f.drawFilters();f.countedRows=0;if(gx.util.browser.isIE()){var h=document.createElement("div");h.setAttribute("class","divIeContainer");f.div.appendChild(h);OAT.Dom.append([g,c],[h,g]);g.style.marginBottom="0px"}else OAT.Dom.append([g,c],[f.div,g]);if(f.autoPaging&&f.allData.length<f.filteredData.length&&
f.colPointers.length>1)f.allData=f.filteredData;else if(f.autoPaging&&f.filteredData.length>f.allData.length&&f.colPointers.length===0)f.filteredData=f.allData;var k,g=f.colConditions.length;if(f.colConditions.length>0){var j=0,l=OAT.Dom.create("tr");f._drawRowConditionsHeadingsCustom(l);for(k=0;k<f.colConditions.length;k++)l=f._drawColConditionsHeadingsCustom(l,k,k===f.colConditions.length-1);l.setAttribute("title_row",true);f.appendRowToTable(c,l,true);k=l}try{for(var h=0-g,m=[false,0,0],n=[],o=
[],g=[],j=0;j<y.length;j++)g[j]=false;for(j=0;j<f.colConditions.length;j++){for(var l=OAT.Dom.create("tr"),q=f.colPointers[j],r=0;r<q.length;r++){var t=q[r],v=OAT.Dom.create("th",{},"even gx-pv-even-row");if(t.span===0)t.span=1;v.colSpan=t.span;j==0&&(t.span===0?h++:h=h+t.span*y.length);OAT.addTextNode(v,f.dimensionPictureValue(t.value,f.colConditions[j]));for(var v=f.applyFormatValues(v,t.value,f.colConditions[j]),u=t,w=false,x=false;u.parent;){if(u.parent.collapsed==void 0){m[0]=false;break}if(u.parent.collapsed){if(!m[0]||
u.parent!=m[1]){x=true;j==f.colConditions.length-1&&o.push(r)}else m[2]++;j==f.colConditions.length-1&&!x&&n.push(r);m[0]=true;m[1]=u.parent;OAT.addTextNode(v,"");w=true;v.colSpan=1;break}else u=u.parent}(!w||x)&&l.appendChild(v)}if(f.options.totals&&j==0&&f.GrandTotalVisibility.TotalForColumns=="Yes"){v=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(v,gx.getMessage("GXPL_QViewerJSTotal"));v.rowSpan=f.colConditions.length;if(f.colConditions.length>0){v.colSpan=y.length;h=h+f.colConditions.length+
(y.length-1)}else h=h+f.colConditions.length;totalSpan=f.colConditions.length;l.appendChild(v)}f.options.headingAfter&&f._drawColConditionsHeadings(l,j);l.setAttribute("title_row",true);f.appendRowToTable(c,l,true)}if(h>2){v=OAT.Dom.create("th",{},"h2subtitle ");OAT.addTextNode(v,"");if(h<1E3)v.colSpan=h;v.style.borderLeftColor="transparent";k.appendChild(v)}f.rowConditions.length&&f.options.headingBefore&&f.colConditions.length===0&&f._drawRowConditionsHeadings(c);var z;z=y.length>1?f.rowConditions.length-
(y.length-1):f.rowConditions.length;k=[false,9999,true,0];h=[];for(o=0;o<y.length;o++){h[o]=[];h[o][0]=[]}q=[];for(o=0;o<y.length;o++){q[o]=[];q[o][0]=[]}m=[];for(o=0;o<f.recordForFormula.length;o++)m[o]=f.recordForFormula[o];n=[];if(f.colConditions.length>0){n=[];for(o=0;o<f.allData.length;o++)n[o]=f.allData[o]}o=[];for(j=0;j<f.h;j++){l=OAT.Dom.create("tr");if(f.rowConditions.length)for(var C=f.rowConditions.length-(y.length-1),t=f.rowPointers[C][j],B=[],F=t;F.parent;){B.unshift(F);F=F.parent}else B=
[f.rowPointers[0][0]];F=-1;for(r=0;r<f.rowConditions.length-(y.length-1);r++){t=B[r];if(t!=void 0&&t.offset==j){F==-1&&(F=r);var H=f.conditions[f.rowConditions[r]].collapsedValues.indexOf(t.value)!=-1;r>=f.rowConditions.length-(y.length-1)-1&&(H=false);v=OAT.Dom.create("th",{},"even gx-pv-even-row");if(!k[0]||k[1]>=r){v.rowSpan=B[r].span;OAT.addTextNode(v,f.dimensionPictureValue(t.value,f.rowConditions[r]));v=f.applyFormatValues(v,t.value,f.rowConditions[r]);f.setClickEventHandlers(v,t.value,"DIMENSION",
f.rowConditions[r],t)}else{v.rowSpan=1;OAT.addTextNode(v,"")}if(k[1]>=r){k[0]=H;k[3]=t;k[1]=H?r:9999;k[2]=true}l.appendChild(v)}}var G=y.length;G===0&&(G=1);var D=OAT.Dom.create("td",{},"even gx-pv-even-row"),t=B[f.rowConditions.length-(G-1)];if(t.value!=f.EmptyValue){if(!k[0]){OAT.addTextNode(D,t.value);D.style.textAlign="left";f.setClickEventHandlers(D,t.value,"MEASURE",getMeasureNumberByName(I,y),"GrandTotal")}}else OAT.addTextNode(D,"");l.appendChild(D);var u=[],F=[],I=t.value,J=getMeasureNumberByName(I,
y);if(f.colConditions.length==0){var E=t.items[0],D=OAT.Dom.create("td",{},"even gx-pv-even-row");if(E!=f.EmptyValue){if(!k[0]){OAT.addTextNode(D,f.defaultPictureValue(E.value,false,J));D=f.applyConditionalFormats(D,E.value,false,J);f.setClickEventHandlers(D,E.value,"MEASURE",J,[Math.floor(t.row/y.length)]);if(f.formulaInfo.measureFormula[J].hasFormula){var L=f.getFormulaRowByCoord(t,[],J,"MeasureInRows",m);if(L!=f.EmptyValue){q[J][0].push(L);h[J][0].push([L,-1])}}else{var N=E.value!="#NuN#"?parseFloat(E.value):
"#NuN#";q[J][0].push(N);h[J][0].push([N,-1])}}}else OAT.addTextNode(D,"");k[0]&&!g[ji]&&(g[ji]=D);u.push([[E.value,[E.row]]]);f.colConditions.length===0&&l.appendChild(D)}else{var M=f.colPointers.length-1;f.colPointers[f.colPointers.length-1].length==0&&M--;if(f.colPointers[M]!=void 0){if(J==0){o.length>0&&!isNaN(o[0])&&n.splice(o[0],1);o=[]}for(r=0;r<f.colPointers[M].length;r++){var O=f.colPointers[M][r],u=t,Q;if(J>0)try{Q=o[r]!=f.EmptyValue?[n[o[r]][f.headerRow.indexOf(I)],o[r]]:f.EmptyValue}catch(S){}else{Q=
f.getMeasureValueCoord(u,O,f.headerRow.indexOf(I),n);Q!=f.EmptyValue&&J==0?o.push(Q[1]):J==0&&o.push(f.EmptyValue)}D=OAT.Dom.create("td",{},"even gx-pv-even-row");if(Q!=f.EmptyValue){OAT.addTextNode(D,f.defaultPictureValue(Q[0],false,J));D=f.applyConditionalFormats(D,Q[0],false,J);f.setClickEventHandlers(D,Q[0],"MEASURE",J,[Q[1]]);var V=parseFloat(Q[0]);Q[0]=="#NuN#"&&(V="#NuN#");if(f.formulaInfo.measureFormula[J].hasFormula){V=f.getFormulaRowByCoord(u,O,J,"MeasureInRows",m);V==f.EmptyValue&&(V=NaN)}q[J][r]==
void 0?q[J][r]=[V]:q[J][r].push(V);h[J][r]==void 0?h[J][r]=[[V,-1]]:h[J][r].push([V,-1]);F.push(V)}else{OAT.addTextNode(D,"");q[J][r]==void 0?q[J][r]=[0]:q[J][r].push(0);h[J][r]==void 0?h[J][r]=[[NaN,-1]]:h[J][r].push([NaN,-1])}l.appendChild(D)}}}if(f.colConditions.length&&j==0&&f.options.headingAfter){v=OAT.Dom.create("th");if(f.rowConditions.length)v.style.border="none";else{f._drawCorner(v,true);v.conditionIndex=-2}v.rowSpan=f.rowStructure.span+(f.options.totals&&f.rowConditions.length?1:0);l.appendChild(v)}if(!k[0]||
k[2]){f.appendRowToTable(c,l,false);k[2]=false}if(f.options.totals&&f.colConditions.length&&f.GrandTotalVisibility.TotalForColumns=="Yes"){D=OAT.Dom.create("td",{},"total");R=0;if(F.length>0)if(f.formulaInfo.measureFormula[getMeasureNumberByName(I,y)].hasFormula)R=f.calculateFormulaTotal(F,getMeasureNumberByName(I,y),"MeasureInRows");else{R=F.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c});isNaN(R)&&(R!="#NuN#"&&R!="#FoE#")&&(R=0)}if(R!=0){OAT.addTextNode(D,
f.defaultPictureValue(R.toString(),false,getMeasureNumberByName(I,y)));D=f.applyConditionalFormats(D,R.toString(),false,getMeasureNumberByName(I,y))}else OAT.addTextNode(D,"");l.appendChild(D)}F=[];if(f.options.totals&&f.rowConditions.length-(y.length-1)>1)for(var U=f.rowConditions.length-(y.length-1)-2;U>=0;U--){u=false;if(j+1<f.rowPointers[C].length){for(var w=[],Y=f.rowPointers[C][j+1];Y.parent;){w.unshift(Y);Y=Y.parent}for(x=U;x>=0;x--)w[x].value!=B[x].value&&(u=true)}else u=true;if(u=u&&f.conditions[f.rowConditions[U]].subtotals==
1)for(u=0;u<y.length;u++){l=OAT.Dom.create("tr");if(u==0){v=OAT.Dom.create("th",{},"h2subtitle");v.colSpan=f.rowConditions.length-(y.length-1)-U;v.rowSpan=y.length;OAT.addTextNode(v,gx.getMessage("GXPL_QViewerJSTotalFor")+" "+B[U].value);l.appendChild(v)}D=OAT.Dom.create("td",{},"total");Q=y[u].getAttribute("displayName");OAT.addTextNode(D,Q);D.style.textAlign="left";f.setClickEventHandlers(D,Q,"MEASURE",u,"GrandTotal");l.appendChild(D);if(f.colConditions.length==0){for(var D=OAT.Dom.create("td",
{},"total"),Z=[],W=0;W<h[u][0].length;W++)if(h[u][0][W][1]==-1||h[u][0][W][1]>U)if(!isNaN(h[u][0][W][0])||h[u][0][W][0]=="#NuN#"||f.formulaInfo.measureFormula[u].hasFormula){Z.push(h[u][0][W][0]);h[u][0][W][1]=U}var R=0;if(Z.length!=0)if(f.formulaInfo.measureFormula[u].hasFormula)R=f.calculateFormulaTotal(Z,u,"MeasureInRows");else{R=f.IsReduceNuN(Z)?"#NuN#":Z.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c});isNaN(R)&&(R!="#NuN#"&&R!="#FoE#")&&(R=0)}F.push(parseFloat(R));
if(R!=0){OAT.addTextNode(D,f.defaultPictureValue(R.toString(),false,u));D=f.applyConditionalFormats(D,R.toString(),false,u)}else OAT.addTextNode(D,"");l.appendChild(D)}else{M=f.colPointers.length-1;f.colPointers[f.colPointers.length-1].length==0&&M--;if(f.colPointers[M]!=void 0)for(w=0;w<f.colPointers[M].length;w++){D=OAT.Dom.create("td",{},"total");Z=[];for(W=0;W<h[u][w].length;W++)if(h[u][w][W][1]==-1||h[u][w][W][1]>U)if(!isNaN(h[u][w][W][0])||h[u][w][W][0]=="#NuN#"||f.formulaInfo.measureFormula[u].hasFormula){Z.push(h[u][w][W][0]);
h[u][w][W][1]=U}R=0;if(Z.length!=0)if(f.formulaInfo.measureFormula[u].hasFormula)R=f.calculateFormulaTotal(Z,u,"MeasureInRows");else{R=f.IsReduceNuN(Z)?"#NuN#":Z.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c});isNaN(R)&&(R!="#NuN#"&&R!="#FoE#")&&(R=0)}if(R!=0&&(!isNaN(R)||R=="#NuN#"||R=="#FoE#")){f.formulaInfo.measureFormula[u].hasFormula?F.push(Z):F.push(parseFloat(R));OAT.addTextNode(D,f.defaultPictureValue(R.toString(),false,u));D=f.applyConditionalFormats(D,
R.toString(),false,u)}else OAT.addTextNode(D,"");l.appendChild(D)}if(f.colConditions.length&&f.GrandTotalVisibility.TotalForColumns=="Yes"){D=OAT.Dom.create("td",{},"gtotal");R=0;F.length!=0&&(R=f.formulaInfo.measureFormula[u].hasFormula?f.calculateFormulaTotal(F,u,"MeasureInRows"):f.IsReduceNuN(F)?"#NuN#":F.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c}));OAT.addTextNode(D,f.defaultPictureValue(R.toString(),false,u));D=f.applyConditionalFormats(D,R.toString(),
false,u);l.appendChild(D);F=[]}}f.appendRowToTable(c,l,false)}}}if(y.length>0&&f.rowConditions.length-y.length+1>0&&f.GrandTotalVisibility.TotalForRows=="Yes"&&f.options.totals&&f.rowConditions.length&&(!f.autoPaging||f.TotalPagesPaging==f.actualPaginationPage||f.FilterByTopFilter))for(j=0;j<y.length;j++){l=OAT.Dom.create("tr");if(z!=0&&j==0){v=OAT.Dom.create("th",{},"h2subtitle");OAT.addTextNode(v,gx.getMessage("GXPL_QViewerJSTotal"));v.colSpan=z;v.rowSpan=y.length;l.appendChild(v)}D=OAT.Dom.create("td",
{},"gtotal");Q=y[j].getAttribute("displayName");if(Q!=f.EmptyValue){OAT.addTextNode(D,Q);D.style.textAlign="left";f.setClickEventHandlers(D,Q,"MEASURE",j,"GrandTotal")}else OAT.addTextNode(D,"");l.appendChild(D);F=[];if(f.colConditions.length==0){D=OAT.Dom.create("td",{},"gtotal");R=0;q[j][0].length>0&&(R=f.formulaInfo.measureFormula[j].hasFormula?f.calculateFormulaTotal(q[j][0],j,"MeasureInRows"):f.IsReduceNuN(q[j][0])?"#NuN#":q[j][0].reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&
isNaN(f)?0:isNaN(c)?f:c}));if(!isNaN(R)||R=="#NuN#"||R=="#FoE#"){OAT.addTextNode(D,f.defaultPictureValue(R.toString(),false,j));D=f.applyConditionalFormats(D,R.toString(),false,j)}else OAT.addTextNode(D,"");l.appendChild(D)}else{M=f.colPointers.length-1;f.colPointers[f.colPointers.length-1].length==0&&M--;if(f.colPointers[M]!=void 0)for(r=0;r<f.colPointers[M].length;r++){D=OAT.Dom.create("td",{},"gtotal");R=0;q[j][r]!=void 0&&q[j][r].length>0&&(R=f.formulaInfo.measureFormula[j].hasFormula?f.calculateFormulaTotal(q[j][r],
j,"MeasureInRows"):f.IsReduceNuN(q[j][r])?"#NuN#":q[j][r].reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c}));if(!isNaN(R)||R=="#NuN#"||R=="#FoE#"){OAT.addTextNode(D,f.defaultPictureValue(R.toString(),false,j));D=f.applyConditionalFormats(D,R.toString(),false,j)}else OAT.addTextNode(D,"");l.appendChild(D);f.formulaInfo.measureFormula[j].hasFormula?F.push(q[j][r]):isNaN(R)||F.push(parseFloat(R))}}if(f.options.totals&&f.colConditions.length&&f.GrandTotalVisibility.TotalForColumns==
"Yes"){D=OAT.Dom.create("td",{},"gtotal");R=0;F.length!=0&&(R=f.formulaInfo.measureFormula[j].hasFormula?f.calculateFormulaTotal(F,j,"MeasureInRows"):f.IsReduceNuN(F)?"#NuN#":F.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c}));OAT.addTextNode(D,f.defaultPictureValue(R.toString(),false,j));D=f.applyConditionalFormats(D,R.toString(),false,j);l.appendChild(D)}f.appendRowToTable(c,l,false)}}catch(aa){}};this.IsReduceNuN=function(c){isNuN=false;for(var f=0;f<c.length;f++){if(c[f]!=
"#NuN#"&&c[f]!=0)return false;c[f]=="#NuN#"&&(isNuN=true)}return isNuN};this.applyFilters=function(){f.filteredData=[];for(var c=0;c<f.allData.length;c++)f.filterOK(f.allData[c])&&f.filteredData.push(f.allData[c])};this.createTempDataStructForAggStepOptimization=function(){try{for(var c=0;c<f.GeneralDataRows.length;c++)for(var g=0;g<f.GeneralDataRows[0].length;g++)for(var h=0;h<f.GeneralDataRows[0].length;h++){f.TempDataStructForAggStepOptimization[f.GeneralDataRows[c][g]]==void 0&&(f.TempDataStructForAggStepOptimization[f.GeneralDataRows[c][g]]=
[]);f.TempDataStructForAggStepOptimization[f.GeneralDataRows[c][g]][f.GeneralDataRows[c][h]]=true}}catch(j){}};this.getMeasureValue=function(c,g,h){for(var j=c,c=[],k=[],l=0;l<h.length-y.length+1;l++)k[l]=h[h.length-y.length+1-(l+1)];for(l=0;l<k.length;l++){c[k[l]]=j.value;j=j.parent}var j="",m=false,n=f.allData;if(f.filterIndexes.length>0)n=f.filteredData;for(l=0;l<n.length;l++){for(var o=false,q=0;q<k.length;q++)if(n[l][k[q]]==c[k[q]])o=true;else{o=false;break}if(o){j=n[l][h.length+f.filterIndexes.length-
y.length+1+g];m=true;break}}return m?j:f.EmptyValue};this.getMeasureValueCoord=function(c,g,h,j){for(var k=[],l=[],m=0;m<f.rowConditions.length-y.length+1;m++)l[m]=f.rowConditions[f.rowConditions.length-y.length+1-(m+1)];for(m=f.colConditions.length-1;m>=0;m--){k[f.colConditions[m]]=g.value;g=g.parent}c=c.parent;for(m=0;m<l.length;m++){k[l[m]]=c.value;c=c.parent}l="";c=false;for(m=g=0;m<j.length;m++){for(var n=false,o=0;o<k.length;o++)if(j[m][o]==k[o])n=true;else if(k[o]==void 0&&f.filterIndexes.length>
0)n=true;else{n=false;break}if(n){l=j[m][h];g=m;c=true;break}}return c?[l,g]:f.EmptyValue};this.getFormulaRowByCoord=function(c,g,h,j,k){for(var j=[],l=[],m=0;m<f.rowConditions.length-y.length+1;m++)l[m]=f.rowConditions[f.rowConditions.length-y.length+1-(m+1)];if(g)for(m=f.colConditions.length-1;m>=0;m--){j[f.colConditions[m]]=g.value;g=g.parent}c=c.parent;for(m=0;m<l.length;m++){j[l[m]]=c.value;c=c.parent}for(m=0;m<f.filterIndexes.length;m++){c=OAT.$v(f.filterDiv.selects[m]);j[f.filterIndexes[m]]=
c=="[all]"?void 0:c}for(var n=false,l=k!=void 0?k:f.recordForFormula,c=[],g=[],m=0;m<f.formulaInfo.recordDataLength;m++)g[m]=0;for(m=0;m<l.length;m++){for(var o=false,q=0;q<j.length;q++)if(l[m][q]==j[q])o=true;else if(j[q]==void 0&&f.filterIndexes.indexOf(q)!=-1)o=true;else{o=false;break}if(o){for(n=0;n<f.formulaInfo.measureFormula[h].relatedMeasures.length;n++){o=f.formulaInfo.measureFormula[h].relatedMeasures[n];if(l[m][o]==void 0)g[o]==0&&(g[o]="#NuN#");else{g[o]=="#NuN#"&&(g[o]=0);g[o]=g[o]+parseFloat(l[m][o])}}n=
true;c.push(m)}}if(n){if(f.formulaInfo.cantFormulaMeasures==1)for(h=0;h<c.length;h++)k.splice(c[h],1);return g}return f.EmptyValue};this.calculateFormulaTotal=function(c,g){try{var h=[];if(c.length==0)return"#NuN#";for(var j=0;j<c.length;j++)if(c[j]!=f.EmptyValue&&c[j]!=0&&(c[j]!="#NuN#"||f.ShowMeasuresAsRows))for(var k=0;k<c[j].length;k++){h[k]==void 0&&(h[k]=0);if(!isNaN(c[j][k])&&c[j][k]!="#NuN#"){h[k]=="#NuN#"&&(h[k]=0);h[k]=h[k]+c[j][k]}c[j][k]=="#NuN#"&&h[k]==0&&(h[k]="#NuN#")}if(f.ShowMeasuresAsRows){if(h.length==
0)return NaN}else if(h.length==0)return"#NuN#";var l=EvaluateExpressionPivotJs(f.formulaInfo.measureFormula[g].PolishNotation,h,f.formulaInfo);return l==Infinity||isNaN(l)?"#FoE#":l}catch(m){return f.EmptyValue}};this.addToStack=function(c,g,h,j){if(f.GeneralDataRows.length>3E3||c<1||g.value==void 0)return true;var k=f.conditions[j[c]].dataRowPosition,c=f.conditions[j[c-1]].dataRowPosition;if(f.allData.length>800&&f.filterIndexes.length>0)return true;for(j=0;j<f.allData.length;j++)if(f.allData[j][k]==
h&&g.value==f.allData[j][c])return true;if(!f.autoPaging||f.rowConditions.length<8)for(j=0;j<f.GeneralDataRows.length;j++)if(f.GeneralDataRows[j][k]==h&&g.value==f.GeneralDataRows[j][c])return true;return false};this.createAggStructure=function(){function c(g,h,j,k){g.items=false;g.depth=-1;var g=[g],l=h.length;f.ShowMeasuresAsRows&&j&&(l=l-(y.length-1));for(var m=0;m<l;m++){var n=f.conditions[h[m]],o=f.conditions[h[m]].dataRowPosition,A=n.sort;if(m>=1&&!f.autoPaging&&f.rowConditions.length>16&&f.GeneralDataRows.length>
1200){n=f.conditions[h[m-1]];o=f.conditions[h[m-1]].dataRowPosition;A=n.sort}if(A!=0&&A!=2){for(var q=true,r=0;r<n.distinctValues.length;r++)if(q&&n.distinctValues[r]!=parseInt(n.distinctValues[r])){q=false;break}q?k.sort(function(c){return function(f,g){return A*(parseInt(f[c])===parseInt(g[c])?0:parseInt(f[c])<parseInt(g[c])?-1:1)}}(o)):k.sort(function(c){return function(f,g){return A*(f[c]===g[c]?0:f[c]<g[c]?-1:1)}}(o))}var o=[],t=n.distinctValues.length;if(m>=1&&!f.autoPaging&&f.rowConditions.length>
16&&f.GeneralDataRows.length>1200)for(var t=f.conditions[h[m]].dataRowPosition,K=[],r=0;r<g.length;r++){for(var v=[],u=0;u<k.length;u++){var w=k[u][t],x=f.addToStack3(m,g[r],k[u],h,A,q);if(x=="break")break;if(K.indexOf(w)==-1&&x){K.push(w);x=false;n.collapsedValues.indexOf(w)!=-1&&(x=true);w={value:w,parent:g[r],used:false,items:false,depth:m,collapsed:x,conditionNumber:h[m]};v.push(w);o.push(w)}}K=[];g[r].items=v}else for(r=0;r<g.length;r++){v=[];u=[0];for(K=0;K<t;K++){var w=n.distinctValues[K];
if(n.blackList.indexOf(w)==-1&&f.addToStack2(m,g[r],w,h,k,u,A,q)){x=false;n.collapsedValues.indexOf(w)!=-1&&(x=true);w={value:w,parent:g[r],used:false,items:false,depth:m,collapsed:x,conditionNumber:h[m]};v.push(w);o.push(w)}}g[r].items=v}g=o}if(f.ShowMeasuresAsRows&&j){o=[];for(r=0;r<g.length;r++){v=[];t=y.length;for(K=0;K<t;K++){j=y[K].getAttribute("displayName");x=false;w={value:j,parent:g[r],used:false,items:false,depth:l,collapsed:x};j=false;if(f.colConditions.length==0){k=f.getMeasureValue(g[r],
K,h);if(k==f.EmptyValue)j=true;else{var T={value:k,parent:w,used:false,items:false,depth:l+1,collapsed:x};w.items=[];w.items.push(T)}}if(!j){v.push(w);f.colConditions.length==0?o.push(T):o.push(w)}}g[r].items=v}g=o}}for(var g=[],h=0;h<f.allData.length;h++)g.push(f.allData[h]);c(f.rowStructure,f.rowConditions,true,g);c(f.colStructure,f.colConditions,false,g)};this.addToStack3=function(c,g,h,j,k,l){if(g.value==void 0)return true;var m=f.conditions[j[c-1]].dataRowPosition;if(g.value==h[m]){k=true;for(l=
1;l<c;l++){m=f.conditions[j[c-1-l]].dataRowPosition;g=g.parent;if(g.value!=h[m]){k=false;break}}if(k)return true}else return k==0||k==2||k==1&&!l&&h[m]<=g.value||k==-1&&!l&&h[m]>=g.value||k==1&&l&&parseInt(h[m])<=parseInt(g.value)||k==-1&&l&&parseInt(h[m])>=parseInt(g.value)?false:"break"};this.addToStack2=function(c,g,h,j,k,l,m,n){if(f.GeneralDataRows.length>3E3&&!f.autoPaging||c<1||g.value==void 0)return true;var o=f.conditions[j[c]].dataRowPosition,q=f.conditions[j[c-1]].dataRowPosition;if(f.allData.length>
1E3&&f.filterIndexes.length>0&&f.rowConditions.length<8)return true;for(var r=true,t=l[0];t<k.length;t++)if(m==0||m==2||m==1&&!n&&k[t][o]<=h||m==-1&&!n&&k[t][o]>=h||m==1&&n&&parseInt(k[t][o])<=parseInt(h)||m==-1&&n&&parseInt(k[t][o])>=parseInt(h)){if(k[t][o]==h){if(r&&m!=0&&m!=2){l[0]=t;r=false}if(g.value==k[t][q]){for(var v=g,u=true,w=1;w<c;w++){var x=f.conditions[j[c-1-w]].dataRowPosition,v=v.parent;if(v.value!=k[t][x]){u=false;break}}if(u)return true}}}else break;if(f.GeneralDataRows.length<500&&
f.GeneralDataRows.length>f.allData.length)for(t=0;t<f.GeneralDataRows.length;t++)if(f.GeneralDataRows[t][o]==h&&g.value==f.GeneralDataRows[t][q])if(c>1){x=f.conditions[j[c-2]].dataRowPosition;if(g.parent.value==f.GeneralDataRows[t][x])return true}else return true;return false};this.fillAggStructure=function(){function c(g,h,j,k){if(f.ShowMeasuresAsRows){k=j.length-y.length;j.splice(k,0,"");for(var l=0;l<y.length;l++){var m=y[l].getAttribute("displayName");j[k]=m;m=g;for(n=0;n<h.length;n++){o=h[n];
o=j[o];A=false;for(q=0;q<m.items.length;q++)if(m.items[q].value==o){A=m.items[q];break}A&&(m=A)}m.used=true}j.splice(k,1)}else{for(var m=g,n=0;n<h.length;n++){for(var o=h[n],o=j[o],A=false,q=0;q<m.items.length;q++)if(m.items[q].value==o){A=m.items[q];m.items[q].row=k;break}A&&(m=A)}m.used=true}}function g(c){if(c.items)for(var f=0;f<c.items.length;f++)g(c.items[f]);else c.used=true}if(f.options.showEmpty){g(f.rowStructure);g(f.colStructure)}else for(var h=0;h<f.filteredData.length;h++){var j=f.filteredData[h];
c(f.rowStructure,f.rowConditions,j,h);c(f.colStructure,f.colConditions,j,h)}};this.checkAggStructure=function(){function c(g){if(f.ShowMeasuresAsRows){if(f.colConditions>0){if(!g.items)return g.used;var h;for(h=g.items.length-1;h>-1;h--)if(h>-1){var j=c(g.items[h]);j!=void 0&&!j&&g.items.splice(h,1)}return g.items.length>0}}else{if(!g.items)return g.used;for(h=g.items.length-1;h>=0;h--)c(g.items[h])||g.items.splice(h,1);return g.items.length>0}}c(f.rowStructure);f.ShowMeasuresAsRows||c(f.colStructure)};
this.applyDefaultFormats=function(c,f){switch(typeof f){case "number":f=gx.text.charReplace(f.toString(),".",gx.decimalPoint);OAT.addTextNode(c,f)}return c};this.refreshPivot=function(c,g){if(c!=""&&g!=""){for(var h=(new DOMParser).parseFromString(c,"text/xml").getElementsByTagName("OLAPDimension"),j,k=0;k<f.conditions.length;k++){if(f.conditions[k]&&f.serverPagination)for(var l=jQuery.extend(true,[],f.conditions[k].blackList),m=0;m<l.length;m++)f.createFilterInfo({op:"pop",values:l[m],dim:k});f.conditions[k].blackList=
[]}k=[];l=[];for(m=0;m<h.length;m++){for(var n=h[m].getElementsByTagName("name")[0].childNodes[0].nodeValue,o=-1,q=0;q<f.columns.length;q++)f.columns[q].attributes.getNamedItem("name").nodeValue===n&&(o=q);if(o!=-1){n=h[m].getElementsByTagName("condition")[0].childNodes[0].nodeValue;if(n==="row"){j=f.colConditions.indexOf(o);if(j!=-1){f.colConditions.splice(j,1);y.length>1?f.rowConditions=[o].concat(f.rowConditions):f.rowConditions.push(o)}else{j=f.filterIndexes.indexOf(o);if(j!=-1){f.filterIndexes.splice(j,
1);y.length>1?f.rowConditions=[o].concat(f.rowConditions):f.rowConditions.push(o)}}k[parseInt(h[m].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=o}else if(n==="col"){j=f.rowConditions.indexOf(o);if(j!=-1){f.rowConditions.splice(j,1);y.length>1?f.colConditions=[o].concat(f.colConditions):f.colConditions.push(o)}else{j=f.filterIndexes.indexOf(o);if(j!=-1){f.filterIndexes.splice(j,1);y.length>1?f.colConditions=[o].concat(f.colConditions):f.colConditions.push(o)}}l[parseInt(h[m].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=
o}else if(n==="none"){j=f.colConditions.indexOf(o);if(j!=-1){f.colConditions.splice(j,1);y.length>1?f.filterIndexes=[o].concat(f.filterIndexes):f.filterIndexes.push(o)}else{j=f.rowConditions.indexOf(o);if(j!=-1){f.rowConditions.splice(j,1);y.length>1?f.filterIndexes=[o].concat(f.filterIndexes):f.filterIndexes.push(o)}}}n=h[m].getElementsByTagName("order")[0].childNodes[0].nodeValue;if(f.serverPagination)f.conditions[o].sort=n=="descending"?-1:1;else{f.conditions[o].sort=n=="descending"?f.conditions[o].sort==
0||f.conditions[o].sort==2?2:-1:f.conditions[o].sort==0||f.conditions[o].sort==2?0:1;f.stateChanged=true;f.sort(f.conditions[o],o)}q=h[m].getElementsByTagName("hide")[0].childNodes;for(n=0;n<q.length;n++)if(q[n].tagName==="value"){j=f.conditions[o].blackList.indexOf(q[n].textContent);if(j===-1)for(j=0;j<f.conditions[o].distinctValues.length;j++)f.conditions[o].distinctValues[j].toString().trimpivot()==q[n].textContent&&(f.serverPagination?f.createFilterInfo({op:"push",values:f.conditions[o].distinctValues[j],
dim:o}):f.conditions[o].blackList.push(f.conditions[o].distinctValues[j]))}if(h[m].getElementsByTagName("filterdivs").length>0){q=h[m].getElementsByTagName("filterdivs")[0].childNodes;for(n=0;n<q.length;n++)if(q[n].tagName==="value"){j=f.filterIndexes.indexOf(o);if(j!=-1&&f.filterDiv.selects[j]!=void 0)f.filterDiv.selects[j].value=q[n].textContent}}}}if(f.rowConditions.length-(y.length-1)==k.length)for(h=0;h<k.length;h++)f.rowConditions[h]=k[h];if(f.colConditions.length==l.length)for(h=0;h<l.length;h++)f.colConditions[h]=
l[h];if(f.serverPagination){for(h=0;h<f.columns.length;h++)f.pageData.AxisInfo=f.createAxisInfo(f.columns[h].getAttribute("dataField"));f.pageData.CollapseInfo=f.CreateExpandCollapseInfo("");f.pageData.DataInfo=f.createDataInfo();h=f.createNewDataInfo();k=f.createNewAxisInfo();f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){if(!qv.util.anyError(c)||f.QueryViewerCollection[f.IdForQueryViewerCollection].debugServices){f.pageData=OATGetNewDataFromXMLForPivot(c,
f.pageData,f.ShowMeasuresAsRows);f.goWhenServerPagination(false,true);qv.util.hideActivityIndicator(f.QueryViewerCollection[f.IdForQueryViewerCollection])}else{c=qv.util.getErrorFromText(c);qv.util.renderError(f.QueryViewerCollection[f.IdForQueryViewerCollection],c)}}.closure(this),[1,f.rowsPerPage,true,k,h,f.pageData.FilterInfo,f.pageData.CollapseInfo,true])}else f.go(false,true)}};this.changePaginationRows=function(c){if(f.autoPaging){var g=f.GeneralDataRows;if(f.RowsWhenMoveToFilter.length>0)g=
f.RowsWhenMoveToFilter;f.allData=[];var h=[];(!this.paginationInfo||!this.paginationInfo.pages)&&createPaginationInfo(f,g);h=f.paginationInfo.pages[c-1].rows;f.colConditions.length>0&&(h=f.rowsForBlankCells(h));f.allData=h;c=f.conditions;f.conditions=[];for(g=0;g<f.headerRow.length;g++)f.pseudoInitCondition(g,c)}};this.rowsForBlankCells=function(c){for(var g=[],h=[],j=[],k=[],l=0;l<c.length;l++){for(var m=[],n=[],o=0;o<f.rowConditions.length-(y.length-1);o++)n[o]=c[l][f.rowConditions[o]];for(o=0;o<
f.colConditions.length;o++)m[o]=c[l][f.colConditions[o]];if(j.indexOf(m.toString())==-1){g.push(m);j.push(m.toString())}if(k.indexOf(n.toString())==-1){h.push(n);k.push(n.toString())}}j=[];for(c=0;c<g.length;c++)for(k=0;k<h.length;k++){l=[];for(o=0;o<f.rowConditions.length-(y.length-1);o++)l[f.rowConditions[o]]=h[k][o];for(o=0;o<f.colConditions.length;o++)l[f.colConditions[o]]=g[c][o];j.push(l)}c=[];for(g=0;g<j.length;g++){h=f.getRowFromDimensionRow(j[g],f.GeneralDataRows);c.push(h)}return c};this.getRowFromDimensionRow=
function(c,f){for(var g=0;g<f.length;g++){for(var h=true,j=0;j<c.length;j++)if(c[j]!=void 0&&c[j]!=f[g][j]){h=false;break}if(h)return f[g]}return null};this.countNotFiltered=function(c){for(var g=0,h=0;h<c.length;h++)f.notInBlackList(c[h],f.conditions)||g++;c=parseInt(g/f.autoPagingRowsPerPage);g%f.autoPagingRowsPerPage!=0&&c++;return c};this.setNewPagesAccount=function(c){try{jQuery("#"+f.controlName+" #tablePagination_totalPages").length>0?OAT.replaceTextNode(jQuery("#"+f.containerName+" #tablePagination_totalPages")[0],
" "+c):OAT.replaceTextNode(jQuery("#"+f.controlName+"_"+f.query+"_tablePagination #tablePagination_totalPages")[0]," "+c)}catch(g){if(f.paginationInfo.totalPages>1){c={currPage:f.actualPaginationPage,ignoreRows:jQuery("tbody tr[title_row=true]",jQuery("#"+f.controlName+"_"+f.query)),optionsForRows:[10,15,20],rowsPerPage:f.autoPagingRowsPerPage,topNav:false,controlName:f.controlName+"_"+f.query,cantPages:f.paginationInfo.totalPages};OAT.partialTablePagination(jQuery("#"+f.controlName+"_"+f.query),
c);jQuery("#"+f.controlName+"_"+f.query).css("margin-bottom","0px")}}};this.notInBlackList=function(c,f){for(var g=false,h=0;h<c.length;h++)f[h]!=void 0&&(f[h].blackList!=void 0&&f[h].blackList.indexOf(c[h])!=-1)&&(g=true);return g};this.preGoWhenShowHideMeasures=function(c){f.headerRow.indexOf(f.initMetadata.Measures[c].displayName);if(f.initMetadata.Measures[c].Visible){for(var g=y.length-1,c=0;c<g;c++)f.rowConditions.splice(f.rowConditions.length-1,1);if(g>=0&&y[0].getAttribute("dataField")!="F0"){c=
f.rowConditions.length+f.colConditions.length+f.filterIndexes.length;if(y.length>0){g=c;for(c=c+y.length;g<c;g++)f.rowConditions.push(g)}}}else if(y.length>1){f.rowConditions.splice(f.rowConditions.length-1,1);f.dataColumnIndex=f.dataColumnIndex-1}for(g=0;g<f.columns.length;g++){c=f.columns[g].getAttribute("dataField");c=f.initMetadata.DataFields.indexOf(c);f.initMetadata.Conditions[c]=f.conditions[g]}this.goWhenHide()};this.preGoWhenShowHideDimension=function(c){for(var g=0;g<f.columns.length;g++){var h=
f.columns[g].getAttribute("dataField"),h=f.initMetadata.DataFields.indexOf(h);f.initMetadata.Conditions[h]=f.conditions[g]}for(var j,k=f.initMetadata.DataFields[c],g=0;g<f.columns.length;g++){h=f.columns[g].getAttribute("dataField");k==h&&(j=g)}if(!f.initMetadata.Dimensions[c].Visible){f.initMetadata.DimensionPosition[c]="row";f.colConditions.indexOf(j)>-1&&(f.initMetadata.DimensionPosition[c]="col");f.filterIndexes.indexOf(j)>-1&&(f.initMetadata.DimensionPosition[c]="fil")}j=f.headerRow.indexOf(f.initMetadata.Dimensions[c].displayName);
if(f.initMetadata.Dimensions[c].Visible){j=f.initMetadata.DimensionPosition[c];if(j==void 0){g=f.initMetadata.Dimensions[c].defaultPosition.toLowerCase();j=g.indexOf("rows")>-1?"row":g.indexOf("columns")>-1?"col":g.indexOf("filters")>-1||g.indexOf("pages")>-1?"fil":"row"}for(g=h=0;g<c;g++)f.initMetadata.Dimensions[g].Visible&&(h=h+1);c=h;if(j=="row"){h=[];g=f.rowConditions.indexOf(c)>-1;for(j=0;j<f.rowConditions.length;j++)if(f.rowConditions[j]<c)h.push(f.rowConditions[j]);else if(f.rowConditions[j]==
c){h.push(c);h.push(c+1);g=true}else{if(!g){h.push(c);g=true}h.push(f.rowConditions[j]+1)}g||h.push(c);f.rowConditions=[];f.rowConditions=h;f.dataColumnIndex=f.dataColumnIndex+1;h=[];for(j=0;j<f.colConditions.length;j++)f.colConditions[j]>=c?h.push(f.colConditions[j]+1):h.push(f.colConditions[j]);f.colConditions=[];f.colConditions=h;h=[];for(j=0;j<f.filterIndexes.length;j++)f.filterIndexes[j]>=c?h.push(f.filterIndexes[j]+1):h.push(f.filterIndexes[j]);f.filterIndexes=[];f.filterIndexes=h}else if(j==
"col"){h=[];for(j=0;j<f.rowConditions.length;j++)f.rowConditions[j]>=c?h.push(f.rowConditions[j]+1):h.push(f.rowConditions[j]);f.rowConditions=[];f.rowConditions=h;f.dataColumnIndex=f.dataColumnIndex+1;h=[];g=f.colConditions.indexOf(c)>-1;for(j=0;j<f.colConditions.length;j++)if(f.colConditions[j]<c)h.push(f.colConditions[j]);else if(f.colConditions[j]==c){h.push(c);h.push(c+1);g=true}else{if(!g){h.push(c);g=true}h.push(f.colConditions[j]+1)}g||h.push(c);f.colConditions=[];f.colConditions=h;h=[];for(j=
0;j<f.filterIndexes.length;j++)f.filterIndexes[j]>=c?h.push(f.filterIndexes[j]+1):h.push(f.filterIndexes[j]);f.filterIndexes=[];f.filterIndexes=h}else if(j=="fil"){h=[];for(j=0;j<f.rowConditions.length;j++)f.rowConditions[j]>=c?h.push(f.rowConditions[j]+1):h.push(f.rowConditions[j]);f.rowConditions=[];f.rowConditions=h;f.dataColumnIndex=f.dataColumnIndex+1;h=[];for(j=0;j<f.colConditions.length;j++)f.colConditions[j]>=c?h.push(f.colConditions[j]+1):h.push(f.colConditions[j]);f.colConditions=[];f.colConditions=
h;h=[];g=f.filterIndexes.indexOf(c)>-1;for(j=0;j<f.filterIndexes.length;j++)if(f.filterIndexes[j]<c)h.push(f.filterIndexes[j]);else if(f.filterIndexes[j]==c){h.push(c);h.push(c+1);g=true}else{if(!g){h.push(c);g=true}h.push(f.filterIndexes[j]+1)}g||h.push(c);f.filterIndexes=[];f.filterIndexes=h}}else{f.rowConditions.indexOf(j)>-1?f.rowConditions.splice(f.rowConditions.indexOf(j),1):f.colConditions.indexOf(j)>-1?f.colConditions.splice(f.colConditions.indexOf(j),1):f.filterIndexes.indexOf(j)>-1&&f.filterIndexes.splice(f.filterIndexes.indexOf(j),
1);f.dataColumnIndex=f.dataColumnIndex-1;for(g=0;g<f.rowConditions.length;g++)f.rowConditions[g]>j&&(f.rowConditions[g]=f.rowConditions[g]-1);for(g=0;g<f.colConditions.length;g++)f.colConditions[g]>j&&(f.colConditions[g]=f.colConditions[g]-1);for(g=0;g<f.filterIndexes.length;g++)f.filterIndexes[g]>j&&(f.filterIndexes[g]=f.filterIndexes[g]-1)}f.initRowConditions=[];for(g=0;g<f.rowConditions.length;g++)f.initRowConditions.push(f.rowConditions[g]);this.goWhenHide()};this.goWhenHide=function(c){for(var g=
[],h=0;h<f.initMetadata.Dimensions.length;h++)f.initMetadata.Dimensions[h].Visible||g.push(f.initMetadata.Dimensions[h].dataField);for(var j=[],h=0;h<f.initMetadata.Measures.length;h++)f.initMetadata.Measures[h].Visible||j.push(f.initMetadata.Measures[h].dataField);f.saveHiddenState({DataFields:f.initMetadata.DataFields,Dimensions:f.initMetadata.Dimensions,Measures:f.initMetadata.Measures,DimensionPosition:f.initMetadata.DimensionPosition,Conditions:f.initMetadata.Conditions,version:f.rememberLayoutStateVersion});
h=OATParseMetadata(f.initMetadata.Metadata,g,j,f.serverPagination);g=h[0];f.HideDataFilds=h[2];f.OrderFildsHidden=h[1];h=jQuery.parseXML(g);y=h.getElementsByTagName("OLAPMeasure");f.columns=h.getElementsByTagName("OLAPDimension");h=OATGetColumnsAndMeasureMeatadata(f.columns,y,f.formulaInfo,f.OrderFildsHidden);f.headerRow=h[0];f.formulaInfo.measureFormula=h[2];f.conditionalFormats=h[3];f.conditionalFormatsColumns=h[4];h=h[1];if(!f.serverPagination){var k=[],h=OATgetAllDataFromXMLOldFormat(f.initMetadata.DataString,
h,f.OrderFildsHidden),k=h[0];f.recordForFormula=h[1];if(h[1].length>0)f.formulaInfo.recordDataLength=h[1][0].length}if(y.length>0)f.dataColumnIndex=f.headerRow.length-1;else if(!f.serverPagination)for(h=0;h<k.length;h++)k[h].push("0");f.serverPagination||reLoadDataArrays(k,f.formulaInfo,f.headerRow,f.columns,f,y,f.recordForFormula);if(f.serverPagination){f.conditions=[];for(h=0;h<f.headerRow.length;h++){f.initCondition(h);if(f.conditions[h]&&f.columns[h]){f.conditions[h].dataField=f.columns[h].getAttribute("dataField");
f.conditions[h].state="all";f.conditions[h].defaultAction="Include";f.conditions[h].visibles=[];f.conditions[h].searchInfo={previousPage:0,totalPages:0,filteredText:"",values:[]}}f.applyCustomFilters(h)}for(h=0;h<f.columns.length;h++){k=f.columns[h].getAttribute("dataField");k=f.initMetadata.DataFields.indexOf(k);if(f.initMetadata.Conditions[k]!=""){f.initMetadata.Conditions[k].dataRowPosition=f.conditions[h].dataRowPosition;f.conditions[h]=f.initMetadata.Conditions[k]}}f.cleanGridCache();f.pageData.AxisInfo=
f.createAxisInfo();k=f.createNewAxisInfo();f.pageData.DataInfo=f.createDataInfo();h=f.createNewDataInfo();f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){if(!qv.util.anyError(c)||f.QueryViewerCollection[f.IdForQueryViewerCollection].debugServices){f.pageData=OATGetNewDataFromXMLForPivot(c,f.pageData,f.ShowMeasuresAsRows);f.goWhenServerPagination(false,false);qv.util.hideActivityIndicator(f.QueryViewerCollection[f.IdForQueryViewerCollection])}else{c=qv.util.getErrorFromText(c);
qv.util.renderError(f.QueryViewerCollection[f.IdForQueryViewerCollection],c)}}.closure(this),[1,f.rowsPerPage,true,k,h,f.pageData.FilterInfo,f.pageData.CollapseInfo,true]);if(c)f.initValueRead(f,0);else for(h=0;h<f.columns.length;h++)if(f.conditions[h].totalPages==void 0){c=10;f.QueryViewerCollection[f.IdForQueryViewerCollection].AutoRefreshGroup!=""&&(c=0);var l=h;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(c){c=JSON.parse(c);f.conditions[l].previousPage=c.PageNumber;
f.conditions[l].totalPages=c.PagesCount;f.conditions[l].blocked=false;if(c.Null){f.conditions[l].hasNull=true;f.conditions[l].distinctValues.indexOf("#NuN#")==-1&&f.conditions[l].distinctValues.push("#NuN#");var g=true;f.conditions[l].NullIncluded||(g=false);g&&f.conditions[l].visibles.indexOf("#NuN#")==-1&&f.conditions[l].visibles.push("#NuN#")}else f.conditions[l].hasNull=false;for(var g=[],h=0;h<c.NotNullValues.length;h++){var j=c.NotNullValues[h],k=false;if(f.conditions[l].state=="none"&&f.UserFilterValues.length>
0&&f.UserFilterValues[l]!=void 0&&f.UserFilterValues[l].length>0&&f.UserFilterValues[l].indexOf(j.trimpivot())!=-1){k=true;g.push(j)}f.conditions[l].distinctValues.indexOf(j)==-1&&f.conditions[l].distinctValues.push(j);f.conditions[l].state=="all"&&f.conditions[l].visibles.indexOf(j)==-1&&f.conditions[l].visibles.push(j);f.conditions[l].state=="none"&&(f.conditions[l].blackList.indexOf(j)==-1&&!k)&&f.conditions[l].blackList.push(j);f.UserExpandValues.length>0&&f.UserExpandValues[l]!=void 0&&(f.UserExpandValues[l][0]==
"#ALLCOLLAPSE#"||f.UserExpandValues[l].indexOf(j.trimpivot())==-1)&&f.conditions[l].collapsedValues.push(j)}for(h=0;h<g.length;h++)f.createFilterInfo({op:"pop",values:g[h],dim:l},true)}.closure(this),[f.columns[l].getAttribute("dataField"),1,c,""])}}if(!f.serverPagination){f.conditions=[];for(h=0;h<f.headerRow.length;h++)f.initCondition(h);for(h=0;h<f.columns.length;h++){k=f.columns[h].getAttribute("dataField");k=f.initMetadata.DataFields.indexOf(k);if(f.initMetadata.Conditions[k]!=""){f.initMetadata.Conditions[k].dataRowPosition=
f.conditions[h].dataRowPosition;f.conditions[h]=f.initMetadata.Conditions[k]}}f.autoPaging=false;f.init();if(f.filterIndexes.length>0){f.preGoWhenMoveTopFilter(f.filterIndexes[0],true);if(f.tempBlackLists&&!f.autoPaging)for(h=0;h<f.conditions.length;h++)if(f.conditions[h]){if(f.tempBlackLists[h])f.conditions[h].blackList=f.tempBlackLists[h];if(f.tempCollapsedValues[h])f.conditions[h].collapsedValues=f.tempCollapsedValues[h]}try{if(f.oldSortValues.length>0)for(c=0;c<f.conditions.length;c++)if(f.conditions[c]){f.conditions[c].sort=
f.oldSortValues[c];f.sort(f.conditions[c])}}catch(m){}}f.go(false,false)}};this.preGo=function(c,g,h,j,l){if(l&&J){c=f.getState();if(c!=null&&c.version===f.rememberLayoutStateVersion&&c.query==f.query&&this.conditions.length==c.conditions.length&&c.filterIndexes.length==0){for(l=0;l<=c.conditions.length-1;l++)if(c.conditions[l]!=false&&f.conditions[l]!=false){for(var m=0;m<c.conditions[l].blackList.length;m++)f.conditions[l].blackList.indexOf(c.conditions[l].blackList[m])==-1&&f.conditions[l].distinctValues.indexOf(c.conditions[l].blackList[m])!=
-1&&f.conditions[l].blackList.push(c.conditions[l].blackList[m]);f.conditions[l].sort=c.conditions[l].sort}f.rowConditions=c.rowConditions;f.colConditions=c.colConditions;f.rowsPerPage=c.rowsPerPage}}if(f.filterIndexes.length>0){collapseRowForCollapseValues(f);l=f.RowsWhenMoveToFilter}else l=f.GeneralDataRows;m=k;k=[];for(var n=c=0,o=[];c<this.autoPagingRowsPerPage&&n<l.length;){if((j==-1||n<l.length&&l[n][j]!=h)&&f.isNotFilterByTopFilter(l[n])&&!f.notInBlackList(l[n],f.conditions)){var q=f.canBeConsiderNoNew(l[n],
k,o);k.push([l[n]]);q||c++}n++}if(k.length<1){k=m;this.go(false,g)}f.allData=k;h=f.conditions;f.conditions=[];for(c=0;c<f.headerRow.length;c++)f.pseudoInitCondition(c,h);setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter)},500);this.go(false,g)};this.canBeConsiderNoNew=function(c,g,h){if(f.colConditions.length>0)for(var j=false,k=0;k<g.length;k++){for(var l=true,m=0;m<f.rowConditions.length;m++)g[k][f.rowConditions[m]]!=c[f.rowConditions[m]]&&(l=false);if(l==true){j=true;break}}if(f.filterIndexes.length>
0){j=false;for(k=0;k<h.length;k++){l=true;for(m=0;m<f.rowConditions.length-y.length+1;m++)h[k][f.rowConditions[m]]!=c[f.rowConditions[m]]&&(l=false);if(l==true){j=true;break}}j||h.push(c)}return j};this.preGoWhenMoveTopFilter=function(c,g){if(g==void 0)for(var h=0;h<f.filterDiv.selects.length;h++)f.filterDiv.selects[h].value="[all]";else{for(var j=false,h=0;h<f.filterDiv.selects.length;h++)f.filterDiv.selects[h].value!="[all]"&&(j=true);if(j&&!f.autoPaging)return}f.FilterByTopFilter=false;for(var k=
[],h=0;h<H.length;h++){var l=h;l!=c&&f.filterIndexes.indexOf(l)==-1&&k.push(l)}j=f.GeneralDataRows;if(f.autoPaging){collapseRowForCollapseValues(f);k=f.RowsWhenMoveToFilter;j=[];l=h=0;value=null;for(var m=[];h<this.autoPagingRowsPerPage&&l<k.length;){if(!f.notInBlackList(k[l],f.conditions)&&f.isNotFilterByTopFilter(k[l])){var n=f.canBeConsiderNoNew(k[l],j,m);j.push([k[l]]);n||h++}l++}f.allData=j;f.nextRowWhenAutopaging=l;f.prevRowWhenAutopaging=0;j=f.conditions;f.conditions=[];for(h=0;h<f.headerRow.length;h++)f.pseudoInitCondition(h,
j);f.TotalPagesPaging=parseInt(f.RowsWhenMoveToFilter.length/f.autoPagingRowsPerPage);f.RowsWhenMoveToFilter.length%f.autoPagingRowsPerPage!=0&&f.TotalPagesPaging++;setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter)},500)}else{m=[];for(h=0;h<j.length;h++){for(var o=false,l=n=0;l<m.length;l++){for(var q=true,r=0;r<k.length;r++)if(j[h][k[r]]!=m[l][k[r]]){q=false;break}if(q){n=l;o=true;break}}if(o){y.length>0&&(f.formulaInfo.measureFormula[y.length-1].hasFormula||(m[n][f.dataColumnIndex]!=
"#NuN#"&&j[h][f.dataColumnIndex]!="#NuN#"?m[n][f.dataColumnIndex]=(parseFloat(m[n][f.dataColumnIndex])+parseFloat(j[h][f.dataColumnIndex])).toString():m[n][f.dataColumnIndex]=="#NuN#"&&(m[n][f.dataColumnIndex]=j[h][f.dataColumnIndex])));for(o=0;o<y.length-1;o++){l=f.rowConditions[f.rowConditions.length-y.length+1+o];f.formulaInfo.measureFormula[o].hasFormula&&f.filterIndexes.length>0||(m[n][l]=(parseFloat(m[n][l])+parseFloat(j[h][l])).toString())}}else{n=[];for(l=0;l<j[h].length;l++)n.push([j[h][l]]);
m.push([n]);for(o=0;o<y.length;o++){l=o<y.length-1?f.rowConditions[f.rowConditions.length-y.length+1+o]:f.dataColumnIndex;if(f.formulaInfo.measureFormula[o].hasFormula&&f.filterIndexes.length>0){q=f.getFormulaRowByDataRow(j[h],o,"");if(q!=f.EmptyValue&&q!="#NuN#"){q=f.calculateFormulaTotal([q],o,"MeasureInRows");isNaN(q)||(n[l]=q.toString())}}}}}f.allData=m;f.conditions=[];for(h=0;h<f.headerRow.length;h++)f.initCondition(h);for(h=0;h<f.headerRow.length;h++)f.restoreSubtotalsAndSortLayout(h)}};this.isNotFilterByTopFilter=
function(c){for(var g=0;g<f.filterIndexes.length;g++){var h=f.filterIndexes[g],j=f.filterDiv.selects[g];if(j!=void 0&&j.selectedIndex&&OAT.$v(j)!="[all]"&&OAT.$v(j)!=c[h])return false}return true};this.preGoWhenFilterByTopFilter=function(){if(f.autoPaging){collapseRowForCollapseValues(f);f.FilterByTopFilter=true;f.allData=f.GeneralDataRows;var c=f.RowsWhenMoveToFilter;k=[];var g=l=0;column=-1;value=null;for(var h=[];l<this.autoPagingRowsPerPage&&g<c.length;){if((column==-1||g<c.length&&c[g][column]!=
value)&&f.isNotFilterByTopFilter(c[g])&&!f.notInBlackList(c[g],f.conditions)){var j=f.canBeConsiderNoNew(c[g],k,h);k.push([c[g]]);j||l++}g++}f.allData=k;f.nextRowWhenAutopaging=g;f.prevRowWhenAutopaging=0;c=f.conditions;f.conditions=[];for(l=0;l<f.headerRow.length;l++)f.pseudoInitCondition(l,c);setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter)},500)}else{f.FilterByTopFilter=true;f.allData=f.GeneralDataRows;f.conditions=[];for(var l=0;l<f.headerRow.length;l++)f.initCondition(l);
for(l=0;l<f.headerRow.length;l++)f.restoreSubtotalsAndSortLayout(l)}};this.preGoWhenCollapsedValue=function(){if(!collapseRowForCollapseValues(f))return false;var c=f.RowsWhenMoveToFilter,g=[],h=0,j=0;value=null;for(var k=[];h<this.autoPagingRowsPerPage&&j<c.length;){if(!f.notInBlackList(c[j],f.conditions)){var l=f.canBeConsiderNoNew(c[j],g,k);g.push([c[j]]);l||h++}j++}f.allData=g;f.nextRowWhenAutopaging=j;f.prevRowWhenAutopaging=0;c=f.conditions;f.conditions=[];for(h=0;h<f.headerRow.length;h++)f.pseudoInitCondition(h,
c);f.TotalPagesPaging=parseInt(f.RowsWhenMoveToFilter.length/f.autoPagingRowsPerPage);f.RowsWhenMoveToFilter.length%f.autoPagingRowsPerPage!=0&&f.TotalPagesPaging++;setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter)},500);return true};this.go=function(c,g){if(k[0]!=void 0){if(!c){f.gd.clearSources();f.gd.clearTargets();f.drawTitleDiv();f.drawFilters();try{f.applyFilters();f.createAggStructure();f.fillAggStructure();f.checkAggStructure();f.count()}catch(h){}if(g===void 0||g===null||
!g){var j=f.createXMLMetadata(),l=f.QueryViewerCollection[D];l!=""&&(l!=null&&l!=void 0)&&qv.util.autorefresh.UpdateLayoutSameGroup(l,qv.pivot.GetRuntimeMetadata(j,l.RealType),true)}}j=[];for(l=0;l<f.filterDiv.selects.length;l++)j[l]=f.filterDiv.selects[l].value;if(f.firstTime)f.firstTime=false;else{j={query:f.query,conditions:f.conditions,colConditions:f.colConditions,rowConditions:f.rowConditions,filterIndexes:f.filterIndexes,filterDivSelects:j,rowsPerPage:f.rowsPerPage,version:f.rememberLayoutStateVersion};
f.deleteState?f.cleanState():f.saveState(j);f.readState=true}f.ShowMeasuresAsRows?f.drawTableWhenShowMeasuresAsRows():f.drawTable();qv.util.hideActivityIndicator(f.QueryViewerCollection[f.IdForQueryViewerCollection]);j=0;if(jQuery("#"+this.controlName+"_"+f.query+"tablePagination_rowsPerPage").length>0){j=parseInt(jQuery("#"+this.controlName+"_"+f.query+"tablePagination_rowsPerPage")[0].value);isNaN(j)||(v=j)}j={currPage:1,ignoreRows:jQuery("tbody tr[title_row=true]",jQuery("#"+this.controlName+"_"+
f.query)),optionsForRows:[10,15,20],rowsPerPage:f.rowsPerPage!="undefined"?f.rowsPerPage:50,topNav:false,controlName:this.controlName+"_"+f.query};if(!f.autoPaging&&v){OAT.tablePagination(jQuery("#"+this.controlName+"_"+f.query),j);jQuery("#"+this.controlName+"_"+f.query).css("margin-bottom","0px")}if(f.autoPaging&&f.allData.length<f.GeneralDataRows.length&&(f.filteredData.length>=f.autoPagingRowsPerPage||f.actualPaginationPage>1||f.paginationInfo&&f.paginationInfo.pages.length>1)){j={currPage:f.actualPaginationPage,
ignoreRows:jQuery("tbody tr[title_row=true]",jQuery("#"+this.controlName+"_"+f.query)),optionsForRows:[10,15,20],rowsPerPage:f.autoPagingRowsPerPage,topNav:false,controlName:this.controlName+"_"+f.query,cantPages:f.TotalPagesPaging};OAT.partialTablePagination(jQuery("#"+f.controlName+"_"+f.query),j);jQuery("#"+this.controlName+"_"+f.query).css("margin-bottom","0px")}if(!G){j=jQuery("#"+this.containerName)[0].clientWidth;jQuery("#"+this.controlName+"_"+f.query).css({width:j+"px"})}j=jQuery("#"+this.controlName+
"_"+f.query)[0].offsetWidth;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(j=j+4)}catch(m){}l=jQuery("#"+this.controlName+"_"+f.query)[0].offsetWidth-1;jQuery("#"+D+"_"+f.query+"_title_div").css({width:j+"px"});jQuery("#"+D+"_"+f.query+"_pivot_page").css({width:j+"px"});jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({width:l+"px"});jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<
jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination");setInterval(function(){jQuery("#"+f.controlName+"_"+f.query).length>0&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+f.controlName+
"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")},150);f.colConditions.length===0&&jQuery(".h2title > div").css({width:"100%"})}};this.gridCache=[];this.cleanGridCache=function(){f.gridCache=[]};this.addPageToCache=function(c,g){f.gridCache.push({page:c,data:g})};this.getPageDataFromCache=function(c){for(var g=0;g<f.gridCache.length;g++)if(f.gridCache[g].page==c)return f.gridCache[g].data;return false};this.goWhenServerPagination=
function(c,g){f.getPageDataFromCache(f.pageData.ServerPageNumber)||f.addPageToCache(f.pageData.ServerPageNumber,f.pageData.rows);if(f.pageData.ServerPageNumber!=f.pageData.PreviousPageNumber){f.QueryViewerCollection[f.IdForQueryViewerCollection].CurrentPage=f.pageData.ServerPageNumber;f.pageData.ServerPageNumber==1?typeof f.QueryViewerCollection[f.IdForQueryViewerCollection].OnFirstPage=="function"&&f.QueryViewerCollection[f.IdForQueryViewerCollection].OnFirstPage():f.pageData.ServerPageNumber==f.pageData.ServerPageCount?
typeof f.QueryViewerCollection[f.IdForQueryViewerCollection].OnLastPage=="function"&&f.QueryViewerCollection[f.IdForQueryViewerCollection].OnLastPage():f.pageData.ServerPageNumber<f.pageData.PreviousPageNumber?typeof f.QueryViewerCollection[f.IdForQueryViewerCollection].OnPreviousPage=="function"&&f.QueryViewerCollection[f.IdForQueryViewerCollection].OnPreviousPage():typeof f.QueryViewerCollection[f.IdForQueryViewerCollection].OnNextPage=="function"&&f.QueryViewerCollection[f.IdForQueryViewerCollection].OnNextPage();
f.pageData.PreviousPageNumber=f.pageData.ServerPageNumber}if(!c){f.gd.clearSources();f.gd.clearTargets();f.drawFilters();if(f.QueryViewerCollection[f.IdForQueryViewerCollection].AutoRefreshGroup!=""&&(g===void 0||g===null||!g))if(!f.firstTime||f.getState()&&f.getState().version==f.rememberLayoutStateVersion){var h;if(f.serverPagination){h=f.getMetadataXML();h=h.replace(/\&amp;/g,"&")}else h=f.createXMLMetadata();var j=f.QueryViewerCollection[f.IdForQueryViewerCollection];j!=""&&(j!=null&&j!=void 0)&&
qv.util.autorefresh.UpdateLayoutSameGroup(j,qv.pivot.GetRuntimeMetadata(h,j.RealType),true)}}h=[];for(j=0;j<f.filterDiv.selects.length;j++)h[j]=f.filterDiv.selects[j].value;if(f.firstTime)f.firstTime=false;else{h={query:f.query,conditions:f.conditions,colConditions:f.colConditions,rowConditions:f.rowConditions,filterIndexes:f.filterIndexes,filterDivSelects:h,rowsPerPage:f.rowsPerPage,AxisInfo:f.pageData.AxisInfo,FilterInfo:f.pageData.FilterInfo,version:f.rememberLayoutStateVersion,DataInfo:f.pageData.DataInfo,
NewAxisInfo:f.createNewAxisInfo(),NewDataInfo:f.createNewDataInfo()};f.deleteState?f.cleanState():f.saveState(h);f.readState=true}f.drawTableWhenServerPagination();if(f.pageData.ServerPageCount>0&&(f.pageData.ServerPageCount>1||f.pageData.rows.length>10)&&f.rowsPerPage>0){h={currPage:f.pageData.ServerPageNumber,ignoreRows:jQuery("tbody tr[title_row=true]",jQuery("#"+this.controlName+"_"+f.query)),optionsForRows:OAT.AddItemToList([10,15,20],N.RowsPerPage),rowsPerPage:f.rowsPerPage,topNav:false,controlName:this.controlName+
"_"+f.query,cantPages:f.pageData.ServerPageCount,controlUcId:D,control:f};OAT.partialTablePagination(jQuery("#"+f.controlName+"_"+f.query),h);jQuery("#"+this.controlName+"_"+f.query).css("margin-bottom","0px")}if(jQuery("#"+this.controlName+"_"+f.query).length>0&&!G){h=jQuery("#"+this.containerName)[0].clientWidth;jQuery("#"+this.controlName+"_"+f.query).css({width:h-4+"px"})}try{var k=jQuery("#"+this.controlName+"_"+f.query)[0].offsetWidth-4;jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>
-1&&(k=k+4)}catch(l){}try{var m=jQuery("#"+this.controlName+"_"+f.query)[0].offsetWidth-1;jQuery("#"+D+"_"+f.query+"_title_div").css({width:k+"px"});jQuery("#"+D+"_"+f.query+"_pivot_page").css({width:k+"px"});jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({width:m+"px"});jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.controlName+"_"+f.query+
"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")}catch(n){}f.RedrawSelectedNode();setInterval(function(){jQuery("#"+f.controlName+"_"+f.query).length>0&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+f.controlName+
"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")},150)};this.getDataForPivot=function(c,g,h,j,k,l,m,n,o,q){j&&f.cleanGridCache();if(j&&h>-1)f.rowsPerPage=h;f.pageData.PreviousPageNumber=f.pageData.ServerPageNumber;if(!j&&f.getPageDataFromCache(g)){f.pageData.ServerPageNumber=g;f.pageData.rows=f.getPageDataFromCache(f.pageData.ServerPageNumber);f.preGoWhenServerPagination(true)}else{if(k!="")f.pageData.AxisInfo=
f.createAxisInfo(k);l!=""&&f.createFilterInfo(l);f.pageData.CollapseInfo=f.CreateExpandCollapseInfo("");f.ExportTo="";if(h<0){h=0;f.ExportTo=m}c=true;if(g>1||!j)c=false;o!=void 0&&o!=""&&(c=true);f.pageData.AxisInfo=f.createAxisInfo(k);k=f.createNewAxisInfo(k);f.pageData.DataInfo=f.createDataInfo();o=f.createNewDataInfo();f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){f.pageData=OATGetNewDataFromXMLForPivot(c,f.pageData,f.ShowMeasuresAsRows,f.ExportTo);
f.preGoWhenServerPagination(q);if(f.ExportTo!=""){c=f.query;if(c==""){c="Query";try{c=f.controlName.split("_")[0]}catch(g){}}f.ExportTo=="HTML"&&f.ExportToHTMLWhenServerPagination();f.ExportTo=="PDF"&&OAT.GeneratePDFOutput(f,c);f.ExportTo=="XLS"&&f.ExportToExcel(c);f.ExportTo=="XML"&&f.ExportToXMLWhenServerPagination();f.ExportTo=="XLSX"&&f.ExportToXLSXWhenServerPagination();f.cleanGridCache()}qv.util.hideActivityIndicator(f.QueryViewerCollection[f.IdForQueryViewerCollection])}.closure(this),[g,h,
j,k,o,f.pageData.FilterInfo,f.pageData.CollapseInfo,c])}};this.CreateExpandCollapseInfo=function(){for(var c=[],g={},h=0;h<f.columns.length;h++){for(var g=-1,j=0;j<f.conditions.length;j++)f.conditions[j].dataField==f.columns[h].getAttribute("dataField")&&(g=j);if(f.conditions[g].collapsedValues.length){g={DataField:f.conditions[g].dataField,NullExpanded:true,NotNullValues:{Expanded:[],Collapsed:f.conditions[g].collapsedValues,DefaultAction:"Expand"}};c.push(g)}}return c};this.createAxisInfo=function(){for(var c=
[],g=1,h=0;h<f.initMetadata.Dimensions.length;h++){var j=-1,k="Rows",l=1,m="Ascending",n=true;if(f.initMetadata.Dimensions[h].Visible){for(m=0;m<f.conditions.length;m++)f.conditions[m].dataField==f.initMetadata.Dimensions[h].dataField&&(j=m);m=f.conditions[j].sort==1?"Ascending":"Descending";n=f.conditions[j].subtotals==1||f.conditions[j].subtotals?true:false;f.rowConditions.indexOf(j)>-1&&(l=f.rowConditions.indexOf(j)+1);if(f.colConditions.indexOf(j)>-1){k="Columns";l=f.colConditions.indexOf(j)+
1}if(f.filterIndexes.indexOf(j)>-1){k="Pages";l=f.filterIndexes.indexOf(j)+1}}else{k="Hidden";l=g;g=g+1}c.push({DataField:f.initMetadata.Dimensions[h].dataField,Order:m,Axis:{Type:k,Position:l},Subtotals:n})}return c};this.createNewAxisInfo=function(){for(var c=[],g=0,h=0,j=0,k=0,l=0,m=0,n=0;n<f.initMetadata.Dimensions.length;n++){var o=-1,q=!f.initMetadata.Dimensions[n].Visible,r="Rows",t=1,v="Ascending",u=true;if(q)if(f.initMetadata.Dimensions[n].defaultPosition!="hidden"){r=f.initMetadata.Dimensions[n].defaultPosition;
if(r=="Rows"){h=h+1;g=t=g+1}if(r=="Columns"){k=k+1;j=t=j+1}if(r=="Pages"){m=m+1;l=t=l+1}}else t=r="";else{for(v=0;v<f.conditions.length;v++)f.conditions[v].dataField==f.initMetadata.Dimensions[n].dataField&&(o=v);v=f.conditions[o].sort==1?"Ascending":"Descending";u=f.conditions[o].subtotals==1||f.conditions[o].subtotals?true:false;if(f.rowConditions.indexOf(o)>-1)if(f.changesrowposition)for(var g=t=f.rowConditions.indexOf(o)+1+h,w=0,x=true,y=f.rowConditions.indexOf(o)+1;y<f.rowConditions.length&&
x;y++){w++;if(f.rowConditions[y]<o){dataFieldRC=f.conditions[f.rowConditions[y]].dataField;for(g=0;g<c.length;g++)if(dataFieldRC==c[g].DataField)positionDF=c[g].Axis.Position;g=t=positionDF-w;x=false}}else g=t=f.rowConditions.indexOf(o)+1+h;if(f.colConditions.indexOf(o)>-1){r="Columns";j=t=f.colConditions.indexOf(o)+1+k}if(f.filterIndexes.indexOf(o)>-1){r="Pages";l=t=f.filterIndexes.indexOf(o)+1+m}}c.push({DataField:f.initMetadata.Dimensions[n].dataField,Order:v,Axis:{Type:r,Position:t},Subtotals:u,
Hidden:q})}return c};this.createDataInfo=function(){for(var c=[],g=1,h=1,j=0;j<f.initMetadata.Measures.length;j++){c.push({DataField:f.initMetadata.Measures[j].dataField,Axis:{Type:f.initMetadata.Measures[j].Visible?"Data":"Hidden",Position:f.initMetadata.Measures[j].Visible?h:g}});f.initMetadata.Measures[j].Visible?h=h+1:g=g+1}return c};this.createNewDataInfo=function(){for(var c=[],g=0;g<f.initMetadata.Measures.length;g++)c.push({DataField:f.initMetadata.Measures[g].dataField,Hidden:!f.initMetadata.Measures[g].Visible,
Position:g+1});return c};this.createFilterInfo=function(c,g){DataFieldFilter=f.conditions[c.dim].dataField;if(c.op=="all"||c.op=="pagefilter"&&c.values=="[all]"){for(var h=-1,j=0;j<f.pageData.FilterInfo.length;j++)if(DataFieldFilter==f.pageData.FilterInfo[j].DataField){h=j;break}h>-1&&f.pageData.FilterInfo.splice(h,1);f.conditions[c.dim].state="all";f.conditions[c.dim].visibles=[];f.conditions[c.dim].blackList=[];f.conditions[c.dim].defaultAction="Include"}else{if(f.conditions[c.dim].state=="none"){f.conditions[c.dim].visibles=
[];for(var k=0;k<f.conditions[c.dim].distinctValues.length;k++)f.conditions[c.dim].blackList.indexOf(f.conditions[c.dim].distinctValues[k])==-1&&f.conditions[c.dim].blackList.push(f.conditions[c.dim].distinctValues[k])}else if(f.conditions[c.dim].state=="all"){f.conditions[c.dim].blackList=[];for(k=0;k<f.conditions[c.dim].distinctValues.length;k++)f.conditions[c.dim].visibles.indexOf(f.conditions[c.dim].distinctValues[k])==-1&&f.conditions[c.dim].visibles.push(f.conditions[c.dim].distinctValues[k])}if(c.op==
"none"){f.conditions[c.dim].state="none";f.conditions[c.dim].visibles=[];f.conditions[c.dim].blackList=[];f.conditions[c.dim].defaultAction="Exclude"}else if(c.op=="push"){f.conditions[c.dim].state="";h=f.conditions[c.dim].visibles.indexOf(c.values);h>-1&&f.conditions[c.dim].visibles.splice(h,1);f.conditions[c.dim].blackList.indexOf(c.values)==-1&&f.conditions[c.dim].blackList.push(c.values)}else if(c.op=="pop"){f.conditions[c.dim].state="";f.conditions[c.dim].visibles.indexOf(c.values)==-1&&f.conditions[c.dim].visibles.push(c.values);
h=f.conditions[c.dim].blackList.indexOf(c.values);h>-1&&f.conditions[c.dim].blackList.splice(h,1)}else if(c.op=="pagefilter"){f.conditions[c.dim].state="";f.conditions[c.dim].defaultAction="Exclude";f.conditions[c.dim].visibles=[];f.conditions[c.dim].visibles.push(c.values);for(j=0;j<f.conditions[c.dim].distinctValues.length;j++){h=f.conditions[c.dim].distinctValues[j];f.conditions[c.dim].blackList.indexOf(h)==-1&&h!=c.values&&f.conditions[c.dim].blackList.push(h)}}else if(c.op=="reverse"){f.conditions[c.dim].defaultAction=
f.conditions[c.dim].defaultAction=="Include"?"Exclude":"Include";if(f.conditions[c.dim].state=="none"){h=-1;for(j=0;j<f.pageData.FilterInfo.length;j++)if(DataFieldFilter==f.pageData.FilterInfo[j].DataField){h=j;break}h>-1&&f.pageData.FilterInfo.splice(h,1);f.conditions[c.dim].state="all";f.conditions[c.dim].visibles=[];f.conditions[c.dim].blackList=[];return}if(f.conditions[c.dim].state=="all"){f.conditions[c.dim].state="none";f.conditions[c.dim].visibles=[];f.conditions[c.dim].blackList=[]}else{for(var j=
[],l=0;l<f.conditions[c.dim].visibles.length;l++)j.push(f.conditions[c.dim].visibles[l]);for(var m=[],l=0;l<f.conditions[c.dim].blackList.length;l++)m.push(f.conditions[c.dim].blackList[l]);f.conditions[c.dim].visibles=[];f.conditions[c.dim].blackList=[];for(k=0;k<f.conditions[c.dim].distinctValues.length;k++){h=f.conditions[c.dim].distinctValues[k];j.indexOf(h)==-1?f.conditions[c.dim].visibles.push(h):f.conditions[c.dim].blackList.push(h)}for(k=0;k<m.length;k++)f.conditions[c.dim].visibles.indexOf(m[k])==
-1&&f.conditions[c.dim].visibles.push(m[k]);for(k=0;k<j.length;k++)f.conditions[c.dim].blackList.indexOf(j[k])==-1&&f.conditions[c.dim].blackList.push(j[k])}}j=false;m=true;l=[];for(k=0;k<f.conditions[c.dim].visibles.length;k++)f.conditions[c.dim].visibles[k]!="#NuN#"&&l.push(f.conditions[c.dim].visibles[k]);var n=[];if(f.conditions[c.dim].state!="none"){for(k=0;k<f.conditions[c.dim].distinctValues.length;k++){h=f.conditions[c.dim].distinctValues[k];h!="#NuN#"&&l.indexOf(h)==-1&&n.push(h)}for(k=0;k<
f.conditions[c.dim].blackList.length;k++)f.conditions[c.dim].blackList[k]!="#NuN#"&&n.indexOf(f.conditions[c.dim].blackList[k])==-1&&n.push(f.conditions[c.dim].blackList[k]);l.length==0&&f.conditions[c.dim].defaultAction=="Exclude"&&(n=[])}if(c.op=="none"){m=false;l=[];n=[]}else f.conditions[c.dim].distinctValues.indexOf("#NuN#")>-1||n.indexOf(f.conditions[c.dim].blackList[k])!=-1?f.conditions[c.dim].visibles.indexOf("#NuN#")==-1&&(m=false):f.conditions[c.dim].defaultAction=="Exclude"&&(m=false);
if(f.conditions[c.dim].hasNull&&c.op!="none"){for(var h=f.defaultPicture.getAttribute("textForNullValues"),o=false,q=0,k=0;k<f.conditions[c.dim].distinctValues.length;k++)q=f.conditions[c.dim].distinctValues[k].length;for(k=0;k<f.conditions[c.dim].distinctValues.length;k++)if(f.conditions[c.dim].distinctValues[k].trimpivot()==f.defaultPicture.getAttribute("textForNullValues")){h=f.conditions[c.dim].distinctValues[k];o=true;break}if(!o)for(k=0;k<q-f.defaultPicture.getAttribute("textForNullValues").length;k++)h=
h+" ";if(m){if(l.indexOf(h)==-1){if(n.indexOf(h)!=-1){n.splice(n.indexOf(h),1);l.push(h)}else f.conditions[c.dim].defaultAction=="Exclude"&&l.push(h);if(f.conditions[c.dim].blackList.indexOf(h)!=-1){f.conditions[c.dim].blackList.splice(f.conditions[c.dim].blackList.indexOf(h),1);f.conditions[c.dim].visibles.indexOf(h)==-1&&f.conditions[c.dim].visibles.push(h)}}}else{if(n.indexOf(h)==-1){n.push(h);f.conditions[c.dim].blackList.indexOf(h)==-1&&f.conditions[c.dim].blackList.push(h)}l.indexOf(h)!=-1&&
l.splice(l.indexOf(h),1);f.conditions[c.dim].visibles.indexOf(h)!=-1&&f.conditions[c.dim].visibles.splice(f.conditions[c.dim].visibles.indexOf(h),1)}}k=f.conditions[c.dim].previousPage==f.conditions[c.dim].totalPages;q=(m||!f.conditions[c.dim].hasNull)&&n.length==0&&c.op!="none"&&c.op!="push"&&(f.conditions[c.dim].defaultAction=="Include"||k)&&!g&&c.op!="reverse";h=0;o=false;for(k=0;k<f.pageData.FilterInfo.length;k++)if(f.pageData.FilterInfo[k].DataField==DataFieldFilter){o=j=true;f.pageData.FilterInfo[k].NullIncluded=
m;f.pageData.FilterInfo[k].NotNullValues.Included=l;f.pageData.FilterInfo[k].NotNullValues.Excluded=n;f.pageData.FilterInfo[k].NotNullValues.DefaultAction=f.conditions[c.dim].defaultAction;h=k}q&&o&&f.pageData.FilterInfo.splice(h,1);if(!j&&!q){filter={DataField:DataFieldFilter,NullIncluded:m,NotNullValues:{Included:l,Excluded:n,DefaultAction:f.conditions[c.dim].defaultAction}};f.pageData.FilterInfo.push(filter)}}};this.moveToNextPage=function(){this.pageData.ServerPageNumber<this.pageData.ServerPageCount&&
this.getDataForPivot(this.UcId,this.pageData.ServerPageNumber+1,this.rowsPerPage,false,"","","","")};this.moveToFirstPage=function(){this.pageData.ServerPageNumber>1&&this.getDataForPivot(this.UcId,1,this.rowsPerPage,false,"","","","")};this.moveToLastPage=function(){this.pageData.ServerPageNumber<this.pageData.ServerPageCount&&this.getDataForPivot(this.UcId,this.pageData.ServerPageCount,this.rowsPerPage,false,"","","","")};this.moveToPreviousPage=function(){this.pageData.ServerPageNumber>1&&f.getDataForPivot(D,
this.pageData.ServerPageNumber-1,this.rowsPerPage,false,"","","","")};this.preGoWhenServerPagination=function(c){f.goWhenServerPagination(c,false)};this.readScrollValue=function(c){var g=f.conditions[c].dataField;if(!f.conditions[c].blocked){f.conditions[c].blocked=true;if(f.conditions[c].filtered){var h=f.conditions[c].searchInfo,j=h.previousPage+1;f.lastRequestValue=g;var k=h.filteredText;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(g){g=JSON.parse(g);f.appendNewFilteredValueData(g,
c,k)}.closure(this),[g,j,10,h.filteredText])}else{var j=f.conditions[c].previousPage+1;f.lastRequestValue=c;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(c){c=JSON.parse(c);f.appendNewValueData(f.lastRequestValue,c)}.closure(this),[g,j,10,""])}}};this.getValuesForColumn=function(c,g,h){var j=f.conditions[g].dataField;if(h!=""){var k=h.replace(/\\/g,"\\\\");f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(h){h=JSON.parse(h);f.changeValues(c,
j,g,h,k)}.closure(this),[j,1,10,k])}else f.resetScrollValue(c,j,g)};this.appendNewValueData=function(c,g){if(g.PageNumber>f.conditions[c].previousPage){f.conditions[c].previousPage=g.PageNumber;f.conditions[c].totalPages=g.PagesCount;var h=[];g.Null&&f.conditions[c].indexOf("#NuN#")==-1&&f.conditions[c].distinctValues.push("#NuN#");for(var j=0;j<g.NotNullValues.length;j++){var k=g.NotNullValues[j];if(f.conditions[c].distinctValues.indexOf(k)==-1){f.conditions[c].distinctValues.push(k);h.push(k)}f.conditions[c].defaultAction==
"Include"?f.conditions[c].visibles.indexOf(k)==-1&&f.conditions[c].blackList.indexOf(k)==-1&&f.conditions[c].visibles.push(k):f.conditions[c].visibles.indexOf(k)==-1&&f.conditions[c].blackList.indexOf(k)==-1&&f.conditions[c].blackList.push(k)}for(j=0;j<h.length;j++){k=true;f.conditions[c].state!="all"&&f.conditions[c].blackList.indexOf(h[j])!=-1&&(k=false);f.conditions[c].hasNull&&h[j].trimpivot()==f.defaultPicture.getAttribute("textForNullValues")||f.appendNewPairToPopUp(h[j],c,k)}}if(f.conditions[c].previousPage<
g.PagesCount)f.conditions[c].blocked=false};this.changeValues=function(c,g,h,j,k){c=jQuery("#"+c+h)[0];(g=c.value)&&(g=g.replace(/\\/g,"\\\\"));if(!((c.value||c.value=="")&&g!=k)){f.conditions[h].filtered=true;f.conditions[h].blocked=true;f.removeAllPairsFromPopUp(h,j.PagesCount>1);f.conditions[h].searchInfo.previousPage=1;f.conditions[h].searchInfo.totalPages=j.PagesCount;f.conditions[h].searchInfo.filteredText=k;for(k=0;k<j.NotNullValues.length;k++){c=j.NotNullValues[k];g=f.conditions[h].distinctValues.indexOf(c)!=
-1;f.conditions[h].distinctValues.indexOf(c)==-1&&f.conditions[h].distinctValues.push(c);(f.conditions[h].state=="all"||f.conditions[h].defaultAction=="Include"&&!g)&&f.conditions[h].visibles.indexOf(c)==-1&&f.conditions[h].blackList.indexOf(c)==-1&&f.conditions[h].visibles.push(c);g=true;f.conditions[h].state!="all"&&f.conditions[h].visibles.indexOf(c)<0&&(g=false);f.conditions[h].searchInfo.values.push(c);f.conditions[h].hasNull&&c.trimpivot()==f.defaultPicture.getAttribute("textForNullValues")||
f.appendNewPairToPopUp(c,h,g)}if(j.PagesCount>0)f.conditions[h].blocked=false}};this.resetScrollValue=function(c,g,h){f.conditions[h].filtered=false;f.conditions[h].blocked=true;f.removeAllPairsFromPopUp(h,data.PagesCount>1);for(c=0;c<f.conditions[h].distinctValues.length;c++){var g=true,j=f.conditions[h].distinctValues[c];f.conditions[h].state!="all"&&f.conditions[h].visibles.indexOf(j)<0&&(g=false);f.conditions[h].hasNull&&j.trimpivot()==f.defaultPicture.getAttribute("textForNullValues")||f.appendNewPairToPopUp(j,
h,g)}if(f.conditions[h].previousPage<f.conditions[h].totalPages)f.conditions[h].blocked=false};this.resetAllScrollValue=function(){for(var c=0;c<f.conditions.length;c++){f.conditions[c].filtered=false;f.conditions[c].blocked=true;if(f.conditions[c].previousPage<f.conditions[c].totalPages)f.conditions[c].blocked=false}};this.appendNewFilteredValueData=function(c,g,h){var j=f.conditions[g].searchInfo;if(!((h||h=="")&&j.filteredText!=h)&&c.PageNumber>j.previousPage){f.conditions[g].searchInfo.previousPage=
c.PageNumber;f.conditions[g].searchInfo.totalPages=c.PagesCount;c.Null&&f.conditions[g].distinctValues.indexOf("#NuN#")==-1&&f.conditions[g].distinctValues.push("#NuN#");for(h=0;h<c.NotNullValues.length;h++){var j=c.NotNullValues[h],k=f.conditions[g].distinctValues.indexOf(j)!=-1;f.conditions[g].distinctValues.indexOf(j)==-1&&f.conditions[g].distinctValues.push(j);f.conditions[g].defaultAction=="Include"&&!k?f.conditions[g].visibles.indexOf(j)==-1&&f.conditions[g].blackList.indexOf(j)==-1&&f.conditions[g].visibles.push(j):
f.conditions[g].visibles.indexOf(j)==-1&&f.conditions[g].blackList.indexOf(j)==-1&&f.conditions[g].blackList.push(j);k=true;f.conditions[g].state!="all"&&f.conditions[g].visibles.indexOf(j)<0&&(k=false);f.conditions[g].hasNull&&j.trimpivot()==f.defaultPicture.getAttribute("textForNullValues")||f.appendNewPairToPopUp(j,g,k)}if(f.conditions[g].searchInfo.previousPage<f.conditions[g].searchInfo.totalPages)f.conditions[g].blocked=false}};this.appendNewPairToPopUp=function(c,g,h){var j=f.dimensionPictureValue(c,
g);c=="#NuN#"&&(j=" ");j=j.replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ");if(j.length>33)var k=j.substring(32,j.length).trimpivot().length>0?"...":"",j=j.substring(0,32)+k;j=j.replace(/ /g," ")+"     ";h=function(c,g,h){var j=OAT.Dom.create("div"),k=h?"check_item_img":"uncheck_item_img";f.isSD&&(k=h?"check_item_img_small":"uncheck_item_img_small");OAT.addImageNode(j,h?"check_box":"check_box_outline_blank","");j.setAttribute("class",k);h=OAT.Dom.create("input");h.type="checkbox";h.id=g;k=OAT.Dom.create("label");
OAT.addTextNode(k,c);k.htmlFor=g;j.appendChild(k);return[j,h]}(j,"pivot_distinct_"+O,h);h[0].setAttribute("value",c);c=jQuery("#values_"+f.UcId+"_"+g)[0];c.appendChild(h[0]);c.children.length>9&&c.setAttribute("class","pivot_popup_fix");OAT.Dom.attach(h[0],"click",function(){f.DiseablePivot();var c="check_item_img",h="uncheck_item_img";if(f.isSD){c="check_item_img_small";h="uncheck_item_img_small"}var j=this.getAttribute("class")!==c,c=this.getAttribute("class")===c?h:c;jQuery(this).find("i")[0].textContent=
j?"check_box":"check_box_outline_blank";this.setAttribute("class",c);c=this.getAttribute("value");if(f.serverPagination){h="pop";j||(h="push");f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[g].dataField,{op:h,values:c,dim:g},"","");f.stateChanged=true;f.onFilteredChangedEventHandleWhenServerPagination(g);f.EneablePivot()}})};this.removeAllPairsFromPopUp=function(c,g){var h="check_item_img",j="uncheck_item_img";if(f.isSD){h="check_item_img_small";j="uncheck_item_img_small"}jQuery("#values_"+
f.UcId+"_"+c).find("."+h).remove();jQuery("#values_"+f.UcId+"_"+c).find("."+j).remove();jQuery(".last_div_popup ."+h).remove();jQuery(".last_div_popup ."+j).remove();if(g){jQuery("#values_"+f.UcId+"_"+c).removeClass("pivot_popup_auto");jQuery("#values_"+f.UcId+"_"+c).addClass("pivot_popup_fix")}else{jQuery("#values_"+f.UcId+"_"+c).removeClass("pivot_popup_fix");jQuery("#values_"+f.UcId+"_"+c).addClass("pivot_popup_auto")}};var da=!1,ca;this.onClickEventHandle=function(c){if(da){da=false;clearTimeout(ca);
var g=f.ClickHandle(c),g=g.replace(/\&/g,"&amp;");qv.pivot.onItemClickEvent(this.QueryViewerCollection[F],g,true)}else{da=true;g=300;f.QueryViewerCollection[F].ItemDoubleClick==void 0&&(g=0);ca=setTimeout(function(){da=false;var g=f.ClickHandle(c),g=g.replace(/\&/g,"&amp;");qv.pivot.onItemClickEvent(f.QueryViewerCollection[F],g,false)},g)}};this.onClickExpandCollapse=function(c){var g=jQuery(c).data("itemValue"),h=jQuery(c).data("numberMorD");jQuery(c).data("itemInfoEC");if(f.conditions[h].collapsedValues.indexOf(g)==
-1){f.conditions[h].collapsedValues.push(g);if(f.serverPagination)f.ExpandCollapseHandleWhenServerPagination(c,"collapse");else{c=f.ExpandCollapseHandle(c,"ItemCollapse");c=c.replace(/\&/g,"&amp;");qv.pivot.onItemExpandCollapseEvent(f.QueryViewerCollection[F],c,true)}}else{f.conditions[h].collapsedValues.splice(f.conditions[h].collapsedValues.indexOf(g),1);if(f.serverPagination)f.ExpandCollapseHandleWhenServerPagination(c,"expande");else{c=f.ExpandCollapseHandle(c,"ItemExpand");c=c.replace(/\&/g,
"&amp;");qv.pivot.onItemExpandCollapseEvent(f.QueryViewerCollection[F],c,false)}}if(this.autoPaging){collapseRowForCollapseValues(f);f.actualPaginationPage=1;f.changePaginationRows(1);f.go(false)}else f.serverPagination||f.go(false)};this.onDblClickEventHandle=function(c){c=f.ClickHandle(c);c=c.replace(/\&/g,"&amp;");qv.pivot.onItemClickEvent(this.QueryViewerCollection[F],c,true)};this.cleanValueForNull=function(c){if(c=="#NuN#"){c=f.defaultPicture.getAttribute("textForNullValues");return c!=void 0?
c:""}return c};this.isClickedRow=function(c,g,h,j,k,l){if(l){if(f.colConditions.indexOf(k)==-1)return true;for(g=0;g<h;g++){k=f.colConditions[g];if(c[k]!=j[k])return false}}else{if(f.rowConditions.indexOf(k)==-1)return true;for(g=0;g<h;g++){k=f.rowConditions[g];if(c[k]!=j[k])return false}}return true};this.isClickedRowMeasure=function(c,f,g){for(f=0;f<c.length;f++)if(c[f]!=void 0&&c[f]!=g[f])return false;return true};this.onClickSelectNode=function(c){var g=jQuery(c).data("itemValue"),h=jQuery(c).data("typeMorD"),
j=jQuery(c).data("numberMorD"),c=jQuery(c).data("itemInfo");f.selection.SelectedNode=[];f.SelectNodes(g,h,j,c)};this.ClickHandle=function(c){var g=jQuery(c).data("itemValue"),h=jQuery(c).data("typeMorD"),j=jQuery(c).data("numberMorD"),k=jQuery(c).data("itemInfo"),l=OAT.IsNodeSelected(c.parentElement),c='<DATA><ITEM type="'+h+'" ';if(h==="MEASURE"){c=c+'name="'+y[j].getAttribute("name")+'" ';c=c+'displayName="'+y[j].getAttribute("displayName")+'" ';c=c+'selected="'+l.toString()+'" ';c=c+'location="data">'}else{c=
c+'name="'+f.columns[j].getAttribute("name")+'" ';c=c+'displayName="'+f.columns[j].getAttribute("displayName")+'" ';c=c+'selected="'+l.toString()+'" ';c=k!=""&&(k.axis!=void 0&&k.axis=="columns"||k[4]=="columns")?c+'location="columns">':c+'location="rows">'}c=c+f.cleanValueForNull(g);l=c=c+"</ITEM><CONTEXT><RELATED>";try{if(f.serverPagination){for(var m=[],n=0;n<f.conditions.length;n++)f.conditions[n].dataField!=void 0&&m.push(f.conditions[n].dataField);for(n=0;n<y.length;n++)y[n].getAttribute("dataField")!=
void 0&&m.push(y[n].getAttribute("dataField"));f.allRowsPivot=[];f.allFullRowsPivot=[];for(var o=f.QueryViewerCollection[f.IdForQueryViewerCollection].getPivottableDataSync().split("<Record>"),n=1;n<o.length;n++){for(var q=[],r=[],t=0;t<m.length;t++){q[t]="#NuN#";var v=o[n].split("<"+m[t]+">");if(v.length>1){var u=v[1].split("</"+m[t]+">");q[t]=u[0];r[t]=q[t]}else if(o[n].indexOf("<"+m[t]+"/>")>=0){q[t]="";r[t]=""}else{q[t]="#NuN#";r[t]="#NuN#"}}if(h=="MEASURE"&&f.formulaInfo.cantFormulaMeasures&&
f.formulaInfo.measureFormula[j].hasFormula){q[j+this.columns.length]=parseFloat(q[j+this.columns.length]).toFixed(15).toString();r[j+this.columns.length]=parseFloat(r[j+this.columns.length]).toFixed(15).toString()}f.allRowsPivot.push(q);for(t=0;t<f.HideDataFilds.length;t++){v=o[n].split("<"+f.HideDataFilds[t]+">");if(v.length>1){u=v[1].split("</"+f.HideDataFilds[t]+">");r[r.length]=u[0]}else r[r.length]=o[n].indexOf("<"+f.HideDataFilds[t]+"/>")>=0?"":"#NuN#"}f.allFullRowsPivot.push(r)}o=false;if(k.row){o=
!k.row.subTotal;!o&&(k.isTotal!=void 0&&!k.isTotal)&&(o=true)}var w=k.axis!=void 0&&k.axis=="columns";w&&(o=true);if((k.row!=void 0||w)&&o){var x=k.row,z=k.cell,q=f.pageData.rows.indexOf(x),B=k.cell,C=f.pageData.columnsHeaders[B];if(w){z=k.rownumber;B=k.columnnumber;C=f.pageData.columnsHeaders[B]}for(var D=[],n=0;n<f.pageData.dataFields.length;n++)D[n]=void 0;if(k.row!=void 0)for(n=0;n<x.headers.length;n++){var F=m.indexOf(x.headers[n].dataField);if(x.headers[n]!=void 0&&x.headers[n].value!=void 0)D[F]=
x.headers[n].value}if(C!=void 0)for(n=0;n<C.subHeaders.length;n++){if(w&&k.rownumber<n)break;if(C.subHeaders[n]!=void 0){F=f.pageData.dataFields.indexOf(C.subHeaders[n].dataField);if(C.subHeaders[n].value!=void 0)D[F]=C.subHeaders[n].value}}for(n=0;n<this.columns.length;n++){var c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">',c=c+"<VALUES",H=false,G="";if(h==="MEASURE")if(D[n]!=void 0)D[n]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(D[n])+"</VALUE>":H=true;else{if(f.filterIndexes.indexOf(n)!=
-1){I=[];for(E=0;E<f.allRowsPivot.length;E++)if(I.indexOf(f.allRowsPivot[E][n])===-1&&f.filterOK(f.allRowsPivot[E])&&f.isClickedRowMeasure(D,g,f.allRowsPivot[E])){I=I.concat(f.allRowsPivot[E][n]);f.allRowsPivot[E][n]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[E][n])+"</VALUE>":H=true}}}else{I=[];for(E=0;E<f.allRowsPivot.length;E++)if(f.allRowsPivot[E][j]===g&&f.isClickedRow(D,g,z,f.allRowsPivot[E],j,w)&&I.indexOf(f.allRowsPivot[E][n])===-1&&f.filterOK(f.allRowsPivot[E])){I=I.concat(f.allRowsPivot[E][n]);
f.allRowsPivot[E][n]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[E][n])+"</VALUE>":H=true}}H&&(c=c+' Null="true"');c=c+">"+G;c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<y.length;n++){c=c+'<ITEM name="'+y[n].getAttribute("name")+'">';c=c+"<VALUES";H=false;G="";if(h==="MEASURE")if(D[n+this.columns.length]!=void 0)D[n+this.columns.length]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(D[n+this.columns.length])+"</VALUE>":H=true;else if(j==n)g!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(g)+"</VALUE>":
H=true;else{I=[];for(E=0;E<f.allRowsPivot.length;E++)parseFloat(f.allRowsPivot[E][j+this.columns.length])===parseFloat(g)&&(f.isClickedRowMeasure(D,g,f.allRowsPivot[E])&&f.filterOK(f.allRowsPivot[E])&&I.indexOf(f.allRowsPivot[E][n+this.columns.length])===-1)&&(f.allRowsPivot[E][n+this.columns.length]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[E][n+this.columns.length])+"</VALUE>":H=true)}else{I=[];for(E=0;E<f.allRowsPivot.length;E++)if(f.allRowsPivot[E][j]===g&&f.isClickedRow(D,g,z,
f.allRowsPivot[E],j,w)&&f.filterOK(f.allRowsPivot[E])&&I.indexOf(f.allRowsPivot[E][n+this.columns.length])===-1){I=I.concat(f.allRowsPivot[E][n+this.columns.length]);f.allRowsPivot[E][n+this.columns.length]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[E][n+this.columns.length])+"</VALUE>":H=true}}H&&(c=c+' Null="true"');c=c+">"+G;c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<f.HideDataFilds.length;n++){c=c+'<ITEM name="'+f.OrderFildsHidden[n]+'">';c=c+"<VALUES";H=false;G="";t=function(c,f){for(var g=
0;g<c.length;g++)if(c[g]!=void 0&&c[g]!=f[g])return false;return true};G="";if(h==="MEASURE"){I=[];for(E=0;E<f.allFullRowsPivot.length;E++)if(t(D,f.allFullRowsPivot[E])&&f.isClickedRowMeasure(D,g,f.allFullRowsPivot[E])&&f.filterOK(f.allFullRowsPivot[E])&&I.indexOf(f.allFullRowsPivot[E][n+this.columns.length+y.length])===-1){I=I.concat(f.allFullRowsPivot[E][n+this.columns.length+y.length]);f.allFullRowsPivot[E][n+this.columns.length+y.length]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(f.allFullRowsPivot[E][n+
this.columns.length+y.length])+"</VALUE>":H=true}}else{I=[];for(E=0;E<f.allFullRowsPivot.length;E++)if(f.allFullRowsPivot[E][j]===g&&f.isClickedRow(D,g,z,f.allFullRowsPivot[E],j,w)&&f.filterOK(f.allFullRowsPivot[E])&&I.indexOf(f.allFullRowsPivot[E][n+this.columns.length+y.length])===-1){I=I.concat(f.allFullRowsPivot[E][n+this.columns.length+y.length]);f.allFullRowsPivot[E][n+this.columns.length+y.length]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(f.allFullRowsPivot[E][n+this.columns.length+y.length])+
"</VALUE>":H=true}}H&&(c=c+' Null="true"');c=c+">"+G;c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k==="GrandTotal"){for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES";H=false;G="";I=[];for(E=0;E<f.allRowsPivot.length;E++)if(I.indexOf(f.allRowsPivot[E][n])===-1&&f.filterOK(f.allRowsPivot[E])){I=I.concat(f.allRowsPivot[E][n]);f.allRowsPivot[E][n]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[E][n])+"</VALUE>":H=true}H&&(c=c+' Null="true"');
c=c+">"+G;c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<f.HideDataFilds.length;n++){c=c+'<ITEM name="'+f.OrderFildsHidden[n]+'">';c=c+"<VALUES";H=false;G="";I=[];for(E=0;E<f.allFullRowsPivot.length;E++)if(I.indexOf(f.allFullRowsPivot[E][n+this.columns.length+y.length])===-1&&f.filterOK(f.allFullRowsPivot[E])){I=I.concat(f.allFullRowsPivot[E][n+this.columns.length+y.length]);f.allFullRowsPivot[E][n+this.columns.length+y.length]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(f.allFullRowsPivot[E][n+this.columns.length+
y.length])+"</VALUE>":H=true}H&&(c=c+' Null="true"');c=c+">"+G;c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<y.length;n++){c=c+'<ITEM name="'+y[n].getAttribute("name")+'">';c=c+"<VALUES";H=false;G="";I=[];for(E=0;E<f.allRowsPivot.length;E++)if(I.indexOf(f.allRowsPivot[E][n+this.columns.length])===-1&&f.filterOK(f.allRowsPivot[E])){I=I.concat(f.allRowsPivot[E][n+this.columns.length]);f.allRowsPivot[E][n+this.columns.length]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[E][n+this.columns.length])+
"</VALUE>":H=true}H&&(c=c+' Null="true"');c=c+">"+G;c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k[0]==="PtrTotals"){x=k[2];B=k[3];B>-1&&(C=f.pageData.columnsHeaders[B]);for(var w=k[4]=="columns",J=k[5],D=[],n=0;n<f.pageData.dataFields.length;n++)D[n]=void 0;if(!w)for(n=0;n<x.headers.length;n++){F=f.pageData.dataFields.indexOf(x.headers[n].dataField);if(x.headers[n]!=void 0&&x.headers[n].value!=void 0)D[F]=x.headers[n].value}if(B>-1)for(n=0;n<C.subHeaders.length;n++)if(C.subHeaders[n]!=void 0){if(w&&J<
n)break;F=f.pageData.dataFields.indexOf(C.subHeaders[n].dataField);if(C.subHeaders[n].value!=void 0)D[F]=C.subHeaders[n].value}L=[];h=[];for(n=0;n<f.allRowsPivot.length;n++)if(f.filterOK(f.allRowsPivot[n])&&f.isClickedRowMeasure(D,g,f.allRowsPivot[n])){L.push(f.allRowsPivot[n]);f.HideDataFilds.length>0&&h.push(f.allFullRowsPivot[n])}for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES";H=false;G="";I=[];for(t=0;t<L.length;t++)if(I.indexOf(L[t][n])===
-1){I=I.concat(L[t][n]);L[t][n]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(L[t][n])+"</VALUE>":H=true}H&&(c=c+' Null="true"');c=c+">"+G;c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<f.HideDataFilds.length;n++){c=c+'<ITEM name="'+f.OrderFildsHidden[n]+'">';c=c+"<VALUES";H=false;G="";I=[];for(t=0;t<L.length;t++)if(I.indexOf(L[t][n])===-1){I=I.concat(L[t][n]);h[t][n+this.columns.length+y.length]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(h[t][n+this.columns.length+y.length])+"</VALUE>":H=true}H&&(c=c+' Null="true"');
c=c+">"+G;c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<y.length;n++){c=c+'<ITEM name="'+y[n].getAttribute("name")+'">';c=c+"<VALUES";H=false;G="";I=[];for(E=0;E<L.length;E++)if(I.indexOf(L[E][n+this.columns.length])===-1){I=I.concat(L[E][n+this.columns.length]);L[E][n+this.columns.length]!="#NuN#"?G=G+"<VALUE>"+f.cleanValueForNull(L[E][n+this.columns.length])+"</VALUE>":H=true}H&&(c=c+' Null="true"');c=c+">"+G;c=c+"</VALUES>";c=c+"</ITEM>"}}}else if(k!="")if(k!="GrandTotal"&&(k[0]===void 0||k[0]!="PartialGrandTotal"&&
k[0]!="RowSubtotal"&&k[0]!="PtrTotals")){for(var q=k.row!=void 0?k.row:k[0],n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";if(h==="MEASURE")c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[q][n])+"</VALUE>";else for(var I=[],E=0;E<this.GeneralDataRows.length;E++)if(this.GeneralDataRows[E][j]===g&&f.isClickedRow(this.filteredData[q],g,j,this.GeneralDataRows[E],j)&&I.indexOf(this.GeneralDataRows[E][n])===-1&&f.filterOK(this.GeneralDataRows[E])){I=
I.concat(this.GeneralDataRows[E][n]);c=c+"<VALUE>"+f.cleanValueForNull(this.GeneralDataRows[E][n])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<y.length;n++){c=c+'<ITEM name="'+y[n].getAttribute("name")+'">';c=c+"<VALUES>";if(h==="MEASURE")c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[q][n+this.columns.length])+"</VALUE>";else{I=[];for(E=0;E<this.allDataWithoutSort.length;E++)if(this.allDataWithoutSort[E][j]===g&&f.filterOK(this.allDataWithoutSort[E])&&I.indexOf(this.allDataWithoutSort[E][n+
this.columns.length])===-1){I=I.concat(this.allDataWithoutSort[E][n+this.columns.length]);c=c+"<VALUE>"+f.cleanValueForNull(this.allDataWithoutSort[E][n+this.columns.length])+"</VALUE>"}}c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k==="GrandTotal"){for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";I=[];for(E=0;E<this.GeneralDataRows.length;E++)if(I.indexOf(this.GeneralDataRows[E][n])===-1&&f.filterOK(this.GeneralDataRows[E])){I=I.concat(this.GeneralDataRows[E][n]);
c=c+"<VALUE>"+f.cleanValueForNull(this.GeneralDataRows[E][n])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<y.length;n++){c=c+'<ITEM name="'+y[n].getAttribute("name")+'">';c=c+"<VALUES>";I=[];for(E=0;E<this.allDataWithoutSort.length;E++)if(I.indexOf(this.allDataWithoutSort[E][n+this.columns.length])===-1&&f.filterOK(this.allDataWithoutSort[E])){I=I.concat(this.allDataWithoutSort[E][n+this.columns.length]);c=c+"<VALUE>"+f.cleanValueForNull(this.allDataWithoutSort[E][n+this.columns.length])+"</VALUE>"}c=
c+"</VALUES>";c=c+"</ITEM>"}}else if(k[0]==="PartialGrandTotal"){for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[k[1][0]][n])+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}var M=[];jQuery.each(k[1],function(c,f){jQuery.inArray(f,M)===-1&&M.push(f)});for(n=0;n<y.length;n++){c=c+'<ITEM name="'+y[n].getAttribute("name")+'">';c=c+"<VALUES>";for(E=0;E<M.length;E++)c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[M[E]][n+
this.columns.length])+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k[0]==="RowSubtotal"){m=k[1].items;for(n=0;n<this.columns.length;n++){for(var c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">',c=c+"<VALUES>",t=0;t<m.length;t++)c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[m[t].row][n])+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<y.length;n++){c=c+'<ITEM name="'+y[n].getAttribute("name")+'">';c=c+"<VALUES>";for(t=0;t<m.length;t++)c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[m[t].row][n+
this.columns.length])+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k[0]==="PtrTotals"){for(var L=[],n=0;n<k[1].length;n++)for(t=0;t<k[1][n].length;t++)L.indexOf(k[1][n][t])===-1&&L.push(k[1][n][t]);for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";I=[];for(t=0;t<L.length;t++)if(I.indexOf(this.filteredData[L[t]][n])===-1){I=I.concat(this.filteredData[L[t]][n]);c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[L[t]][n])+"</VALUE>"}c=
c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<y.length;n++){c=c+'<ITEM name="'+y[n].getAttribute("name")+'">';c=c+"<VALUES>";I=[];for(E=0;E<L.length;E++)if(I.indexOf(this.filteredData[L[E]][n+this.columns.length])===-1){I=I.concat(this.filteredData[L[E]][n+this.columns.length]);c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[L[E]][n+this.columns.length])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}}}catch(N){c=l}l=c=c+"</RELATED><FILTERS>";try{for(n=0;n<f.filterIndexes.length;n++){c=c+'<ITEM name="'+this.columns[f.filterIndexes[n]].getAttribute("name")+
'" displayName="'+this.columns[f.filterIndexes[n]].getAttribute("displayName")+'">';c=c+"<VALUES>";c=c+"<VALUE>";c=f.filterDiv.selects[n].value==="[all]"?c+gx.getMessage("GXPL_QViewerJSAllOption"):c+f.cleanValueForNull(f.filterDiv.selects[n].value);c=c+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}}catch(O){c=l}return c+"</FILTERS></CONTEXT></DATA>"};this.SelectNodes=function(c,g,h,j,k,l,m){for(var n=false,o=g=="DIMENSION"?f.columns[h].getAttribute("dataField"):y[h].getAttribute("dataField"),q=0;q<jQuery("#"+
f.controlName+"_"+f.query+" tr").length&&!n;q++)for(var r=jQuery("#"+f.controlName+"_"+f.query+" tr")[q],t=0;t<r.children.length&&!n;t++){var v=jQuery(r.children[t]).data("itemValue"),u=jQuery(r.children[t]).data("typeMorD"),w=jQuery(r.children[t]).data("numberMorD"),x=jQuery(r.children[t]).data("itemInfo");if(x&&h==w&&g==u)if(j=="GrandTotal"&&x=="GrandTotal")if(OAT.IsNodeSelected(r.children[t])){if(!k){OAT.ClearSelectedNodes(jQuery("#"+f.controlName+"_"+f.query));f.selection.SelectedNode=[]}}else{k?
OAT.SetNodeBackgroundColor(r.children[t],f.selection.Color):OAT.SetSelectedNodeBackgroundColor(r.children[t],f.selection.Color,jQuery("#"+f.controlName+"_"+f.query));k||f.selection.SelectedNode.push({value:c,dataField:o,type:g,rowData:["GrandTotal"],clicked:true});if(f.selection.EntireLine){selectedCellOffset=r.children[t].offsetLeft;for(var z=f.colConditions.length>0?f.colConditions.length+1:0,x=z+1;x<jQuery("#"+f.controlName+"_"+f.query+" tr").length;x++){u=jQuery("#"+f.controlName+"_"+f.query+
" tr")[x];OAT.SelectAllRow(u,f.selection.Color)}}}else if(j[0]=="PtrTotals"&&x!="GrandTotal"&&x.length>0&&g=="MEASURE"){if(v=j[2].headers.length==x[2].headers.length&&j[3]==x[3])for(u=0;u<j[2].headers.length;u++)j[2].headers[u].value!=x[2].headers[u].value&&(v=false);if(v){n=true;if(OAT.IsNodeSelected(r.children[t])){if(!k){OAT.ClearSelectedNodes(jQuery("#"+f.controlName+"_"+f.query));f.selection.SelectedNode=[]}}else{k?OAT.SetNodeBackgroundColor(r.children[t],f.selection.Color):OAT.SetSelectedNodeBackgroundColor(r.children[t],
f.selection.Color,jQuery("#"+f.controlName+"_"+f.query));k||f.selection.SelectedNode.push({value:c,dataField:o,type:g,rowData:[j],clicked:true});if(f.selection.EntireLine)for(v=0;v<r.children.length;v++){x=jQuery(r.children[v]).data("typeMorD");u=jQuery(r.children[v]).data("itemInfo");if(x=="DIMENSION"&&u[0]!=void 0&&u[0]=="PtrTotals"){OAT.SetNodeBackgroundColor(r.children[v],f.selection.Color);OAT.SelectAllRow(r,f.selection.Color,v);selectedCellOffset=r.children[v].offsetLeft;selectedRowOffset=r.children[0].offsetLeft;
for(var w=false,C=-1,z=f.colConditions.length>0?f.colConditions.length+1:0,x=q-1;x>z&&!w;x--){var u=jQuery("#"+f.controlName+"_"+f.query+" tr")[x],B=u.children[0].offsetLeft;if(jQuery(u.children[0]).hasClass("h2subtitle")&&B<=selectedRowOffset){w=true;C=x}w||OAT.SelectAllRow(u,f.selection.Color)}for(x=C;x>=0;x--){w=jQuery("#"+f.controlName+"_"+f.query+" tr")[x];if(!jQuery(w.children[0]).hasClass("h2subtitle"))for(z=0;z<w.children.length;z++){u=parseInt(jQuery(w.children[z]).attr("rowspan"));x+u>q&&
OAT.SetNodeBackgroundColor(w.children[z],f.selection.Color)}}}}}}}else if(f.sameValue(c,v,g,h,j))if(j.cell!=void 0&&j.cell==x.cell){if(j.row!=void 0&&x.row!=void 0){v=j.row.headers.length==x.row.headers.length;for(u=0;u<j.row.headers.length;u++)j.row.headers[u].value!=x.row.headers[u].value&&(v=false);if(v){n=true;if(OAT.IsNodeSelected(r.children[t])){if(!k){OAT.ClearSelectedNodes(jQuery("#"+f.controlName+"_"+f.query));f.selection.SelectedNode=[]}}else{k?OAT.SetNodeBackgroundColor(r.children[t],f.selection.Color):
OAT.SetSelectedNodeBackgroundColor(r.children[t],f.selection.Color,jQuery("#"+f.controlName+"_"+f.query));k||f.selection.SelectedNode.push({value:c,dataField:o,type:g,rowData:[f.createDataRowFromItem(x,g)],clicked:true});if(f.selection.EntireLine){OAT.SelectAllRow(r,f.selection.Color,t);for(x=q-1;x>=0;x--){w=jQuery("#"+f.controlName+"_"+f.query+" tr")[x];for(z=0;z<w.children.length;z++){u=parseInt(jQuery(w.children[z]).attr("rowspan"));x+u>q&&OAT.SetNodeBackgroundColor(w.children[z],f.selection.Color)}}x=
parseInt(jQuery(r.children[t]).attr("rowspan"));if(x>=1){for(v=q+1;v<q+x;v++){u=jQuery("#"+f.controlName+"_"+f.query+" tr")[v];OAT.SelectAllRow(u,f.selection.Color)}v=q+x;u=jQuery("#"+f.controlName+"_"+f.query+" tr")[v];if(u!=void 0&&jQuery(u.children[0]).hasClass("h2subtitle")&&!jQuery(u.children[0]).hasClass("grandtotaltitle")){selectedCellOffset=r.children[t].offsetLeft;rowOffset=u.children[0].offsetLeft;rowOffset==selectedCellOffset&&OAT.SelectAllRow(u,f.selection.Color)}}if(f.colConditions.length>
0&&g=="MEASURE"){selectedCellOffset=r.children[t].offsetLeft;for(x=1;x<jQuery("#"+f.controlName+"_"+f.query+" tr").length;x++)if(x!=q){w=false;u=jQuery("#"+f.controlName+"_"+f.query+" tr")[x];for(v=0;v<u.children.length&&!w;v++){z=u.children[v].offsetLeft+u.children[v].offsetWidth;if(z>selectedCellOffset+1){w=true;OAT.SetNodeBackgroundColor(u.children[v],f.selection.Color)}}}}}}}}}else if(j[0]=="PtrTotals"&&j[1]==x[1]&&g=="DIMENSION"){if(v=j[2].headers.length==x[2].headers.length&&j[3]==x[3])for(u=
0;u<j[2].headers.length;u++)j[2].headers[u].value!=x[2].headers[u].value&&(v=false);if(v){n=true;if(OAT.IsNodeSelected(r.children[t])){if(!k){OAT.ClearSelectedNodes(jQuery("#"+f.controlName+"_"+f.query));f.selection.SelectedNode=[]}}else{OAT.ClearSelectedNodes(jQuery("#"+f.controlName+"_"+f.query));k?OAT.SetNodeBackgroundColor(r.children[t],f.selection.Color):OAT.SetSelectedNodeBackgroundColor(r.children[t],f.selection.Color,jQuery("#"+f.controlName+"_"+f.query));k||f.selection.SelectedNode.push({value:c,
dataField:o,type:g,rowData:[j],clicked:true});if(f.selection.EntireLine){OAT.SelectAllRow(r,f.selection.Color,t);selectedCellOffset=r.children[t].offsetLeft;selectedRowOffset=r.children[0].offsetLeft;w=false;C=-1;z=f.colConditions.length>0?f.colConditions.length+1:0;for(x=q-1;x>z&&!w;x--){u=jQuery("#"+f.controlName+"_"+f.query+" tr")[x];B=u.children[0].offsetLeft;if(jQuery(u.children[0]).hasClass("h2subtitle")&&B<=selectedRowOffset){w=true;C=x}w||OAT.SelectAllRow(u,f.selection.Color)}for(x=C;x>=0;x--){w=
jQuery("#"+f.controlName+"_"+f.query+" tr")[x];if(!jQuery(w.children[0]).hasClass("h2subtitle"))for(z=0;z<w.children.length;z++){u=parseInt(jQuery(w.children[z]).attr("rowspan"));x+u>q&&OAT.SetNodeBackgroundColor(w.children[z],f.selection.Color)}}}}}}else if(j=="EventSelection"&&f.sameValue(c,v,g,h,j)&&!jQuery(r.children[0]).hasClass("h2subtitle")&&(!jQuery(r.children[t]).hasClass("gtotal")&&!jQuery(r.children[t]).hasClass("subtotal"))&&f.checkConditions(m,x)){OAT.SetNodeBackgroundColor(r.children[t],
f.selection.Color,jQuery("#"+f.controlName+"_"+f.query));f.selection.SelectedNode.length<=l?f.selection.SelectedNode.push({value:c,dataField:o,type:g,rowData:[f.createDataRowFromItem(x,g)],clicked:false}):f.selection.SelectedNode[l].rowData.push(f.createDataRowFromItem(x,g));if(f.selection.EntireLine){OAT.SelectAllRow(r,f.selection.Color,t);for(x=q-1;x>0;x--){v=jQuery("#"+f.controlName+"_"+f.query+" tr")[x];for(w=0;w<v.children.length;w++){u=parseInt(jQuery(v.children[w]).attr("rowspan"));x+u>q&&
OAT.SetNodeBackgroundColor(v.children[w],f.selection.Color)}}v=parseInt(jQuery(r.children[t]).attr("rowspan"));if(v>=1){for(x=q+1;x<q+v;x++)OAT.SelectAllRow(jQuery("#"+f.controlName+"_"+f.query+" tr")[x],f.selection.Color);x=q+v;v=jQuery("#"+f.controlName+"_"+f.query+" tr")[x];if(v!=void 0&&jQuery(v.children[0]).hasClass("h2subtitle")&&!jQuery(v.children[0]).hasClass("grandtotaltitle")){selectedCellOffset=r.children[t].offsetLeft;rowOffset=v.children[0].offsetLeft;rowOffset==selectedCellOffset&&OAT.SelectAllRow(v,
f.selection.Color)}}if(f.colConditions.length>0&&g=="MEASURE"){selectedCellOffset=r.children[t].offsetLeft;for(x=1;x<jQuery("#"+f.controlName+"_"+f.query+" tr").length;x++)if(x!=q){w=false;u=jQuery("#"+f.controlName+"_"+f.query+" tr")[x];for(v=0;v<u.children.length&&!w;v++){z=u.children[v].offsetLeft+u.children[v].offsetWidth;if(z>selectedCellOffset){w=true;OAT.SetNodeBackgroundColor(u.children[v],f.selection.Color)}}}}}}}};this.getRowInitialShift=function(c,f){for(var g=0,h=f-1;h>=0;h--)for(var j=
c[h],k=0;k<j.children.length;k++){var l=parseInt(jQuery(j.children[k]).attr("rowspan"));h+l>f&&(g=g+1)}return g};this.getCellPositionSpanWithSpans=function(c,f,g){for(var c=c[f],f=0,h=g,j=0,k=0;k<c.children.length&&f<g;k++){var l=parseInt(jQuery(c.children[k]).attr("colspan"));if(l>1){h<l?h=h-l:(h=h-l,j=j+1);f=f+l}else{f=f+1;j=j+1}}return j};this.RedrawSelectedNode=function(){if(f.selection.SelectedNode)for(var c=0;c<f.selection.SelectedNode.length;c++){var g;if(f.selection.SelectedNode[c].type==
"DIMENSION")for(var h=0;h<f.columns.length;h++)f.selection.SelectedNode[c].dataField==f.columns[h].getAttribute("dataField")&&(g=h);else for(h=0;h<y.length;h++)f.selection.SelectedNode[c].dataField==y[h].getAttribute("dataField")&&(g=h);if(f.selection.SelectedNode[c].rowData[0]=="GrandTotal")f.SelectNodes(f.selection.SelectedNode[c].value,f.selection.SelectedNode[c].type,g,"GrandTotal",true);else if(f.selection.SelectedNode[c].rowData[0].length>0&&f.selection.SelectedNode[c].rowData[0][0]=="PtrTotals")f.SelectNodes(f.selection.SelectedNode[c].value,
f.selection.SelectedNode[c].type,g,f.selection.SelectedNode[c].rowData[0],true);else for(h=0;h<jQuery("#"+f.controlName+"_"+f.query+" tr").length;h++)for(var j=jQuery("#"+f.controlName+"_"+f.query+" tr")[h],k=0;k<j.children.length;k++){var l=jQuery(j.children[k]).data("itemValue"),m=jQuery(j.children[k]).data("typeMorD"),n=jQuery(j.children[k]).data("numberMorD"),o=jQuery(j.children[k]).data("itemInfo");if(f.sameValue(f.selection.SelectedNode[c].value,l,f.selection.SelectedNode[c].type,g,o)&&(g==
n&&f.selection.SelectedNode[c].type==m)&&o.row!=void 0){l=f.createDataRowFromItem(o,m);for(m=0;m<f.selection.SelectedNode[c].rowData.length;m++){for(var n=true,q=0;q<f.selection.SelectedNode[c].rowData[m].length;q++)f.selection.SelectedNode[c].rowData[m][q]!=void 0&&l[q]!=void 0&&!(f.filterIndexes.indexOf(q)>-1)&&!(f.colConditions.indexOf(q)>-1)&&f.selection.SelectedNode[c].rowData[m][q]!="[all]"&&(l[q]!="[all]"&&f.selection.SelectedNode[c].rowData[m][q].trim()!=l[q].trim())&&(n=false);n&&f.SelectNodes(f.selection.SelectedNode[c].value,
f.selection.SelectedNode[c].type,g,o,true,c)}}}}};this.sameValue=function(c,g,h,j,k){try{var l=false;if(g!=void 0){var m=h=="DIMENSION"?f.columns[j].getAttribute("dataType"):y[j].getAttribute("dataType");if(m=="real"||m=="integer"){l=parseFloat(c)==parseFloat(g);if(!l&&h=="DIMENSION"&&k[0]!=void 0&&k[0]=="PtrTotals"&&c.trim()==g.trim())return true}else l=c.trim()==g.trim()}return l}catch(n){return false}};this.checkConditions=function(c,g){for(var h=0;h<c.length;h++){if(!g.row||!g.row.headers)return false;
for(var j=0;j<g.row.headers.length;j++)if(g.row.headers[j].dataField==c[h].DataField){for(var k,l=0;l<f.columns.length;l++)g.row.headers[j].dataField==f.columns[l].getAttribute("dataField")&&(k=l);if(!f.sameValue(c[h].Value,g.row.headers[j].value,"DIMENSION",k,g))return false}for(j=0;j<g.row.cells.length;j++){for(var m,l=0;l<y.length;l++)if(g.row.cells[j].dataField==y[l].getAttribute("dataField")){k=l;m=y[l].getAttribute("name")}if(m==c[h].Name&&!f.sameValue(c[h].Value,g.row.cells[j].value,"MEASURE",
k,g))return false}}return true};this.selectValue=function(c){OAT.ClearSelectedNodes(jQuery("#"+f.controlName+"_"+f.query));f.selection.SelectedNode=[];for(var g=-2,h=-2,j,k,l=0;l<c.length;l++){for(var m,n,o=0;o<y.length;o++)if(c[l].Name==y[o].getAttribute("name")){m="MEASURE";n=o}for(o=0;o<f.columns.length;o++)if(c[l].Name==f.columns[o].getAttribute("name")){m="DIMENSION";n=o}if(f.rowConditions.indexOf(n)>=h){g=l;h=f.rowConditions.indexOf(n);j=m;k=n}}f.SelectNodes(c[g].Value,j,k,"EventSelection",
false,0,c)};this.deselectValue=function(){OAT.ClearSelectedNodes(jQuery("#"+f.controlName+"_"+f.query));f.selection.SelectedNode=[]};this.createDataRowFromItem=function(c,g){var h=c.row;f.pageData.rows.indexOf(h);for(var j=f.pageData.columnsHeaders[c.cell],k=[],l=0;l<f.pageData.dataFields.length;l++)k[l]=void 0;if(h!=void 0&&h.headers!=void 0)for(l=0;l<h.headers.length;l++){var m=f.pageData.dataFields.indexOf(h.headers[l].dataField);if(h.headers[l]!=void 0&&h.headers[l].value!=void 0)k[m]=h.headers[l].value}if(g!=
"DIMENSION"&&j!=void 0)for(l=0;l<j.subHeaders.length;l++)if(j.subHeaders[l]!=void 0){m=f.pageData.dataFields.indexOf(j.subHeaders[l].dataField);if(j.subHeaders[l].value!=void 0)k[m]=j.subHeaders[l].value}for(l=0;l<f.filterIndexes.length;l++)k[f.filterIndexes[l]]=f.filterDiv.selects[l].value;return k};this.ExpandCollapseHandle=function(c,g){var h=jQuery(c).data("itemValue");jQuery(c).data("typeMorD");var j=jQuery(c).data("numberMorD"),k=jQuery(c).data("itemInfo"),l;l='<DATA event="'+g+'"><ITEM name="'+
H[j].getAttribute("name")+'" ';l=l+'displayName="'+H[j].getAttribute("displayName")+'" ';l=l+">"+f.cleanValueForNull(h);h=l=l+"</ITEM><CONTEXT><EXPANDEDVALUES>";try{if(k!="")for(var k=[],m=0;m<this.GeneralDataRows.length;m++)if(k.indexOf(this.GeneralDataRows[m][j])==-1){k=k.concat(this.GeneralDataRows[m][j]);f.conditions[j].collapsedValues.indexOf(this.GeneralDataRows[m][j])===-1&&(l=l+"<VALUE>"+f.cleanValueForNull(this.GeneralDataRows[m][j])+"</VALUE>")}}catch(n){l=h}return l+"</EXPANDEDVALUES></CONTEXT></DATA>"};
this.ExpandCollapseHandleWhenServerPagination=function(c,g){if(typeof f.QueryViewerCollection[F].ItemExpand=="function"||qv.util.isGeneXusPreview()){var h=jQuery(c).data("numberMorD");if(f.conditions[h].previousPage>=f.conditions[h].totalPages){h=f.ExpandCollapseHandleWhenServerPaginationCreateXML(c,g);h=h.replace(/\&/g,"&amp;");qv.pivot.onItemExpandCollapseEvent(f.QueryViewerCollection[F],h,g=="collapse");f.getDataForPivot(f.UcId,f.pageData.ServerPageNumber,f.rowsPerPage,true,"","","","",true)}else{f.lastColumnNumber=
h;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(h){var h=JSON.parse(h),j=f.lastColumnNumber;f.conditions[j].previousPage=h.PageNumber;f.conditions[j].totalPages=h.PagesCount;f.conditions[j].blocked=true;if(h.Null&&!f.conditions[j].hasNull){f.conditions[j].hasNull=true;f.conditions[j].distinctValues.indexOf("#NuN#")==-1&&f.conditions[j].distinctValues.push("#NuN#");f.conditions[j].defaultAction=="Include"?f.conditions[j].visibles.indexOf("#NuN#")==-1&&f.conditions[j].visibles.push("#NuN#"):
f.conditions[j].blackList.indexOf("#NuN#")==-1&&f.conditions[j].blackList.push("#NuN#")}for(var k=0;k<h.NotNullValues.length;k++){var l=h.NotNullValues[k];if(f.conditions[j].distinctValues.indexOf(l)==-1){f.conditions[j].distinctValues.push(l);f.conditions[j].defaultAction=="Include"&&f.conditions[j].visibles.indexOf(l)==-1&&f.conditions[j].visibles.push(l);f.conditions[j].state=="Exclude"&&f.conditions[j].blackList.indexOf(l)==-1&&f.conditions[j].blackList.push(l)}}var m=f.ExpandCollapseHandleWhenServerPaginationCreateXML(c,
g),m=m.replace(/\&/g,"&amp;");f.getDataForPivot(f.UcId,f.pageData.ServerPageNumber,f.rowsPerPage,true,"","","","",true);setTimeout(function(){qv.pivot.onItemExpandCollapseEvent(f.QueryViewerCollection[F],m,g=="collapse")},2E3)}.closure(this),[f.columns[h].getAttribute("dataField"),1,0,""])}}else f.getDataForPivot(f.UcId,f.pageData.ServerPageNumber,f.rowsPerPage,true,"","","","",true)};this.ExpandCollapseHandleWhenServerPaginationCreateXML=function(c,g){var h=jQuery(c).data("itemValue");jQuery(c).data("typeMorD");
var j=jQuery(c).data("numberMorD");jQuery(c).data("itemInfo");actionName='event="ItemExpand"';g=="collapse"&&(actionName='event="ItemCollapse"');for(var k="<DATA "+actionName+"><ITEM ",k=k+'name="'+H[j].getAttribute("name")+'" ',k=k+'displayName="'+H[j].getAttribute("displayName")+'" ',k=k+">"+h+"</ITEM><CONTEXT><EXPANDEDVALUES>",h=0;h<f.conditions[j].distinctValues.length;h++)f.conditions[j].collapsedValues.indexOf(f.conditions[j].distinctValues[h])==-1&&(k=k+"<VALUE>"+f.conditions[j].distinctValues[h]+
"</VALUE>");return k+"</EXPANDEDVALUES></CONTEXT></DATA>"};this.onFilteredChangedEventHandle=function(c){for(var g='<DATA event="FilterChanged" name="'+this.columns[c].getAttribute("name")+'" displayName="'+this.columns[c].getAttribute("displayName")+'">',h=0;h<f.conditions[c].distinctValues.length;h++){var j=f.conditions[c].distinctValues[h];if(f.conditions[c].blackList.indexOf(j)==-1&&f.valueIsShowed(j,c)||f.conditions[c].blackList.indexOf(j)==-1)g=g+"<VALUE>"+j+"</VALUE>"}g=g+"</DATA>";qv.util.isGeneXusPreview()&&
window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,g);if(this.QueryViewerCollection[F].FilterChanged){g=g.replace(/\&/g,"&amp;");h=qv.util.dom.xmlDocument(g);c=qv.util.dom.selectXPathNode(h,"/DATA");this.QueryViewerCollection[F].FilterChangedData={};this.QueryViewerCollection[F].FilterChangedData.Name=c.getAttribute("name");this.QueryViewerCollection[F].FilterChangedData.SelectedValues=[];g=-1;for(h=0;h<c.childNodes.length;h++)if(c.childNodes[h].nodeName=="VALUE"){g++;
this.QueryViewerCollection[F].FilterChangedData.SelectedValues[g]=c.childNodes[h].firstChild.nodeValue}this.QueryViewerCollection[F].FilterChanged()}};this.onFilteredChangedEventHandleWhenServerPagination=function(c){if(f.QueryViewerCollection[F].FilterChanged||qv.util.isGeneXusPreview())if(f.conditions[c].previousPage>=f.conditions[c].totalPages)f.onFilteredChangedEventHandleWhenServerPaginationCreateXML(c,f.conditions[c].distinctValues,f.conditions[c].blackList);else{f.lastColumnNumber=c;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(g){setTimeout(function(){var h=
JSON.parse(g);f.onFilteredChangedEventHandleWhenServerPaginationCreateXML(f.lastColumnNumber,h.NotNullValues,f.conditions[c].blackList)},200)}.closure(this),[f.columns[c].getAttribute("dataField"),1,0,""])}};this.onFilteredChangedEventHandleWhenServerPaginationCreateXML=function(c,g){for(var h='<DATA event="FilterChanged" name="'+f.columns[c].getAttribute("name")+'" displayName="'+f.columns[c].getAttribute("displayName")+'">',j=0;j<g.length;j++){var k=g[j],l=true;f.conditions[c].state=="all"?l=true:
f.conditions[c].state=="none"?l=false:f.conditions[c].blackList.indexOf(k)!=-1?l=false:g.indexOf(k)!=-1?l=true:f.conditions[c].defaultAction=="Exclude"&&(l=false);l&&(h=h+"<VALUE>"+k+"</VALUE>")}h=h+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,h);if(f.QueryViewerCollection[F].FilterChanged){h=h.replace(/\&/g,"&amp;");j=qv.util.dom.xmlDocument(h);h=qv.util.dom.selectXPathNode(j,"/DATA");f.QueryViewerCollection[F].FilterChangedData=
{};f.QueryViewerCollection[F].FilterChangedData.Name=h.getAttribute("name");f.QueryViewerCollection[F].FilterChangedData.SelectedValues=[];k=-1;for(j=0;j<h.childNodes.length;j++)if(h.childNodes[j].nodeName=="VALUE"){k++;f.QueryViewerCollection[F].FilterChangedData.SelectedValues[k]=h.childNodes[j].firstChild.nodeValue}f.QueryViewerCollection[F].FilterChanged()}};this.onDragUndDrop=function(c,g){for(var h='<DATA name="'+f.columns[c].getAttribute("name")+'" displayName="'+f.columns[c].getAttribute("displayName")+
'">',j=0;j<g.length;j++){var k=g[j],l=true;f.conditions[c].state=="all"?l=true:f.conditions[c].state=="none"?l=true:f.conditions[c].defaultAction=="Exclude"&&(l=false);l&&(h=h+"<VALUE>"+k+"</VALUE>")}(h+"</DATA>").replace(/\&/g,"&amp;");for(j=0;j<Node.children.length;j++)if(Node.childNodes[j].nodeName=="VALUE"){valueIndex++;f.QueryViewerCollection[F].FilterChangedData.SelectedValues[valuesIndex]=Node.childNodes[j].firstChild.nodeValues}f.QueryViewerCollection[F].FilterChanged()};this.onDragundDropEventHandle=
function(c,f,g){c='<DATA event="DragAndDrop" name="'+this.columns[c].getAttribute("name")+'" displayName="'+this.columns[c].getAttribute("displayName")+'" axis="'+f+'"  position="'+(g+1)+'" />';try{c=c.replace(/\&/g,"&amp;");qv.pivot.onOAT_PIVOTDragAndDropEvent(this.QueryViewerCollection[F],c)}catch(h){}};this.pivotStateChanged=function(){if(f.serverPagination){for(var c=0;c<f.pageData.AxisInfo.length;c++)if(f.pageData.AxisInfo[c].Axis.Type!=f.initState.AxisInfo[c].Axis.Type)return true;for(c=0;c<
f.pageData.DataInfo.length;c++)if(f.pageData.DataInfo[c].Axis.Type!=f.initState.DataInfo[c].Axis.Type)return true;if(f.initState.CollapseInfo.length!=f.pageData.CollapseInfo.length)return true;var c=JSON.stringify(f.initState.CollapseInfo),g=JSON.stringify(f.pageData.CollapseInfo);if(c!=g)return true}else for(var h=0;h<f.initState.conditions.length;h++)if(f.initState.conditions[h]){c=JSON.stringify(f.initState.conditions[h].collapsedValues);g=JSON.stringify(f.conditions[h].collapsedValues);if(c!=
g)return true}return false};f.autoPaging&&0<f.colConditions.length&&(k=f.rowsForBlankCells(k));if(f.serverPagination)f.initWhenServerPagination();else if(f.init(),f.autoPaging||16>=f.rowConditions.length||1200>=f.GeneralDataRows.length)if(0<f.filterIndexes.length){f.preGoWhenMoveTopFilter(f.filterIndexes[0],!0);f.stateChanged=!0;if(f.tempBlackLists&&!f.autoPaging)for(O=0;O<f.conditions.length;O++)if(f.conditions[O]&&(f.tempBlackLists[O]&&(f.conditions[O].blackList=f.tempBlackLists[O]),f.tempCollapsedValues[O]))f.conditions[O].collapsedValues=
f.tempCollapsedValues[O];try{if(0<f.oldSortValues.length)for(c=0;c<f.conditions.length;c++)f.conditions[c]&&(f.conditions[c].sort=f.oldSortValues[c],f.sort(f.conditions[c]))}catch(fa){}f.go(!1)}else f.autoPaging?f.preGoWhenCollapsedValue()?f.go(!1):f.preGo(!1,null,null,-1,!0):f.go(!0);else setTimeout(function(){if(f.filterIndexes.length>0){f.preGoWhenMoveTopFilter(f.filterIndexes[0],true);f.stateChanged=true;if(f.tempBlackLists&&!f.autoPaging)for(var c=0;c<f.conditions.length;c++)if(f.conditions[c]){if(f.tempBlackLists[c])f.conditions[c].blackList=
f.tempBlackLists[c];if(f.tempCollapsedValues[c])f.conditions[c].collapsedValues=f.tempCollapsedValues[c]}try{if(f.oldSortValues.length>0)for(c=0;c<f.conditions.length;c++)if(f.conditions[c]){f.conditions[c].sort=f.oldSortValues[c];f.sort(f.conditions[c])}}catch(g){}f.go(false)}else f.autoPaging?f.preGoWhenCollapsedValue()?f.go(false):f.preGo(false,null,null,-1,true):f.go(true)},500)};try{OAT.Loader.featureLoaded("pivot")}catch(ERROR$$27){}var sortUnidimensionalArray=function(c,g,h){for(var j=function(c,
g){return c==g?0:1*(parseInt(c)>parseInt(g)?1:-1)},k=function(c,g){return c==g?0:1*(c>g?1:-1)},l=!0,n=0;n<c.length;n++)l&&c[n]!=parseInt(c[n])&&(l=!1);c.sort(l?j:k);for(j=0;j<h.columns[g].childNodes.length;j++)if(void 0!=h.columns[g].childNodes[j]&&void 0!=h.columns[g].childNodes[j].localName&&"customOrder"===h.columns[g].childNodes[j].localName){c=[];for(k=0;k<h.columns[g].childNodes[j].childNodes.length;k++)"Value"==h.columns[g].childNodes[j].childNodes[k].localName&&c.push(h.columns[g].childNodes[j].childNodes[k].textContent)}return c},
fillGeneralDistinctValues=function(c,g,h){g.GeneralDistinctValues=[];for(var j=0;j<c;j++){for(var k=[],l=0;l<h.length;l++)void 0==h[l][j]?-1==k.indexOf(" ")&&k.push(" "):-1==k.indexOf(h[l][j])&&k.push(h[l][j]);g.GeneralDistinctValues[j]=sortUnidimensionalArray(k,j,g)}},fromUndefinedToBlanck=function(c){for(var g=0;g<c.length;g++)for(var h=0;h<c[g].length;h++)void 0==c[g][h]&&(c[g][h]=" ")},sumGrandPagingTotals=function(c,g,h,j,k){for(var l=c[0].length-h,g=[],n=0;n<h;n++)if(j.measureFormula[n].hasFormula){g[n]=
[];for(var o=0;o<k.formulaInfo.recordDataLength;o++)g[n][o]=0}else g[n]=0;for(var m=!0,n=0;n<c.length;n++)if(k.isNotFilterByTopFilter(c[n])&&!k.notInBlackList(c[n],k.conditions)){for(o=0;o<h;o++)j.measureFormula[o].hasFormula||("#NuN#"!=c[n][l+o]&&"#NuN#"!=g[o]?g[o]+=parseFloat(c[n][l+o]):m&&"#NuN#"==c[n][l+o]?g[o]="#NuN#":"#NuN#"==g[o]&&"#NuN#"!=c[n][l+o]&&(g[o]=parseFloat(c[n][l+o])));m=!1}for(c=0;c<h;c++)if(j.measureFormula[c].hasFormula)for(n=0;n<k.recordForFormula.length;n++)for(o=0;o<k.formulaInfo.measureFormula[c].relatedMeasures.length;o++)l=
k.formulaInfo.measureFormula[c].relatedMeasures[o],isNaN(parseFloat(k.recordForFormula[n][l]))||(g[c][l]+=parseFloat(k.recordForFormula[n][l]));for(c=0;c<h;c++)j.measureFormula[c].hasFormula&&(g[c]=k.calculateFormulaTotal([g[c]],c,"MeasureInRows"));return g},notInBlackListB=function(c,g){for(var h=!1,j=0;j<c.length;j++)void 0!=g[j]&&(void 0!=g[j].blackList&&-1!=g[j].blackList.indexOf(c[j]))&&(h=!0);return h},getDataRowFromItem=function(c){for(var g=[];0<c.depth;)g=[c.value].concat(g),c=c.parent;return g=
[c.value].concat(g)},getTotalsForDataRow=function(c,g,h,j,k,l,n,o){for(var m=c[0].length-h,j=[],r=0;r<h;r++)j[r]=0;for(var r=[],t=0;t<k.length;t++)r[t]=k[t];r.sort();for(k=0;k<r.length;k++)r[k]<g.length&&("[all]"==n[k].value?g.splice(r[k],0,"#-#!"):g.splice(r[k],0,n[k].value));n=!1;k=!0;for(r=0;r<c.length;r++)if(o.isNotFilterByTopFilter(c[r])&&!o.notInBlackList(c[r],o.conditions)){for(var t=!0,u=0;u<g.length&&!(c[r][u]!=g[u]&&"#-#!"!=g[u]&&(t=!1),!t);u++);if(t){n||(n=belongToCollection(c[r],l));for(t=
0;t<h;t++)"#NuN#"!=c[r][m+t]&&"#NuN#"!=j[t]?j[t]+=parseFloat(c[r][m+t]):k&&"#NuN#"==c[r][m+t]?j[t]="#NuN#":"#NuN#"==j[t]&&"#NuN#"!=c[r][m+t]&&(j[t]=parseFloat(c[r][m+t]));k=!1}}try{for(c=0;c<h;c++)if(o.formulaInfo.measureFormula[c].hasFormula){var v=o.getFormulaRowByDataRow(g,c,"");j[c]=o.calculateFormulaTotal([v],c,"MesaureAsColumn")}}catch(x){}return!n?!1:j},belongToCollection=function(c,g){for(var h=0;h<g.length;h++){for(var j=!0,k=0;k<c.length-measures.length&&!(g[h][k]!=c[k]&&(j=!1),!j);k++);
if(j)return!0}return!1},removeExtraRows=function(c,g,h){var j=1,k=c[0][0];0<c[0].length-0-1&&(j=1+j);for(var l=[],n=0;n<c.length&&!(k==c[n][0]?(l.push([c[n]]),0===c[0].length-g-0-1&&(j+=1)):(j=1+j,k=c[n][0],0<c[0].length-g-1&&(j+=getTrueCantRows(l,1,g)),l=[],l.push([c[n]])),j>h);n++);0<c[0].length-g-0-1&&getTrueCantRows(l,1,g);return n},collapseRowForCollapseValues=function(c){c.paginationInfo=!1;if(0<c.filterIndexes.length){c.FilterByTopFilter=!0;for(var g=c.allData=c.GeneralDataRows,h=[],j=0;j<
c.columns.length;j++)if(-1==c.filterIndexes.indexOf(j))h.push(j);else{var k=c.filterIndexes.indexOf(j),k=c.filterDiv.selects[k];void 0!=k&&"[all]"!=OAT.$v(k)&&h.push(j)}k=[];for(j=0;j<g.length;j++){for(var l=!1,n=0,o=0;o<k.length;o++){for(var m=!0,r=0;r<h.length;r++)if(g[j][h[r]]!=k[o][h[r]]){m=!1;break}if(m){n=o;l=!0;break}}if(l){0<measures.length&&(c.formulaInfo.measureFormula[measures.length-1].hasFormula||("#NuN#"!=k[n][c.dataColumnIndex]&&"#NuN#"!=g[j][c.dataColumnIndex]?k[n][c.dataColumnIndex]=
(parseFloat(k[n][c.dataColumnIndex])+parseFloat(g[j][c.dataColumnIndex])).toString():"#NuN#"==k[n][c.dataColumnIndex]&&(k[n][c.dataColumnIndex]=g[j][c.dataColumnIndex])));for(l=0;l<measures.length-1;l++)o=c.rowConditions[c.rowConditions.length-measures.length+1+l],c.formulaInfo.measureFormula[l].hasFormula&&0<c.filterIndexes.length||(k[n][o]=(parseFloat(k[n][o])+parseFloat(g[j][o])).toString())}else{n=[];for(l=0;l<g[j].length;l++)n.push([g[j][l]]);k.push([n]);for(l=0;l<measures.length;l++)o=l<measures.length-
1?c.rowConditions[c.rowConditions.length-measures.length+1+l]:c.dataColumnIndex,c.formulaInfo.measureFormula[l].hasFormula&&0<c.filterIndexes.length&&(m=c.getFormulaRowByDataRow(g[j],l,""),m!=c.EmptyValue&&"#NuN#"!=m&&(m=c.calculateFormulaTotal([m],l,"MeasureInRows"),isNaN(m)||(n[o]=m.toString())))}}c.RowsWhenMoveToFilter=k}for(var t=[],h=[],j=0;j<c.conditions.length;j++)void 0!=c.conditions[j].collapsedValues&&0<c.conditions[j].collapsedValues.length&&(t.push(c.conditions[j].dataRowPosition),h.push(c.conditions[j].collapsedValues));
if(0<t.length){g=c.GeneralDataRows;0<c.RowsWhenMoveToFilter.length&&(g=c.RowsWhenMoveToFilter);c.FilterByTopFilter=!0;k=[];for(j=0;j<g.length;j++){for(var u=!1,v=0;v<t.length;v++)if(-1!=h[v].indexOf(g[j][t[v]])){u=!0;if(c.isNotFilterByTopFilter(g[j])&&!c.notInBlackList(g[j],c.conditions)){l=!1;for(o=n=0;o<k.length;o++){m=!0;for(r=0;r<=t[v];r++)if(g[j][r]!=k[o][r]){m=!1;break}if(m){n=o;l=!0;break}}if(l){0<measures.length&&(c.formulaInfo.measureFormula[measures.length-1].hasFormula||("#NuN#"!=k[n][c.dataColumnIndex]&&
"#NuN#"!=g[j][c.dataColumnIndex]?k[n][c.dataColumnIndex]=(parseFloat(k[n][c.dataColumnIndex])+parseFloat(g[j][c.dataColumnIndex])).toString():"#NuN#"==k[n][c.dataColumnIndex]&&(k[n][c.dataColumnIndex]=g[j][c.dataColumnIndex])));for(l=0;l<measures.length-1;l++)o=c.rowConditions[c.rowConditions.length-measures.length+1+l],c.formulaInfo.measureFormula[l].hasFormula&&0<c.filterIndexes.length||(k[n][o]=(parseFloat(k[n][o])+parseFloat(g[j][o])).toString())}else{n=[];for(l=0;l<g[j].length;l++)n.push([g[j][l]]);
k.push([n]);for(l=0;l<measures.length;l++)o=l<measures.length-1?c.rowConditions[c.rowConditions.length-measures.length+1+l]:c.dataColumnIndex,c.formulaInfo.measureFormula[l].hasFormula&&0<c.filterIndexes.length&&(m=c.getFormulaRowByDataRow(g[j],l,""),m!=c.EmptyValue&&"#NuN#"!=m&&(m=c.calculateFormulaTotal([m],l,"MeasureInRows"),isNaN(m)||(n[o]=m.toString())))}}break}if(!u){n=[];for(l=0;l<g[j].length;l++)n.push([g[j][l]]);k.push([n]);for(l=0;l<measures.length;l++)o=l<measures.length-1?c.rowConditions[c.rowConditions.length-
measures.length+1+l]:c.dataColumnIndex,c.formulaInfo.measureFormula[l].hasFormula&&0<c.filterIndexes.length&&(m=c.getFormulaRowByDataRow(g[j],l,""),m!=c.EmptyValue&&"#NuN#"!=m&&(m=c.calculateFormulaTotal([m],l,"MeasureInRows"),isNaN(m)||(n[o]=m.toString())))}}c.RowsWhenMoveToFilter=k}if(0<c.filterIndexes.length){h=[];for(j=0;j<c.columns.length;j++)-1==c.filterIndexes.indexOf(j)?h.push(j):(k=c.filterIndexes.indexOf(j),k=c.filterDiv.selects[k],void 0!=k&&"[all]"!=OAT.$v(k)&&h.push(j));g=c.RowsWhenMoveToFilter;
k=[];for(u=g[0].length-1;-1<u;u--){j=!0;for(n=0;n<g.length;n++)if(j&&g[n][u]!=parseInt(g[n][u])){j=!1;break}k[u]=j}u=h[0];g=k[u]?g.sort(function(c){return function(g,h){return parseInt(g[c])===parseInt(h[c])?0:parseInt(g[c])<parseInt(h[c])?-1:1}}(u)):g.sort(function(c){return function(g,h){return g[c]===h[c]?0:g[c]<h[c]?-1:1}}(u));h=g[0][u];for(j=n=0;j<g.length;j++)h!=g[j][u]?(h=g[j][u],g=OAT.PartialSort(g,n,j-1,u+1,c.headerRow.length,k),n=j):j==g.length-1&&(g=OAT.PartialSort(g,n,j,u+1,c.headerRow.length,
k));c.RowsWhenMoveToFilter=g}0<c.filterIndexes.length||0<t.length||(c.RowsWhenMoveToFilter=c.GeneralDataRows);return 0<t.length},calculateTotalRowsWithSubtotalRows=function(c,g,h){for(var j=[],k=0;k<h.rowConditions.length-1-(measures.length-1);k++)h.conditions[h.rowConditions[k]]&&(j[k]=1==h.conditions[h.rowConditions[k]].subtotals?1:0);for(var l=k=0;l<h.rowConditions.length-1-(measures.length-1);l++){if(-1!=h.conditions[h.rowConditions[l]].collapsedValues.indexOf(c[h.rowConditions[l]])){k=1;break}if(c[h.rowConditions[l]]!=
g[h.rowConditions[l]]){k+=j.reduce(function(c,g){return c+g});break}j[l]=0}return k},showSubtotalRowsForFirstColumn=function(c,g,h){for(var j=0;j<h.rowConditions.length-1-(measures.length-1);j++);j=0;-1!=h.conditions[h.rowConditions[0]].collapsedValues.indexOf(c[h.rowConditions[0]])?substotals=1:c[h.rowConditions[0]]!=g[h.rowConditions[0]]&&(j=1);return j},createPaginationInfo=function(c,g){c.paginationInfo||(c.paginationInfo={},c.paginationInfo.pages=[]);for(var h=0,j=0,k=0,l=0,n=[],o=0,m=0;m<g.length;)if(l>=
c.autoPagingRowsPerPage&&(l=!1,c.paginationInfo.pages[h]={firstRow:j,lastRow:k,rows:n,lastSumShow:l,extraRows:o},h++,j=m,l=0,n=[],o=0),!c.notInBlackList(g[m],c.conditions)&&c.isNotFilterByTopFilter(g[m])){var r=0;0==n.length&&(0<h&&!c.paginationInfo.pages[h-1].lastSumShow)&&(r=showSubtotalRowsForFirstColumn(c.paginationInfo.pages[h-1].rows[c.paginationInfo.pages[h-1].rows.length-1],g[m],c),0<r&&(n.push([c.paginationInfo.pages[h-1].rows[c.paginationInfo.pages[h-1].rows.length-1]]),o=calculateTotalRowsWithSubtotalRows(n[0],
g[m],c),r=1));if(0<n.length&&(1!=n.length||0==o))r=calculateTotalRowsWithSubtotalRows(n[n.length-1],g[m],c);l+1+r<=c.autoPagingRowsPerPage?(n.push([g[m]]),l=l+1+r,k=m,m++):(l+=r,l=0<r&&l==c.autoPagingRowsPerPage,c.paginationInfo.pages[h]={firstRow:j,lastRow:k,rows:n,lastSumShow:l,extraRows:o},h++,j=m,l=0,n=[],o=0)}else m++;l<c.autoPagingRowsPerPage&&(c.paginationInfo.pages[h]={firstRow:j,lastRow:k,rows:n,extraRows:0},h++);c.paginationInfo.totalPages=h;c.setNewPagesAccount(c.paginationInfo.totalPages);
c.TotalPagesPaging=c.paginationInfo.totalPages},calculateGrandTotalForLastMeasure=function(c){if(c.actualPaginationPage==c.TotalPagesPaging){var g=c.GeneralDataRows;0<c.RowsWhenMoveToFilter.length&&(g=c.RowsWhenMoveToFilter);for(var h=0,j=!0,k=[],l=0;l<g.length;l++)if(c.isNotFilterByTopFilter(g[l])&&!c.notInBlackList(g[l],c.conditions))if(c.formulaInfo.measureFormula[measures.length-1].hasFormula){var n=c.getFormulaRowByDataRow(g[l],measures.length-1,"");n!=c.EmptyValue&&"#NuN#"!=n&&k.push(n)}else isNaN(parseFloat(g[l][c.dataColumnIndex]))||
(j=!1,h+=parseFloat(g[l][c.dataColumnIndex]));return c.formulaInfo.measureFormula[measures.length-1].hasFormula?c.calculateFormulaTotal([k],measures.length-1,"MeasureInRows"):j?"#NuN#":h}return 0},getTrueCantRows=function(c,g,h){var j=0;0!=c[0].length-h-g-1&&(j=1+j);for(var k=c[0][g],l=[],n=0;n<c.length;n++)k==c[n][g]?(l.push([c[n]]),0===c[0].length-h-g-1&&(j+=1)):(j=1+j,k=c[n][g],0<c[0].length-h-g-1&&(j+=getTrueCantRows(l,g+1,h)),l=[],l.push([c[n]]));0<c[0].length-h-g-1&&(j+=getTrueCantRows(l,g+
1,h));return j},getMeasureNumberByName=function(c,g){for(var h=0;h<g.length;h++)if(g[h].getAttribute("displayName")==c)return h;return 0},getMeasureNumberByDataField=function(c,g){for(var h=0;h<g.length;h++)if(g[h].getAttribute("dataField")==c)return h;return 0},saveAsIE=function(){var c=get_blob();saveAs(new c([self.file.fileName||self.file.fileContent],{type:"text/plain;charset="+self.file.fileContent.toBase64()}),(self.file.fileName||self.file.fileContent)+"."+self.fileExtension)},getValueMeasureFromMeasureList=
function(c,g,h,j,k){for(var l=0;l<c.length;l++)if(void 0!=c[l][h]&&void 0!=c[l][h][1]&&c[l][h][1][0]==g)return c[l][h][0];return j[g][j[0].length-k+h]},reLoadDataArrays=function(c,g,h,j,k,l,n){fromUndefinedToBlanck(c);if(void 0!=c[0]){if(0<g.cantFormulaMeasures)for(var o=0;o<c.length;o++)c[o][h.length]=o;for(var m=[],r=h.length-1;-1<r;r--){for(var o=!0,t=0;t<c.length;t++)if(o&&c[t][r]!=parseInt(c[t][r])){o=!1;break}m[r]=o}for(var r=0,c=m[r]?c.sort(function(c){return function(g,h){return parseInt(g[c])===
parseInt(h[c])?0:parseInt(g[c])<parseInt(h[c])?-1:1}}(r)):c.sort(function(c){return function(g,h){return g[c]===h[c]?0:g[c]<h[c]?-1:1}}(r)),t=c[0][r],u=0,o=0;o<c.length;o++)t!=c[o][r]?(t=c[o][r],c=OAT.PartialSort(c,u,o-1,r+1,h.length,m),u=o):o==c.length-1&&(c=OAT.PartialSort(c,u,o,r+1,h.length,m))}m=c;c=[];0<m.length&&(c[0]=m[0]);r=0;for(o=1;o<m.length;o++){for(var t=!0,v=0;v<j.length;v++)if(m[o][v]!=m[o-1][v]){t=!1;break}if(t){for(v=j.length;v<j.length+l.length;v++)u=parseFloat(c[r][v])+parseFloat(m[o][v]),
"#NuN#"==c[r][v]&&"#NuN#"==m[o][v]?u="#NuN#":"#NuN#"==c[r][v]?u=m[o][v]+"":"#NuN#"==m[o][v]&&(u=c[r][v]+""),c[r][v]=u+"";if(0<g.cantFormulaMeasures){for(var x=c[r][h.length],t=m[o][h.length],v=0;v<g.measureFormula.length;v++)if(g.measureFormula[v].hasFormula)for(var B=0;B<g.measureFormula[v].relatedMeasures.length;B++){var H=g.measureFormula[v].relatedMeasures[B],u=parseFloat(n[x][H])+parseFloat(n[t][H]);n[x][H]=u+""}for(v=j.length;v<j.length+l.length;v++)u=parseFloat(n[x][v])+parseFloat(n[t][v]),
n[x][v]=u+"";for(u=0;u<h.length;u++)n[t][u]=""}}else r++,c[r]=m[o]}if(0<g.cantFormulaMeasures&&void 0!=c[0])for(j=0;j<c.length;j++)c[j].splice(h.length,1);k.recordForFormula=n;k.formulaInfo=g;for(n=0;n<l.length;n++)if(g.measureFormula[n]&&g.measureFormula[n].hasFormula)for(j=0;j<c.length;j++)if(0==c[j][c[j].length-l.length+n]&&(o=k.getFormulaRowByDataRow(c[j],n,""),o=EvaluateExpressionPivotJs(g.measureFormula[n].PolishNotation,o,g),Infinity==o||isNaN(o)))c[j][c[j].length-l.length+n]="#FoE#";k.GeneralDataRows=
c;k.autoPagingRowsPerPage=void 0!=pageSize?parseInt(pageSize):10;k.TotalPagesPaging=parseInt(c.length/k.autoPagingRowsPerPage);0!=c.length%k.autoPagingRowsPerPage&&k.TotalPagesPaging++;k.allData=c;0<c.length&&fillGeneralDistinctValues(h.length-l.length,k,c)}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){OAT.Statistics={list:[{longDesc:"Count",shortDesc:"COUNT",func:"count"},{longDesc:"Sum",shortDesc:"SUM",func:"sum"},{longDesc:"Product",shortDesc:"PRODUCT",func:"product"},{longDesc:"Arithmetic mean",shortDesc:"MEAN",func:"amean"},{longDesc:"Maximum",shortDesc:"MAX",func:"max"},{longDesc:"Minimum",shortDesc:"MIN",func:"min"},{longDesc:"Distinct values",shortDesc:"DISTINCT",func:"distinct"},{longDesc:"Variance",shortDesc:"VAR",func:"variance"},
{longDesc:"Standard deviation",shortDesc:"STDDEV",func:"deviation"},{longDesc:"Median",shortDesc:"MEDIAN",func:"median"},{longDesc:"Mode",shortDesc:"MODE",func:"mode"}],count:function(c){return c.length},sum:function(c){if("#FoE#"==c)return"#NaV#";for(var g=0<c.length,h=0,j=0;j<c.length;j++)"#NuN#"!=c[j]&&(g=!1),isNaN(c[j])||(h+=c[j]);return g?"#NuN#":h},product:function(c){for(var g=1,h=0;h<c.length;h++)g*=c[h];return g},amean:function(c){for(var g=0,h=0;h<c.length;h++)g+=c[h];return c.length?g/
c.length:0},max:function(c){for(var g=Number.MIN_VALUE,h=0;h<c.length;h++)c[h]>g&&(g=c[h]);return g},min:function(c){for(var g=Number.MAX_VALUE,h=0;h<c.length;h++)c[h]<g&&(g=c[h]);return g},distinct:function(c){for(var g=0,h={},j=0;j<c.length;j++)h[c[j]]=1;for(p in h)g++;return g},deviation:function(c){c=OAT.Statistics.variance(c);return Math.sqrt(c)},variance:function(c){if(2>c.length)return 0;for(var g=0,h=OAT.Statistics.amean(c),j=0;j<c.length;j++)g+=(c[j]-h)*(c[j]-h);return g/(c.length-1)},median:function(c){return c.sort(function(c,
h){return c-h})[Math.floor(c.length/2)]},mode:function(c){for(var g={},h=0;h<c.length;h++){var j=c[h]+"";j in g?g[j]++:g[j]=1}var c=0,h="",k;for(k in g)j=g[k],j>c&&(c=j,h=k);return parseFloat(h)}};try{OAT.Loader.featureLoaded("statistics")}catch(ERROR$$28){}OAT.WinData={TYPE_TEMPLATE:-1,TYPE_AUTO:0,TYPE_MS:1,TYPE_MAC:2,TYPE_ROUND:3,TYPE_RECT:4,TYPE_ODS:5};OAT.Win=function(c){var g=this;this.options={title:"",x:0,y:0,visibleButtons:"cmMfr",enabledButtons:"cmMfr",innerWidth:0,innerHeight:0,outerWidth:350,
outerHeight:!1,stackGroupBase:100,type:OAT.WinData.TYPE_AUTO,template:!1,className:!1};for(var h in c)this.options[h]=c[h];g.dom={buttons:{c:!1,m:!1,M:!1,f:!1,r:!1},container:!1,content:!1,title:!1,caption:!1,status:!1,resizeContainer:!1};g.moveTo=function(c,h){g.dom.container.style.left=c+"px";g.dom.container.style.top=h+"px"};g.innerResizeTo=function(){};g.outerResizeTo=function(){};g.show=function(){document.body.appendChild(g.dom.container);OAT.Dom.show(g.dom.container)};g.hide=function(){OAT.Dom.hide(g.dom.container)};
g.close=g.hide();g.minimize=function(){};g.maximize=function(){};g.flip=function(){};g.accomodate=function(c){c=OAT.Dom.getWH(c);g.innerResizeTo(c[0],c[1])};g.options.type==OAT.WinData.TYPE_TEMPLATE&&OAT.WinTemplate(g);g.options.type==OAT.WinData.TYPE_MS&&OAT.WinMS(g);g.options.type==OAT.WinData.TYPE_MAC&&OAT.WinMAC(g);g.options.type==OAT.WinData.TYPE_RECT&&OAT.WinRECT(g,c.containerQuery);g.options.type==OAT.WinData.TYPE_ROUND&&OAT.WinROUND(g);g.options.type==OAT.WinData.TYPE_ODS&&OAT.WinODS(g);-1!=
g.options.enabledButtons.indexOf("m")&&g.dom.buttons.m&&OAT.Dom.attach(g.dom.buttons.m,"click",g.minimize);-1!=g.options.enabledButtons.indexOf("M")&&g.dom.buttons.M&&OAT.Dom.attach(g.dom.buttons.M,"click",g.maximize);-1!=g.options.enabledButtons.indexOf("c")&&g.dom.buttons.c&&OAT.Dom.attach(g.dom.buttons.c,"click",g.hide);-1!=g.options.enabledButtons.indexOf("f")&&g.dom.buttons.f&&OAT.Dom.attach(g.dom.buttons.f,"click",g.flip);-1!=g.options.enabledButtons.indexOf("r")&&g.dom.buttons.r&&OAT.Resize.create(g.dom.buttons.r,
g.dom.resizeContainer,OAT.Resize.TYPE_XY);g.dom.title&&OAT.Drag.create(g.dom.title,g.dom.container);g.moveTo(g.options.x,g.options.y);(g.options.outerWidth||g.options.outerHeight)&&g.outerResizeTo(g.options.outerWidth,g.options.outerHeight);(g.options.innerWidth||g.options.innerHeight)&&g.innerResizeTo(g.options.innerWidth,g.options.innerHeight);g.dom.caption&&OAT.addTextNode(g.dom.caption,g.options);g.options.stackGroupBase&&OAT.WinManager.addWindow(g.options.stackGroupBase,g.dom.container);g.hide()};
OAT.WinTemplate=function(c){var g=c.options.template;if(g){for(var h="function"==typeof g?g():OAT.$(g).cloneNode(!0),j={oat_w_ctr:"container",oat_w_title_ctr:"title",oat_w_title_t_ctr:"caption",oat_w_content:"content",oat_w_max_b:["buttons","M"],oat_w_min_b:["buttons","m"],oat_w_close_b:["buttons","c"],oat_w_flip_b:["buttons","f"],oat_w_resize_handle:["buttons","r"]},k=[h],g=h.getElementsByTagName("*"),h=0;h<g.length;h++)k.push(g[h]);for(h=0;h<k.length;h++){var g=k[h],l;for(l in j)if(OAT.Dom.isClass(g,
l)){var n=j[l];n instanceof Array?c.dom[n[0]][n[1]]=g:c.dom[n]=g}}c.moveTo=function(g,h){c.dom.container.style.left=g+"px";c.dom.container.style.top=h+"px"};c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h+"px":"auto"};c.innerResizeTo=function(g,h){c.dom.content.style.width=g?g+"px":"auto";c.dom.content.style.height=h?h+"px":"auto"}}else alert("OAT Window cannot be created, as a template is required but not specified!")};OAT.WinMS=function(c){OAT.Style.include("winms.css");
c.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winms_container");c.dom.resizeContainer=c.dom.container;c.dom.content=OAT.Dom.create("div",{},"oat_winms_content");c.dom.title=OAT.Dom.create("div",{},"oat_winms_title");c.dom.caption=OAT.Dom.create("span",{},"oat_winms_caption");c.dom.status=OAT.Dom.create("div",{},"oat_winms_status");OAT.Dom.append([c.dom.container,c.dom.title,c.dom.content,c.dom.status]);-1!=c.options.visibleButtons.indexOf("c")&&(c.dom.buttons.c=OAT.Dom.create("div",
{},"oat_winms_close_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.c]));-1!=c.options.visibleButtons.indexOf("M")&&(c.dom.buttons.M=OAT.Dom.create("div",{},"oat_winms_max_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.M]));-1!=c.options.visibleButtons.indexOf("m")&&(c.dom.buttons.m=OAT.Dom.create("div",{},"oat_winms_min_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.m]));-1!=c.options.visibleButtons.indexOf("r")&&(c.dom.buttons.r=OAT.Dom.create("div",{},"oat_winms_resize_b"),OAT.Dom.append([c.dom.container,
c.dom.buttons.r]));OAT.Dom.append([c.dom.title,c.dom.caption]);c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h+"px":"auto"}};OAT.WinMAC=function(c){OAT.Style.include("winmac.css");c.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winmac_container");c.dom.resizeContainer=c.dom.container;c.dom.content=OAT.Dom.create("div",{},"oat_winmac_content");c.dom.title=OAT.Dom.create("div",{},"oat_winmac_title");c.dom.caption=OAT.Dom.create("span",
{},"oat_winmac_caption");c.dom.status=OAT.Dom.create("div",{},"oat_winmac_status");OAT.Dom.append([c.dom.container,c.dom.title,c.dom.content,c.dom.status]);c.dom.buttons.lc=OAT.Dom.create("div",{},"oat_winmac_leftCorner");OAT.Dom.append([c.dom.title,c.dom.buttons.lc]);c.dom.buttons.rc=OAT.Dom.create("div",{},"oat_winmac_rightCorner");OAT.Dom.append([c.dom.title,c.dom.buttons.rc]);-1!=c.options.visibleButtons.indexOf("c")&&(c.dom.buttons.c=OAT.Dom.create("div",{},"oat_winmac_close_b"),OAT.Dom.append([c.dom.title,
c.dom.buttons.c]));-1!=c.options.visibleButtons.indexOf("M")&&(c.dom.buttons.M=OAT.Dom.create("div",{},"oat_winmac_max_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.M]));-1!=c.options.visibleButtons.indexOf("m")&&(c.dom.buttons.m=OAT.Dom.create("div",{},"oat_winmac_min_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.m]));-1!=c.options.visibleButtons.indexOf("r")&&(c.dom.buttons.r=OAT.Dom.create("div",{},"oat_winmac_resize_b"),OAT.Dom.append([c.dom.container,c.dom.buttons.r]));OAT.Dom.append([c.dom.title,
c.dom.caption]);c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h-8+"px":"auto"}};OAT.WinRECT=function(c,g){c.dom.container=void 0!=g?OAT.Dom.create("div",{position:"absolute"},g+" oat_winrect_container"):OAT.Dom.create("div",{position:"absolute"},"oat_winrect_container");c.dom.resizeContainer=c.dom.container;var h=-1<navigator.userAgent.toLowerCase().indexOf("android");gx.util.browser.isIPad()||gx.util.browser.isIPhone()||h?(c.dom.content=
OAT.Dom.create("div",{},"oat_winrect_content oat_winrect_content_small"),c.dom.title=OAT.Dom.create("div",{},"oat_winrect_title oat_winrect_title_small")):(c.dom.content=OAT.Dom.create("div",{},"oat_winrect_content"),c.dom.title=OAT.Dom.create("div",{},"oat_winrect_title"));c.dom.caption=OAT.Dom.create("span",{},"oat_winrect_caption");c.dom.status=OAT.Dom.create("div",{},"oat_winrect_status");OAT.Dom.append([c.dom.container,c.dom.title,c.dom.content,c.dom.status]);c.dom.buttons.c=gx.util.browser.isIPad()||
gx.util.browser.isIPhone()||h?OAT.Dom.create("div",{},"oat_winrect_close_b oat_winrect_close_small"):OAT.Dom.create("div",{},"oat_winrect_close_b");OAT.addImageNode(c.dom.buttons.c,"close","");OAT.Dom.append([c.dom.title,c.dom.buttons.c]);c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h+"px":"auto"}};OAT.WinROUND=function(c){OAT.Style.include("winround.css");c.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winround_container");
c.dom.resizeContainer=c.dom.container;c.dom.table=OAT.Dom.create("table",{},"oat_winround_wrapper");c.dom.tr_t=OAT.Dom.create("tr",{});c.dom.td_lt=OAT.Dom.create("td",{},"oat_winround_lt");c.dom.td_t=OAT.Dom.create("td",{},"oat_winround_t");c.dom.td_rt=OAT.Dom.create("td",{},"oat_winround_rt");c.dom.tr_m=OAT.Dom.create("tr",{});c.dom.td_l=OAT.Dom.create("td",{},"oat_winround_l");c.dom.td_m=OAT.Dom.create("td",{},"oat_winround_m");c.dom.td_r=OAT.Dom.create("td",{},"oat_winround_r");c.dom.tr_b=OAT.Dom.create("tr",
{});c.dom.td_lb=OAT.Dom.create("td",{},"oat_winround_lb");c.dom.td_b=OAT.Dom.create("td",{},"oat_winround_b");c.dom.td_rb=OAT.Dom.create("td",{},"oat_winround_rb");c.dom.content=OAT.Dom.create("div",{},"oat_winround_content");c.dom.title=OAT.Dom.create("div",{},"oat_winround_title");c.dom.caption=OAT.Dom.create("span",{},"oat_winround_caption");c.dom.status=OAT.Dom.create("div",{},"oat_winround_status");-1!=c.options.visibleButtons.indexOf("c")&&(c.dom.buttons.c=OAT.Dom.create("div",{},"oat_winround_close_b"),
OAT.Dom.append([c.dom.title,c.dom.buttons.c]));-1!=c.options.visibleButtons.indexOf("r")&&(c.dom.buttons.r=OAT.Dom.create("div",{},"oat_winround_resize_b"),OAT.Dom.append([c.dom.td_rb,c.dom.buttons.r]));OAT.Dom.append([c.dom.title,c.dom.caption]);OAT.Browser.isIE?(OAT.addTextNode(c.dom.container,'<table class="oat_winround_wrapper"><tr><td class="oat_winround_lt"></td><td class="oat_winround_t"></td><td class="oat_winround_rt"></td></tr><tr><td class="oat_winround_l"></td><td class="oat_winround_m"></td><td class="oat_winround_r"></td></tr><tr><td class="oat_winround_lb"></td><td class="oat_winround_b"></td><td class="oat_winround_rb"></td></tr></table>'),
c.dom.container.childNodes[0].childNodes[0].childNodes[0].childNodes[1].appendChild(c.dom.title),c.dom.container.childNodes[0].childNodes[0].childNodes[1].childNodes[1].appendChild(c.dom.content),c.dom.container.childNodes[0].childNodes[0].childNodes[2].childNodes[1].appendChild(c.dom.status),c.dom.container.childNodes[0].childNodes[0].childNodes[2].childNodes[2].appendChild(c.dom.buttons.r)):(OAT.Dom.append([c.dom.tr_t,c.dom.td_lt,c.dom.td_t,c.dom.td_rt]),OAT.Dom.append([c.dom.tr_m,c.dom.td_l,c.dom.td_m,
c.dom.td_r]),OAT.Dom.append([c.dom.tr_b,c.dom.td_lb,c.dom.td_b,c.dom.td_rb]),OAT.Dom.append([c.dom.table,c.dom.tr_t,c.dom.tr_m,c.dom.tr_b]),OAT.Dom.append([c.dom.td_t,c.dom.title]),OAT.Dom.append([c.dom.td_m,c.dom.content]),OAT.Dom.append([c.dom.td_b,c.dom.status]),OAT.Dom.append([c.dom.container,c.dom.table]));c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h+"px":"auto"}};OAT.WinODS=function(c){OAT.Style.include("winods.css");c.dom.container=
OAT.Dom.create("div",{position:"absolute"},"oat_winods_container");c.dom.resizeContainer=c.dom.container;c.dom.content=OAT.Dom.create("div",{},"oat_winods_content");c.dom.title=OAT.Dom.create("div",{},"oat_winods_title");c.dom.caption=OAT.Dom.create("span",{},"oat_winods_caption");c.dom.status=OAT.Dom.create("div",{},"oat_winods_status");OAT.Dom.append([c.dom.container,c.dom.title,c.dom.content,c.dom.status]);-1!=c.options.visibleButtons.indexOf("c")&&(c.dom.buttons.c=OAT.Dom.create("div",{},"oat_winods_close_b"),
OAT.Dom.append([c.dom.title,c.dom.buttons.c]));-1!=c.options.visibleButtons.indexOf("r")&&(c.dom.buttons.r=OAT.Dom.create("div",{},"oat_winods_resize_b"),OAT.Dom.append([c.dom.container,c.dom.buttons.r]));OAT.Dom.append([c.dom.title,c.dom.caption]);c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h+"px":"auto"}};OAT.WinManager={stackingGroups:{},addWindow:function(c,g){if(c in OAT.WinManager.stackingGroups)var h=OAT.WinManager.stackingGroups[c];
else h=new OAT.Layers(c),OAT.WinManager.stackingGroups[c]=h;h.addLayer(g,"click")},removeWindow:function(){if(zI in OAT.WinManager.stackingGroups)var c=OAT.WinManager.stackingGroups[zI];else c=new OAT.Layers(zI),OAT.WinManager.stackingGroups[zI]=c;c.removeLayer(container)}};try{OAT.Loader.featureLoaded("win")}catch(ERROR$$29){}OAT.Resize={TYPE_X:1,TYPE_Y:2,TYPE_XY:3,element:[],mouse_x:0,mouse_y:0,move:function(c){if(OAT.Resize.element.length){for(var g=c.clientX-OAT.Resize.mouse_x,h=c.clientY-OAT.Resize.mouse_y,
j=1,k=0;k<OAT.Resize.element.length;k++){var l=OAT.Resize.element[k][0],l=OAT.Dom.getWH(l),n=OAT.Resize.element[k][2],o=g,m=h;switch(OAT.Resize.element[k][1]){case OAT.Resize.TYPE_X:m=0;break;case -OAT.Resize.TYPE_X:o=-g;m=0;break;case OAT.Resize.TYPE_Y:o=0;break;case -OAT.Resize.TYPE_Y:o=0;m=-h;break;case -OAT.Resize.TYPE_XY:o=-g,m=-h}n(l[0]+o,l[1]+m)&&(j=0)}if(j){for(k=0;k<OAT.Resize.element.length;k++)switch(l=OAT.Resize.element[k][0],OAT.Resize.element[k][1]){case OAT.Resize.TYPE_X:OAT.Dom.resizeBy(l,
g,0);break;case -OAT.Resize.TYPE_X:OAT.Dom.resizeBy(l,-g,0);break;case OAT.Resize.TYPE_Y:OAT.Dom.resizeBy(l,0,h);break;case -OAT.Resize.TYPE_Y:OAT.Dom.resizeBy(l,0,-h);break;case OAT.Resize.TYPE_XY:OAT.Dom.resizeBy(l,g,h);break;case -OAT.Resize.TYPE_XY:OAT.Dom.resizeBy(l,-g,-h)}OAT.Resize.mouse_x=c.clientX;OAT.Resize.mouse_y=c.clientY}}},up:function(){for(var c=0;c<OAT.Resize.element.length;c++)OAT.Resize.element[c][3]();OAT.Resize.element=[]},create:function(c,g,h,j,k){var l=OAT.$(c),c=OAT.$(g),
g=function(){return!1},n=function(){return!1};j&&(g=j);k&&(n=k);switch(h){case OAT.Resize.TYPE_XY:l.style.cursor="nw-resize";break;case OAT.Resize.TYPE_X:l.style.cursor="w-resize";break;case OAT.Resize.TYPE_Y:l.style.cursor="n-resize"}j=function(c){OAT.Resize.element=l._Resize_movers;OAT.Resize.mouse_x=c.clientX;OAT.Resize.mouse_y=c.clientY;c.cancelBubble=!0};l._Resize_movers||(OAT.Dom.attach(l,"mousedown",j),l._Resize_movers=[]);l._Resize_movers.push([c,h,g,n])},remove:function(c,g){var h=OAT.$(c);
OAT.$(g);if(h._Resize_movers){for(var j=-1,k=0;k<h._Resize_movers.length;k++)h._Resize_movers[k][0]==g&&(j=k);-1!=j&&h._Resize_movers.splice(j,1)}},removeAll:function(c){c=OAT.$(c);c._Resize_movers&&(c._Resize_movers=[])},createDefault:function(c,g,h){if(OAT.Preferences.allowDefaultResize){var j=OAT.Dom.create("div",{position:"absolute",width:"10px",height:"10px",right:"0px",fontSize:"1px",bottom:"0px"});c.appendChild(j);OAT.Resize.create(j,c,OAT.Resize.TYPE_XY,g,h);OAT.Dom.hide(j);var k=function(){j._Resize_pending&&
OAT.Dom.hide(j)};OAT.Dom.attach(c,"mouseover",function(){OAT.Dom.show(j);j._Resize_pending=0});OAT.Dom.attach(c,"mouseout",function(){j._Resize_pending=1;setTimeout(k,2E3)})}}};OAT.Dom.attach(document,"mousemove",OAT.Resize.move);OAT.Dom.attach(document,"mouseup",OAT.Resize.up);try{OAT.Loader.featureLoaded("resize")}catch(ERROR$$30){}OAT.XMLHTTP=function(){this.obj=this.iframe=!1;this.open=function(c,g,h){this.iframe?this.temp_src=g:this.obj.open(c,g,h)};this.send=function(c){this.iframe?this.ifr.src=
this.temp_src:this.obj.send(c)};this.setResponse=function(c){this.iframe?OAT.Dom.attach(this.ifr,"load",c):this.obj.onreadystatechange=c};this.getResponseText=function(){};this.getResponseXML=function(){return this.iframe?(alert("IFRAME mode active -> XML data not supported"),""):this.obj.responseXML};this.getReadyState=function(){return this.iframe?4:this.obj.readyState};this.getStatus=function(){return this.iframe?200:this.obj.status};this.setRequestHeader=function(c,g){this.iframe||this.obj.setRequestHeader(c,
g)};this.getAllResponseHeaders=function(){return!this.iframe?this.obj.getAllResponseHeaders():{}};this.isIframe=function(){return this.iframe};window.XMLHttpRequest?this.obj=new XMLHttpRequest:window.ActiveXObject&&(this.obj=new ActiveXObject("Microsoft.XMLHTTP"));this.obj||(this.iframe=!0,this.ifr=OAT.Dom.create("iframe"),this.ifr.style.display="none",this.ifr.src="javascript:;",document.body.appendChild(this.ifr))};OAT.XMLHTTP_supported=function(){return!(new OAT.XMLHTTP).isIframe()};try{OAT.Loader.featureLoaded("ajax")}catch(ERROR$$31){}OAT.AnchorData=
{active:!1,window:!1};OAT.Anchor={appendContent:function(c){if(c.content&&c.window){"function"==typeof c.content&&(c.content=c.content());var g=c.window;OAT.Dom.clear(g.dom.content);g.dom.content.appendChild(c.content);OAT.Anchor.fixSize(g)}},callForData:function(c,g){var h=c.window;c.stat=1;c.status&&OAT.addTextNode(h.dom.status,c.status);var j=c.datasource;if(j){j.connection=c.connection;var k=c.elm.innerHTML,l=function(){h.dom.caption.innerHTML=c.elm.innerHTML;c.title&&(h.dom.caption.innerHTML=
c.title)};j.bindRecord(l);j.bindEmpty(l)}switch(c.result_control){case "grid":l=new OAT.FormObject.grid(0,0,0,1);l.showAll=!0;c.content=l.elm;l.elm.style.position="relative";l.init();j.bindRecord(l.bindRecordCallback);j.bindPage(l.bindPageCallback);j.bindHeader(l.bindHeaderCallback);break;case "form":var n=!1;c.content=OAT.Dom.create("div");n=new OAT.Form(c.content,{onDone:function(){h.resizeTo(n.totalWidth+5,n.totalHeight+5);c.anchorTo(g[0],g[1])}});j.bindFile(function(c){c=OAT.Xml.createXmlDoc(c);
n.createFromXML(c)});break;case "timeline":l=new OAT.FormObject.timeline(0,20,0);c.content=l.elm;l.elm.style.position="relative";l.elm.style.width=c.width-5+"px";l.elm.style.height=c.height-65+"px";l.init();for(var o=0;o<l.datasources[0].fieldSets.length;o++)l.datasources[0].fieldSets[o].realIndexes=[o];j.bindPage(l.bindPageCallback)}OAT.Anchor.appendContent(c);if(j){j.options.query=j.options.query.replace(/\$link_name/g,k);c.connection.options.endpoint=c.href;c.connection.options.url=c.href;switch(j.type){case OAT.DataSourceData.TYPE_SPARQL:k=
new OAT.SparqlQuery;k.fromString(j.options.query);k=k.variables.length?"format=xml":"format=rdf";j.options.query="query="+encodeURIComponent(j.options.query)+"&"+k;break;case OAT.DataSourceData.TYPE_GDATA:j.options.query=j.options.query?"q="+encodeURIComponent(j.options.query):""}j.advanceRecord(0)}},fixSize:function(){setTimeout(function(){},50)},assign:function(c,g){var h=OAT.$(c),j={href:!1,newHref:"javascript:void(0)",connection:!1,datasource:!1,content:!1,status:!1,title:!1,result_control:"grid",
activation:"hover",width:340,height:!1,elm:h,window:!1,arrow:!1,type:OAT.WinData.TYPE_RECT,visibleButtons:"cr",enabledButtons:"cr",template:!1},k;for(k in g)j[k]=g[k];var l=new OAT.Win({outerWidth:j.width,outerHeight:j.height,title:"",type:j.type,status:j.status,visibleButtons:j.visibleButtons,enabledButtons:j.enabledButtons,template:j.template,containerQuery:j.containerQuery});OAT.Dom.attach(l.dom.container,"mouseover",function(){var c=OAT.AnchorData.active;c&&"hover"==c.activation&&c.endClose()});
OAT.Dom.attach(l.dom.container,"mouseout",function(){var c=OAT.AnchorData.active;c&&"hover"==c.activation&&c.startClose()});k=OAT.Dom.create("div",{});j.window=l;l.close=function(){OAT.Dom.hide(l.dom.container)};l.onclose=l.close;l.close();j.stat=0;!j.href&&"href"in h&&(j.href=h.href);"a"==h.tagName.toString().toLowerCase()&&OAT.Dom.changeHref(h,j.newHref);j.displayRef=function(c){var g=j.window;g.hide();OAT.AnchorData.active=j;c=OAT.Dom.eventPos(c);OAT.AnchorData.window=g;j.stat?OAT.Anchor.appendContent(j):
OAT.Anchor.callForData(j,c);"focus"==j.activation&&(c=OAT.Dom.position(h));j.anchorTo(c[0],c[1]);g.show();j.anchorTo(c[0],c[1])};j.displayRef2=function(c){var g=j.window;g.hide();OAT.AnchorData.active=j;OAT.AnchorData.window=g;j.stat?OAT.Anchor.appendContent(j):OAT.Anchor.callForData(j,c);"focus"==j.activation&&(c=OAT.Dom.position(h));j.anchorTo(c[0],c[1]);g.show();j.anchorTo(c[0],c[1])};j.anchorTo=function(c,g){var h=j.window,k=OAT.Dom.getFreeSpace(c,g),l=OAT.Dom.getWH(h.dom.container),u=k[1]?g-
30-l[1]:g+30,k=k[0]?c+20-l[0]:c-30;0>k&&(k=10);0>u&&(u=10);h.moveTo(k,u-20)};j.closeRef=function(){j.closeFlag&&(j.window.hide(),OAT.AnchorData.active=!1)};j.close=function(){j.window.hide()};j.startClose=function(){j.closeFlag=1;setTimeout(j.closeRef,1E3)};j.endClose=function(){j.closeFlag=0};switch(j.activation){case "hover":OAT.Dom.attach(h,"mouseover",j.displayRef);OAT.Dom.attach(h,"mouseout",j.startClose);break;case "click":OAT.Dom.attach(h,"click",j.displayRef);break;case "dblclick":OAT.Dom.attach(h,
"dblclick",j.displayRef);break;case "focus":OAT.Dom.attach(h,"focus",j.displayRef),OAT.Dom.attach(h,"blur",j.close)}return j},close:function(c,g){c=OAT.$(c);"BODY"!=c.tagName&&(c.className.match(/^oat_win.+_container$/)?(OAT.Dom.hide(c),g&&this.close(c.parentNode)):this.close(c.parentNode))},openAnchor:function(){var c=this.window;c.hide();OAT.AnchorData.active=this;b=OAT.Dom.eventPos(b);OAT.AnchorData.window=c;a.stat?OAT.Anchor.appendContent(a):OAT.Anchor.callForData(a,b);"focus"==a.activation&&
(b=OAT.Dom.position(e));a.anchorTo(b[0],b[1]);c.show();a.anchorTo(b[0],b[1])}};try{OAT.Loader.featureLoaded("anchor")}catch(ERROR$$32){}OAT.Animation=function(c,g){var h=this;this.elm=OAT.$(c);this.options={delay:50,startFunction:function(){},conditionFunction:function(){},stepFunction:function(){},stopFunction:function(){}};for(var j in g)h.options[j]=g[j];this.step=function(){setTimeout(function(){h.running&&(h.options.conditionFunction(h)?(h.running=0,h.options.stopFunction(h),OAT.MSG.send(h,OAT.MSG.ANIMATION_STOP,
h)):(h.options.stepFunction(h),h.step(h)))},h.options.delay)};this.start=function(){h.running=1;h.options.startFunction(h);h.step()};this.stop=function(){h.running=0}};OAT.AnimationSize=function(c,g){var h=this;this.options={width:-1,height:-1,delay:50,speed:1};for(var j in g)h.options[j]=g[j];this.animation=new OAT.Animation(c,{delay:h.options.delay,startFunction:function(c){c.stepX=0;c.stepY=0;var g=OAT.Dom.getWH(c.elm);c.width=g[0];c.height=g[1];c.diffX=-1==h.options.width?0:h.options.width-g[0];
c.diffY=-1==h.options.height?0:h.options.height-g[1];c.signX=0<=c.diffX?1:-1;c.signY=0<=c.diffY?1:-1;var g=c.diffX*c.diffX,j=c.diffY*c.diffY;c.stepX=c.signX*Math.sqrt(h.options.speed*h.options.speed*g/(g+j));c.stepY=c.signY*Math.sqrt(h.options.speed*h.options.speed*j/(g+j))},stopFunction:function(c){-1!=h.options.width&&(c.elm.style.width=h.options.width+"px");-1!=h.options.height&&(c.elm.style.height=h.options.height+"px")},conditionFunction:function(c){var g=0<c.signX?c.width>=h.options.width:c.width<=
h.options.width,c=0<c.signY?c.height>=h.options.height:c.height<=h.options.height;-1==h.options.width&&(g=1);-1==h.options.height&&(c=1);return g&&c},stepFunction:function(c){c.width+=c.stepX;c.height+=c.stepY;var g=parseInt(c.width),j=parseInt(c.height);-1!=h.options.width&&(c.elm.style.width=(0<=g?g:0)+"px");-1!=h.options.height&&(c.elm.style.height=(0<=j?j:0)+"px")}});this.start=h.animation.start;this.stop=h.animation.stop};OAT.AnimationPosition=function(c,g){var h=this;this.options={left:-1,top:-1,
delay:50,speed:1};for(var j in g)h.options[j]=g[j];this.animation=new OAT.Animation(c,{delay:h.options.delay,startFunction:function(c){c.stepX=0;c.stepY=0;var g=OAT.Dom.getLT(c.elm);c.left=g[0];c.top=g[1];c.diffX=-1==h.options.left?0:h.options.left-g[0];c.diffY=-1==h.options.top?0:h.options.top-g[1];c.signX=0<=c.diffX?1:-1;c.signY=0<=c.diffY?1:-1;var g=c.diffX*c.diffX,j=c.diffY*c.diffY;c.stepX=c.signX*Math.sqrt(h.options.speed*h.options.speed*g/(g+j));c.stepY=c.signY*Math.sqrt(h.options.speed*h.options.speed*
j/(g+j))},stopFunction:function(c){-1!=h.options.left&&(c.elm.style.left=h.options.left+"px");-1!=h.options.top&&(c.elm.style.top=h.options.top+"px")},conditionFunction:function(c){var g=0<c.signX?c.left>=h.options.left:c.left<=h.options.left,c=0<c.signY?c.top>=h.options.top:c.top<=h.options.top;-1==h.options.left&&(g=1);-1==h.options.top&&(c=1);return g&&c},stepFunction:function(c){c.left+=c.stepX;c.top+=c.stepY;var g=parseInt(c.left),j=parseInt(c.top);-1!=h.options.left&&(c.elm.style.left=g+"px");
-1!=h.options.top&&(c.elm.style.top=j+"px")}});this.start=h.animation.start;this.stop=h.animation.stop};OAT.AnimationOpacity=function(c,g){var h=this;this.options={opacity:1,delay:50,speed:0.1};for(var j in g)h.options[j]=g[j];this.animation=new OAT.Animation(c,{delay:h.options.delay,startFunction:function(c){c.opacity=1;OAT.Browser.isGecko&&(c.opacity=parseFloat(OAT.Dom.style(c.elm,"opacity")));if(OAT.Browser.isIE){var g=OAT.Dom.style(c.elm,"filter").match(/alpha\(opacity=([^\)]+)\)/);g&&(c.opacity=
parseFloat(g[1])/100)}c.step_=1;c.diff=h.options.opacity-c.opacity;c.sign=0<=c.diff?1:-1;c.step_=c.sign*h.options.speed},stopFunction:function(c){OAT.Style.opacity(c.elm,h.options.opacity)},conditionFunction:function(c){return 0<c.sign?c.opacity+1.0E-4>=h.options.opacity:c.opacity-1.0E-4<=h.options.opacity},stepFunction:function(c){c.opacity+=c.step_;OAT.Style.opacity(c.elm,c.opacity)}});this.start=h.animation.start;this.stop=h.animation.stop};OAT.AnimationCSS=function(c,g){var h=this;this.options=
{delay:50,property:!1,start:0,step:1,stop:10};for(var j in g)h.options[j]=g[j];this.animation=new OAT.Animation(c,{delay:h.options.delay,startFunction:function(c){c[h.options.property]=h.options.start;c.elm.style[h.options.property]=h.options.start},stopFunction:function(c){c.elm.style[h.options.property]=h.options.stop},conditionFunction:function(c){return c[h.options.property]==h.options.stop},stepFunction:function(c){c[h.options.property]+=h.options.step;c.elm.style[h.options.property]=c[h.options.property]}});
this.start=h.animation.start;this.stop=h.animation.stop};try{OAT.Loader.featureLoaded("animation")}catch(ERROR$$33){}OAT.getURL=function(){try{var c=location.href.substring(0,location.href.lastIndexOf("/")),g=c;"http://"==g.substr(0,7)&&(g=g.substr(7));var h="",j=g.indexOf("/");-1<j&&(h=g.substr(j+1),g.substr(0,j));var k=location.href.substring(c.length+1,location.href.length+1),j=k.indexOf("?");-1<j&&(k=k.substring(0,j));j=k.indexOf("#");-1<j&&(k=k.substring(0,j));c="";j=k.indexOf(".");-1<j&&(c=
k.substring(j+1),k=k.substr(0,j));j=k;""!=c&&(j+="."+c);""==j&&(k="index");args=location.search.substr(1).split("?");return h+k}catch(l){return""}};OAT.PartialSort=function(c,g,h,j,k,l){for(var n=[],o=0;o<=h-g;o++)n[o]=c[g+o];l[j]?n.sort(function(c){return function(g,h){return parseInt(g[c])===parseInt(h[c])?0:parseInt(g[c])<parseInt(h[c])?-1:1}}(j)):n.sort(function(c){return function(g,h){return g[c]===h[c]?0:g[c]<h[c]?-1:1}}(j));if(j<k-1)for(var o=n[0][j],m=0,r=0;r<n.length;r++)o!=n[r][j]?(o=n[r][j],
n=OAT.PartialSort(n,m,r-1,j+1,k,l),m=r):r==n.length-1&&(n=OAT.PartialSort(n,m,r,j+1,k,l));for(o=g;o<=h;o++)c[o]=n[o-g];return c}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){OAT.tablePagination=function(c,g){var h={rowsPerPage:5,currPage:1,jstype:"pivot",optionsForRows:[5,10,25,50,100],ignoreRows:[],topNav:!1},g=jQuery.extend(h,g);return c.each(function(){function c(j){if(!(0==j||j>w)){var j=(j-1)*h.rowsPerPage,k=j+h.rowsPerPage-1;jQuery(B).show();for(var l=0;l<B.length;l++){(l<j||l>k)&&jQuery(B[l]).hide();if("pivot"===g.jstype)for(;null!=B[l].childNodes[0].getAttribute("pivotCorrect");)B[l].deleteCell(0);"tf"==
B[l].getAttribute("visibQ")&&jQuery(B[l]).hide()}if("pivot"===g.jstype&&1<j&&(null===B[j].childNodes[0].getAttribute("spanCorrect")||"0"===B[j].childNodes[0].getAttribute("spanCorrect"))){k=B[j-1];for(l=1;l<j+1&&!(0>j-l);l++)for(var k=B[j-l],m=0;m<k.childNodes.length;m++)if(void 0!=k.childNodes[m]&&void 0!=k.childNodes[m].getAttribute("rowspan")&&1<k.childNodes[m].getAttribute("rowspan")){if(k.childNodes[m].getAttribute("rowspan")<=l||null!=k.childNodes[m].getAttribute("hidden"))break;for(var n=j;n<
j+(k.childNodes[m].getAttribute("rowspan")-l);n++){var o=0;void 0!=B[n].childNodes[0].getAttribute("colspan")&&null!=B[n].childNodes[0].getAttribute("colspan")&&parseInt(B[n].childNodes[0].getAttribute("colspan"));var o=void 0!=k.childNodes[m].getAttribute("colspan")&&null!=k.childNodes[m].getAttribute("colspan")?parseInt(k.childNodes[m].getAttribute("colspan")):1,r=B[n].insertCell(m);r.setAttribute("pivotCorrect",!0);r.setAttribute("colspan",o);r.setAttribute("class","pivotAdd");r.setAttribute("style",
k.childNodes[m].style.cssText+"border-bottom: none; border-top: none;");n===j&&(r.innerHTML=k.childNodes[m].innerHTML,r.className=k.childNodes[m].className+" pivotAdd",r.removeChild(r.childNodes[0]));void 0!=B[n].childNodes[0].getAttribute("rowspan")&&null!=B[n].childNodes[0].getAttribute("rowspan")&&(n=n+parseInt(B[n].childNodes[0].getAttribute("rowspan"))-1)}}}}}function k(){var c=Math.round(H/h.rowsPerPage),c=c*h.rowsPerPage<H?c+1:c;0<jQuery(o)[u]().find(m).length&&jQuery(o)[u]().find(m).html(c);
return c}function l(g){1>g||g>w||(z=g,c(z),1<z?jQuery("#tablePagination_firstPage,#tablePagination_prevPage").removeClass("disabled_pivot_button"):jQuery("#tablePagination_firstPage,#tablePagination_prevPage").addClass("disabled_pivot_button"),z!=w?jQuery("#tablePagination_nextPage,#tablePagination_lastPage").removeClass("disabled_pivot_button"):jQuery("#tablePagination_nextPage,#tablePagination_lastPage").addClass("disabled_pivot_button"),jQuery(o)[u]().find(r).val(z))}function n(){var c=1;try{var h=
100;gx.util.browser.webkit&&!(0<jQuery("#"+g.controlName).closest(".gxwebcomponent").length)&&(h*=100);if(z>10*h){0<jQuery("#"+g.controlName).closest(".gxwebcomponent").length&&(c+=2);for(h=z/h;10<h;)h/=10,c++}}catch(j){}var h=1==z?" disabled_pivot_button":"",k=z==w?" disabled_pivot_button":"",l=-1<navigator.userAgent.toLowerCase().indexOf("android");!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()&&!l?(l=[],l.push("<div id='"+g.controlName+"_tablePagination' class='pivot_pag_div'>")):(l=[],
l.push("<div id='"+g.controlName+"_tablePagination' class='pivot_pag_div pivot_pag_div_sd'>"));l.push("<span id='tablePagination_perPage'>");l.push("<select id='"+g.controlName+"tablePagination_rowsPerPage'><option value='5'>5</option></select>");l.push(" "+gx.getMessage("GXPL_QViewerJSPerPage")+" ");l.push("</span>");l.push("<span id='"+g.controlName+"_tablePagination_paginater'>");l.push("<div class='pagefirst "+h+"' id='tablePagination_firstPage' >");l.push('<i class="material-icons">first_page</i>');
l.push("</div>");l.push("<div class='pageprev "+h+"' id='tablePagination_prevPage' >");l.push('<i class="material-icons">navigate_before</i>');l.push("</div>");l.push("<span style=''>&nbsp;"+gx.getMessage("GXPL_QViewerJSPage")+"&nbsp;</span>");l.push("<input id='tablePagination_currPage' type='input' value='"+z+"' size='"+c+"'>");l.push("<span>&nbsp;"+gx.getMessage("GXPL_QViewerJSOf")+"</span><span id='tablePagination_totalPages'>&nbsp;"+w+"</span>");l.push("<div class='pagenext "+k+"' id='tablePagination_nextPage' >");
l.push('<i class="material-icons">navigate_next</i>');l.push("</div>");l.push("<div class='pagelast "+k+"' id='tablePagination_lastPage'>");l.push('<i class="material-icons">last_page</i>');l.push("</div>");l.push("</span>");l.push("</div>");return l.join("").toString()}var o=jQuery(this)[0],m,r,t;m="#tablePagination_totalPages";r="#tablePagination_currPage";t="#"+g.controlName+"tablePagination_rowsPerPage";var u=h.topNav?"prev":"next";try{h.rowsPerPage=parseInt(h.rowsPerPage)}catch(v){h.rowsPerPage=
10}var x=jQuery.makeArray(jQuery("tbody tr",o)),B=jQuery.grep(x,function(c){return-1==jQuery.inArray(c,h.ignoreRows)},!1),H=B.length,w=k(),z=h.currPage>w?1:h.currPage;-1==jQuery.inArray(h.rowsPerPage,h.optionsForRows)&&h.optionsForRows.push(h.rowsPerPage);0==jQuery(o)[u]().find(m).length?h.topNav?jQuery(this).before(n()):(jQuery(this).after(n()),1==w?jQuery("#"+g.controlName+"_tablePagination_paginater").css("display","none"):jQuery("#"+g.controlName+"_tablePagination_paginater").css("display","")):
jQuery(o)[u]().find(r).val(z);(function(){var c=h.optionsForRows;c.sort(function(c,g){return c-g});for(var j=jQuery(o)[u]().find(t)[0],k=j.length=0;k<c.length;k++)j.options[k]=c[k]==h.rowsPerPage?new Option(c[k],c[k],true,true):new Option(c[k],c[k]);B.length<=h.rowsPerPage?jQuery("#"+g.controlName+"_tablePagination").css("display","none"):jQuery("#"+g.controlName+"_tablePagination").css("display","");w==1||w==0?jQuery("#"+g.controlName+"_tablePagination_paginater").css("display","none"):jQuery("#"+
g.controlName+"_tablePagination_paginater").css("display","")})();c(z);jQuery(o)[u]().find("#tablePagination_firstPage").bind("click",function(){l(1)});jQuery(o)[u]().find("#tablePagination_prevPage").bind("click",function(){l(z-1)});jQuery(o)[u]().find("#tablePagination_nextPage").bind("click",function(){l(parseInt(z)+1)});jQuery(o)[u]().find("#tablePagination_lastPage").bind("click",function(){l(w)});jQuery(o)[u]().find(r).bind("change",function(){l(this.value)});jQuery(o)[u]().find(t).bind("change",
function(){h.rowsPerPage=parseInt(this.value,10);w=k();l(1);w==1?jQuery("#"+g.controlName+"_tablePagination_paginater").css("display","none"):jQuery("#"+g.controlName+"_tablePagination_paginater").css("display","")})})};var currPageNumber=[];OAT.partialTablePagination=function(c,g){var h={rowsPerPage:5,currPage:1,jstype:"pivot",optionsForRows:[5,10,25,50,100],ignoreRows:[],topNav:!1,cantPages:10},g=jQuery.extend(h,g);return c.each(function(){function c(j,k){if(!(1>j||j>jQuery("#"+g.controlName+"_tablePagination_paginater #tablePagination_totalPages")[0].innerHTML.replace("&nbsp;",
"")))if(currPageNumber[g.controlName]=j,jQuery(l)[m]().find(n).val(currPageNumber[g.controlName]),1<currPageNumber[g.controlName]?jQuery("#tablePagination_firstPage,#tablePagination_prevPage").removeClass("disabled_pivot_button"):jQuery("#tablePagination_firstPage,#tablePagination_prevPage").addClass("disabled_pivot_button"),currPageNumber[g.controlName]!=u?jQuery("#tablePagination_nextPage,#tablePagination_lastPage").removeClass("disabled_pivot_button"):jQuery("#tablePagination_nextPage,#tablePagination_lastPage").addClass("disabled_pivot_button"),
g.control&&"table"==g.jstype){var o=k?h.rowsPerPage:OAT_JS.grid.gridData[g.controlUcId].rowsPerPage;g.control.getDataForTable(g.controlUcId,j,o,k,"","","","","",!0);setTimeout(function(){u=g.control.getActualCantPages(g.controlUcId);currPageNumber[g.controlName]!=u?jQuery("#tablePagination_nextPage,#tablePagination_lastPage").removeClass("disabled_pivot_button"):jQuery("#tablePagination_nextPage,#tablePagination_lastPage").addClass("disabled_pivot_button")},500)}else g.control&&(o=k?h.rowsPerPage:
g.control.rowsPerPage,g.control.getDataForPivot(g.controlUcId,j,o,k,"","","","","",!0))}function k(){var c=1;try{var h=100;gx.util.browser.webkit&&!(0<jQuery("#"+g.controlName).closest(".gxwebcomponent").length)&&(h*=100);if(currPageNumber[g.controlName]>10*h){0<jQuery("#"+g.controlName).closest(".gxwebcomponent").length&&(c+=2);for(var j=currPageNumber[g.controlName]/h;10<j;)j/=10,c++}}catch(k){}var h=1==currPageNumber[g.controlName]?" disabled_pivot_button":"",j=currPageNumber[g.controlName]==u?
" disabled_pivot_button":"",l=-1<navigator.userAgent.toLowerCase().indexOf("android");!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()&&!l?(l=[],l.push("<div id='"+g.controlName+"_tablePagination' class='pivot_pag_div'>"),l.push("<span id='tablePagination_perPage'>"),l.push("<select id='"+g.controlName+"tablePagination_rowsPerPage'></select>")):(l=[],l.push("<div id='"+g.controlName+"_tablePagination' class='pivot_pag_div pivot_pag_div_sd'>"),l.push("<span id='tablePagination_perPage'>"),l.push("<select id='"+
g.controlName+"tablePagination_rowsPerPage'><option value='5'>5</option></select>"));l.push(" "+gx.getMessage("GXPL_QViewerJSPerPage")+" ");l.push("</span>");l.push("<span id='"+g.controlName+"_tablePagination_paginater'>");l.push("<div class='pagefirst "+h+"' id='tablePagination_firstPage' >");l.push('<i class="material-icons">first_page</i>');l.push("</div>");l.push("<div class='pageprev "+h+"' id='tablePagination_prevPage' >");l.push('<i class="material-icons">navigate_before</i>');l.push("</div>");
l.push("<span style=''>&nbsp;"+gx.getMessage("GXPL_QViewerJSPage")+"&nbsp;</span>");l.push("<input id='tablePagination_currPage' type='input' value='"+currPageNumber[g.controlName]+"' size='"+c+"'>");l.push("<span>&nbsp;"+gx.getMessage("GXPL_QViewerJSOf")+"</span><span id='tablePagination_totalPages'>&nbsp;"+u+"</span>");l.push("<div class='pagenext "+j+"' id='tablePagination_nextPage' >");l.push('<i class="material-icons">navigate_next</i>');l.push("</div>");l.push("<div class='pagelast "+j+"' id='tablePagination_lastPage'>");
l.push('<i class="material-icons">last_page</i>');l.push("</div>");l.push("</span>");l.push("</div>");return l.join("").toString()}var l=jQuery(this)[0],n,o;n="#tablePagination_currPage";o="#"+g.controlName+"tablePagination_rowsPerPage";var m=h.topNav?"prev":"next";try{h.rowsPerPage=parseInt(h.rowsPerPage)}catch(r){h.rowsPerPage=10}var t=jQuery.makeArray(jQuery("tbody tr",l));jQuery.grep(t,function(c){return-1==jQuery.inArray(c,h.ignoreRows)},!1);var u=h.cantPages;currPageNumber[g.controlName]=h.currPage>
u?1:h.currPage;-1==jQuery.inArray(h.rowsPerPage,h.optionsForRows)&&h.optionsForRows.push(h.rowsPerPage);0==jQuery(l)[m]().find("#tablePagination_totalPages").length?h.topNav?jQuery(this).before(k()):jQuery(this).after(k()):jQuery(l)[m]().find(n).val(currPageNumber[g.controlName]);(function(){var c=h.optionsForRows;c.sort(function(c,g){return c-g});for(var j=jQuery(l)[m]().find(o)[0],k=j.length=0;k<c.length;k++)j.options[k]=c[k]==h.rowsPerPage?new Option(c[k],c[k],!0,!0):new Option(c[k],c[k]);1==u||
0==u?jQuery("#"+g.controlName+"_tablePagination_paginater").css("display","none"):jQuery("#"+g.controlName+"_tablePagination_paginater").css("display","")})();jQuery(l)[m]().find("#tablePagination_firstPage").bind("click",function(){c(1,!1)});jQuery(l)[m]().find("#tablePagination_prevPage").bind("click",function(){c(currPageNumber[g.controlName]-1,!1)});jQuery(l)[m]().find("#tablePagination_nextPage").bind("click",function(){c(parseInt(currPageNumber[g.controlName])+1,!1)});jQuery(l)[m]().find("#tablePagination_lastPage").bind("click",
function(){c(parseInt(jQuery("#"+g.controlName+"_tablePagination_paginater #tablePagination_totalPages")[0].textContent.replace("&nbsp;","")),!1)});jQuery(l)[m]().find(n).bind("change",function(){c(parseInt(this.value,10),!1)});jQuery(l)[m]().find(o).bind("change",function(){h.rowsPerPage=parseInt(this.value,10);u=h.cantPages;c(1,!0)})})}};
